/*
 *
 * Wijmo Library 3.20132.12
 * http://wijmo.com/
 *
 * Copyright(c) GrapeCity, Inc.  All rights reserved.
 * 
 * Licensed under the Wijmo Commercial License. Also available under the GNU GPL Version 3 license.
 * licensing@wijmo.com
 * http://wijmo.com/widgets/license/
 *
 *
 */
var wijmo;(function(e){e.expando=".wijmo";var t=function(){function e(e){this.message=e,this.stack="Wijmo"+(new Error).stack,this.name="WijmoError"}return e}();e.WijmoError=t;var n=t;n.prototype=new Error,n.prototype.constructor=n})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){var n=function(){function t(e){this.object=e}return t.getFrom=function(r,i){typeof i=="undefined"&&(i=!0);var s=e.expando,o;if(Object(r)!==r)return null;o=r[s],o&&o.object!==r&&(o=null);if(i&&!(o instanceof t&&Object.prototype.hasOwnProperty.call(r,s))){o=new t(r);try{Object.defineProperty(r,s,{value:o,configurable:!1,enumerable:!1,writable:!1})}catch(u){r[s]=o}}return o},t}();t.Expando=n})(e.data||(e.data={}));var t=e.data})(wijmo||(wijmo={}));var wijmo;(function(e){(function(e){(function(e){function t(e){return function(){var t=function(){return e.prototype._call.apply(t,arguments)};return $.extend(t,e.prototype),e.apply(t,arguments),t}}e.funcClass=t})(e.util||(e.util={}));var t=e.util})(e.data||(e.data={}));var t=e.data})(wijmo||(wijmo={}));var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(e){function i(e){return t.isFunction(e.subscribe)}function l(e){return typeof e=="undefined"&&(e=null),new f(e)}function c(e){return typeof e=="undefined"&&(e=null),new f(e,!0)}function h(e){return t.isFunction(e)&&i(e)}var t=jQuery,n=function(){function e(e,t){this.handler=e,this.context=t}return e.prototype.trigger=function(e){return this.handler.apply(this.context,e)},e}();e.SubscriberEntry=n;var r=function(){function r(e){this.defaultContext=e,this._entries=[]}return r.prototype.subscribe=function(t,r){typeof r=="undefined"&&(r=this.defaultContext);var i=this,s=new n(t,r);return this._entries.push(s),{dispose:function(){return e.util.remove(i._entries,s)}}},r.prototype.trigger=function(){var t=[];for(var n=0;n<arguments.length-0;n++)t[n]=arguments[n+0];e.util.each(this._entries,function(e,n){return n.trigger(t)})},r.makeSubscribable=function(n){var i=new r(n);return n.subscribe=t.proxy(i.subscribe,i),i},r}();e.Subscribable=r,e.isSubscriptable=i;var s=function(){function e(){}return e.prototype.subscribe=function(e,t){return this._subscribable=this._subscribable||new r(this),this._subscribable.subscribe(e,t)},e.prototype._trigger=function(){var e=[];for(var t=0;t<arguments.length-0;t++)e[t]=arguments[t+0];this._subscribable&&this._subscribable.trigger.apply(this._subscribable,arguments)},e}();e.BaseObservable=s;var o=function(e){function t(t){e.call(this),this.mutable=t}return __extends(t,e),t.prototype._call=function(){return this.mutable.value},t}(s);e._ReadOnlyObservable=o;var u=e.util.funcClass(o),a=function(e){function t(t,n){typeof n=="undefined"&&(n=!1),e.call(this),this.value=t,this.checkNewValue=n}return __extends(t,e),t.prototype._call=function(e){return arguments.length>0&&(!this.checkNewValue||e!==this.value)&&(this.value=e,this._trigger(e),this._readOnly&&this._readOnly._trigger(e)),this.value},t.prototype.read=function(){return this._readOnly=this._readOnly||new u(this),this._readOnly},t}(s);e._MutableObservable=a;var f=e.util.funcClass(a);e.observable=l,e.observableWithNewValueCheck=c,e.isObservable=h})(e.data||(e.data={}));var t=e.data})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){(function(n){function i(e,t){return typeof t=="undefined"&&(t=!1),r.isArray(e)?e=e.slice(0):r.isPlainObject(e)&&(e=r.extend(!!t,{},e)),e}function s(e){return typeof e=="string"||e instanceof String}function o(e){return typeof e=="number"}function u(t){return t===e.expando||t===r.expando}function a(e,t){var n=this;r.each(e,function(e,r){if(!u(e))return t.call(n,e,r)})}function f(t,n){var i=r.map(t,n);return delete i[e.expando],i}function l(e){var t;return e&&r.isFunction(e.toString)&&e.toString!==Object.prototype.toString?t=e.toString():t=JSON.stringify(e),t!=null&&t.length>2&&t[0]==='"'&&t[t.length-1]==='"'&&(t=t.substr(1,t.length-2)),t}function c(e){var t=[];for(var n=0;n<arguments.length-1;n++)t[n]=arguments[n+1];return e.replace(/{(\d+)}/g,function(e,n){return l(t[parseInt(n,10)])})}function h(e,t){var n=!0;return a(e,function(e,r){n=r,t&&(n=t.call(n,n,e));if(!n)return!1}),n}function p(e,t){var n=!1;return a(e,function(e,r){n=r,t&&(n=t.call(n,n,e));if(n)return!1}),n}function d(e,t){var n,i,o;if(e==null)return t==null?0:-1;if(t==null)return 1;if(r.isArray(e)&&r.isArray(t)){i=Math.min(e.length,t.length);for(n=0;n<i;n++){o=d(e[n],t[n]);if(o!==0)return o}return e.length-t.length}return s(e)&&s(t)?(e=e.toLowerCase(),t=t.toLowerCase(),e<t?-1:e>t?1:0):(o=e-t,isNaN(o)?0:o)}function v(e,t){return r.inArray(t,e)>=0}function m(e,t){var n=0,r;for(r=0;r<e.length;)e[r]!==t?r++:(e.splice(r,1),n++);return n}function g(e,t){return e==-1?-1:e==0?0:t?Math.ceil(e/t):1}function y(e,t){function i(){return e.apply(t,n)}var n=[];for(var r=0;r<arguments.length-2;r++)n[r]=arguments[r+2];if(typeof setTimeout==typeof undefined)return i();setTimeout(i,10)}function b(e){if(typeof console=="undefined")return;console.error?console.error(e):console.log&&console.log(e)}function w(e,n){var r=0,i=e,s;for(;;){var o=n.indexOf(".",r);o>=0?(s=n.substring(r,o),r=o+1):r>0?s=n.substring(r):s=n,i=i[s],t.isObservable(i)&&(i=i());if(o<0)break}return i}function E(e,n,r){var i=0,s;for(;;){var o=n.indexOf(".",i);o>=0?(s=n.substring(i,o),i=o+1):i>0?s=n.substring(i):s=n;var u=e[s];if(!(o>=0)){t.isObservable(u)?u(r):e[s]=r;break}t.isObservable(u)&&(u=u()),e=u}}function S(e){return typeof e=="object"&&!r.isArray(e)&&!r.isPlainObject(e)&&e.constructor!==Object.prototype.constructor}function x(e){t.util.each(e,function(e,n){if(!n||typeof n!="object")return;t.util.each(n,function(e,r){var i;if(!t.util.isString(r))return;i=/\/Date\((-?\d+)\)\//.exec(r);if(!i)return;n[e]=new Date(parseInt(i[1],10))})})}var r=jQuery;n.clone=i,n.isString=s,n.isNumeric=o,n.isInternalProperty=u,n.each=a,n.map=f,n.toStr=l,n.format=c,n.every=h,n.some=p,n.compare=d,n.contains=v,n.remove=m,n.pageCount=g,n.executeDelayed=y,n.logError=b,n.getProperty=w,n.setProperty=E,n.isClassInstance=S,n.convertDateProperties=x;var T=function(){function e(e){this.key=e}return e}();n.HashMapEntry=T;var N=function(){function e(){this.hash={}}return e.prototype.getEntry=function(e,t){typeof t=="undefined"&&(t=!1);if(e===null)return!this.nullEntry&&t&&(this.nullEntry=new T(e)),this.nullEntry;var n=String(e),r=this.hash[n],i;if(r==null){if(!t)return null;r=[],this.hash[n]=r}for(var s=0;s<r.length;s++)if(r[s].key===e)return r[s];return t&&(i=new T(e),r.push(i)),null},e.prototype.containsKey=function(e){return!!this.getEntry(e)},e.prototype.get=function(e,t){typeof t=="undefined"&&(t=null);var n=this.getEntry(e);return n?n.value:t},e.prototype.put=function(e,t){this.getEntry(e,!0).value=t},e}();n.HashMap=N})(t.util||(t.util={}));var n=t.util})(e.data||(e.data={}));var t=e.data})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){t.errors={},t.errors._register=function(n){t.util.each(n,function(n,r){function i(){var n=[];for(var i=0;i<arguments.length-0;i++)n[i]=arguments[i+0];var s;return $.isFunction(r)?r=r.apply(this,arguments):arguments.length>0&&(n.unshift(r),r=t.util.format.apply(this,n)),r=$.trim(r),s=r[r.length-1],s!=="."&&s!=="!"&&s!=="?"&&(r+="."),new e.WijmoError(r)}t.errors[n]=function(){throw i.apply(this,arguments)},t.errors[n].create=i})},t.errors._register({indexOutOfBounds:"Index is outside the bounds of the array.",notImplemented:"The operation is not implemented",unsupportedOperation:"Unsupported operation",unsupportedFilterOperator:"Unsupported filter operator: {0}",unsupportedDataSource:"Unsupported data source",argument:function(e){var t="Unexpected argument value.";return e&&(t+="\nParameter name: "+e),t},argumentNull:"Argument '{0}' is null/undefined",noParser:"There is no parser for type '{0}'",noUrl:"Url is not specified",cantConvert:"Value can't be converted to type '{0}': '{1}'",noGlobalize:"Globalize is not defined. Make sure you include globalize.js",itemNotInView:"Item {0} is not in the data view",unsupportedFilterFormat:"The filter format is not supported",multiPropertyKeysNotSupported:"Entities with multiple properties in the primary key are not supported. Entity type: {0}",keyPropertyNotFound:"Key property not found in {0} entity type"})})(e.data||(e.data={}));var t=e.data})(wijmo||(wijmo={}));var wijmo;(function(e){(function(e){(function(t){function r(n,r){typeof r=="undefined"&&(r=!1),n=n.toLowerCase();var i=t.ops[n];if(!i){var s=t.opMap[n];s&&(i=t.ops[s])}return!i&&r&&e.errors.unsupportedFilterOperator(n),i}function i(i){var s;if(!n.isPlainObject(i))return{operator:"==",op:t.ops.equals,value:i};var o=i.operator||t.ops.equals;if(e.util.isString(i.operator)){if(i.operator.toLowerCase()==="nofilter")return null;o=r(i.operator,!0)}else n.isFunction(o.apply)||e.errors.unsupportedFilterOperator(o);return{operator:i.operator,op:o,value:i.value}}function s(t){var r={original:t,func:null,normalized:null};if(n.isFunction(t))r.func=t;else if(n.isArray(t))e.errors.unsupportedFilterFormat(t);else if(t){r.normalized={};var s=!1;e.util.each(t,function(t,o){n.isArray(o)&&e.errors.unsupportedFilterFormat(),o=i(o),o&&(r.normalized[t]=o,s=!0)}),s?r.func=function(t){return e.util.every(r.normalized,function(n,r){var i=e.util.getProperty(t,r);return n.op.apply(i,n.value)})}:r.normalized=null}return!r.normalized&&!r.func&&(r.func=function(e){return!0}),r}var n=jQuery;t.opMap={"==":"equals",doesnotcontain:"notcontain","!=":"notequal",">":"greater","<":"less",">=":"greaterorequal","<=":"lessorequal",isnotempty:"notisempty",isnotnull:"notisnull"},t.normalizeCondition=i,t.compile=s,t.ops=function(){function r(e,n,r,i,s){return t[e.toLowerCase()]={name:e,displayName:n,arity:r,applicableTo:i,apply:s}}function i(t){return t instanceof Date&&(t=t.getTime()),e.util.isString(t)&&(t=t.toLowerCase()),t}function s(e,t,n,s){r(e,t,2,n,function(e,t){return s(i(e),i(t))})}function o(e,t,n,i){r(e,t,1,n,i)}function u(e,t,r){s(e,t,n.prim,r)}function a(e,t,r){s(e,t,n.str,r)}var t={},n={str:["string"],prim:["string","number","datetime","currency","boolean"]};return u("Equals","Equals",function(e,t){return e==t}),u("NotEqual","Not equal",function(e,t){return e!=t}),u("Greater","Greater than",function(e,t){return e>t}),u("Less","Less than",function(e,t){return e<t}),u("GreaterOrEqual","Greater or equal",function(e,t){return e>=t}),u("LessOrEqual","Less or equal",function(e,t){return e<=t}),a("Contains","Contains",function(e,t){return e==t||e&&e.indexOf&&e.indexOf(t)>=0}),a("NotContain","Does not contain",function(e,t){return e!=t&&(!e||!e.indexOf||e.indexOf(t)<0)}),a("BeginsWith","Begins with",function(e,t){return e==t||e&&e.indexOf&&e.indexOf(t)==0}),a("EndsWith","Ends with",function(t,n){var r;return!e.util.isString(t)||!e.util.isString(n)?!1:(r=t.lastIndexOf(n),r>=0&&t.length-r===n.length)}),o("IsEmpty","Is empty",n.str,function(e){return!e&&e!==0&&e!==!1}),o("NotIsEmpty","Is not empty",n.str,function(e){return!!e||e===0||e===!1}),o("IsNull","Is null",n.prim,function(e){return e==null}),o("NotIsNull","Is not null",n.prim,function(e){return e!=null}),t}()})(e.filtering||(e.filtering={}));var t=e.filtering})(e.data||(e.data={}));var t=e.data})(wijmo||(wijmo={}));var wijmo;(function(e){(function(e){(function(t){function n(t){var n=[];return t=e.util.isString(t)?t.split(/,\s*/):$.isArray(t)?t.slice(0):[t],t=$.isArray(t)?t.slice(0):[t],e.util.each(t,function(t,r){var i=!0,s;if(r==null)return;if(!e.util.isString(r)){r.property!=null&&n.push(r);return}if(r[0]==="-")i=!1,r=r.substr(1);else{var o=/\s(asc|desc)\s*$/.exec(r);o&&(r=r.substr(0,o.index),i=o[1]!=="desc")}n.push({property:r,asc:i})}),n.length>0?n:null}function r(t,r){typeof r=="undefined"&&(r=e.util.compare);var i=n(t),s={original:t,propertyCompareTo:r,compare:null,normalized:i};return i!=null&&(s.compare=function(t,n){var s=0,o,u;for(s=0;s<i.length;s++){u=i[s],o=r(e.util.getProperty(t,u.property),e.util.getProperty(n,u.property));if(o!==0)return u.asc||(o=-o),o}return 0}),s}t.compile=r})(e.sorting||(e.sorting={}));var t=e.sorting})(e.data||(e.data={}));var t=e.data})(wijmo||(wijmo={}));var wijmo;(function(e){(function(e){function r(r){return t.isFunction(r)||e.errors.argument("factory"),n.push(r),{dispose:function(){e.util.remove(n,r)}}}function i(t){if(s(t))return t;var r=e.util.some(n,function(e){return e(t)});return r||e.errors.unsupportedDataSource()}function s(e){return e&&t.isFunction(e.count)&&t.isFunction(e.item)&&t.isFunction(e.getProperty)}var t=jQuery,n=[];e.registerDataViewFactory=r,r(function(e){return s(e)&&e}),r(function(n){return t.isArray(n)&&new e.ArrayDataView(n)}),e.asDataView=i,e.isDataView=s})(e.data||(e.data={}));var t=e.data})(wijmo||(wijmo={}));var wijmo;(function(e){(function(e){var t=jQuery,n=function(){function n(n){function i(e){return function(){if(r)return;r=!0;try{e.apply(this,arguments)}finally{r=!1}}}this.array=n,this.currentItem=e.observableWithNewValueCheck(null),this.currentPosition=e.observableWithNewValueCheck(-1);var r=!1;this.currentItem.subscribe(i(function(e){this.currentPosition(e==null?-1:t.inArray(e,this.array))}),this),this.currentPosition.subscribe(i(function(t){e.util.isNumeric(t)||e.errors.argument("value"),(t<-1||t>=this.array.length)&&e.errors.indexOutOfBounds(),this.currentItem(t<0?null:this.array[t])}),this)}return n.prototype.update=function(){var e=this.currentItem(),n=this.currentPosition(),r=t.inArray(e,this.array);r<0&&e==null&&this._recentlyRemovedItem!=null&&(r=t.inArray(this._recentlyRemovedItem,this.array)),r>=0?(e&&(this._recentlyRemovedItem=e),this.currentPosition(r)):n>=0&&n<this.array.length?this.currentItem(this.array[n]):n==this.array.length&&this.array.length>0?(n=this.array.length-1,this.currentPosition(n),this.currentItem(this.array[n])):(this.currentPosition(-1),this.currentItem(null))},n.prototype.updateDelayed=function(){e.util.executeDelayed(this.update,this)},n}();e.CurrencyManager=n})(e.data||(e.data={}));var t=e.data})(wijmo||(wijmo={}));var wijmo;(function(e){(function(e){var t=jQuery,n=function(){function t(t){function n(){this.pageSize()>0&&this.pageIndex()>=0?(this._skip=this.pageSize()*this.pageIndex(),this._take=this.pageSize()):(this._skip=0,this._take=-1),t(!0)}this.onChanged=t,this.filter=e.observable(),this._compiledFilter=e.filtering.compile(null),this.sort=e.observable(),this._compiledSort=e.sorting.compile(null),this.pageIndex=e.observable(0),this.pageSize=e.observable(0),this._skip=0,this._take=-1,this.filter.subscribe(function(e){this.onFilterChanged(e),t()},this),this.sort.subscribe(function(){this._compiledSort=e.sorting.compile(this.sort()),t()},this),this.pageIndex.subscribe(n,this),this.pageSize.subscribe(n,this)}return t.prototype.onFilterChanged=function(t){this._compiledFilter=e.filtering.compile(t)},t.prototype.setFilter=function(e){this.filter(e)},t.prototype.update=function(e){"filter"in e&&this.setFilter(e.filter),"sort"in e&&this.sort(e.sort),"pageSize"in e&&this.pageSize(e.pageSize),"pageIndex"in e&&this.pageIndex(e.pageIndex)},t.prototype.apply=function(t,n){typeof n=="undefined"&&(n=!0);var r=this,i=[];e.util.each(t,function(e,t){if(r._compiledFilter.func&&!r._compiledFilter.func(t))return;i.push(t)}),this._compiledSort.compare&&i.sort(this._compiledSort.compare);var s=i.length;return n&&this._take>0&&(this._skip>0&&i.splice(0,Math.min(this._skip,i.length)),this._take<i.length&&(i.length=this._take)),{results:i,totalCount:s}},t.prototype.toObj=function(){return{filter:this._compiledFilter.normalized,sort:this._compiledSort.normalized,pageSize:this.pageSize(),pageIndex:this.pageIndex()}},t}();e.Shape=n;var r=function(){function r(t){this.isRemote=!1,this.localPaging=!0,this.local=[],this._updatingShape=!1,this._pageCount=e.observable(1),this._totalItemCount=e.observable(0),this._isLoaded=e.observable(!1),this._isLoading=e.observable(!1),this._currentEditItem=e.observable(),this._isCurrentEditItemNew=!1,this._currentEditItemSnapshot=null,this.isLoading=this._isLoading.read(),this.isLoaded=this._isLoaded.read(),this._changed=new e.Subscribable(this),this.currentEditItem=this._currentEditItem.read(),this._initCurrency(),this._initShape(t)}return r.prototype.dispose=function(){},r.prototype.count=function(){return this.local.length},r.prototype.item=function(t){return(t<0||t>=this.local.length)&&e.errors.indexOutOfBounds(),this.local[t]},r.prototype.indexOf=function(e){return t.inArray(e,this.local)},r.prototype.getSource=function(){return this.sourceArray},r.prototype.toObservableArray=function(){return this._koArray||(this._koArray=ko.observableArray(this.local)),this._koArray},r._getProps=function(r){var i=[];return e.util.each(r,function(e,n){e=String(e);if(e.match(/^_/))return;if(t.isFunction(n)&&!n.subscribe)return;i.push({name:e})}),i},r.prototype.getProperties=function(){return this.count()?r._getProps(this.item(0)):[]},r.prototype._readProperty=function(t,n){return e.util.getProperty(t,n)},r.prototype.getProperty=function(e,t){var n=this._getItem(e);return this._readProperty(n,t)},r.prototype._writeProperty=function(t,n,r){e.util.setProperty(t,n,r)},r.prototype.setProperty=function(e,t,n){var r=this._getItem(e);return r===this.currentEditItem()&&this._currentEditItemSnapshot&&!(t in this._currentEditItemSnapshot)&&(this._currentEditItemSnapshot[t]=this.getProperty(e,t)),this._writeProperty(r,t,n),this},r.prototype.subscribe=function(e,t){return this._changed.subscribe(e,t)},r.prototype.trigger=function(){this._currencyManager.update(),this._changed.trigger(this.local),this._koArray&&this._koArray.notifySubscribers(this.local)},r.prototype.canFilter=function(){return!0},r.prototype.canSort=function(){return!0},r.prototype._updateShape=function(e){this._updatingShape=!0;try{this._shape.update(e)}finally{this._updatingShape=!1}},r.prototype.prevPage=function(){return this.pageIndex()<1?!1:(this.pageIndex(this.pageIndex()-1),!0)},r.prototype.nextPage=function(){return this.pageCount()>0&&this.pageIndex()+1>=this.pageCount()?!1:(this.pageIndex(this.pageIndex()+1),!0)},r.prototype._createShape=function(e){return new n(e)},r.prototype._initShape=function(e){var t=this,n=function(e){typeof e=="undefined"&&(e=!1),t._updatingShape||t.refresh(null,e&&t.localPaging)};this._shape=this._createShape(n),e&&this._updateShape(e),this.filter=this._shape.filter,this.sort=this._shape.sort,this.pageIndex=this._shape.pageIndex,this.pageSize=this._shape.pageSize,this.pageCount=this._pageCount.read(),this.totalItemCount=this._totalItemCount.read()},r.prototype._localRefresh=function(n){typeof n=="undefined"&&(n=this.localPaging);var r=this,i=this._shape.apply(this.sourceArray,n);return this.local.length=0,t.each(i.results,function(e,t){return r.local.push(t)}),n&&this._totalItemCount(i.totalCount),this._pageCount(e.util.pageCount(this.totalItemCount(),this.pageSize())),this.trigger(),t.Deferred().resolve().promise()},r.prototype._remoteRefresh=function(){return this._localRefresh()},r.prototype.refresh=function(e,t){typeof t=="undefined"&&(t=!1);var n=this;this.cancelRefresh(),e&&this._updateShape(e),this._isLoading(!0);var r=t?this._localRefresh():this._remoteRefresh();return r.then(function(){n._isLoaded(!0),n._isLoading(!1)})},r.prototype.cancelRefresh=function(){},r.prototype._initCurrency=function(){this._currencyManager=new e.CurrencyManager(this.local),this.currentItem=this._currencyManager.currentItem,this.currentPosition=this._currencyManager.currentPosition},r.prototype.isCurrentEditItemNew=function(){return this._isCurrentEditItemNew},r.prototype._beginEdit=function(e,t){this.commitEdit(),this._currentEditItemSnapshot={},this._isCurrentEditItemNew=t,this._currentEditItem(e)},r.prototype.canAdd=function(){return!0},r.prototype.add=function(t){t||e.errors.argument("item"),this.commitEdit(),this.local.push(t),this._beginEdit(t,!0),this.trigger()},r.prototype.canAddNew=function(){return!1},r.prototype.addNew=function(){return e.errors.unsupportedOperation()},r.prototype.editItem=function(e){typeof e=="undefined"&&(e=this.currentItem()),this.commitEdit(),e=this._getItem(e),e&&this._beginEdit(e,!1)},r.prototype.canRemove=function(){return!0},r.prototype._remove=function(t){this.local.splice(t.index,1),e.util.remove(this.sourceArray,t.item),this.trigger()},r.prototype.remove=function(e){typeof e=="undefined"&&(e=this.currentItem()),this.commitEdit();var t=this._resolve(e);return t?(this._remove(t),!0):!1},r.prototype.canCancelEdit=function(){return!0},r.prototype.cancelEdit=function(){var n=this,r;if(!this.currentEditItem())return;var i=this.currentEditItem();this._currentEditItem(null),this._isCurrentEditItemNew?e.util.remove(this.local,this.item):this._currentEditItemSnapshot&&t.each(this._currentEditItemSnapshot,function(e,t){return n._writeProperty(i,e,t)}),this.trigger()},r.prototype.canCommitEdit=function(){return!0},r.prototype.commitEdit=function(){if(!this.currentEditItem())return;var t=this.currentEditItem;this._currentEditItem(null),this._isCurrentEditItemNew&&this.sourceArray.push(t);var n=this._shape._compiledFilter.func;n&&!n(t)&&e.util.remove(this.local,t),this.trigger()},r.prototype._getItem=function(t){var n;return e.util.isNumeric(t)?this.item(t):t},r.prototype._resolve=function(t,n){typeof n=="undefined"&&(n=!1);var r;return e.util.isNumeric(t)?{index:t,item:this.item(t)}:(r=this.indexOf(t),r<0?(n&&e.errors.itemNotInView(t),null):{index:r,item:t})},r}();e.ArrayDataViewBase=r;var i=function(e){function t(t,n){e.call(this,n),this.sourceArray=t,this.refresh()}return __extends(t,e),t}(r);e.ArrayDataView=i})(e.data||(e.data={}));var t=e.data})(wijmo||(wijmo={}));var wijmo;(function(e){(function(e){var t=jQuery,n=function(e){function n(t){e.call(this),this.isRemote=!0,this.sourceArray=[],t&&this._construct(t)}return __extends(n,e),n.prototype._construct=function(e){this.options=e=t.extend({localPaging:!1},e),this.localPaging=e.localPaging,this._updateShape(e)},n}(e.ArrayDataViewBase);e.RemoteDataView=n})(e.data||(e.data={}));var t=e.data})(wijmo||(wijmo={}));;
var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(e){var t=jQuery,n=function(){function e(e){this._originalReader=e}return e.prototype.read=function(e){e.items=null,this._originalReader&&t.isFunction(this._originalReader.read)&&this._originalReader.read(e),t.isArray(e.items)||(t.isArray(e.data)?e.items=e.data:e.data&&t.isArray(e.data.rows)?e.items=e.data.rows:e.items=[]);if(e.dynamic)if(!e.data||isNaN(e.data.totalRows))throw"totalRows value is missing"},e}(),r=function(r){function i(e){var i=this;r.call(this),this.dataSource=e,this.isRemote=!0,this.localPaging=!0,this._origLoaded=e.loaded,this._origReader=e.reader,e.loaded=function(e,n){i._loaded(),t.isFunction(i._origLoaded)&&i._origLoaded.apply(i,arguments)},e.reader=new n(e.reader);var s=e.items&&e.items.length>0;t.isArray(e.data)&&!s&&e.read(),e.items&&this._loaded()}return __extends(i,r),i.prototype.dispose=function(){this.dataSource.loaded=this._origLoaded,this.dataSource.reader=this._origReader,r.prototype.dispose.call(this)},i.prototype.getProperties=function(){return this.sourceArray&&this.sourceArray.length?e.ArrayDataViewBase._getProps(this.sourceArray[0]):[]},i.prototype._loaded=function(){this.sourceArray=this.dataSource.items,this.dataSource.data&&e.util.isNumeric(this.dataSource.data.totalRows)&&this._totalItemCount(this.dataSource.data.totalRows);var t=r.prototype._localRefresh.call(this,!this.dataSource.dynamic);this._currentDeferred&&t.then(this._currentDeferred.resolve)},i.prototype._remoteRefresh=function(){this._currentDeferred&&this._currentDeferred.state()==="pending"&&this._currentDeferred.fail(),this._currentDeferred=t.Deferred();var e={},n=!1;return this.dataSource.dynamic&&(n=!0,e.data=this._prepareRequest(),this.dataSource.proxy&&(this._origDataOption||(this._origDataOption=t.extend({},this.dataSource.proxy.options.data)),this.dataSource.proxy.options.data=t.extend({},this._origDataOption,e.data))),this.dataSource.load(e,n),this._currentDeferred},i.prototype._prepareRequest=function(){return{filtering:this._prepareFilterRequest(),paging:this._preparePageRequest(),sorting:this._prepareSortRequest()}},i.prototype._prepareFilterRequest=function(){var e=[];return this._shape._compiledFilter&&this._shape._compiledFilter.normalized&&t.each(this._shape._compiledFilter.normalized,function(t,n){e.push({dataKey:t,filterOperator:n.op.Name,filterValue:n.value})}),e},i.prototype._preparePageRequest=function(){return{pageIndex:this._shape.pageIndex(),pageSize:this._shape.pageSize()}},i.prototype._prepareSortRequest=function(){return!this._shape._compiledSort||!this._shape._compiledSort.normalized||this._shape._compiledSort.normalized.length==0?[]:t.map(this._shape._compiledSort.normalized,function(e){return{dataKey:e.property,sortDirection:e.asc?"ascending":"descending"}})},i}(e.ArrayDataViewBase);e.registerDataViewFactory(function(e){if(typeof wijdatasource=="function"&&e instanceof wijdatasource)return new r(e);return})})(e.data||(e.data={}));var t=e.data})(wijmo||(wijmo={}));;
var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype._create=function(){window.wijmoApplyWijTouchUtilEvents&&(n=window.wijmoApplyWijTouchUtilEvents(n)),this.element.addClass(this.options.wijCSS.widget+" wijmo-wijpager "+this.options.wijCSS.helperClearFix),this.options.disabled&&this.disable(),this._refresh()},t.prototype._destroy=function(){this.element.removeClass(this.options.wijCSS.widget+" wijmo-wijpager "+this.options.wijCSS.helperClearFix),this.$ul.remove()},t.prototype._setOption=function(e,t){this._super(e,t),this._refresh()},t.prototype._refresh=function(){this._validate(),this.$ul&&this.$ul.remove(),this.element.append(this.$ul=n('<ul class="ui-list '+this.options.wijCSS.cornerAll+" "+this.options.wijCSS.content+" "+this.options.wijCSS.helperClearFix+'" role="tablist"></ul>'));switch((this.options.mode||"").toLowerCase()){case"nextprevious":this._createNextPrev(!1);break;case"nextpreviousfirstlast":this._createNextPrev(!0);break;case"numeric":this._createNumeric(!1);break;case"numericfirstlast":this._createNumeric(!0)}},t.prototype._validate=function(){var e=this.options;if(isNaN(e.pageCount)||e.pageCount<1)e.pageCount=1;isNaN(e.pageIndex)||e.pageIndex<0?e.pageIndex=0:e.pageIndex>=e.pageCount&&(e.pageIndex=e.pageCount-1);if(isNaN(e.pageButtonCount)||e.pageButtonCount<1)e.pageButtonCount=1},t.prototype._createNextPrev=function(e){var t=this.options;e&&t.pageIndex&&this.$ul.append(this._createPagerItem(!1,t.firstPageText,1,t.firstPageClass)),t.pageIndex&&this.$ul.append(this._createPagerItem(!1,t.previousPageText,t.pageIndex,t.previousPageClass)),t.pageIndex+1<t.pageCount&&this.$ul.append(this._createPagerItem(!1,t.nextPageText,t.pageIndex+2,t.nextPageClass)),e&&t.pageIndex+1<t.pageCount&&this.$ul.append(this._createPagerItem(!1,t.lastPageText,t.pageCount,t.lastPageClass))},t.prototype._createNumeric=function(e){var t=this.options,n=t.pageIndex+1,r=1,i=Math.min(t.pageCount,t.pageButtonCount),s;n>i&&(r=Math.floor(t.pageIndex/t.pageButtonCount)*t.pageButtonCount+1,i=r+t.pageButtonCount-1,i=Math.min(i,t.pageCount),i-r+1<t.pageButtonCount&&(r=Math.max(1,i-t.pageButtonCount+1))),r!==1&&(e&&this.$ul.append(this._createPagerItem(!1,t.firstPageText,1,t.firstPageClass)),this.$ul.append(this._createPagerItem(!1,"...",r-1,"")));for(s=r;s<=i;s++)this.$ul.append(this._createPagerItem(s===n,s.toString(),s,""));t.pageCount>i&&(this.$ul.append(this._createPagerItem(!1,"...",i+1,"")),e&&this.$ul.append(this._createPagerItem(!1,t.lastPageText,t.pageCount,t.lastPageClass)))},t.prototype._createPagerItem=function(e,t,r,i){var s,o=this.options.wijCSS,u=this,a=n("<li />").addClass("wijmo-wijpager-button "+o.cornerAll).attr({role:"tab","aria-label":t,title:t});return e?a.addClass(o.stateActive).attr("aria-selected","true"):a.addClass(o.stateDefault).hover(function(){u.options.disabled||n(this).addClass(o.stateHover)},function(){u.options.disabled||n(this).removeClass(o.stateHover)}).bind("click."+this.widgetName,{newPageIndex:r-1},n.proxy(this._onClick,this)),e?s=n("<span />"):s=i?n("<span />").addClass(o.icon+" "+i):n("<a/>").attr("href","#"),s.text(t),a.append(s),a},t.prototype._onClick=function(e){if(this.options.disabled)return!1;var t={newPageIndex:e.data.newPageIndex,handled:!1};if(this._trigger("pageIndexChanging",null,t)!==!1&&this.options.pageIndex!==t.newPageIndex){this.options.pageIndex=t.newPageIndex,t.handled||this._refresh();var n={newPageIndex:t.newPageIndex};this._trigger("pageIndexChanged",null,n)}return!1},t}(e.wijmoWidget);t.wijpager=r,r.prototype.widgetEventPrefix="wijpager";var i=function(){function e(){this.wijMobileCSS={header:"ui-header ui-bar-a",content:"ui-body-c",stateDefault:"ui-btn-up-c",stateHover:"ui-btn-down-b",stateActive:"ui-btn-down-c"},this.firstPageClass=n.wijmo.widget.prototype.options.wijCSS.iconSeekFirst,this.firstPageText="First",this.lastPageClass=n.wijmo.widget.prototype.options.wijCSS.iconSeekEnd,this.lastPageText="Last",this.mode="numeric",this.nextPageClass=n.wijmo.widget.prototype.options.wijCSS.iconSeekNext,this.nextPageText="Next",this.pageButtonCount=10,this.previousPageClass=n.wijmo.widget.prototype.options.wijCSS.iconSeekPrev,this.previousPageText="Previous",this.pageCount=1,this.pageIndex=0,this.pageIndexChanging=null,this.pageIndexChanged=null}return e}();r.prototype.options=n.extend(!0,{},e.wijmoWidget.prototype.options,new i),n.wijmo.registerWidget("wijpager",r.prototype)})(e.pager||(e.pager={}));var t=e.pager})(wijmo||(wijmo={}));;
var wijmo;(function(e){(function(e){"use strict";var t=jQuery,n,r,i;n=function(e){var t=this;t.data={},t.reader=null,t.proxy=null,t.items=[],t.loading=null,t.loaded=null,t._constructor(e)},window.wijdatasource=n,t.extend(n.prototype,{_constructor:function(e){t.extend(this,e)},load:function(e,n){var r=this,i=r.proxy;if(t.isFunction(r.loading)&&r.loading(r,e)===!1)return;i?i.request(r,r.loaded,e):((r.items.length===0||n)&&this.read(),t.isFunction(r.loaded)&&r.loaded(r,e))},read:function(){var e=this,t=e.data;t&&e.reader?e.reader.read(e):e.items=e.data}}),r=function(e){t.isFunction(window.wijmoASPNetParseOptions)&&wijmoASPNetParseOptions(e),t.isArray(e)&&(this.fields=e)},window.wijarrayreader=r,t.extend(r.prototype,{read:function(e){t.isArray(e.data)?e.items=this._map(e.data):e.items=[]},_map:function(e){var n=this,r=[];return n.fields===undefined||n.fields.length===0?(t.extend(!0,r,e),r):(t.each(e,function(e,i){var s={};t.each(n.fields,function(e,n){n.mapping&&typeof n.mapping&&window[n.mapping]&&(n.mapping=window[n.mapping]);if(t.isFunction(n.mapping))return s[n.name]=n.mapping(i),!0;var r=n.mapping!==undefined?n.mapping:n.name,o=i[r];o===undefined&&(n.defaultValue!==undefined?o=n.defaultValue:o=i),s[n.name]=o}),r.push(s)}),r)}}),i=function(e){this.options=e,t.isFunction(window.wijmoASPNetParseOptions)&&wijmoASPNetParseOptions(e)},window.wijhttpproxy=i,t.extend(i.prototype,{request:function(e,n,r){var i=this,s,o;s=t.extend({},this.options),o=s.success,s.success=function(u){t.isFunction(o)&&o(u),i._complete(u,e,n,s,r)},t.ajax(s)},_complete:function(e,n,r,i,s){n.data=i.key!==undefined?e[i.key]:e,n.read(),t.isFunction(r)&&r(n,s)}})})(e.checkbox||(e.checkbox={}));var t=e.checkbox})(wijmo||(wijmo={}));;
var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(t){"use strict";var n=jQuery,r="wijcombobox",i="wijmo-wijcombobox-input",s=function(t){function r(){t.apply(this,arguments)}return __extends(r,t),r.prototype._create=function(){var e=this,t;e.selectedItem=null,e.selectedItems=[],window.wijmoApplyWijTouchUtilEvents&&(n=window.wijmoApplyWijTouchUtilEvents(n));try{t=document.activeElement}catch(r){}e._initInnerData(),e._createDOMElements(),e._bindInputEvents(),e._initDropDownList(),e.repaint(),e._checkSelectIndex(),e._usingRemoteData()&&e.options.data&&(e.originalDataSourceLoaded=e.options.data.loaded),t===e._input[0]&&e.options.isEditable&&n(function(){e._input.focus()}),e.element.is(":hidden")&&e.element.wijAddVisibilityObserver&&e.element.wijAddVisibilityObserver(function(){e.repaint(),e.element.wijRemoveVisibilityObserver&&e.element.wijRemoveVisibilityObserver()},"wijcombobox")},r.prototype._initInnerData=function(){var e=this,t=e.options,r;t.dataSource!==null?(r=e._isBind(),r?e.innerData=e._getMappingItems():e.innerData=t.data):e.innerData=t.data,n.isArray(e.innerData)&&(e.items=[],n.each(e.innerData,function(t,r){e.items.push(n.extend(!0,{},r))}),e.innerData=e.items),e.listHasCreated=!1},r.prototype._checkSelectIndex=function(){var e=this,t,r=e.options,i=e.innerData;r.selectedIndex===-1&&r.selectedValue&&n.each(i,function(e,t){if(i[e].value===r.selectedValue)return r.selectedIndex=e,r.selectionMode==="multiple"&&(r.selectedIndex=[r.selectedIndex]),!1}),t=r.selectedIndex,!e._usingRemoteData()&&(t>=0||n.isArray(t))&&(this.menu.unselectItems(t),e.search(null,"checkindex")),r.selectedIndex===-1&&r.text&&(!r.forceSelectionText||r.forceSelectionText&&e._checkTextInItems(r.text)!==-1)&&(e._input.val(r.text),r.selectedIndex=e._checkTextInItems(r.text),r.selectionMode==="multiple"&&(r.selectedIndex=[r.selectedIndex]),r.selectedIndex>-1&&e._checkSelectIndex())},r.prototype.repaint=function(){var e=this.options,t=this;if(t.element.is(":visible")||t._comboDiv||t._select!==undefined&&t._input.is(":visible")){t._showTrigger();if(e.disabledState){var n=e.disabled;t.disable(),e.disabled=n}return e.disabled&&t.disable(),!0}return!1},r.prototype._bindInputEvents=function(){var t=this,r=this.options.wijCSS,i,s,o,u,a;i=t._input,s=t.options,i.bind("keydown.wijcombobox",function(r){if(s.disabledState===!0||s.disabled)return;o=r.keyCode,u=e.getKeyCodeEnum();switch(o){case u.UP:t._move("previous",r),r.preventDefault();break;case u.DOWN:t._move("next",r),r.preventDefault();break;case u.ENTER:t.menu.active&&(r.preventDefault(),s.selectionMode==="multiple"&&t.menu&&t.menu.items&&t.menu.items.length===1&&n.each(t.selectedItems,function(e,n){n!==t.menu.items[0]&&(n.selected=!1)}),t.menu.select(r)),r.preventDefault();break;case u.TAB:i.trigger("wijcomboblur");if(!t.menu.active||s.selectionMode==="multiple"&&u.TAB===o)return;t.menu.select(r);var a=i.val().length;t._selectText(a,a,i);break;case u.ESCAPE:t.close(r,undefined);break;case u.LEFT:case u.RIGHT:case u.SHIFT:case 16:case 17:case u.CONTROL:case u.HOME:case u.END:case u.DELETE:case u.PAGE_UP:case u.PAGE_DOWN:break;case 18:i.trigger("wijcomboblur");break;default:window.clearTimeout(t.searching),s.isEditable===!1&&(t._cacheKey===undefined&&(t._cacheKey=""),t._cacheKey+=String.fromCharCode(o)),t.searching=window.setTimeout(function(){var e;s.isEditable===!1?(e=t._cacheKey,t._cacheKey=undefined):e=i.val(),t.search(e,r)},s.delay)}}).bind("wijcomboblur.wijcombobox",function(e){window.clearTimeout(t.searching),t._addInputFocus(!1,r.stateFocus),t.closing=window.setTimeout(function(){t.close(e,!0)},150)}).bind("focus.wijcombobox",function(){t._addInputFocus(!0,r.stateFocus)}).bind("blur.wijcombobox",function(){t.menu.element.is(":visible")||i.trigger("wijcomboblur"),a=i.val(),s.text!==a&&t._trigger("textChanged",null,{oldText:s.text,newText:a}),t._change()}),n.browser.msie&&parseInt(n.browser.version)>9&&i.bind("mouseup.wijcombobox",function(e){if(i.val()=="")return;setTimeout(function(){i.val()==""&&(t._clearSelection(),t._setSelectedIndex(-1))},5)})},r.prototype._addInputFocus=function(e,t){var n=this,r,i,s;r=n._input.parent(),i=e?"addClass":"removeClass",s=n._triggerArrow,r[i](t),s!==undefined&&s[i](t)},r.prototype._renderColumnsHeader=function(e){var t=this,r=n("<ul class='wijmo-wijcombobox-rowheader'></ul>");n.each(this.options.columns,function(e,i){var s=n("<li class='wijmo-wijcombobox-cell "+t.options.wijCSS.header+"'></li>");s.html(i.name),i.width!==undefined&&s.width(i.width),s.appendTo(r)}),e.append(r)},r.prototype._hasSameValueText=function(e,t){return e.label===t.label&&e.value===t.value},r.prototype._getItemIndex=function(e,t){var r=-1;return n.each(t,function(t,n){n.label===e.label&&n.value===e.value&&(r=t)}),r},r.prototype._getListItemByComboboxItem=function(e){var t;if(this.items){t=this._getItemIndex(e,this.items);if(this.menu.items&&t<this.menu.items.length)return this.menu.items[t]}return null},r.prototype._initDropDownList=function(){var e=this,t,r,i,s,o,u=this.options.wijCSS,a=parseInt(e._input.css("zIndex"),10),f;t=e.element[0].ownerDocument,isNaN(a)&&(a=0),e._comboDiv?r=e._oriList:r=n("<div class='wijmo-wijcombobox-list'></div>"),i=e.options,i.columns.length>0&&(r.addClass("wijmo-wijcombobox-multicolumn"),s=n("<div class='wijmo-wijsuperpanel-header "+u.stateDefault+"'></div>"),e._renderColumnsHeader(s),r.append(s)),o={keepHightlightOnMouseLeave:!0,selectionMode:i.selectionMode,addHoverItemClass:i.columns.length===0,focus:function(t,n){var r=n;i.selectOnItemFocus&&e.menu.select(null,{notCloseAfterSelected:!0}),i.columns.length>0&&r.element&&(r.element.prev().addClass("wijmo-wijcombobox-active-prev"),r.element.find(".wijmo-wijcombobox-row>.wijmo-wijcombobox-cell").addClass(u.stateHover))},selected:function(t,n){window.clearTimeout(e.closing);var r=i.selectionMode,s,o,u=!1,a,f,l,c,h,p;s=n.item,c=n.previousItem,o=e._getItemIndex(s,e.items),e.items[o].selected=s.selected,c&&(h=e._getItemIndex(c,e.items),h>-1&&(e.items[h].selected=c.selected));if(e._trigger("select",t,s))if(r==="single"){if(!e._usingRemoteData()){o===-1&&(o=n.selectedIndex);if(o!==i.selectedIndex){f=i.selectedIndex,l=e.selectedItem,u=e._triggerSelectedIndexChanging(l,s,f,o);if(u)return;e._setInputText(s.label),l!==null&&(l.selected=!1),e.selectedItem=s,i.selectedIndex=o,i.selectedValue=e.selectedItem.value,e._select!==undefined&&(e._select[0].selectedIndex=i.selectedIndex,e._select.trigger("change")),i.inputTextInDropDownList=!0,i.text=e._input.val(),l&&l.element&&(p=e._getListItemByComboboxItem(l),p&&p.element.removeClass("wijmo-wijcombobox-selecteditem")),e._trigger("changed",null,{oldItem:l,selectedItem:e.selectedItem,newIndex:i.selectedIndex,oldIndex:f}),e._triggerSelectedIndexChanged(l,e.selectedItem,f,i.selectedIndex)}else e.selectedItem&&e._input.val()!==e.selectedItem.label&&(n.data===undefined||!n.data.notCloseAfterSelected)&&e._input.val(s.label)}else if(e.selectedItem===null||!e._hasSameValueText(s,e.selectedItem)){l=e.selectedItem,f=i.selectedIndex,u=e._triggerSelectedIndexChanging(l,s,f,n.selectedIndex);if(u)return;e._setInputText(s.label),i.text=e._input.val(),e.selectedItem=s,o===undefined&&(o=n.selectedIndex),o!==i.selectedIndex&&(i.selectedIndex=o,i.selectedValue=e.selectedItem.value),i.inputTextInDropDownList=!0,e._trigger("changed",null,{selectedItem:s}),e._triggerSelectedIndexChanged(l,s,f,i.selectedIndex)}}else if(!e._usingRemoteData()){u=e._triggerSelectedIndexChanging(null,s,f,n.selectedIndex);if(u)return;e.selectedItems=n.selectedItems,e._selectedItemsToInputVal(e.selectedItems),i.inputTextInDropDownList=!0,i.selectedIndex=n.selectedIndex,e._trigger("changed",null,{selectedItem:s,selectedItems:e.selectedItems}),e._triggerSelectedIndexChanged(null,s,null,i.selectedIndex)}(n.data===undefined||!n.data.notCloseAfterSelected)&&r==="single"&&(e.close(t),e._input.focus())},blur:function(e,t){var n=t.element;i.columns.length>0&&n&&(n.find(".wijmo-wijcombobox-row>.wijmo-wijcombobox-cell").removeClass(u.stateHover),n.prev().removeClass("wijmo-wijcombobox-active-prev"))},itemRendering:function(e,t){var n=t,r,i,s;r="",n.isSeparator&&(r+=" wijmo-wijcombobox-separator"),n.selected&&(r+=" wijmo-wijcombobox-selecteditem"),r.length>0&&n.element.addClass(r)},itemRendered:function(e,t){var r=t,s,o;if(r.cells===undefined)return;s=r.element,s.empty(),o=n("<ul class='wijmo-wijcombobox-row'></ul>"),n.each(r.cells,function(e,t){var r=n("<li class='wijmo-wijcombobox-cell "+u.stateDefault+"'></li>");i.columns&&i.columns.length>e&&typeof i.columns[e].width!="undefined"&&r.width(i.columns[e].width),r.append(t),r.attr("title",t),o.append(r)}),s.append(o)},listRendered:function(t,r){var s=e.menu.selectedItem,o=e.menu.selectedItems,u,a;i.selectionMode==="single"&&s?(u=e._getItemIndex(s,e.items),e.selectedItem=e.items[u],e._setInputText(e.selectedItem.label,!0)):o&&o.length>0&&(u=[],a=[],n.each(o,function(t,n){var r=e._getItemIndex(n,e.items);u.push(r),a.push(e.items[r])}),e._selectedItemsToInputVal(a)),u>=-1&&(i.selectedIndex=u)},superPanelOptions:{resized:function(t){var n=e.menu,r=n.element;i.dropdownWidth=r.outerWidth(),i.dropdownHeight=r.outerHeight(),e._positionList(),e.menu.refreshSuperPanel()}}},o=n.extend(!0,o,i.listOptions),f=i.ensureDropDownOnBody?n("body"):e._comboElement,e.menu=r.appendTo(f,t).wijlist(o).css({zIndex:a+1,top:0,left:0}).hide().data("wijmoWijlist"),e._createDropDownList(),e._menuUL=e.menu.ul},r.prototype._setInputText=function(e,t){var n=this,r=n._input.val();n._input.val(e),r!==e&&!t&&n._trigger("textChanged",null,{oldText:r,newText:e})},r.prototype._triggerSelectedIndexChanged=function(e,t,n,r){var i=this.options,s;i.selectionMode==="single"?this._trigger("selectedIndexChanged",null,{oldItem:e,selectedItem:t,newIndex:r,oldIndex:n}):(s=this._getItemIndex(t,this.items),this._trigger("selectedIndexChanged",null,{selectedItem:t,selectedIndex:s,selectedItems:this.selectedItems}))},r.prototype._triggerSelectedIndexChanging=function(e,t,n,r){var i=this.options,s,o,u=!0,a;return i.selectionMode==="single"?(o={oldItem:e,selectedItem:t,newIndex:r,oldIndex:n},u=this._trigger("selectedIndexChanging",null,o)):(s=this._getItemIndex(t,this.items),o={selectedItem:t,selectedIndex:s,selectedItems:this.selectedItems},u=this._trigger("selectedIndexChanging",null,o)),u||(t.selected=!1,a=this._getListItemByComboboxItem(t),a&&t.element.removeClass("wijmo-wijcombobox-selecteditem")),!u},r.prototype._createDropDownList=function(e){var t=this,r,i=t.options,s=e;s||(s=t.innerData),s===null?r=null:r=n.isArray(s)?s:s.items,t._comboDiv?!t.listHasCreated&&r&&r.length>0&&(t.menu.setTemplateItems(i.data),t.menu.renderList(),t.listHasCreated=!0):!t.listHasCreated&&r&&r.length>0&&(t.menu.setItems(r),t.menu.renderList(),t.listHasCreated=!0)},r.prototype._getSelectedItemsText=function(e){var t="",r,i;return r=this,i=r.options.multipleSelectionSeparator,r.selectedItems=e,n.each(e,function(e,n){n&&(t+=n.label+i)}),t.length>0&&(t=t.substr(0,t.lastIndexOf(i))),t},r.prototype._selectedItemsToInputVal=function(e){var t=this;t._setInputText(t._getSelectedItemsText(e)),t.options.text=t._input.val()},r.prototype._createDOMElements=function(){var e=this,t,r=this.options.wijCSS,s,o,u;u=n("<div class='wijmo-wijcombobox-wrapper "+r.stateDefault+" "+r.cornerAll+"'>"+"</div>"),s=e.element,s.is("select")?(t=n("<div role='combobox' class='wijmo-wijcombobox "+r.widget+" "+r.helperClearFix+"'>"+"</div>"),t.append(u),e._comboElement=t,e._select=s,s.addClass(r.widget),o=e._input=n("<input role='textbox' aria-autocomplete='list' aria-haspopup='true' />").insertAfter(s),e.options.data||(e.options.data=e._convertSelectOptions(),e._initInnerData())):s.is("div")&&n(s.children()[0]).is("input[type='text']")&&n(s.children()[1]).is("div")?(e._comboElement=e._comboDiv=t=s,e._oriList=n(s.children()[1]),o=e._input=n(s.children()[0]),u.prependTo(t).append(o),s.addClass("wijmo-wijcombobox "+r.widget+" "+r.helperClearFix),s.attr("role","combobox")):(t=n("<div role='combobox' class='wijmo-wijcombobox "+r.widget+" "+r.helperClearFix+"'>"+"</div>"),t.append(u),e._comboElement=t,o=e._input=s),e._comboDiv||(t.insertBefore(o),e.element.is(":visible")&&o.width(o.width()),t.children(".wijmo-wijcombobox-wrapper").append(o)),s.attr("title")&&e._comboElement.attr("title",s.attr("title")),o.attr({autocomplete:"off",role:"textbox","aria-wijcombobox":"list","aria-haspopup":"true"}).addClass(i),e._oldWidth=s.css("width"),e.options.isEditable===!1&&(o.attr("readonly","readonly"),u.bind("click",function(){if(e.options.disabledState===!0||e.options.disabled)return;e._triggerClick()})),(e.options.disabledState===!0||e.options.disabled===!0)&&o.attr("disabled","disabled"),t.bind("mouseenter",function(){if(e.options.disabledState===!0||e.options.disabled)return;e._addInputFocus(!0,r.stateHover)}).bind("mouseleave",function(){e._addInputFocus(!1,r.stateHover)})},r.prototype._convertSelectOptions=function(){var e=[],t,r;return t=this,r=t._select.get(0).options,n.each(r,function(t,n){e.push({label:n.text,value:n.value})}),t.options.selectedIndex===-1&&t.options.selectedValue===null&&t.options.text===null&&(t.options.selectedIndex=t._select[0].selectedIndex),e},r.prototype.getComboElement=function(){return this._comboElement},r.prototype._showTrigger=function(){var e=this,t,r,i,s,o=this.options.wijCSS,u,a=0,f,l,c,h,p,d,v="<label class='wijmo-wijcombobox-label "+o.content+"'></label>",m="<div class='wijmo-wijcombobox-trigger "+o.stateDefault+" "+o.cornerRight+"'>"+"<span class='"+o.icon+" "+o.iconArrowDown+"'></span>"+"</div>";t=e.options,r=e._input,i=r.parent(),s=e._comboElement,f=e._triggerArrow,l=e._label,e._select!==undefined&&(n.browser.msie?(u=e._select.clone(),e._select.after(u),a=u.width(),u.remove()):a=e._select.width(),r.width(a+(e.innerData.length>20?t.selectElementWidthFix:0)),e._select.hide()),r.css("margin-left",""),r.css("margin-right",""),s.width(i[0].offsetWidth),t.labelText!==null?(l=e._label=n(v),i.append(l.html(t.labelText))):l!==undefined&&(l.remove(),e._label=undefined),t.showTrigger?(r.removeClass(o.cornerAll),f===undefined&&(f=e._triggerArrow=n(m),s.append(f),f.bind("mouseover.triggerevent",e,function(e){if(t.disabledState===!0||t.disabled)return;var r=n(e.currentTarget);r.addClass(o.stateHover)}).bind("mousedown.triggerevent",e,function(e){if(t.disabledState===!0||t.disabled)return;var r=n(e.currentTarget);r.addClass(o.stateActive)}).bind("mouseup.triggerevent",e,function(e){var t=n(e.currentTarget);t.removeClass(o.stateActive)}).bind("click.triggerevent",e,function(){if(t.disabledState===!0||t.disabled)return;e._triggerClick()})),t.triggerPosition==="right"?(f.css({left:"",right:"0px"}),f.removeClass(o.cornerLeft),f.addClass(o.cornerRight)):(f.css({right:"",left:"0px"}),f.removeClass(o.cornerRight),f.addClass(o.cornerLeft)),f.setOutHeight(s.innerHeight()),c=f.find("span"),c.css("margin-left",(f.innerWidth()-c[0].offsetWidth)/2),c.css("margin-top",(f.innerHeight()-c[0].offsetHeight)/2)):(f!==undefined&&(f.unbind(".triggerevent"),f.remove(),e._triggerArrow=undefined),r.removeClass(o.cornerLeft),r.removeClass(o.cornerRight),r.addClass(o.cornerAll)),h=p=d=0,l!==undefined&&(p+=l[0].offsetWidth),f!==undefined&&(d=f.width()),h=p+d,r.setOutWidth(i.innerWidth()-h),h=h===0?"":h,t.triggerPosition==="right"?(r.css("margin-left",""),r.css("margin-right",h),l!==undefined&&(l.css("left",""),l.css("right",d))):(r.css("margin-right",""),r.css("margin-left",h),l!==undefined&&(l.css("right",""),l.css("left",d)))},r.prototype._triggerClick=function(e){var t=this,n="";window.clearTimeout(t.closing),t.menu.element.is(":visible")?t.close():(t._usingRemoteData()&&(n=t._input.val()),t.search(n,e))},r.prototype.destroy=function(){var e=this,t=this.options.wijCSS,r=e.element;e.options.isEditable===!1&&r.removeAttr("readonly"),e._select!==undefined?(e._select.removeClass(t.widget),e._select.show(),e._input.remove()):e._comboDiv?(e._comboDiv.removeClass("wijmo-wijcombobox "+t.widget+" "+t.helperClearFix),e._comboDiv.removeAttr("role"),e._input.insertBefore(e._comboDiv),e._comboDiv.children(".wijmo-wijcombobox-wrapper").remove()):(r.css("width",e._oldWidth),r.removeClass(i),r.removeAttr("autocomplete").removeAttr("role").removeAttr("aria-wijcombobox").removeAttr("aria-haspopup"),r.insertBefore(e._comboElement),r.css("padding","")),e._comboElement.remove(),e.menu.destroy(),e.menu.element.remove(),n.wijmo.widget.prototype.destroy.call(e)},r.prototype._setOption=function(e,t){var r=this,i,s,o,u,a,f=this.options.wijCSS,l=r._label,c,h,p,d=null,v=0,m="<label class='wijmo-wijcombobox-label "+f.content+"'></label>",g=r.options;i=r._comboElement,s=r.element,u=s.parent(),h=g.selectedIndex,r._triggerArrow&&(v=r._triggerArrow.outerWidth()),n.wijmo.widget.prototype._setOption.apply(r,arguments);if(e==="disabled")t?(i.addClass("wijmo-wijcombobox-disabled "+f.stateDisabled),r._input.attr("disabled","disabled"),r._comboDiv&&r._input.addClass("wijmo-wijcombobox-disabled "+f.stateDisabled).attr("disabled","disabled"),r._triggerArrow&&r._triggerArrow.unbind("click.triggerevent"),r.close()):(i.removeClass("wijmo-wijcombobox-disabled "+f.stateDisabled),r._input.removeAttr("disabled"),r._comboDiv&&r._input.removeClass("wijmo-wijcombobox-disabled "+f.stateDisabled).removeAttr("disabled"),r._triggerArrow&&r._triggerArrow.bind("click.triggerevent",r,function(){if(g.disabledState===!0)return;r._triggerClick()}));else if(e==="labelText")g.labelText!==null?(l=r._label=n(m),r._input.parent().append(l.html(g.labelText)),r._triggerArrow!==undefined&&(c=r._triggerArrow[0].offsetWidth),g.triggerPosition==="right"?l!==undefined&&(l.css("left",""),l.css("right",c)):l!==undefined&&(l.css("right",""),l.css("left",c)),r.repaint()):l!==undefined&&(l.remove(),r._label=undefined);else if(e==="showTrigger")r._showTrigger(),!g.showTrigger&&r.element.is("select")&&s.width(s.width()+v);else if(e==="triggerPosition")s.width(s.width()+v),r._showTrigger();else if(e==="selectionMode")r.menu._setOption("selectionMode",t);else if(e==="isEditable")t?(r._input.removeAttr("readonly"),n(".wijmo-wijcombobox-wrapper",r._comboElement[0]).bind("click",function(){r._triggerClick()})):(r._input.attr("readonly","readonly"),n(".wijmo-wijcombobox-wrapper",r._comboElement[0]).unbind("click"));else if(e==="data"||e==="dataSource"){r._initInnerData(),r._setSelectedIndex(g.selectedIndex);if(n.isArray(r.innerData))r.listHasCreated=!1,r._createDropDownList();else try{r.innerData.loaded=function(e,t){e===null?r.items=null:r.items=n.isArray(e)?e:e.items,r.listHasCreated=!1,r._createDropDownList()},r.innerData.load(null)}catch(y){}g.selectedIndex!==-1&&(d=o?o[h]:null,o=r.innerData,r._trigger("changed",null,{oldItem:d,selectedItem:r.selectedItem,newIndex:g.selectedIndex,oldIndex:h}),r._triggerSelectedIndexChanged(d,r.selectedItem,h,g.selectedIndex)),r._keypress=!1}else if(e==="selectedIndex"){if(t===h)return;r.selectedItem=null,r.innerData===null?o=null:o=n.isArray(r.innerData)?r.innerData:r.innerData.items,d=o?o[h]:null;if(t>-1){o&&o[t]!==null&&(p=o[t]),a=r._triggerSelectedIndexChanging(d,p,h,t);if(a){g.selectedIndex=h;return}h!==null&&h!==-1&&h!==undefined&&d&&(d.selected=!1,d.element&&d.element.removeClass("wijmo-wijcombobox-selecteditem")),o&&o[t]!==null&&(r.selectedItem=o[t],r.selectedItem&&(r.selectedItem.selected=!0,r._setInputText(r.selectedItem.label),g.selectedValue=r.selectedItem.value,g.inputTextInDropDownList=!0,g.text=r._input.val()))}else if(t<=-1||!t){a=r._triggerSelectedIndexChanging(d,null,h,t);if(a){g.selectedIndex=h;return}g.inputTextInDropDownList=!1,r._clearSelection()}r._trigger("changed",null,{oldItem:d,selectedItem:r.selectedItem,newIndex:g.selectedIndex,oldIndex:h}),r._triggerSelectedIndexChanged(d,r.selectedItem,h,g.selectedIndex)}else if(e==="selectedValue")t?(r.selectedItem&&r.selectedItem.selected!==undefined&&(r.selectedItem.selected=!1),o=r.items,o||(o=r.innerData),o&&(this.options.selectedIndex>-1&&o.length>this.options.selectedIndex&&o[this.options.selectedIndex]&&(o[this.options.selectedIndex].selected=!1,this.menu.deactivate(),this.menu.unselectItems(this.options.selectedIndex),r.menu.items[this.options.selectedIndex].selected=!1),n.each(o,function(e,n){if(o[e].value===t)return r.selectedItem=o[e],r.selectedItem.selected=!0,r.menu.items[e].selected=!0,r._setInputText(r.selectedItem.label),g.selectionMode==="single"?g.selectedIndex=e:g.selectedIndex=[e],g.inputTextInDropDownList=!0,g.text=r._input.val(),!1}))):(g.inputTextInDropDownList=!1,r._clearSelection());else if(e==="text"){if(g.forceSelectionText&&r._checkTextInItems(t)===-1)return;r._setInputText(t)}},r.prototype._setSelectedIndex=function(e){var t=this,r=t.options,i=[];if(e===null||e===undefined)return;e===-1?(t.selectedItem=null,r.selectedIndex=-1,r.selectedValue=null,r.text?t._input.val(r.text):t._input.val("")):n.isArray(e)?(t.selectedItems=[],n.each(e,function(e,n){t.items&&t.items[n]!==null&&t.items[n]!==undefined&&(t.items[n].selected=!0,i.push(t.items[n]))}),t.selectedItems=i,t._selectedItemsToInputVal(i)):t.items&&t.items[e]!==null&&t.items[e]!==undefined?(t.items[e].selected=!0,t._input.val(t.items[e].label),t.selectedItem=t.items[e]):t.items&&n.isArray(t.items)&&e>t.items.length-1&&(r.selectedIndex=-1,t._input.val("")),r.text=t._input.val()},r.prototype.search=function(e,t){var r=this,i,s,o,u;i=r.options,s=r.innerData,window.clearTimeout(r.closing),o={value:e,e:t,self:r};if(s!==null||r._comboDiv){u=r._isBind();if(t!=="checkindex"&&r._trigger("search",t,{datasrc:s,term:o})===!1)return;if(n.isArray(s)||u||r._comboDiv)r._hideShowArrow(!1),r._onListLoaded(s,o);else{if(!u&&n.isArray(i.dataSource))return;if(r._usingRemoteData()&&t!==undefined&&e.length<i.minLength)return;r._hideShowArrow(!1),s.loaded=function(e,t){r.listHasCreated=!1,r._createDropDownList(e),r._onListLoaded(e,t),r.originalDataSourceLoaded&&r.originalDataSourceLoaded(e,t)},s.load(o)}}},r.prototype.getSelectedItems=function(){var e=this.options;return e.selectionMode==="single"?this.selectedItem:this.selectedItems},r.prototype._isBind=function(){var e=this.options,t=e.data;return t!==null&&t.label&&t.label.bind?!0:!1},r.prototype._getMappingItems=function(){var e=this.options,t=e.dataSource,r=e.data,i,s,o;return!t||!r?null:!r.label||!r.label.bind||!r.value||!r.value.bind?null:(s=r.label.bind,o=r.value.bind,t&&t.length!==0?(i=[],n.each(t,function(e,t){i.push({label:t[s],value:t[o]})}),i):null)},r.prototype._clearSelection=function(){var e=this,t=e.options,r,i;t.selectionMode==="single"?e.selectedItem!==null&&(e.selectedItem.selected=!1,r=e._getItemIndex(e.selectedItem,e.items),e.items[r].selected=!1,i=e._getItemIndex(e.selectedItem,e.menu.items),e.menu.unselectItems(i),e.selectedItem=null):e.selectedItems&&(i=[],n.each(e.selectedItems,function(t,n){n.selected&&(n.selected=!1,t=e._getItemIndex(n,e.items),e.items[t].selected=!1,i.push(e._getItemIndex(n,e.menu.items)))}),e.menu.unselectItems(i),e.selectedItem=null,e.selectedItems=[]),t.selectedValue=null,e._setInputText(""),t.text=e._input.val()},r.prototype._usingRemoteData=function(){var e=this.options.data,t=!1;return!n.isArray(e)&&e!==null&&e.proxy&&(t=!0),t},r.prototype._hideShowArrow=function(e){var t=this,n,r;n=t.element,r=t._triggerArrow,r!==undefined&&r[e?"show":"hide"](),n[e?"removeClass":"addClass"]("wijmo-wijcombobox-loading")},r.prototype._onListLoaded=function(e,t){var r=t.self,i,s,o=this.options.wijCSS,u,a,f,l,c;i=r._input,s=r.options,u=t.value,e===null?a=null:a=n.isArray(e)?e:e.items,r.items=a;if(t.e==="checkindex"){n.each(r.items,function(e,t){t.selected&&(t.selected=!1)}),f=s.selectedIndex,s.selectionMode==="multiple"&&n.isArray(f)?(r.selectedItems=[],n.each(f,function(e,t){var n=a[t];n.selected=!0,r.selectedItems.push(n),c=r._getItemIndex(n,r.menu.items),r.menu.items[c].selected=!0}),r._selectedItemsToInputVal(r.selectedItems)):(a[f].selected=!0,r.selectedItem=a[f],c=r._getItemIndex(a[f],r.menu.items),r.menu.items[c].selected=!0,i.val(r.selectedItem.label)),r._hideShowArrow(!0);return}!r._usingRemoteData()&&a?l=a:(r._topHit=null,l=a),l&&l.length>0||r._comboDiv?(r._openlist(l,t,u),r._addInputFocus(!0,o.stateFocus)):r.close(null,!0),r._hideShowArrow(!0)},r.prototype.close=function(e,t){var r=this,i,s=this.options.wijCSS,o,u;i=r.menu,r._dropDownHeight=i.element.outerHeight(),r._dropDownWidth=i.element.outerWidth(),window.clearTimeout(r.closing),i.element.is(":visible")&&!i.element.is(":animated")&&!i.element.parent().is(":animated")&&(r._trigger("close",e),i.deactivate(),o=r.options.hidingAnimation,o&&(o.effect==="size"||o.animated==="size")&&(o.options=n.extend({to:{width:0,height:0}},o.options)),u=i.element.attr("style"),t!==!0&&o?i.element.hide(o.effect||o.animated,o.options,o.speed||o.duration,function(){i.element.removeAttr("style").attr("style",u).hide(),o.callback&&o.callback.apply(this,arguments)}):i.element.hide(),r._addInputFocus(!1,s.stateFocus),n(document).unbind("mouseup",r.closeOnClick))},r.prototype._change=function(){var e=this,t,n,r,i,s,o,u,a,f,l=-1;t=e.options,n=t.forceSelectionText,r=t.selectionMode,i=e._input,s=i.val(),o=e.selectedItem,u=e.selectedItems,a=t.selectedIndex?t.selectedIndex:-1,f=e.innerData,n?r==="single"&&(o!==null?o.label!==s&&i.val(o.label):i.val("")):r==="single"&&(!o&&s!==""||o!==null&&o.label.toString()!==s)&&(e.selectedItem!==null&&(e.selectedItem.selected=!1),l=e._checkTextInItems(s),l===-1?(e.selectedItem=null,t.selectedIndex=-1,t.selectedValue=null,t.inputTextInDropDownList=!1):f&&(e.selectedItem=f[l],t.selectedIndex=l,t.selectedValue=e.selectedItem.value,t.inputTextInDropDownList=!0),t.text=e._input.val(),e._trigger("changed",null,{oldItem:o,selectedItem:e.selectedItem,newIndex:t.selectedIndex,oldIndex:a}),a!==l&&e._triggerSelectedIndexChanged(o,e.selectedItem,a,t.selectedIndex));if(r==="multiple"){if(!e.selectedItems||e.selectedItems.length===0)u=[o];e._selectedItemsToInputVal(u)}},r.prototype._checkTextInItems=function(e){var t=this,r=-1,i=t.items;return e&&n.each(i,function(t,n){if(i[t]&&i[t].label&&i[t].label.toString()===e)return r=t,!1}),r},r.prototype._openlist=function(t,r,i){var s=r.self,o=r.e,u,a,f,l,c,h=2,p=0,d,v,m,g,y,b,w=n.trim(s._input.val()).length,E=e.getKeyCodeEnum(),S,x=!1;u=s._keypress=!!o,l=s.options,f=s.menu.element,n.ui?f.zIndex(s.element.zIndex()+100):(S=parseInt(s.element.css("zIndex"),10),isNaN(S)&&(S=0),f.css("zIndex",S+100)),s.listHasCreated||s._createDropDownList();if(!s._usingRemoteData()&&i!==null&&i!==undefined){x=s._keypress&&l.isEditable&&l.columns.length===0&&l.highlightMatching&&w>0,o&&o.keyCode===E.DOWN&&i.length===0&&w>0?s._topHit=s.menu.filterItems(s._input.val(),!1,x):s._topHit=s.menu.filterItems(i,l.autoFilter,x);if(s._topHit===null&&s.innerData&&n("li[wijhidden]",s.menu.element).length===s.innerData.length)return s.close(null,!0),!1}return s.menu.element.show(),l.dropdownWidth==="auto"?a=s._comboElement.outerWidth():a=l.dropdownWidth,c=f.css("padding"),f.css("padding","0px"),f.setOutWidth(a),f.css("padding",c),d=l.dropdownHeight,f.children(".wijmo-wijsuperpanel-header")&&(p=f.children(".wijmo-wijsuperpanel-header").outerHeight()||0),m=Math.min(s._menuUL.outerHeight()+h+p,d),f.setOutHeight(m),s.menu.refreshSuperPanel(),s._positionList(),!u&&s.selectedItem!==undefined&&s.menu.activate(null,s.selectedItem,!0),u&&o.keyCode!==E.BACKSPACE?l.isEditable?s._runAutoComplete():s.menu.activate(null,s._topHit,!0):(g=s.options.showingAnimation,l.showingAnimation!==null&&(o===undefined||o.keyCode!==E.BACKSPACE)&&(s.menu.element.hide(),b={from:{width:0,height:0},to:{width:s._dropDownWidth||f.outerWidth(),height:s._dropDownHeight||f.outerHeight()}},g&&(g.effect==="size"||g.animated==="size")&&(g.options=n.extend(b,g.options)),y=f.attr("style"),f.show(g.effect||g.animated,g.options,g.speed||g.duration,function(){f.removeAttr("style").attr("style",y).show(),g.callback&&g.callback.apply(this,arguments),n.browser.msie&&f.css("filter","")}))),s.hasOwnProperty("closeOnClick")||(v=s.closeOnClick,s.closeOnClick=function(e){return v(e)}),s._trigger("open"),n(document).bind("mouseup",s,s.closeOnClick),!0},r.prototype.closeOnClick=function(e){var t=e.data,r=t.options.wijCSS,i,s=e.target;!n.contains(t._comboElement[0],s)&&!n.contains(t.menu.element[0],s)&&(n.support.isTouchEnabled&&n.support.isTouchEnabled()?(i=t.menu.element.offset(),(e.pageX<i.left||e.pageX>i.left+t.menu.element.width()||e.pageY<i.top||e.pageY>i.top+t.menu.element.height())&&t.close()):t.close(),n(".wijmo-wijcombobox-wrapper",t._comboElement[0]).removeClass(r.stateHover).removeClass(r.stateFocus),n(".wijmo-wijcombobox-trigger",t._comboElement[0]).removeClass(r.stateHover).removeClass(r.stateFocus))},r.prototype._positionList=function(){var e=this,t,r;t=e.options.dropDownListPosition,r={my:"left top",at:"left bottom",of:e._comboElement,collision:"none"},r=n.extend(r,t),e.menu.element.position(r)},r.prototype._runAutoComplete=function(){var e=this,t,n,r,i,s,o;t=e._input,n=e._topHit;if(!e.options.autoComplete||n===null||n===undefined)return;e.menu.activate(null,n,!0),r=t.val(),i=n.label,t.val(i),s=r.length,o=i.length,e._selectText(s,o,t)},r.prototype._selectText=function(e,t,n){var r=n.val(),i=n.get(0),s;r.length>0&&(i.setSelectionRange!==undefined?i.setSelectionRange(e,t):i.createTextRange!==undefined&&(s=i.createTextRange(),s.moveStart("character",e),s.moveEnd("character",t-r.length),s.select()))},r.prototype._move=function(e,t){if(!this.menu.element.is(":visible")){this.search("",t);return}if(this.menu.first()&&/^previous/.test(e)||this.menu.last()&&/^next/.test(e))return;this.menu[e](t)},r.prototype._escapeRegex=function(e){return e===undefined?e:e.replace(/([\^\$\(\)\[\]\{\}\*\.\+\?\|\\])/gi,"\\$1")},r.prototype._filter=function(e,t){var r=this._escapeRegex(t),i,s=null;return e?(i=new RegExp(r,"i"),n.each(e,function(e,t){if(r===undefined||r.length===0){t.match=!0;return}var n=i.exec(t.label);n===null?t.match=!1:(s===null&&n.index===0&&(s=t),t.match=n.index>=0)}),this._topHit=s,e):null},r}(e.wijmoWidget);t.wijcombobox=s;var o=function(){function e(){this.initSelector=":jqmData(role='wijcombobox')",this.dataSource=null,this.data=null,this.labelText=null,this.minLength=4,this.delay=300,this.showingAnimation=null,this.hidingAnimation=null,this.showTrigger=!0,this.triggerPosition="right",this.dropdownHeight=300,this.dropdownWidth="auto",this.selectOnItemFocus=!1,this.autoFilter=!0,this.autoComplete=!0,this.highlightMatching=!0,this.dropDownListPosition={},this.columns=[],this.selectionMode="single",this.multipleSelectionSeparator=",",this.forceSelectionText=!1,this.select=null,this.isEditable=!0,this.selectedIndex=-1,this.selectedValue=null,this.inputTextInDropDownList=!1,this.text=null,this.ensureDropDownOnBody=!0,this.open=null,this.close=null,this.selectElementWidthFix=6,this.search=null,this.changed=null,this.textChanged=null,this.selectedIndexChanged=null,this.selectedIndexChanging=null,this.listOptions=null}return e}();s.prototype.options=n.extend(!0,{},e.wijmoWidget.prototype.options,new o),n.wijmo.registerWidget("wijcombobox",s.prototype)})(e.combobox||(e.combobox={}));var t=e.combobox})(wijmo||(wijmo={}));;
var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=e.getKeyCodeEnum(),i=function(e){function t(){e.apply(this,arguments),this._boundMouseWheel=!1,this._wasPopupShowing=!1}return __extends(t,e),t.prototype._elemWithClasses=function(e,t){return typeof t=="undefined"&&(t=[]),n(e).addClass(t.join(" "))},t.prototype._divWithClasses=function(){var e=[];for(var t=0;t<arguments.length-0;t++)e[t]=arguments[t+0];return this._elemWithClasses("<div/>",e)},t.prototype._spanWithClasses=function(){var e=[];for(var t=0;t<arguments.length-0;t++)e[t]=arguments[t+0];return this._elemWithClasses("<span/>",e)},t.prototype._horizontalBorderWidth=function(e){return e.leftBorderWidth()+e.rightBorderWidth()},t.prototype._verticalBorderWidth=function(e){return e.topBorderWidth()+e.bottomBorderWidth()},t.prototype._create=function(){var e=this,t=document.activeElement==this.element[0],r=this._horizontalBorderWidth(this.element),i=this._verticalBorderWidth(this.element);if(this.element[0].tagName.toLowerCase()!=="input")throw"Target element is not a INPUT";this._creationDate=new Date,window.wijmoApplyWijTouchUtilEvents&&(n=window.wijmoApplyWijTouchUtilEvents(n)),this.element.is(":hidden")&&this.element.wijAddVisibilityObserver&&this.element.wijAddVisibilityObserver(function(){e._destroy(),e._create(),e.element.wijRemoveVisibilityObserver&&e.element.wijRemoveVisibilityObserver()},"wijinput"),this.element.data("widgetName",this.widgetName),n.effects&&n.effects.save?n.effects.save(this.element,["width","height"]):n.save&&n.save(this.element,["width","height"]);var s=this.options.wijCSS;this.element.wrap("<div><span/></div"),this.wrapper=this.element.parent(),this.outerDiv=this.wrapper.parent(),this.outerDiv.addClass([s.wijinput,s.widget,s.helperClearFix,s.stateDefault,s.cornerAll].join(" ")),this.wrapper.addClass(s.wijinputWrapper),this.element.addClass(s.wijinputInput).addClass(s.cornerAll).attr("role","textbox");if(!(n.browser.msie&&parseFloat(n.browser.version)<=7))try{this.element.attr("aria-multiline",!1)}catch(o){this.element[0].setAttribute("aria-multiline","false")}var u=this.options.buttonAlign==="left";this.options.showTrigger&&(this.triggerBtn=this._divWithClasses(s.wijinputTrigger,s.stateDefault,u?s.cornerLeft:s.cornerRight).append(this._spanWithClasses(s.icon,s.iconArrowDown)).attr("role","button").appendTo(this.outerDiv),this.element.attr({role:"combobox","aria-expanded":!1})),this.options.showSpinner&&(this.spinner=this._divWithClasses(s.wijinputSpinner,s.wijinputButton),this.spinUp=this._divWithClasses(s.stateDefault,s.wijinputSpinUp).append(this._spanWithClasses(s.icon,s.iconArrowUp)).attr("role","button"),this.spinDown=this._divWithClasses(s.stateDefault,s.wijinputSpinDown).append(this._spanWithClasses(s.icon,s.iconArrowDown)).attr("role","button"),this.options.showTrigger||(this.spinUp.addClass(u?s.cornerTL:s.cornerTR),this.spinDown.addClass(u?s.cornerBL:s.cornerBR)),this.spinner.append(this.spinUp).append(this.spinDown).appendTo(this.outerDiv),this.element.attr("role","spinner")),this.options.showTrigger&&this.options.showSpinner?this.outerDiv.addClass(u?s.inputSpinnerTriggerLeft:s.inputSpinnerTriggerRight):(this.options.showTrigger&&this.outerDiv.addClass(u?s.inputTriggerLeft:s.inputTriggerRight),this.options.showSpinner&&this.outerDiv.addClass(u?s.inputSpinnerLeft:s.inputSpinnerRight)),this._initialize(),t&&n(function(){return e.element.focus().wijtextselection(0,e.element.val().length)});var a=this.element[0].style;a.width&&(this._isInPercents(a.width)?this.outerDiv.width(a.width):this.outerDiv.width(this.element.width()+r-this._horizontalBorderWidth(this.outerDiv)),this.element.width("")),a.height&&(this._isInPercents(a.height)?this.outerDiv.height(a.height):this.outerDiv.height(this.element.height()+i-this._verticalBorderWidth(this.outerDiv)),this.element.height(""))},t.prototype._isInPercents=function(e){return e.match(/%$/)},t.prototype._createTextProvider=function(){return undefined},t.prototype._beginUpdate=function(){},t.prototype._endUpdate=function(){var e=this;this.element.mousewheel&&!this._boundMouseWheel&&(this.element.mousewheel(function(t,n){e.isFocused()&&e._doSpin(n>0,!1)&&t.preventDefault()}),this._boundMouseWheel=!0)},t.prototype._isPopupShowing=function(){return!!this._comboDiv&&this._comboDiv.wijpopup("isVisible")},t.prototype._onTriggerMouseUp=function(){this._wasPopupShowing=this._isPopupShowing()},t.prototype._onTriggerClicked=function(){this._wasPopupShowing?this._hidePopup():(this._showPopup(),this._wasPopupShowing=!0)},t.prototype._showPopup=function(){this._popupComboList()},t.prototype._hidePopup=function(){this._comboDiv.wijpopup("hide")},t.prototype._initialize=function(){var e=this;this.element.data("initializing",!0),this._trigger("initializing"),this.element.data("preText",this.element.val()),this.element.data("elementValue",this.element.val()),this.element.data("errorstate",!1),this.element.data("breakSpinner",!0),this.element.data("prevCursorPos",-1),this.element.data("simulating",!1),this._createTextProvider(),this._beginUpdate();var t=this.options,r=function(e){return(e.which?e.which:e.button)===1},i=function(i){if(e.options.disabled)return;if(!r(i))return;e._trySetFocus(),e.element.data("breakSpinner",!1),e._addState("active",n(e)),e._doSpin(n(i.currentTarget).hasClass(t.wijCSS.wijinputSpinUp),!0)},s=function(t){if(e.options.disabled)return;if(!r(t))return;e._stopSpin(),e._removeState("active",n(e))},o;this.triggerBtn&&!t.disabledState&&this.triggerBtn.bind({mouseover:function(){if(e.options.disabled)return;e._addState("hover",n(e))},mouseout:function(){if(e.options.disabled)return;e._removeState("hover",n(e))},mousedown:function(t){if(e.options.disabled)return;if(!r(t))return;e._stopEvent(t),e._addState("active",n(e)),e._trigger("triggerMouseDown")},mouseup:function(t){e._onTriggerMouseUp()},click:function(t){if(e.options.disabled)return;e._stopEvent(t),e._stopSpin(),e._removeState("active",n(e)),e._trigger("triggerMouseUp"),e._onTriggerClicked(),e._trySetFocus()}}),this.spinUp&&!t.disabledState&&this.spinUp.bind({mouseover:function(){if(e.options.disabled)return;e._addState("hover",n(e))},mouseout:function(){if(e.options.disabled)return;e._removeState("hover",n(e)),e._removeState("active",n(e)),e._stopSpin()},mousedown:i,mouseup:s}),this.spinDown&&!t.disabledState&&this.spinDown.bind({mouseover:function(){if(e.options.disabled)return;e._addState("hover",n(e))},mouseout:function(){if(e.options.disabled)return;e._removeState("hover",n(e)),e._removeState("active",n(e)),e._stopSpin()},mousedown:i,mouseup:s}),this.element.bind({"focus.wijinput":n.proxy(this._onFocus,this),"blur.wijinput":n.proxy(this._onBlur,this),"mouseup.wijinput":n.proxy(this._onMouseUp,this),"keypress.wijinput":n.proxy(this._onKeyPress,this),"keydown.wijinput":n.proxy(this._onKeyDown,this),"keyup.wijinput":n.proxy(this._onKeyUp,this),"compositionstart.wijinput":n.proxy(this._onCompositionStart,this),"compositionend.wijinput":n.proxy(this._onCompositionEnd,this),"change.wijinput":n.proxy(this._onChange,this),"paste.wijinput":n.proxy(this._onPaste,this),"drop.wijinput":n.proxy(this._onDrop,this)}),this.element.bind("propertychange.wijinput input.wijinput",n.proxy(this._onInput,this)),this.element.data("initializing",!1),this._resetData(),this._endUpdate(),this._updateText(),this.options.disabledState&&(o=t.disabled,this.disable(),t.disabled=o),this.options.disabled&&this.disable(),this.element.data("initialized",!0),this._trigger("initialized")},t.prototype._init=function(){},t.prototype._setOption=function(e,t){this._super(e,t);switch(e){case"buttonAlign":case"showTrigger":case"showSpinner":this._destroy(),this._create();break;case"showNullText":this._updateText();break;case"disabled":this.element.attr("disabled",t);var n=t?"addClass":"removeClass",r=this.options.wijCSS.stateDisabled;this.element[n](r),this.triggerBtn&&this.triggerBtn[n](r),this.spinUp&&this.spinUp[n](r),this.spinDown&&this.spinDown[n](r)}},t.prototype.destroy=function(){this._super(),this._destroy()},t.prototype.isDestroyed=function(){return!this.outerDiv},t.prototype._destroy=function(){if(this.isDestroyed())return;this.wrapper=undefined,this.outerDiv=undefined,this.element.unbind(".wijinput"),this.element.removeData("errorstate").removeData("breakSpinner").removeData("prevCursorPos").removeData("simulating").removeData("isPassword").removeClass(this.options.wijCSS.wijinputInput).removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow").removeAttr("aria-expanded"),this.element.parent().replaceWith(this.element),this.element.parent().replaceWith(this.element),n.effects&&n.effects.restore?n.effects.restore(this.element,["width","height"]):n.restore&&n.restore(this.element,["width","height"])},t.prototype.widget=function(){return this.outerDiv||this._super()},t.prototype._getCulture=function(e){return typeof e=="undefined"&&(e=this.options.culture),Globalize.findClosestCulture(e||this.options.culture)},t.prototype._addState=function(e,t){t.is(":not(.ui-state-disabled)")&&t.addClass(this.options.wijCSS.getState(e))},t.prototype._removeState=function(e,t){t.removeClass(this.options.wijCSS.getState(e))},t.prototype._isInitialized=function(){return!this.element.data("initializing")},t.prototype._setData=function(e){this.setText(e)},t.prototype._resetData=function(){},t.prototype._validateData=function(){},t.prototype.getText=function(){return this._isInitialized()?this._textProvider.toString(!0,!1,!1):this.element.val()},t.prototype.setText=function(e){this._isInitialized()?(this._textProvider.set(e),this._updateText()):this.element.val(e)},t.prototype.getPostValue=function(){return this._isInitialized()?this._textProvider.toString(!0,!1,!0):this.element.val()},t.prototype.selectText=function(e,t){typeof e=="undefined"&&(e=0),typeof t=="undefined"&&(t=this.getText().length);if(this.element.is(":disabled"))return;this.element.wijtextselection(e,t)},t.prototype.focus=function(){if(this.element.is(":disabled"))return;this.element.get(0).focus()},t.prototype.isFocused=function(){return this.outerDiv.hasClass(this.options.wijCSS.stateFocus)},t.prototype._raiseTextChanged=function(){var e=this.element.val(),t=this.element.data("preText");!!this.element.data("initialized")&&t!==e&&(this._trigger("textChanged",null,{text:e}),this.element.data("changed",!0)),this.element.data("preText",e)},t.prototype._raiseDataChanged=function(){},t.prototype._allowEdit=function(){return!this.element.attr("readOnly")&&!this.element.is(":disabled")},t.prototype._updateText=function(e){typeof e=="undefined"&&(e=!1);if(!this._isInitialized())return;e=!!e;var t=this.element.wijtextselection(),n=this.options;this.isDeleteAll&&n.showNullText?(this.isDeleteAll=!1,n.date=null,this.element.val(n.nullText)):(this.element.val(this._textProvider.toString()),this.options.text=this._textProvider.toString(!0,!1,!1));if(this.element.is(":disabled"))return;e&&this.selectText(t.start,t.end),this.element.data("prevCursorPos",t.start),this._raiseTextChanged(),this._raiseDataChanged()},t.prototype._trySetFocus=function(){if(document.activeElement!==this.element[0])try{this.options.disableUserInput||this.element.focus()}catch(e){}},t.prototype._deleteSelText=function(e){typeof e=="undefined"&&(e=!1);if(!this._allowEdit())return;var t=this.element.wijtextselection(),n;if(e){if(t.end<1)return;t.end===t.start&&t.start--}t.end--,t.end<t.start&&(t.end=t.start),n=new a,this._textProvider.removeAt(t.start,t.end,n),this._updateText(),this.selectText(n.testPosition,n.testPosition)},t.prototype._fireIvalidInputEvent=function(e){var t=this,r;if(n.isFunction(this.options.invalidInput)&&this._trigger("invalidInput",null,{widget:this,"char":e})===!0)return;this.element.data("errorstate")||(r=this.options.invalidClass||this.options.wijCSS.stateError,this.element.data("errorstate",!0),window.setTimeout(function(){t.outerDiv&&t.outerDiv.removeClass(r),t.element.data("errorstate",!1)},200),this.outerDiv.addClass(r))},t.prototype._onInput=function(e){if(!this._isSimulating()||!this.element.data("ime")||this.element.data("isComposingIME")){this.element.data("isComposingIME")&&this.element.data("simulationPending",!0);return}this._simulate()},t.prototype._keyDownPreview=function(e){return!1},t.prototype._onDoubleByteCharacter=function(){var e=this.element.data("lastDbsState"),t=this.element.wijtextselection(),n=this.element.val();this.element.data("isComposingIME")&&e&&e.selection.start===t.start&&e.Text===n?(this.element.removeData("lastDbsState"),this._onCompositionEnd()):(this.element.data("lastDbsState",{selection:t,text:n}),this._onCompositionStart())},t.prototype._onCompositionStart=function(){if(this.element.data("isComposingIME"))return;this.element.data("isComposingIME",!0),this._beforeSimulate(!0)},t.prototype._onCompositionEnd=function(){if(!this.element.data("isComposingIME"))return;this.element.data("isComposingIME",!1),this._isInitialized()&&(!this._textProvider||!this._textProvider.noMask)&&this._simulateIfPending()},t.prototype._simulateIfPending=function(){this.element.data("simulationPending")&&this.element.data("lastSelection")&&this._simulate()},t.prototype._beforeSimulate=function(e){typeof e=="undefined"&&(e=!1),this.element.data("lastSelection")||(this.element.data("lastSelection",this.element.wijtextselection()),this.element.data("lastValue",this.element.val())),this.element.data("ime",e),this.element.data("simulating",!0)},t.prototype._isSimulating=function(){return this.element.data("simulating")},t.prototype._simulate=function(e){var t=this,n=null,r,i,s;this.element.data("simulationPending",!1),typeof e=="string"?n=e:(r=this.element.wijtextselection(),i=this.element.data("lastSelection").start,s=r.end,s>=i&&(n=this.element.val().substring(i,s))),n&&window.setTimeout(function(){if(!t.element.data("lastValue"))return;t.element.val(t.element.data("lastValue"));var e=t.element.data("lastSelection"),r,i;t.element.wijtextselection(e),t.element.data("batchKeyPress",!0),t.element.data("simulating",!1),r=jQuery.Event("keypress"),r.ctrlKey=r.altKey=!1;for(i=0;i<n.length;i++)r.which=r.charCode=r.keyCode=n.charCodeAt(i),t._onKeyPress(r);t.element.data("batchKeyPress",!1),t._endSimulate()},1)},t.prototype._endSimulate=function(){this._simulateIfPending(),this.element.removeData("ime"),this.element.removeData("lastSelection"),this.element.removeData("lastValue")},t.prototype._onKeyDown=function(e){this.element.data("prevCursorPos",-1),this._deleteKeyDown=!1;if(!this._isInitialized()||this._textProvider&&!!this._textProvider.noMask)return;var t=this._getKeyCode(e);if(t===229){this._onDoubleByteCharacter();return}this._onCompositionEnd();if(this.options.disableUserInput){this._stopEvent(e);return}if(this._keyDownPreview(e)){this._stopEvent(e);return}switch(t){case r.UP:this._doSpin(!0,!1),this._stopEvent(e);return;case r.DOWN:this._doSpin(!1,!1),this._stopEvent(e);return}if(e.ctrlKey)switch(t){case r.INSERT:case 67:return;default:}if(e.ctrlKey||e.altKey)return;switch(t){case 112:case 113:case 114:case 115:case 116:case 117:case r.TAB:case r.CAPSLOCK:case r.END:case r.HOME:case r.CTRL:case r.SHIFT:return;case r.BACKSPACE:this._deleteSelText(!0),this._stopEvent(e);return;case r.DELETE:this._deleteSelText(!1),this._stopEvent(e),this._deleteKeyDown=!0;return;case r.ENTER:this._onEnterDown(e);break;case r.ESCAPE:this._stopEvent(e),window.setTimeout(n.proxy(this._resetData,this),1);return;case r.PAGE_UP:case r.PAGE_DOWN:case r.ALT:this._stopEvent(e);return}},t.prototype._onEnterDown=function(e){this.options.hideEnter&&this._stopEvent(e)},t.prototype._onKeyUp=function(e){if(this._textProvider&&!!this._textProvider.noMask)return;var t=this._getKeyCode(e);if(this._isSimulating()){t===r.ENTER&&this._onCompositionEnd();return}if(!this._isInitialized())return;if(t===r.ENTER||t===r.ESCAPE)return;if(this.options.disableUserInput){this._raiseTextChanged(),this._raiseDataChanged();return}this._stopEvent(e)},t.prototype._getKeyCode=function(e){var t=window.navigator.userAgent;return t.indexOf("iPod")===-1&&t.indexOf("iPhone")===-1||e.which!==127?e.keyCode||e.which:8},t.prototype._keyPressPreview=function(e){return!1},t.prototype._onKeyPress=function(e){if(this._isSimulating()||this._textProvider&&!!this._textProvider.noMask)return;this.element.data("prevCursorPos",-1);if(this.options.disableUserInput)return;if(!this._allowEdit())return;if(e.ctrlKey&&e.keyCode===119){this._onPaste(e);return}var t=e.keyCode||e.which,n,i;switch(t){case 0:case r.TAB:case r.UP:case r.DOWN:case r.LEFT:case r.RIGHT:return;case r.BACKSPACE:this._stopEvent(e);return;case r.DELETE:if(this._deleteKeyDown){this._stopEvent(e);return}break;case r.ENTER:this.options.hideEnter&&this._stopEvent(e);return}if(e.ctrlKey||e.altKey)if(t!==r.SPACE)return;if(this._keyPressPreview(e))return;i=String.fromCharCode(t),n=this._textProvider.replaceWith(this.element.wijtextselection(),i),n?(this._updateText(),this.selectText(n.testPosition+1,n.testPosition+1)):this._fireIvalidInputEvent(i),this.element.data("batchKeyPress")||this._stopEvent(e)},t.prototype._isNullText=function(e){return e=e||this.element.val(),this.options.showNullText&&e===this.options.nullText},t.prototype._doFocus=function(){var e=this.element.wijtextselection(),t=e.start,r;this._updateText(),r=this.element.val(),r.length===t&&(t=0),n.browser.safari||this.selectText(t,t)},t.prototype._afterFocused=function(){this._isNullText()&&this._doFocus()},t.prototype._onFocus=function(e){if(this.options.disableUserInput)return;this._addState("focus",this.outerDiv);if(!this.element.data("breakSpinner"))return;if(!this._isInitialized())return;if(!this._allowEdit())return;this.element.data("focusNotCalledFirstTime")||this.element.data("focusNotCalledFirstTime",(new Date).getTime()),this._afterFocused()},t.prototype._onBlur=function(e){var t=this;if(this.options.disableUserInput)return;this._onCompositionEnd();if(this._isComboListVisible())return;var n=this.isFocused(),r;this._removeState("focus",this.outerDiv);if(!this.element.data("breakSpinner")){this.element.get(0).focus(),r=this.element.data("prevCursorPos"),r!==undefined&&r!==-1&&this.selectText(r,r);return}if(!this._isInitialized()||!n)return;this.element.data("value",this.element.val()),window.setTimeout(function(){t._onChange(),t._updateText(),t._validateData(),t.element.data("changed")&&(t.element.data("changed",!1),t._popupVisible()||(t._trigger("change"),t.element.change()))},100)},t.prototype._popupVisible=function(){return this._isComboListVisible()},t.prototype._onMouseUp=function(e){if(!this._isInitialized())return;if(this.element.is(":disabled"))return;var t=this.element.wijtextselection(),n=this;this.element.data("prevCursorPos",t.start);if(this.element.val()=="")return;setTimeout(function(){n.element.val()==""&&n.setText("")},5)},t.prototype._onChange=function(){if(!this.element)return;var e=this.element.val(),t=this.getText();t!==e&&this.setText(e)},t.prototype._onPaste=function(e){if(this._textProvider&&!!this._textProvider.noMask)return;this._beforeSimulate();var t=this;window.setTimeout(function(){t._simulate()},1)},t.prototype._onDrop=function(e){this._beforeSimulate();if(e.originalEvent&&e.originalEvent.dataTransfer){var t=e.originalEvent.dataTransfer.getData("Text");t&&this._simulate(t)}},t.prototype._stopEvent=function(e){e.stopPropagation(),e.preventDefault()},t.prototype._calcSpinInterval=function(){return this._repeatingCount++,this._repeatingCount>10?50:this._repeatingCount>4?100:this._repeatingCount>2?200:400},t.prototype._doSpin=function(e,t){return!1},t.prototype._stopSpin=function(){this.element.data("breakSpinner",!0),this._repeatingCount=0},t.prototype._hasComboItems=function(){return!!this.options.comboItems&&this.options.comboItems.length},t.prototype._isComboListVisible=function(){return this._comboDiv?this._comboDiv.wijpopup("isVisible"):!1},t.prototype._popupComboList=function(){var e=this;if(!this._hasComboItems())return;if(!this._allowEdit())return;var t;this._comboDiv===undefined&&(this._comboDiv=n("<div></div>").appendTo(document.body).css("position","absolute"),t=this._normalize(this.options.comboItems),this._comboDiv.wijlist({maxItemsCount:5,selected:function(t,n){e._setData(n.item.value),e._comboDiv.wijpopup("hide"),e._trySetFocus()}}),this._comboDiv.wijlist("setItems",t),this._comboDiv.wijlist("renderList")),this._comboDiv.width(this.outerDiv.width()),this._comboDiv.wijlist("option","autoSize",!this.options.comboHeight),this.options.comboHeight&&this._comboDiv.height(this.options.comboHeight),this._comboDiv.wijlist("refreshSuperPanel"),this._comboDiv.wijpopup({autoHide:!0}),this.outerDiv.attr("aria-expanded",!0),this._comboDiv.wijpopup("show",{of:this.outerDiv,offset:"0 4",hidden:function(){e.outerDiv.attr("aria-expanded",!1)}})},t.prototype._normalize=function(e){return e.length&&e[0].label&&e[0].value?e:n.map(e,function(e){return typeof e=="string"?{label:e,value:e}:n.extend({label:e.label||e.value,value:e.value||e.label},e)})},t}(e.wijmoWidget);t.wijinputcore=i;var s="wijmo-wijinput",o=s+"-",u=function(){function e(){this.wijCSS={wijinput:s,wijinputInput:o+"input",wijinputWrapper:o+"wrapper",wijinputTrigger:o+"trigger",wijinputSpinner:o+"spinner",wijinputButton:o+"button",wijinputSpinUp:o+"spinup",wijinputSpinDown:o+"spindown"},this.culture="",this.invalidClass=n.wijmo.wijCSS.stateError,this.nullText="",this.showNullText=!1,this.hideEnter=!1,this.disableUserInput=!1,this.buttonAlign="right",this.showTrigger=!1,this.showSpinner=!1,this.comboItems=undefined,this.comboWidth=undefined,this.comboHeight=undefined,this.initializing=null,this.initialized=null,this.triggerMouseDown=null,this.triggerMouseUp=null,this.textChanged=null,this.invalidInput=null}return e}();i.prototype.options=n.extend(!0,{},e.wijmoWidget.prototype.options,new u);var a=function(){function e(){this.characterEscaped=1,this.noEffect=2,this.sideEffect=3,this.success=4,this.unknown=0,this.hint=0,this.alphanumericCharacterExpected=-2,this.asciiCharacterExpected=-1,this.digitExpected=-3,this.invalidInput=-51,this.letterExpected=-4,this.nonEditPosition=-54,this.positionOutOfRange=-55,this.promptCharNotAllowed=-52,this.signedDigitExpected=-5,this.unavailableEditPosition=-53,this.testPosition=-1}return e.prototype.clone=function(){var t=new e;return t.hint=this.hint,t.testPosition=this.testPosition,t},e}();t.wijInputResult=a;var f=function(){function e(){}return e.prototype.set=function(e,t){},e.prototype.toString=function(e,t,n,r,i){return""},e.prototype.insertAt=function(e,t,n){return!1},e.prototype.removeAt=function(e,t,n,r){},e.prototype.replaceWith=function(e,t){var n=e.start,r=new a;return e.start<e.end&&(this.removeAt(e.start,e.end-1,r,!0),n=r.testPosition),this.insertAt(t,n,r)?r:null},e}();t.wijTextProvider=f})(e.input||(e.input={}));var t=e.input})(wijmo||(wijmo={}));;
var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(t){"use strict";function i(e,t){typeof t=="undefined"&&(t=2);var n=""+e+"";if(n.length>t)n=n.substr(n.length-t);else while(n.length<t)n="0"+n;return n}var n=jQuery,r=e.getKeyCodeEnum(),s=function(e){function i(){e.apply(this,arguments)}return __extends(i,e),i.prototype._createTextProvider=function(){this._textProvider=new u(this,this.options.dateFormat)},i.prototype._strToDate=function(e){return this._textProvider.parseDate(e)},i.prototype._beginUpdate=function(){var t=this.options,n,r=null;e.prototype._beginUpdate.call(this),t.minDate&&typeof t.minDate=="string"&&(t.minDate=this._strToDate(t.minDate)),t.maxDate&&typeof t.maxDate=="string"&&(t.maxDate=this._strToDate(t.maxDate)),t.date?typeof t.date=="string"?n=t.date:r=t.date:!this.element.data("elementValue")||(n=this.element.data("elementValue")),n&&(r=this._strToDate(n)),this._safeSetDate(r),this.element.data({defaultDate:r===null?r:new Date(t.date.getTime()),preDate:r===null?r:new Date(t.date.getTime())}),this._resetTimeStamp(),t.showTrigger&&!this._hasComboItems()&&this._initCalendar(),this.element.addClass(t.wijCSS.wijinputdate).attr({"aria-valuemin":new Date(1900,1,1),"aria-valuemax":new Date(2099,1,1),"aria-valuenow":t.date})},i.prototype._endUpdate=function(){var t=this;e.prototype._endUpdate.call(this),this.element.bind("click.wijinput",function(){t._highLightCursor()})},i.prototype._isValidDate=function(e,t){var n=this.options;if(e===undefined)return!1;if(isNaN(e))return!1;if(e.getFullYear()<1||e.getFullYear()>9999)return!1;if(t){if(n.minDate&&e<n.minDate)return!1;if(n.maxDate&&e>n.maxDate)return!1}return!0},i.prototype._checkRange=function(e){var t=this.options;return e&&(t.minDate&&e<t.minDate&&(e=new Date(Math.max(t.minDate,e))),t.maxDate&&e>t.maxDate&&(e=new Date(Math.min(t.maxDate,e)))),e},i.prototype._safeSetDate=function(e){var t=this.options,n=e;return e=this._checkRange(e),isNaN(e)&&(e=n),t.date=e,!0},i.prototype._safeGetDate=function(){var e=this.options.date||this._creationDate;return e=this._checkRange(e),e},i.prototype._setOption=function(t,n){e.prototype._setOption.call(this,t,n);var r=this.options;switch(t){case"minDate":case"maxDate":typeof r[t]=="string"&&(r[t]=this._strToDate(n));if(r.date<r.minDate||r.date>r.maxDate)this._safeSetDate(r.date),this._updateText(),this._highLightField();break;case"date":!n||(typeof n=="string"?n=this._strToDate(n):typeof n=="object"?n=new Date(n.getTime()):n=new Date(n),isNaN(n)&&(n=new Date)),this._safeSetDate(n),this._updateText(),this._highLightField();break;case"dateFormat":case"culture":this._textProvider._setFormat(this.options.dateFormat),this._updateText();var i=this.element.data("calendar");i&&i.wijcalendar("option",t,n);break;case"activeField":n=Math.min(n,this._textProvider.getFieldCount()-1),n=Math.max(n,0),this.options.activeField=n,this._highLightField(),this._resetTimeStamp();break;case"nextTooltip":case"prevTooltip":case"titleFormat":case"toolTipFormat":var i=this.element.data("calendar",i);i&&i.wijcalendar("option",t,n)}},i.prototype._setData=function(e){this.option("date",e)},i.prototype._resetData=function(){var e=this.element.data("defaultDate");e===undefined||e===null?(e=this.element.data("elementValue"),e!==undefined&&e!==null&&e!==""?this.setText(e):this._setData(null)):this._setData(e)},i.prototype._resetTimeStamp=function(){this.element.data("cursorPos",0),this.element.data("timeStamp",new Date("1900/1/1"))},i.prototype.getPostValue=function(){if(!this._isInitialized())return this.element.val();if(this.options.showNullText&&this.isDateNull())return"";var e=this._textProvider.toString();return e===this.options.nullText?"":e},i.prototype._highLightField=function(e){typeof e=="undefined"&&(e=this.options.activeField);if(this.isFocused()){var t=this._textProvider.getFieldRange(e);t&&this.element.wijtextselection(t)}},i.prototype._highLightCursor=function(e){if(this._isNullText())return;e===undefined&&(e=Math.max(0,this.element.wijtextselection().start));var t=this._textProvider.getCursorField(e);if(t<0)return;this._setOption("activeField",t)},i.prototype._toNextField=function(){this._setOption("activeField",this.options.activeField+1)},i.prototype._toPrevField=function(){this._setOption("activeField",this.options.activeField-1)},i.prototype._toFirstField=function(){this._setOption("activeField",0)},i.prototype._toLastField=function(){this._setOption("activeField",this._textProvider.getFieldCount())},i.prototype._clearField=function(e){typeof e=="undefined"&&(e=this.options.activeField);var n=this._textProvider.getFieldRange(e),r,i=this;n&&(r=new t.wijInputResult,this._textProvider.removeAt(n.start,n.end,r),this._updateText(),window.setTimeout(function(){i._highLightField()},1))},i.prototype._doSpin=function(e,t){var n=this;return this._allowEdit()?t&&this.element.data("breakSpinner")?!1:(this._textProvider[e?"incEnumPart":"decEnumPart"]()&&(this._updateText(),this._highLightField()),t&&!this.element.data("breakSpinner")&&window.setTimeout(function(){return n._doSpin(e,!0)},this._calcSpinInterval()),!0):!1},i.prototype._onChange=function(){},i.prototype._afterFocused=function(){this._isNullText()&&this._doFocus()},i.prototype._keyDownPreview=function(e){var t=e.keyCode||e.which,n;switch(t){case r.LEFT:return this._toPrevField(),!0;case r.RIGHT:return this._toNextField(),!0;case r.TAB:if(e.shiftKey){if(this.options.activeField>0)return this._toPrevField(),!0}else{n=this.element.wijtextselection();if(n&&n.end-n.start===this.element.val().length)break;if(this.options.activeField<this._textProvider.getFieldCount()-1)return this._toNextField(),!0}break;case r.SPACE:case 188:case 190:case 110:case 191:if(e.shiftKey){if(this.options.activeField>0)return this._toPrevField(),!0}else if(this.options.activeField<this._textProvider.getFieldCount()-1)return this._toNextField(),!0;break;case r.HOME:return e.ctrlKey?this._setOption("date",new Date):this._toFirstField(),!0;case r.END:return e.ctrlKey?this._setOption("date",new Date("1970/1/1")):this._toLastField(),!0;case r.DELETE:if(this._allowEdit())return n=this.element.wijtextselection(),n.end-n.start===this.element.val().length?(this.isDeleteAll=!0,this._setOption("date",new Date("1970/1/1"))):this._clearField(),!0}return!1},i.prototype._autoMoveToNextField=function(e,t){if(!this.options.autoNextField)return;this._textProvider.needToMove(this.options.activeField,e,t)&&this._toNextField()},i.prototype._keyPressPreview=function(e){var t=e.keyCode||e.which,n,i,s,o,u,a,f,l,c,h,p;if(t===r.ENTER)return this.isDateNull()&&(this.options.date=new Date),!1;n=this._textProvider.getFieldRange(this.options.activeField);if(n){if(t===r.TAB)return!0;if(t===r.SPACE)return this._stopEvent(e),!0;i=String.fromCharCode(t),s=this._textProvider.isFieldSep(i,this.options.activeField);if(s)return this._toNextField(),this._stopEvent(e),!0;o=this.element.data("cursorPos"),u=new Date,f=this.element.data("timeStamp"),p=this.element.data("lastInput"),a=u.getTime()-f.getTime()>this.options.keyDelay;var h=i;return a?o=0:p&&(h=p+h),this.element.data({timeStamp:u,lastInput:h}),l=n.start+o,this.element.data("cursorPos",++o),c=this._textProvider.addToField(h,this.options.activeField,l),c?(this._updateText(),this._autoMoveToNextField(o,i),this._highLightField()):(this._resetTimeStamp(),this._fireIvalidInputEvent()),this._stopEvent(e),!0}return!1},i.prototype._raiseDataChanged=function(){var e=this.options.date,t=this.element.data("preDate");this.element.data("preDate",e?new Date(e.getTime()):null);if(!t&&e||t&&!e||t&&e&&t.getTime()!==e.getTime())this._syncCalendar(),this.element.attr("aria-valuenow",e),this._trigger("dateChanged",null,{date:e})},i.prototype.isDateNull=function(){return this.options.date===null||this.options.date===undefined},i.prototype._isMinDate=function(e){return e.getFullYear()===1&&e.getMonth()===0&&e.getDate()===1},i.prototype._initCalendar=function(){var e=this,t=this.options,r=t.calendar,i;if(r===undefined||r===null)return;if(typeof r=="boolean"||r==="default")r=n("<div/>"),r.appendTo(document.body);i=n(r);if(i.length!==1)return;this.element.data("calendar",i),t.localization&&(t.nextTooltip=t.localization.nextTooltip,t.prevTooltip=t.localization.prevTooltip,t.titleFormat=t.localization.titleFormat,t.toolTipFormat=t.localization.toolTipFormat),i.wijcalendar({popupMode:!0,culture:t.culture,nextTooltip:t.nextTooltip||"Next",prevTooltip:t.prevTooltip||"Previous",titleFormat:t.titleFormat||"MMMM yyyy",toolTipFormat:t.toolTipFormat||"dddd, MMMM dd, yyyy",selectedDatesChanged:function(){var t=i.wijcalendar("getSelectedDate"),n=e.option("date");i.wijcalendar("close"),t&&(n&&(t.setHours(n.getHours()),t.setMinutes(n.getMinutes()),t.setSeconds(n.getSeconds()),t.setMilliseconds(n.getMilliseconds())),e.option("date",t),e.selectText()),e._trySetFocus()}}),this._syncCalendar()},i.prototype._syncCalendar=function(){var e=this.element.data("calendar"),t,n;if(!e)return;t=this.options,n=this._safeGetDate(),this._isMinDate(n)&&(n=new Date),e.wijcalendar("option","displayDate",n),t.minDate&&e.wijcalendar("option","minDate",t.minDate),t.maxDate&&e.wijcalendar("option","maxDate",t.maxDate),e.wijcalendar("unSelectAll"),e.wijcalendar("selectDate",n),e.wijcalendar("refresh")},i.prototype._isPopupShowing=function(){var t=this.element.data("calendar");return t?t.wijcalendar("isPopupShowing"):e.prototype._isPopupShowing.call(this)},i.prototype._showPopup=function(){var t=this.element.data("calendar");if(!t)return e.prototype._showPopup.call(this);if(!this._allowEdit())return;this._syncCalendar(),t.wijcalendar("popup",n.extend({},this.options.popupPosition,{of:this.outerDiv}))},i.prototype._hidePopup=function(){var t=this.element.data("calendar");if(!t)return e.prototype._hidePopup.call(this);t.wijcalendar("close")},i.prototype._isCalendarVisible=function(){if(!this._allowEdit())return!1;var e=this.element.data("calendar");return e?e.wijcalendar("isPopupShowing"):!1},i.prototype._popupVisible=function(){return this._hasComboItems()?this._isComboListVisible():this._isCalendarVisible()},i}(t.wijinputcore);t.wijinputdate=s;var o=function(){function e(){this.wijCSS={wijinputdate:t.wijinputcore.prototype.options.wijCSS.wijinput+"-date"},this.date=null,this.minDate=null,this.maxDate=null,this.dateFormat="d",this.startYear=1950,this.smartInputMode=!0,this.activeField=0,this.keyDelay=800,this.autoNextField=!0,this.calendar="default",this.popupPosition={offset:"0 4"},this.dateChanged=null}return e}();s.prototype.options=n.extend(!0,{},t.wijinputcore.prototype.options,new o),n.wijmo.registerWidget("wijinputdate",s.prototype);var u=function(e){function r(t,n){e.call(this),this.inputWidget=t,this.maskPartsCount=0,this.pattern="M/d/yyyy",this._disableSmartInputMode=!1,this.paddingZero=i,this.descriptors=new Array(0),this.desPostions=new Array(0),this.fields=new Array(0),this._setFormat(n)}return __extends(r,e),r.prototype.initialize=function(){},r.prototype.getFieldCount=function(){return this.fields.length},r.prototype.getFieldRange=function(e){var t=this.fields[e];return{start:t.startIndex,end:t.startIndex+t.getText().length}},r.prototype.getCursorField=function(e){e=Math.min(e,this.desPostions.length-1),e=Math.max(e,0);var t=this.desPostions[e].desc,r;if(t.type===-1){r=n.inArray(t,this.descriptors);if(!(r>0&&this.descriptors[r-1].type!==-1))return-1;t=this.descriptors[r-1]}return n.inArray(t,this.fields)},r.prototype.needToMove=function(e,t,n){if(!this.inputWidget._isValidDate(this.inputWidget._safeGetDate(),!0))return!1;var r=this.fields[e],i=parseInt(n,10);if(t===r.maxLen)return!0;if(isNaN(i))return!1;switch(r.type){case 20:case 25:case 45:case 46:return i>1;case 47:case 48:return i>2;case 30:case 31:return i>3;case 50:case 51:case 60:case 61:return i>6}return!1},r.prototype._getCulture=function(){return this.inputWidget._getCulture()},r.prototype._isDigitString=function(e){e=n.trim(e);if(e.length===0)return!0;var t=e.charAt(0),r,i;if(t==="+"||t==="-")e=e.substr(1),e=n.trim(e);if(e.length===0)return!0;try{return r=parseFloat(e),i=r.toString(),i===e}catch(s){return!1}},r.prototype._setFormat=function(e){this.descriptors=[];var t="",r="",i=!1,s=!1,o,u;this.pattern=this._parseFormatToPattern(e);for(o=0;o<this.pattern.length;o++){u=this.pattern.charAt(o);if(s){this.descriptors.push(this.createDescriptor(-1,u)),t="",s=!1;continue}if(u==="\\"){s=!0,t.length>0&&(this.handlePattern(t)||this.descriptors.push(this.createDescriptor(-1,r)),t="");continue}if(u==="'"){i?(i=!1,t=""):(i=!0,t.length>0&&(this.handlePattern(t)||this.descriptors.push(this.createDescriptor(-1,r)),t=""));continue}if(i){this.descriptors.push(this.createDescriptor(-1,u)),t="";continue}o||(r=u),r!==u&&t.length>0&&(this.handlePattern(t)||this.descriptors.push(this.createDescriptor(-1,r)),t=""),t+=u,r=u}t.length>0&&(this.handlePattern(t)||this.descriptors.push(this.createDescriptor(-1,r))),this.fields=n.grep(this.descriptors,function(e){return e.type!==-1})},r.prototype._parseFormatToPattern=function(e){var t=this.inputWidget._getCulture().calendars.standard,n=t.patterns.d;if(e.length<=1)switch(e){case"":case"d":n=t.patterns.d;break;case"D":n=t.patterns.D;break;case"f":n=t.patterns.D+" "+t.patterns.t;break;case"F":n=t.patterns.D+" "+t.patterns.T;break;case"g":n=t.patterns.d+" "+t.patterns.t;break;case"G":n=t.patterns.d+" "+t.patterns.T;break;case"m":n=t.patterns.M;break;case"M":n=t.patterns.M;break;case"s":n=t.patterns.S;break;case"t":n=t.patterns.t;break;case"T":n=t.patterns.T;break;case"u":n=t.patterns.S;break;case"U":n=t.patterns.D+" "+t.patterns.T;break;case"y":n=t.patterns.Y;break;case"Y":n=t.patterns.Y}else n=e;return n},r.prototype.getDate=function(){return this.inputWidget?new Date(this.inputWidget._safeGetDate().getTime()):undefined},r.prototype.setDate=function(e){this.inputWidget&&this.inputWidget._setData(e)},r.prototype._internalSetDate=function(e){if(this.inputWidget){var t=this,n=this.inputWidget.options,r=this.inputWidget.element,i=!!r.data("typing"),s;i?(n.date=e,s=function(){var e=new Date,i=r.data("timeStamp");e.getTime()-i.getTime()>n.keyDelay?(t.inputWidget._safeSetDate(n.date),t.inputWidget._updateText(),t.inputWidget._highLightField()):window.setTimeout(s,n.keyDelay)},window.setTimeout(s,n.keyDelay)):this.inputWidget._safeSetDate(e)}},r.prototype.daysInMonth=function(e,t){e-=1;var n=(new Date(t,++e,1,-1)).getDate();return n},r.prototype.setYear=function(e,t,n){try{t&&t.isfullreset&&(t.offset=1,e="1970");if(typeof e=="string"&&!this._isDigitString(e))return!1;e*=1;var r=this.inputWidget.options,i=1,s=9999,o,u,a;n&&(r.minDate&&(i=Math.max(i,r.minDate.getFullYear())),r.maxDate&&(s=Math.min(s,r.maxDate.getFullYear()))),t&&t.isreset&&(e=i),e<i&&(e=i),e>s&&(e=s),o=this.getDate(),u=new Date(o.getTime()),u.setFullYear(e);if(this._isValidDate(u))return a=this.daysInMonth(this.getMonth(),this.getYear()),a===o.getDate()?(u=new Date(o.getTime()),u.setDate(1),u.setFullYear(e),a=this.daysInMonth(u.getMonth()+1,u.getFullYear()),u.setDate(a),this._isValidDate(u)?(this._internalSetDate(u),!0):!1):(o.setFullYear(e),this._internalSetDate(o),!0);return t&&t.isreset?(o.setFullYear(1),this._internalSetDate(o),!0):!1}catch(f){return!1}},r.prototype.getYear=function(){return this.getDate().getFullYear()},r.prototype.setMonth=function(e,t,n){try{n&&n.isfullreset&&(e="1"),e*=1;var r=this.getDate(),i,s;if(typeof t!="undefined"&&!t)if(e>12||e<1){if(!n||!n.isreset)return!1;e=1}return i=this.daysInMonth(this.getMonth(),this.getYear()),i===this.getDate().getDate()?(s=new Date(r.getTime()),s.setDate(1),s.setMonth(e-1),i=this.daysInMonth(s.getMonth()+1,s.getFullYear()),s.setDate(i),this._isValidDate(s)?(this._internalSetDate(s),!0):!1):(s=new Date(r.getTime()),s.setMonth(e-1),this._isValidDate(s)?(this._internalSetDate(s),!0):!1)}catch(o){return!1}},r.prototype.getMonth=function(){return this.getDate().getMonth()+1},r.prototype.setDayOfMonth=function(e,t,n){try{if(n&&n.isfullreset)return this.setDayOfMonth(1,t);var r=this.getDate(),i,s;e*=1;if(typeof t!="undefined"&&!t){i=this.daysInMonth(this.getMonth(),this.getYear());if(e>i||e<1)return n&&n.isreset?this.setDayOfMonth(1,t,n):!1}return s=new Date(r.getTime()),s.setDate(e),this._isValidDate(s)?(this._internalSetDate(s),!0):!1}catch(o){return!1}},r.prototype.getDayOfMonth=function(){return this.getDate().getDate()},r.prototype.setHours=function(e,t){try{e*=1;if(typeof t!="undefined"&&!t&&e>24)return!1;var n=new Date(this.getDate().getTime());return n.setHours(e),this._isValidDate(n)?(this._internalSetDate(n),!0):!1}catch(r){return!1}},r.prototype.getHours=function(){return this.getDate().getHours()},r.prototype.setMinutes=function(e,t){try{e*=1;if(typeof t!="undefined"&&!t&&e>60)return!1;var n=new Date(this.getDate().getTime());return n.setMinutes(e),this._isValidDate(n)?(this._internalSetDate(n),!0):!1}catch(r){return!1}},r.prototype.getMinutes=function(){return this.getDate().getMinutes()},r.prototype.setSeconds=function(e,t){try{e*=1;if(typeof t!="undefined"&&!t&&e>60)return!1;var n=new Date(this.getDate().getTime());return n.setSeconds(e),this._isValidDate(n)?(this._internalSetDate(n),!0):!1}catch(r){return!1}},r.prototype.getSeconds=function(){return this.getDate().getSeconds()},r.prototype.setDayOfWeek=function(e){try{e*=1;var t=e-this.getDayOfWeek();return this.setDayOfMonth(this.getDayOfMonth()+t,!0)}catch(n){return!1}},r.prototype.getDayOfWeek=function(){return this.getDate().getDay()+1},r.prototype.handlePattern=function(e){var t=new RegExp("y{3,4}"),n=t.test(e);return n?(this.descriptors.push(this.createDescriptor(10)),!0):(t=new RegExp("y{2,2}"),n=t.test(e),n?(this.descriptors.push(this.createDescriptor(2)),!0):(t=new RegExp("y{1,1}"),n=t.test(e),n?(this.descriptors.push(this.createDescriptor(1)),!0):(t=new RegExp("d{4,4}"),n=t.test(e),n?(this.descriptors.push(this.createDescriptor(101)),!0):(t=new RegExp("d{3,3}"),n=t.test(e),n?(this.descriptors.push(this.createDescriptor(100)),!0):(t=new RegExp("d{2,2}"),n=t.test(e),n?(this.descriptors.push(this.createDescriptor(30)),!0):(t=new RegExp("d{1,1}"),n=t.test(e),n?(this.descriptors.push(this.createDescriptor(31)),!0):(t=new RegExp("M{4,4}"),n=t.test(e),n?(this.descriptors.push(this.createDescriptor(27)),!0):(t=new RegExp("M{3,3}"),n=t.test(e),n?(this.descriptors.push(this.createDescriptor(26)),!0):(t=new RegExp("M{2,2}"),n=t.test(e),n?(this.descriptors.push(this.createDescriptor(20)),!0):(t=new RegExp("M{1,1}"),n=t.test(e),n?(this.descriptors.push(this.createDescriptor(25)),!0):(t=new RegExp("h{2,2}"),n=t.test(e),n?(this.descriptors.push(this.createDescriptor(46)),!0):(t=new RegExp("h{1,1}"),n=t.test(e),n?(this.descriptors.push(this.createDescriptor(45)),!0):(t=new RegExp("H{2,2}"),n=t.test(e),n?(this.descriptors.push(this.createDescriptor(48)),!0):(t=new RegExp("H{1,1}"),n=t.test(e),n?(this.descriptors.push(this.createDescriptor(47)),!0):(t=new RegExp("m{2,2}"),n=t.test(e),n?(this.descriptors.push(this.createDescriptor(50)),!0):(t=new RegExp("m{1,1}"),n=t.test(e),n?(this.descriptors.push(this.createDescriptor(51)),!0):(t=new RegExp("s{2,2}"),n=t.test(e),n?(this.descriptors.push(this.createDescriptor(60)),!0):(t=new RegExp("s{1,1}"),n=t.test(e),n?(this.descriptors.push(this.createDescriptor(61)),!0):(t=new RegExp("t{2,2}"),n=t.test(e),n?(this.descriptors.push(this.createDescriptor(251)),!0):(t=new RegExp("t{1,1}"),n=t.test(e),n?(this.descriptors.push(this.createDescriptor(250)),!0):!1))))))))))))))))))))},r.prototype.createDescriptor=function(e,t){var n=null,r=this.maskPartsCount++;switch(e){case-1:n=new l(this,r),n.liternal=t;break;case 20:n=new h(this,r);break;case 25:n=new p(this,r);break;case 26:n=new d(this,r);break;case 27:n=new v(this,r);break;case 30:n=new g(this,r);break;case 31:n=new y(this,r);break;case 100:n=new b(this,r);break;case 101:n=new w(this,r);break;case 10:n=new S(this,r);break;case 1:n=new T(this,r);break;case 2:n=new N(this,r);break;case 45:n=new L(this,r);break;case 46:n=new A(this,r);break;case 47:n=new M(this,r);break;case 48:n=new _(this,r);break;case 250:n=new P(this,r);break;case 251:n=new H(this,r);break;case 50:n=new j(this,r);break;case 51:n=new F(this,r);break;case 60:n=new q(this,r);break;case 61:n=new R(this,r);break;default:}return n},r.prototype.toString=function(){if(this.inputWidget.options.showNullText&&!this.inputWidget.isFocused()&&this.inputWidget.isDateNull())return this.inputWidget.options.nullText;var e="",t=0,n,r,i;this.desPostions=new Array(0);for(n=0;n<this.descriptors.length;n++){this.descriptors[n].startIndex=e.length,r=this.descriptors[n].getText(),e+=r;for(i=0;i<r.length;i++){this.desPostions.push({desc:this.descriptors[n],pos:i,text:r,length:r.length}),t++;if(this.desPostions.length!==t)throw"Fatal Error !!!!!!!!!!!!!!!"}}return e},r.prototype.parseDate=function(e){var t;if(this.pattern==="dddd"||this.pattern==="ddd"||typeof e=="object")try{t=new Date(e),isNaN(t)&&(t=new Date)}catch(n){t=new Date}else t=Globalize.parseDate(e,this.pattern,this._getCulture()),t||(t=this._tryParseDate(e,this.pattern)),t||(t=new Date);return t},r.prototype.set=function(e){return this._internalSetDate(new Date(this.parseDate(e))),!0},r.prototype.haveEnumParts=function(){return!1},r.prototype.removeLiterals=function(e){return e=""+e+"",e=e.replace(new RegExp("[+]","g"),""),e=e.replace(new RegExp("[.]","g"),""),e=e.replace(new RegExp("[:]","g"),""),e=e.replace(new RegExp("[-]","g"),""),e=e.replace(new RegExp("[()=]","g"),""),e},r.prototype.getFirstDelimiterPos=function(e,t){var n=0,r=0,i,s;while(n<t.length&&r<e.length){i=t.charAt(n),s=e.charAt(r);if(i!==s)return r-1;r++,n++}return e.length-1},r.prototype.findAlikeArrayItemIndex=function(e,t){var n=-1,r=99999,i,s;for(i=0;i<e.length;i++)s=e[i].toLowerCase().indexOf(t.toLowerCase()),s!==-1&&s<r&&(r=s,n=i);return n},r.prototype._isValidDate=function(e){return this.inputWidget._isValidDate(e)},r.prototype.isFieldSep=function(e,t){var n=t++,r;return n<this.descriptors.length?(r=this.descriptors[n],r.type!==-1?!1:e===r.text):!1},r.prototype.getPositionType=function(e){var t=this.desPostions[e];return t.desc.type},r.prototype.addToField=function(e,t,n){var r=this.fields[t],i,s,o;return i=e,s={val:e,pos:0,offset:0,isreset:!1},this.inputWidget.element.data("typing",!0),o=r.setText(i,e.length===1?!1:!0,s),this.inputWidget.element.data("typing",!1),o},r.prototype.insertAt=function(e,n,r){typeof r=="undefined"&&(r=new t.wijInputResult),r.testPosition=-1;var i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w;if(e.length===1){i=this.desPostions[n];if(i&&i.desc.type===-1&&i.text===e)return r.testPosition=n,r.hint=r.characterEscaped,!0}s=e,o=n,e=this.removeLiterals(e),u=e,a=!1,l=!1,o>0&&u.length===1&&(o--,n=o,i=this.desPostions[o],a=!0,i&&(i.desc.type===-1||i.desc.getText().length!==1)&&(n++,o++,a=!1)),f=!1;while(u.length>0&&o<this.desPostions.length){i=this.desPostions[o];if(i.desc.type===-1){o+=i.length;continue}if(i.desc.needAdjustInsertPos()){c=u.substr(0,i.length-i.pos),c=i.text.slice(0,i.pos)+c+i.text.slice(i.pos+c.length,i.length),a&&(c=i.text+c),l&&(c+=i.text),p=i.desc.getText().length,v="";try{e.length===1&&(i.pos?i.pos>0&&(v=c.substring(0,i.pos+1)):v=e)}catch(E){}p===1&&c.length>1&&e.length===1&&(i.desc.type===31||i.desc.type===25)&&(this._disableSmartInputMode=!0),h={val:e,pos:i.pos,offset:0,isreset:!1},f=i.desc.setText(c,e.length===1?!1:!0,h),this._disableSmartInputMode=!1,!f&&typeof v!="undefined"&&v.length>0&&(i.desc.type===26||i.desc.type===27||i.desc.type===100||i.desc.type===101||i.desc.type===250||i.desc.type===251)&&(f=i.desc.setText(v,e.length===1?!1:!0,h));if(f)r.hint=r.success,r.testPosition=o+h.offset,e.length===1&&(m=i.desc.getText().length,d=i.pos,i.pos>m-1&&(d=m),g=m-p,g>0&&i.pos===p-1&&(d=m-1),y=this.toString(),r.testPosition=i.desc.startIndex+d+h.offset),u=u.slice(i.length-i.pos,u.length);else{r.hint=r.invalidInput,r.testPosition!==-1&&(r.testPosition=n);if(i.desc.type!==-1&&e.length===1)return!1}o+=i.length}else b=this.getFirstDelimiterPos(u,s),b<0&&(b=0),c=u.substring(0,b+1),h={val:e,pos:i.pos,offset:0,isreset:!1},f=i.desc.setText(c,e.length===1?!1:!0,h),f?(r.hint=r.success,r.testPosition=o+h.offset,u=u.slice(b+1,u.length)):(r.hint=r.invalidInput,r.testPosition!==-1&&(r.testPosition=n)),b<0&&(b=0),w=b+1,o+=w}return f},r.prototype.removeAt=function(e,t,n){try{var r=this.desPostions[e],i,s,o,u,a=this.inputWidget,f=a.element,l=f.val().length;return l===t+1&&e===0&&(a.isDeleteAll=!0),r.desc.needAdjustInsertPos()&&(i="0",s=e,r.text=r.desc.getText(),i=r.text.slice(0,r.pos)+i+r.text.slice(r.pos+i.length,r.length),o={val:i,pos:r.pos,offset:0,isreset:!0,isfullreset:!1},t-e+1>=r.length&&(o.isfullreset=!0,e+=r.length,s=e),u=r.desc.setText(i,!1,o),u?(n.hint=n.success,n.testPosition=s):(n.hint=n.invalidInput,n.testPosition===-1&&(n.testPosition=e))),e<t&&this.removeAt(e+1,t,n),!0}catch(c){return!1}},r.prototype.incEnumPart=function(){var e=this.fields[this.inputWidget.options.activeField];return e&&e.inc(),!0},r.prototype.decEnumPart=function(e){var t=this.fields[this.inputWidget.options.activeField];return t&&t.dec(),!0},r.prototype.setValue=function(e){return this.setDate(new Date(e instanceof Date?e.getTime():e)),!0},r.prototype.getValue=function(){return this.getDate()},r.prototype._isSmartInputMode=function(){return this._disableSmartInputMode?!1:this.inputWidget?this.inputWidget.options.smartInputMode:!0},r.prototype._getInt=function(e,t,r,i){var s,o;for(s=i;s>=r;s--){o=e.substring(t,t+s);if(o.length<r)return null;if(n.wij.charValidator.isDigit(o))return o}return null},r.prototype._tryParseDate=function(e,t){var n=this._getCulture().calendars,r,i,s,o;return t=t||n.standard.patterns.d,t&&(t.indexOf("MMM")===-1&&t.indexOf("MMMM")===-1&&(t=t.replace("MM","M")),t=t.replace("dd","d"),t=t.replace("tt","a")),r=t.replace("yyyy","yy"),i=n.standard["/"],s=[t,r,t.replace(new RegExp(i,"g"),"-"),r.replace(new RegExp(i,"g"),"-"),t.replace(new RegExp(i,"g"),"."),r.replace(new RegExp(i,"g"),".")],o=Globalize.parseDate(e,s,this._getCulture()),o?o:(o=new Date(e),o.toString()!=="Invalid Date"&&e&&e!==""?o:0)},r.prototype._formatDate=function(e,t,n){var r=this;if(!e.valueOf())return"&nbsp;";var s=this.inputWidget._getCulture().calendars.standard,o=t.replace(new RegExp("yyyy|MMMM|MMM|MM|M|mm|m|dddd|ddd|dd|d|hh|h|HH|H|ss|s|tt|t|a/p","gi"),function(t){var o;switch(t){case"yyyy":return i(e.getFullYear(),4);case"MMMM":return n.dateTimeFormat.monthNames[e.getMonth()];case"MMM":return n.dateTimeFormat.abbreviatedMonthNames[e.getMonth()];case"MM":return r.paddingZero(e.getMonth()+1,2);case"M":return r.paddingZero(e.getMonth()+1,1);case"mm":return r.paddingZero(e.getMinutes(),2);case"m":return r.paddingZero(e.getMinutes(),1);case"dddd":return n.dateTimeFormat.dayNames[e.getDay()];case"ddd":return n.dateTimeFormat.abbreviatedDayNames[e.getDay()];case"dd":return r.paddingZero(e.getDate(),2);case"d":return r.paddingZero(e.getDate(),1);case"hh":return o=e.getHours()%12,r.paddingZero(o?o:12,2);case"h":return o=e.getHours()%12,r.paddingZero(o?o:12,1);case"HH":return r.paddingZero(e.getHours(),2);case"H":return r.paddingZero(e.getHours(),1);case"ss":return r.paddingZero(e.getSeconds(),2);case"s":return r.paddingZero(e.getSeconds(),1);case"tt":return e.getHours()<12?s.AM[0]:s.PM[0];case"t":return e.getHours()<12?s.AM[0].length>0?s.AM[0].charAt(0):"":s.PM[0].length>0?s.PM[0].charAt(0):"";case"a/p":return e.getHours()<12?"a":"p"}return"N"});return o},r}(t.wijTextProvider);t.wijDateTextProvider=u,function(e){e._map=[],e.liternal=-1,e.OneDigitYear=1,e.TwoDigitYear=2,e.FourDigitYear=10,e.TwoDigitMonth=20,e.Month=25,e.AbbreviatedMonthNames=26,e.MonthNames=27,e.TwoDigityDayOfMonth=30,e.DayOfMonth=31,e.AbbreviatedDayNames=100,e.DayNames=101,e.h=45,e.hh=46,e.H=47,e.HH=48,e.ShortAmPm=250,e.AmPm=251,e.mm=50,e.m=51,e.ss=60,e.s=61}(t.DescriptorType||(t.DescriptorType={}));var a=t.DescriptorType,f=function(){function e(e,t){this.id=t,this.startIndex=0,this.name=null,this.type=a.liternal,this.maxLen=2,this._txtProvider=e,this.startIndex=0}return e.prototype.getText=function(){return null},e.prototype.setText=function(e,t,n){return!1},e.prototype.inc=function(){},e.prototype.dec=function(){},e.prototype.needAdjustInsertPos=function(){return!0},e.prototype.reachMaxLen=function(){var e=this.getText();do{if(e.charAt(0)!=="0")break;e=e.slice(1)}while(e.length>0);return e.length>=this.maxLen},e}();t._iDateDescriptor=f;var l=function(e){function t(t,n){e.call(this,t,n),this.liternal="",this.maxLen=100}return __extends(t,e),t.prototype.getText=function(){return this.liternal},t}(f),c=function(e){function t(t,n){e.call(this,t,n)}return __extends(t,e),t.prototype.inc=function(){this._txtProvider.setMonth(this._txtProvider.getMonth()+1,!0)},t.prototype.dec=function(){this._txtProvider.setMonth(this._txtProvider.getMonth()-1,!0)},t.prototype.setText=function(e,t,n){return this._txtProvider.setMonth(e,t,n)},t}(f),h=function(e){function t(t,n){e.call(this,t,n),this.name="Two-digit month",this.type=a.TwoDigitMonth}return __extends(t,e),t.prototype.getText=function(){var e=""+this._txtProvider.getMonth()+"";return e.length===1?"0"+e:e},t}(c),p=function(e){function t(t,n){e.call(this,t,n),this.name="month",this.type=a.Month}return __extends(t,e),t.prototype.getText=function(){var e=""+this._txtProvider.getMonth()+"";return e},t}(c),d=function(e){function t(t,n){e.call(this,t,n),this.name="AbbreviatedMonthNames",this.type=a.AbbreviatedMonthNames,this.maxLen=a.AbbreviatedMonthNames}return __extends(t,e),t.prototype.getText=function(){var e=this._txtProvider.getMonth(),t=this._txtProvider._getCulture();return t.calendars.standard.months.namesAbbr[e-1]},t.prototype.setText=function(e,t,n){var r=-1,i=this._txtProvider.inputWidget._getCulture().calendars.standard;return r=this._txtProvider.findAlikeArrayItemIndex(i.months.namesAbbr,e),r===-1?!1:this._txtProvider.setMonth(r+1,t,n)},t}(c),v=function(e){function t(t,n){e.call(this,t,n),this.name="MonthNames",this.type=a.MonthNames,this.maxLen=100}return __extends(t,e),t.prototype.getText=function(){var e=this._txtProvider.getMonth(),t=this._txtProvider._getCulture();return t.calendars.standard.months.names[e-1]},t.prototype.setText=function(e,t,n){var r=-1,i;if(n&&n.isfullreset)r=1;else{i=this._txtProvider._getCulture(),r=this._txtProvider.findAlikeArrayItemIndex(i.calendars.standard.months.names,e);if(r===-1)return!1}return this._txtProvider.setMonth(r+1,t,n)},t}(c),m=function(e){function t(t,n){e.call(this,t,n)}return __extends(t,e),t.prototype.inc=function(){this._txtProvider.setDayOfMonth(this._txtProvider.getDayOfMonth()+1,!0)},t.prototype.dec=function(){this._txtProvider.setDayOfMonth(this._txtProvider.getDayOfMonth()-1,!0)},t.prototype.setText=function(e,t,n){return this._txtProvider.setDayOfMonth(e,t,n)},t}(f),g=function(e){function t(t,n){e.call(this,t,n),this.name="Two-digit day of month",this.type=a.TwoDigityDayOfMonth}return __extends(t,e),t.prototype.getText=function(){return i(this._txtProvider.getDayOfMonth())},t}(m),y=function(e){function t(t,n){e.call(this,t,n),this.name="Day of month",this.type=a.DayOfMonth}return __extends(t,e),t.prototype.getText=function(){var e=this._txtProvider.getDayOfMonth();return""+e+""},t}(m),b=function(e){function t(t,n){e.call(this,t,n),this.name="AbbreviatedDayNames",this.type=a.AbbreviatedDayNames,this.maxLen=100}return __extends(t,e),t.prototype.getText=function(){var e=this._txtProvider.getDayOfWeek(),t=this._txtProvider._getCulture();return t.calendars.standard.days.namesShort[e-1]},t.prototype.setText=function(e,t,n){var r=-1,i=this._txtProvider._getCulture();return r=this._txtProvider.findAlikeArrayItemIndex(i.calendars.standard.days.namesShort,e),r===-1?!1:this._txtProvider.setDayOfWeek(r+1)},t.prototype.needAdjustInsertPos=function(){return!1},t}(m),w=function(e){function t(t,n){e.call(this,t,n),this.name="DayNames",this.type=a.DayNames,this.maxLen=100}return __extends(t,e),t.prototype.getText=function(){var e=this._txtProvider.getDayOfWeek(),t=this._txtProvider._getCulture();return t.calendars.standard.days.names[e-1]},t.prototype.setText=function(e,t,n){var r=-1,i=this._txtProvider._getCulture();return r=this._txtProvider.findAlikeArrayItemIndex(i.calendars.standard.days.names,e),r===-1?!1:this._txtProvider.setDayOfWeek(r+1)},t.prototype.needAdjustInsertPos=function(){return!1},t}(m),E=function(e){function t(t,n){e.call(this,t,n)}return __extends(t,e),t.prototype.inc=function(){this._txtProvider.setYear(this._txtProvider.getYear()+1,null,!0)},t.prototype.dec=function(){this._txtProvider.setYear(this._txtProvider.getYear()-1,null,!0)},t}(f),S=function(e){function t(t,n){e.call(this,t,n),this.name="Four-digit year",this.type=a.FourDigitYear,this.maxLen=4}return __extends(t,e),t.prototype.getText=function(){return i(this._txtProvider.getYear(),4)},t.prototype.setText=function(e,t,n){if(this._txtProvider._isSmartInputMode()&&n){var r=2e3,i,s,o,u,a,f,l,c;this._txtProvider.inputWidget.options.startYear&&(r=this._txtProvider.inputWidget.options.startYear),s=r+100-1,i=this._txtProvider.paddingZero(r,4),s=this._txtProvider.paddingZero(s,4);if(n.pos===0||n.pos===1){o=new Date,u=this._txtProvider.paddingZero(this._txtProvider.getYear(),4);if(u.charAt(0)==="0"&&u.charAt(1)==="0"&&n.pos<=1)return a=n.val,f="00",a>=5?f=i.slice(0,2):f=s.slice(0,2),l=n.val+u.slice(3,4),c=f+l,n.offset=2-n.pos,this._txtProvider.setYear(c,n),!0}}return this._txtProvider.setYear(e,n)},t}(E),x=function(e){function t(t,n){e.call(this,t,n)}return __extends(t,e),t.prototype.setText=function(e,t,n){e=i(e);var r=i(this._txtProvider.getYear(),4),s,o,u,a,f;return e==="00"&&(s=this._txtProvider.getMonth(),o=this._txtProvider.getDayOfMonth(),u=this._txtProvider.getHours(),a=this._txtProvider.getMinutes(),f=this._txtProvider.getSeconds(),s===1&&o===1&&!u&&!a&&!f&&(r="0001",e="01")),r.length>=2&&(r=r.substr(0,2)+e.substr(0,2)),this._txtProvider.setYear(r,n)},t}(E),T=function(e){function t(t,n){e.call(this,t,n),this.name="One-digit year",this.type=a.OneDigitYear}return __extends(t,e),t.prototype.getText=function(){var e=i(this._txtProvider.getYear());return e[0]==="0"&&(e=e[1]),e},t}(x),N=function(e){function t(t,n){e.call(this,t,n),this.name="Two-digit year",this.type=a.TwoDigitYear}return __extends(t,e),t.prototype.getText=function(){return i(this._txtProvider.getYear(),2)},t}(x),C=function(e){function t(t,n){e.call(this,t,n)}return __extends(t,e),t.prototype.inc=function(){this._txtProvider.setHours(this._txtProvider.getHours()+1,!0)},t.prototype.dec=function(){this._txtProvider.setHours(this._txtProvider.getHours()-1,!0)},t}(f),k=function(e){function t(t,n){e.call(this,t,n)}return __extends(t,e),t.prototype.setText=function(e,t,n){var r=this._txtProvider.getHours();return r>12&&(e=e*1+12),this._txtProvider.setHours(e,t)},t}(C),L=function(e){function t(t,n){e.call(this,t,n),this.name="h",this.type=a.h}return __extends(t,e),t.prototype.getText=function(){var e=this._txtProvider.getHours();return e>12?e-=12:e===0&&(e=12),""+e+""},t}(k),A=function(e){function t(t,n){e.call(this,t,n),this.name="hh",this.type=a.hh}return __extends(t,e),t.prototype.getText=function(){var e=this._txtProvider.getHours();if(e>12)e-=12;else if(e===0)return"12";return i(e)},t}(k),O=function(e){function t(t,n){e.call(this,t,n)}return __extends(t,e),t.prototype.setText=function(e,t,n){return this._txtProvider.setHours(e,t)},t}(C),M=function(e){function t(t,n){e.call(this,t,n),this.name="H",this.type=a.H}return __extends(t,e),t.prototype.getText=function(){var e=this._txtProvider.getHours();return""+e+""},t}(O),_=function(e){function t(t,n){e.call(this,t,n),this.name="HH",this.type=a.HH}return __extends(t,e),t.prototype.getText=function(){return i(this._txtProvider.getHours())},t}(O),D=function(e){function t(t,n){e.call(this,t,n)}return __extends(t,e),t.prototype.inc=function(){var e=(this._txtProvider.getHours()+12)%24;this._txtProvider.setHours(e,!0)},t.prototype.dec=function(){var e=(this._txtProvider.getHours()+12)%24;this._txtProvider.setHours(e,!0)},t.prototype.setText=function(e,t,n){var r;return e.toLowerCase().indexOf("a")>=0?(r=this._txtProvider.getHours()%12,this._txtProvider.setHours(r,!0)):e.toLowerCase().indexOf("p")>=0&&(r=this._txtProvider.getHours()%12+12,this._txtProvider.setHours(r,!0)),!0},t}(f),P=function(e){function t(t,n){e.call(this,t,n),this.name="t",this.type=a.ShortAmPm}return __extends(t,e),t.prototype.getText=function(){var e=this._txtProvider.getHours(),t=this._txtProvider._getCulture(),n=t.calendars.standard[e<12?"AM":"PM"][0];return n.charAt(0)||" "},t}(D),H=function(e){function t(t,n){e.call(this,t,n),this.name="tt",this.type=a.AmPm}return __extends(t,e),t.prototype.getText=function(){var e=this._txtProvider.getHours(),t="",n=this._txtProvider._getCulture();return e<12?t=n.calendars.standard.AM[0]:t=n.calendars.standard.PM[0],t.length<=0&&(t=" "),t},t}(D),B=function(e){function t(t,n){e.call(this,t,n),this.delta=1}return __extends(t,e),t.prototype.inc=function(){this._txtProvider.setMinutes(this._txtProvider.getMinutes()+this.delta,!0)},t.prototype.dec=function(){this._txtProvider.setMinutes(this._txtProvider.getMinutes()-this.delta,!0)},t.prototype.setText=function(e,t,n){return n&&n.isfullreset&&(e="0"),this._txtProvider.setMinutes(e,t)},t}(f),j=function(e){function t(t,n){e.call(this,t,n),this.name="mm",this.type=a.mm}return __extends(t,e),t.prototype.getText=function(){return i(this._txtProvider.getMinutes())},t}(B),F=function(e){function t(t,n){e.call(this,t,n),this.name="m",this.type=a.m,this.delta=12}return __extends(t,e),t.prototype.getText=function(){return this._txtProvider.getMinutes().toString()},t}(B),I=function(e){function t(t,n){e.call(this,t,n)}return __extends(t,e),t.prototype.inc=function(){this._txtProvider.setSeconds(this._txtProvider.getSeconds()+12,!0)},t.prototype.dec=function(){this._txtProvider.setSeconds(this._txtProvider.getSeconds()-12,!0)},t.prototype.setText=function(e,t,n){return n&&n.isfullreset&&(e="0"),this._txtProvider.setSeconds(e,t)},t}(f),q=function(e){function t(t,n){e.call(this,t,n),this.name="ss",this.type=a.ss}return __extends(t,e),t.prototype.getText=function(){return i(this._txtProvider.getSeconds())},t}(I),R=function(e){function t(t,n){e.call(this,t,n),this.name="s",this.type=a.s}return __extends(t,e),t.prototype.getText=function(){return this._txtProvider.getSeconds().toString()},t}(I)})(e.input||(e.input={}));var t=e.input})(wijmo||(wijmo={}));;
var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(e){"use strict";var t=jQuery;(function(e){e._map=[],e.editOptional=1,e.editRequired=2,e.separator=4,e.literal=8})(e.wijchartype||(e.wijchartype={}));var n=e.wijchartype,r=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype._createTextProvider=function(){this._textProvider=new s(this,this.options.mask,!1)},t.prototype._checkMaskAndPassword=function(){var e=!this.options.mask||this.options.mask.length<0;if(e&&this._isPassword())throw'Option "passwordChar" requires a mask'},t.prototype._updateIsPassword=function(){var e=this.options.passwordChar.length>0&&this.element.attr("type")!=="password";this.element.data("isPassword",e),this._checkMaskAndPassword()},t.prototype._beginUpdate=function(){this.element.addClass(this.options.wijCSS.wijinputmask),this._updateIsPassword(),this.element.data("defaultText",this.options.text)},t.prototype._setOption=function(t,n){e.prototype._setOption.call(this,t,n);switch(t){case"text":this.setText(n);break;case"mask":case"culture":if(typeof n=="undefined"||n.length<=0)return;this._checkMaskAndPassword();var r=this.getText();t==="mask"&&(this._textProvider.mask=n,this._textProvider.initialMask=n),this._textProvider.initialize(),this._textProvider.set(r),this._updateText();break;case"promptChar":this._textProvider&&(this._textProvider.updatePromptChar(),this._updateText());break;case"hidePromptOnLeave":case"resetOnPrompt":this._updateText();break;case"passwordChar":this._updateIsPassword(),this._updateText()}},t.prototype._resetData=function(){var e=this.element.data("defaultText");if(e===undefined||e===null)e=this.element.data("elementValue");if(e===undefined||e===null)e="";this.setText(e)},t.prototype._isPassword=function(){return!!this.element.data("isPassword")},t.prototype._getTextWithPrompts=function(){return this._isInitialized()?this._textProvider.toString(!0,!0,!1):this.element.val()},t.prototype._getTextWithLiterals=function(){return this._isInitialized()?this._textProvider.toString(!0,!1,!0):this.element.val()},t.prototype._getTextWithPromptAndLiterals=function(){return this._isInitialized()?this._textProvider.toString(!0,!0,!0):this.element.val()},t.prototype._getTextWithPromptAndLiteralsAndPassword=function(){return this._isInitialized()?this._textProvider.toString(!1,!0,!0):this.element.val()},t.prototype._onChange=function(){if(!this.element)return;var e=this.element.val(),t=this.getText();this.getText()!==e&&this._getTextWithPrompts()!==e&&this._getTextWithPromptAndLiterals()!==e&&this._getTextWithPromptAndLiteralsAndPassword()!==e&&this.setText(e)},t.prototype._afterFocused=function(){(this._isNullText()||!!this.options.hidePromptOnLeave)&&this._doFocus()},t}(e.wijinputcore);e.wijinputmask=r;var i=function(){function t(){this.wijCSS={wijinputmask:e.wijinputcore.prototype.options.wijCSS.wijinput+"-mask"},this.text=null,this.mask="",this.promptChar="_",this.hidePromptOnLeave=!1,this.resetOnPrompt=!0,this.allowPromptAsInput=!1,this.passwordChar="",this.resetOnSpace=!0,this.skipLiterals=!0}return t}();r.prototype.options=t.extend(!0,{},e.wijinputcore.prototype.options,new i),t.wijmo.registerWidget("wijinputmask",r.prototype);var s=function(r){function i(e,t,n){r.call(this),this.inputWidget=e,this.mask=t,this.asciiOnly=n,this.testString="",this.assignedCharCount=0,this.requiredCharCount=0,this.noMask=!1,this.descriptors=[],this.initialize()}return __extends(i,r),i.prototype.initialize=function(){this.noMask=!this.mask||this.mask.length<=0;if(this.noMask)return;this.testString="",this.assignedCharCount=0,this.requiredCharCount=0,this.descriptors=new Array(0);var e="none",t=!1,r=0,i,s,u,a=n.literal,f="",l,c,h,p,d=this.inputWidget._getCulture();for(i=0;i<this.mask.length;i++){u=!1,l=this.mask.charAt(i),t&&(t=!1,u=!0);if(!u){h=l;if(h<="C"){switch(h){case"#":case"9":case"?":case"C":l=this.getPromtChar(),a=n.editOptional,u=!0;break;case"$":f=d.numberFormat.currency.symbol,a=n.separator,u=!0;break;case"%":case"-":case";":case"=":case"@":case"B":a=n.literal,u=!0;break;case"&":case"0":case"A":l=this.getPromtChar(),a=n.editRequired,u=!0;break;case",":f=d.numberFormat[","],a=n.separator,u=!0;break;case".":f=d.numberFormat["."],a=n.separator,u=!0;break;case"/":f=d.calendars.standard["/"],a=n.separator,u=!0;break;case":":f=d.calendars.standard[":"],a=n.separator,u=!0;break;case"<":e="lower";continue;case">":e="upper";continue}u||(a=n.literal,u=!0)}if(!u){if(h<="\\"){switch(h){case"L":l=this.getPromtChar(),a=n.editRequired,u=!0;break;case"\\":t=!0,a=n.literal;continue}u||(a=n.literal,u=!0)}if(!u){h==="a"&&(l=this.getPromtChar(),a=n.editOptional,u=!0);if(!u){h!=="|"&&(a=n.literal,u=!0);if(!u){e="none";continue}}}}}if(u){p=new o(i,a),this.isEditDesc(p)&&(p.caseConversion=e),a!==n.separator&&(f=l);for(s=0;s<f.length;s++)c=f.charAt(s),this.testString=this.testString+c,this.descriptors[this.descriptors.length]=p,r++}}},i.prototype.getAllowPromptAsInput=function(){return this.inputWidget?this.inputWidget.options.allowPromptAsInput:!1},i.prototype.getPasswordChar=function(){return this.inputWidget?this.inputWidget.options.passwordChar:"*"},i.prototype.isPassword=function(){return this.inputWidget?this.inputWidget._isPassword():!1},i.prototype.getResetOnPrompt=function(){return this.inputWidget?this.inputWidget.options.resetOnPrompt:!0},i.prototype.getResetOnSpace=function(){return this.inputWidget?this.inputWidget.options.resetOnSpace:!0},i.prototype.getSkipLiterals=function(){return this.inputWidget?this.inputWidget.options.skipLiterals:!0},i.prototype.getHidePromptOnLeave=function(){return this.inputWidget?this.inputWidget.options.hidePromptOnLeave:!1},i.prototype._trueOR=function(e,t){return(e>>>1|t>>>1)*2+(e&1|t&1)},i.prototype.setValue=function(e){return!1},i.prototype.getValue=function(){return null},i.prototype.getPromtChar=function(){return this.inputWidget?this.inputWidget.options.promptChar:"_"},i.prototype.updatePromptChar=function(){if(this.noMask)return;var e,r;for(e=0;e<this.descriptors.length;e++){r=this.descriptors[e];if(r.charType===n.editOptional||r.charType===n.editRequired)r.isAssigned||(this.testString=t.wij.charValidator.setChar(this.testString,this.getPromtChar(),e))}},i.prototype.resetChar=function(e){var r=this.descriptors[e];this.isEditPos(e)&&r.isAssigned&&(r.isAssigned=!1,this.testString=t.wij.charValidator.setChar(this.testString,this.getPromtChar(),e),this.assignedCharCount--,r.charType===n.editRequired&&this.requiredCharCount--)},i.prototype.getAdjustedPos=function(e){return this.noMask?e>=this.testString.length&&(e=this.testString.length-1):e>=this.descriptors.length&&(e-=1),Math.max(0,e)},i.prototype.incEnumPart=function(e,t,n){return!this.noMask},i.prototype.decEnumPart=function(e,t,n){return!this.noMask},i.prototype.findNonEditPositionInRange=function(e,t,r){return this.findPositionInRange(e,t,r,this._trueOR(n.literal,n.separator))},i.prototype.findPositionInRange=function(e,t,n,r){e=Math.max(0,e),t=Math.min(t,this.testString.length-1);if(e<=t)while(e<=t){var i=n?e++:t--,s=this.descriptors[i];if((s.charType&4294967295&(r&4294967295))===s.charType)return i}return-1},i.prototype.findAssignedEditPositionInRange=function(e,t,r){return this.assignedCharCount===0?-1:this.findEditPositionInRange(e,t,r,n.editRequired)},i.prototype.findEditPositionInRange=function(e,t,r,i){do{var s,o;s=this.findPositionInRange(e,t,r,this._trueOR(n.editRequired,n.editOptional));if(s===-1)break;o=this.descriptors[s];switch(i){case n.editOptional:if(!o.isAssigned)return s;break;case n.editRequired:if(o.isAssigned)return s;break;default:return s}r?e++:t--}while(e<=t);return-1},i.prototype.findAssignedEditPositionFrom=function(e,t){if(!this.assignedCharCount)return-1;var n,r;return t?(n=e,r=this.testString.length-1):(n=0,r=e),this.findAssignedEditPositionInRange(n,r,t)},i.prototype.findEditPositionFrom=function(e,t){var n,r;return t?(n=e,r=this.testString.length-1):(n=0,r=e),this.findEditPositionInRange(n,r,t,0)},i.prototype.setChar=function(e,r,i){r=r<0?0:r,i||(i=this.descriptors[r]),this.testEscapeChar(e,r,i)?this.resetChar(r):(t.wij.charValidator.isLetter(e)&&(t.wij.charValidator.isUpper(e)?i.caseConversion==="lower"&&(e=e.toLowerCase()):i.caseConversion==="upper"&&(e=e.toUpperCase())),this.testString=t.wij.charValidator.setChar(this.testString,e,r),i.isAssigned||(i.isAssigned=!0,this.assignedCharCount++,i.charType===n.editRequired&&this.requiredCharCount++))},i.prototype.internalInsertAt=function(t,n,r,i){if(t.length===0)return r.testPosition=n,r.hint=r.noEffect,!0;if(!this._testString(t,n,r))return!1;var s=this.findEditPositionFrom(n,!0),o=this.findAssignedEditPositionInRange(s,r.testPosition,!0)!==-1,u=this.findAssignedEditPositionFrom(this.testString.length-1,!1),a,f,l,c,h;if(o&&r.testPosition===this.testString.length-1)return r.hint=r.unavailableEditPosition,r.testPosition=this.testString.length,!1;a=this.findEditPositionFrom(r.testPosition+1,!0);if(o){f=new e.wijInputResult,f.hint=f.unknown,l=!0;while(l){l=!1;if(a===-1)return r.hint=r.unavailableEditPosition,r.testPosition=this.testString.length,!1;c=this.descriptors[s];if(c.isAssigned&&!this.testChar(this.testString.charAt(s),a,f))return r.hint=f.hint,r.testPosition=a,!1;if(s!==u){s=this.findEditPositionFrom(s+1,!0),a=this.findEditPositionFrom(a+1,!0),l=!0;continue}}f.hint>r.hint&&(r.hint=f.hint)}if(!i){if(o)while(s>=n)h=this.descriptors[s],h.isAssigned?this.setChar(this.testString.charAt(s),a):this.resetChar(a),a=this.findEditPositionFrom(a-1,!1),s=this.findEditPositionFrom(s-1,!1);this.setString(t,n)}return!0},i.prototype.insertAt=function(t,n,r){typeof r=="undefined"&&(r=new e.wijInputResult);if(t===undefined)throw"InsertAt: input";return this.noMask?(this.testString=this.testString.substring(0,n)+t+this.testString.substring(n,this.testString.length),r.testPosition=n+t.length-1,!0):n>=0&&n<this.testString.length?this.internalInsertAt(t,n,r,!1):(r.testPosition=n,r.hint=r.positionOutOfRange,!1)},i.prototype.clear=function(e){if(this.noMask){this.testString="",e.hint=e.success;return}if(!this.assignedCharCount)e.hint=e.noEffect;else{e.hint=e.success;for(var t=0;t<this.testString.length;t++)this.resetChar(t)}},i.prototype.isLiteral=function(e){return e?e.charType!==n.literal?e.charType===n.separator:!0:!1},i.prototype.testEscapeChar=function(e,t,n){return t=t<0?0:t,n||(n=this.descriptors[t]),this.isLiteral(n)?this.getSkipLiterals()?e===this.testString.charAt(t):!1:!!this.getResetOnPrompt()&&e===this.getPromtChar()||!!this.getResetOnSpace()&&e===" "?!0:!1},i.prototype.testChar=function(e,n,r){if(!t.wij.charValidator.isPrintableChar(e))return r.hint=r.invalidInput,!1;var i=this.descriptors[n];if(!i)return!1;if(this.isLiteral(i))return this.getSkipLiterals()&&e===this.testString.charAt(n)?(r.hint=r.characterEscaped,!0):(r.hint=r.nonEditPosition,!1);if(e===this.getPromtChar()){if(this.getResetOnPrompt())return this.isEditDesc(i)&&i.isAssigned?r.hint=r.sideEffect:r.hint=r.characterEscaped,!0;if(!this.getAllowPromptAsInput())return r.hint=r.promptCharNotAllowed,!1}if(e===" "&&this.getResetOnSpace())return this.isEditDesc(i)&&i.isAssigned?r.hint=r.sideEffect:r.hint=r.characterEscaped,!0;switch(this.mask.charAt(i.maskPosition)){case"L":if(!t.wij.charValidator.isLetter(e))return r.hint=r.letterExpected,!1;if(!t.wij.charValidator.isAsciiLetter(e)&&this.asciiOnly)return r.hint=r.asciiCharacterExpected,!1;break;case"a":if(!t.wij.charValidator.isAlphanumeric(e)&&e!==" ")return r.hint=r.alphanumericCharacterExpected,!1;if(!t.wij.charValidator.isAciiAlphanumeric(e)&&this.asciiOnly)return r.hint=r.asciiCharacterExpected,!1;break;case"?":if(!t.wij.charValidator.isLetter(e)&&e!==" ")return r.hint=r.letterExpected,!1;if(t.wij.charValidator.isAsciiLetter(e)||!this.asciiOnly)break;return r.hint=r.asciiCharacterExpected,!1;case"A":if(!t.wij.charValidator.isAlphanumeric(e))return r.hint=r.alphanumericCharacterExpected,!1;if(t.wij.charValidator.isAciiAlphanumeric(e)||!this.asciiOnly)break;return r.hint=r.asciiCharacterExpected,!1;case"C":if(!t.wij.charValidator.isAscii(e)&&this.asciiOnly&&e!==" ")return r.hint=r.asciiCharacterExpected,!1;break;case"9":if(!t.wij.charValidator.isDigit(e)&&e!==" ")return r.hint=r.digitExpected,!1;break;case"#":if(!t.wij.charValidator.isDigit(e)&&e!=="-"&&e!=="+"&&e!==" ")return r.hint=r.digitExpected,!1;break;case"&":if(!t.wij.charValidator.isAscii(e)&&this.asciiOnly)return r.hint=r.asciiCharacterExpected,!1;break;case"0":if(!t.wij.charValidator.isDigit(e))return r.hint=r.digitExpected,!1}return e===this.testString.charAt(n)&&i.isAssigned?r.hint=r.noEffect:r.hint=r.success,!0},i.prototype._testString=function(t,n,r){r.hint=r.unknown,r.testPosition=n;if(t.length){var i=new e.wijInputResult,s,o;i.testPosition=r.testPosition,i.hint=r.hint;for(s=0;s<t.length;s++){o=t.charAt(s);if(r.testPosition>this.testString.length)return r.hint=r.unavailableEditPosition,!1;if(!this.testEscapeChar(o,r.testPosition)){r.testPosition=this.findEditPositionFrom(r.testPosition,!0);if(r.testPosition===-1)return r.testPosition=this.testString.length,r.hint=r.unavailableEditPosition,!1}if(!this.testChar(o,r.testPosition,i))return r.hint=i.hint,!1;i.hint>r.hint&&(r.hint=i.hint),r.testPosition+=1;if(r.testPosition===this.testString.length)break}r.testPosition-=1}return!0},i.prototype.set=function(t,n){typeof n=="undefined"&&(n=new e.wijInputResult);if(t===undefined)throw"SetFromPos: input parameter is null or undefined.";n.hint=n.unknown,n.testPosition=0;if(!t.length)return this.clear(n),!0;if(this.noMask)return this.testString=t,!0;if(!this.testSetString(t,n.testPosition,n))return!1;var r=this.findAssignedEditPositionFrom(n.testPosition+1,!0);return r!==-1&&this.resetString(r,this.testString.length-1),!0},i.prototype.resetString=function(e,t){if(this.noMask){this.testString="";return}e=this.findAssignedEditPositionFrom(e,!0);if(e!==-1){t=this.findAssignedEditPositionFrom(t,!1);while(e<=t)e=this.findAssignedEditPositionFrom(e,!0),this.resetChar(e),e++}},i.prototype.setString=function(e,t){var n,r;for(n=0;n<e.length;n++){r=e.charAt(n),this.testEscapeChar(r,t)||(t=this.findEditPositionFrom(t,!0));if(t<0||t>=this.testString.length)return;this.setChar(r,t),t++}},i.prototype.testSetString=function(e,t,n){return e.length>this.testString.length&&(e=e.substring(0,this.testString.length)),this._testString(e,t,n)?(this.setString(e,t),!0):!1},i.prototype.toString=function(e,r,i,s,o){var u=this.inputWidget.options.text||"",a,f,l,c,h,p,d,v,m;u=t.trim(u);if(this.inputWidget.options.showNullText&&!this.inputWidget.isFocused()&&(u===""||u===this.inputWidget.options.nullText))return this.inputWidget.options.nullText;e=e===undefined?!this.isPassword():e,r=r===undefined?this.getHidePromptOnLeave()?this.inputWidget.isFocused():!0:r,i=i===undefined?!0:i;if(this.noMask){if(!e){a="";for(f=0;f<this.testString.length;f++)a+=this.getPasswordChar();return a}return this.testString}s=s===undefined?0:s,o=o===undefined?this.testString.length:o;if(o<=0)return"";s<0&&(s=0);if(s>=this.testString.length)return"";l=this.testString.length-s,o>l&&(o=l);if((!this.isPassword()||e)&&r&&i)return c=this.testString.substring(s,o-s),c;h="",p=s+o-1;for(d=s;d<=p;d++){v=this.testString.charAt(d),m=this.descriptors[d];switch(m.charType){case n.editOptional:case n.editRequired:if(!m.isAssigned)break;if(!this.isPassword()||e){h+=v;continue}h+=this.getPasswordChar();continue;case n.editRequired|n.editOptional:h+=v;continue;case n.separator:case n.literal:if(!i)continue;h+=v;continue;default:h+=v;continue}if(r){h+=v;continue}h+=" ";continue}return h},i.prototype.isEditDesc=function(e){return this.noMask?!0:e.charType!==n.editRequired?e.charType===n.editOptional:!0},i.prototype.isEditPos=function(e){if(this.noMask)return!0;if(e<0||e>=this.testString.length)return!1;var t=this.descriptors[e];return this.isEditDesc(t)},i.prototype.internalRemoveAt=function(t,n,r,i){typeof i=="undefined"&&(i=!1);if(this.noMask){try{this.testString=this.testString.substring(0,t)+this.testString.substring(n+1,this.testString.length),r.testPosition=t}catch(s){}return!0}var o=new e.wijInputResult,u,a,f,l,c,h,p,d,v,m,g=this.findAssignedEditPositionFrom(this.testString.length-1,!1);f=this.findEditPositionInRange(t,n,!0,0),r.hint=r.noEffect;if(f===-1||f>g)return r.testPosition=t,!0;r.testPosition=t,l=n<g,this.findAssignedEditPositionInRange(t,n,!0)!==-1&&(r.hint=r.success);if(l){c=this.findEditPositionFrom(n+1,!0),h=c,t=f,p=!0;while(p){p=!1,u=this.testString.charAt(c),d=this.descriptors[c];if((u!==this.getPromtChar()||d.isAssigned)&&!this.testChar(u,f,o))return r.hint=o.hint,r.testPosition=f,!1;if(c!==g){c=this.findEditPositionFrom(c+1,!0),f=this.findEditPositionFrom(f+1,!0),p=!0;continue}}r.sideEffect>r.hint&&(r.hint=r.sideEffect);if(i)return!0;c=h,f=t,v=!0;while(v){v=!1,a=this.testString.charAt(c),m=this.descriptors[c],a===this.getPromtChar()&&!m.isAssigned?this.resetChar(f):(this.setChar(a,f),this.resetChar(c));if(c!==g){c=this.findEditPositionFrom(c+1,!0),f=this.findEditPositionFrom(f+1,!0),v=!0;continue}}t=f+1}return t<=n&&this.resetString(t,n),!0},i.prototype.removeAt=function(t,n,r){typeof n=="undefined"&&(n=t),typeof r=="undefined"&&(r=new e.wijInputResult);if(n>=this.testString.length)return r.testPosition=n,r.hint=r.positionOutOfRange,!1;if(t>=0&&t<=n){var i=this.internalRemoveAt(t,n,r,!1);return i}return r.testPosition=t,r.hint=r.positionOutOfRange,!1},i}(e.wijTextProvider);e.wijMaskedTextProvider=s;var o=function(){function e(e,t){this.maskPos=e,this.charType=t,this.caseConversion="none",this.isAssigned=!1,this.maskPosition=0,this.maskPosition=e,this.charType=t}return e}();e.wijCharDescriptor=o})(e.input||(e.input={}));var t=e.input})(wijmo||(wijmo={}));;
var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(e){"use strict";var t=jQuery,n=function(n){function r(){n.apply(this,arguments)}return __extends(r,n),r.prototype._createTextProvider=function(){this._textProvider=new i(this,this.options.type),this._textProvider._nullvalue=this.element.val()===""&&this.options.value===null},r.prototype._beginUpdate=function(){var e=this.options;this.element.addClass(e.wijCSS.wijinputnumber),this.element.data({defaultValue:e.value,preValue:e.value}).attr({"aria-valuemin":e.minValue,"aria-valuemax":e.maxValue,"aria-valuenow":e.value||0})},r.prototype._setOption=function(e,t){n.prototype._setOption.call(this,e,t);switch(e){case"minValue":this.element.attr("aria-valuemin",t),this._updateText();break;case"maxValue":this.element.attr("aria-valuemax",t),this._updateText();break;case"value":this.setValue(t),this._updateText();break;case"showGroup":case"decimalPlaces":case"culture":this._textProvider.updateStringFormat(),this._updateText()}},r.prototype._setData=function(e){this.setValue(e)},r.prototype._resetData=function(){var e=this.element.data("defaultValue");if(e===undefined||e===null){e=this.element.data("elementValue");if(e===undefined||e===null&&e==="")e=0}this.setValue(e)},r.prototype._validateData=function(){this._textProvider.checkAndRepairBounds(!0,!1)||this._updateText()},r.prototype._raiseDataChanged=function(){var e=this.options.value,t=this.element.data("preValue");this.element.data("preValue",e),t!==e&&(this.element.attr("aria-valuenow",e),this._trigger("valueChanged",null,{value:e}))},r.prototype.getValue=function(){var e=this._textProvider.getValue();if(e===undefined||e===null)e=this.getText();return e},r.prototype.setValue=function(e,t){typeof t=="undefined"&&(t=!1);try{t=!!t,e===null||typeof e=="undefined"?e=null:typeof e=="boolean"?e=e?"1":"0":typeof e=="string"&&(e=this._textProvider.tryParseValue(e));if(this._textProvider.setValue(e))this._updateText();else if(t){var n="",r;n=this.getText(),this.setText(e),e=e.trim(),r=this.getText().trim(),r!==e&&this.setText(n)}else this.setText(e);return!0}catch(i){return!1}},r.prototype.isValueNull=function(){try{return this._textProvider.isValueNull()}catch(e){return!0}},r.prototype.getPostValue=function(){if(!this._isInitialized())return this.element.val();if(this.options.showNullText&&this.isValueNull())return"0";var e=this.options.value?this.options.value:0;return this.options.type==="percent"&&(e=(e/100).toFixed(10)),e.toString()},r.prototype._updateText=function(e){typeof e=="undefined"&&(e=!1);if(!this._isInitialized())return;this.options.value=this._textProvider.getValue(),n.prototype._updateText.call(this,e),this._textProvider.checkAndRepairBounds(!1,!1)||this._trigger("valueBoundsExceeded")},r.prototype._doSpin=function(n,r){if(!this._allowEdit())return!1;if(r&&this.element.data("breakSpinner"))return!1;var i=this.element.wijtextselection(),s=new e.wijInputResult;return this.element.data("focusNotCalledFirstTime")!==-9&&(new Date).getTime()-this.element.data("focusNotCalledFirstTime")<600&&(this.element.data("focusNotCalledFirstTime",-9),this.element.data("prevCursorPos",0)),this.element.data("prevCursorPos")===-1?this.element.data("prevCursorPos",i.start):i.start=this.element.data("prevCursorPos"),s.testPosition=i.start,this._textProvider[n?"incEnumPart":"decEnumPart"](i.start,s,this.options.increment),this._updateText(),this.element.data("prevCursorPos",s.testPosition),this.selectText(s.testPosition,s.testPosition),r&&!this.element.data("breakSpinner")&&window.setTimeout(t.proxy(function(){this._doSpin(n,!0)},this),this._calcSpinInterval()),!0},r.prototype._deleteSelText=function(e){typeof e=="undefined"&&(e=!1);var t=this.element.wijtextselection(),r=t.start===0&&t.end===this.element.val().length,i;if(t.start===t.end&&!e){i=this._textProvider._stringFormat._currentText;if(i.charAt(t.end)===this._textProvider.getGroupSeparator()||i.charAt(t.end)===this._textProvider.getDecimalSeparator()){t.start++,t.end++,this.element.wijtextselection(t);return}}n.prototype._deleteSelText.call(this,e);if(r||parseFloat(this.element.val())===0)this._textProvider._nullvalue=!0,this._updateText(!0)},r}(e.wijinputcore);e.wijinputnumber=n;var r=function(){function t(){this.wijCSS={wijinputnumber:e.wijinputcore.prototype.options.wijCSS.wijinput+"-numeric"},this.type="numeric",this.value=null,this.minValue=-1e9,this.maxValue=1e9,this.showGroup=!1,this.decimalPlaces=2,this.increment=1,this.valueChanged=null,this.valueBoundsExceeded=null}return t}();n.prototype.options=t.extend(!0,{},e.wijinputcore.prototype.options,new r),t.wijmo.registerWidget("wijinputnumber",n.prototype);var i=function(n){function r(e,t){n.call(this),this._type="numeric",this._stringFormat=null,this._nullvalue=!1,this.inputWidget=e,this._type=t,this._stringFormat=new s(this._type,this.inputWidget.options.decimalPlaces,this.inputWidget.options.showGroup,this._getCulture()),this._stringFormat._setValueFromJSFloat(this.getValue())}return __extends(r,n),r.prototype._getCulture=function(){return this.inputWidget._getCulture()},r.prototype.getDecimalSeparator=function(){return this._getCulture().numberFormat["."]},r.prototype.getGroupSeparator=function(){return this._getCulture().numberFormat[","]},r.prototype.tryParseValue=function(e){return this._stringFormat.tryParseValue(e)},r.prototype.toString=function(){return this.inputWidget.options.showNullText&&!this.inputWidget.isFocused()&&this.isValueNull()?this.inputWidget.options.nullText:this._stringFormat.getFormattedValue()},r.prototype.isValueNull=function(){var e=this.inputWidget.options,t=e.minValue;return null===e.value||undefined===e.value||this._nullvalue},r.prototype.set=function(e,t){return this.clear(),this.insertAt(e,0,t),!0},r.prototype.clear=function(){this._stringFormat.clear()},r.prototype.checkAndRepairBounds=function(e,t){var n=!0,r,i;return typeof e=="undefined"&&(e=!1),r=this.inputWidget.options.minValue,i=this.inputWidget.options.maxValue,typeof t!="undefined"&&t?this._stringFormat.checkMinValue(r,!1,!0):(this._stringFormat.checkMinValue(r,e,!1)||(n=!1),this._stringFormat.checkMaxValue(i,e)||(n=!1),this.inputWidget.options.decimalPlaces>=0&&this._stringFormat.checkDigitsLimits(this.inputWidget.options.decimalPlaces),n)},r.prototype.countSubstring=function(e,t){var n=0,r=e.indexOf(t);while(r!==-1)n++,r=e.indexOf(t,r+1);return n},r.prototype.getAdjustedPositionFromLeft=function(e){var n=this._stringFormat._currentText,r,i;for(r=0;r<n.length;r++){i=n.charAt(r);if(!(!t.wij.charValidator.isDigit(i)&&i!==this.getGroupSeparator()&&i!==this.getDecimalSeparator()||i==="0"))break;this._stringFormat.isZero()?e<r&&e++:e<=r&&e++}return e},r.prototype.getDecimalSeparatorPos=function(){var e=this._stringFormat._currentText;return e.indexOf(this.getDecimalSeparator())},r.prototype.removeLeadingZero=function(e){var t=0;(e.charAt(t)===" "||e.charAt(t)===this._getCulture().numberFormat.currency.symbol)&&t++;while(e.charAt(t)==="0"&&e.charAt(t+1)!==".")e=e.substr(0,t)+e.substr(t+1);return e},r.prototype.insertAt=function(n,r,i){var s=this._getCulture().numberFormat,o,u,a,f,l,c,h,p,d,v;i?this._nullvalue=!1:i=new e.wijInputResult;if(n.length===1){if(n==="+")return this._stringFormat.setPositiveSign(),this.checkAndRepairBounds(!0,!1),!0;if(n==="-"||n===")"||n==="(")return this._stringFormat.invertSign(),this.checkAndRepairBounds(!0,!1),i.testPosition=r,this._stringFormat.isNegative()?i.testPosition=r:i.testPosition=r-2,!0;if(!t.wij.charValidator.isDigit(n)){if(n===this.getDecimalSeparator()){o=this.getDecimalSeparatorPos();if(o>=0)return i.testPosition=o,!0}if(n!==this.getGroupSeparator()&&n!==this.getDecimalSeparator()&&n!==")"&&n!=="+"&&n!=="-"&&n!=="("&&n!==this.getDecimalSeparator())return this._type==="percent"&&n===s.percent.symbol?(i.testPosition=r,!0):this._type==="currency"&&n===s.currency.symbol?(i.testPosition=r,!0):!1}}r=this.getAdjustedPositionFromLeft(r),u=r,a=this._stringFormat._currentText,u>a.length&&(u=a.length-1),f=this.removeLeadingZero(a.substring(0,u)),l=a.substring(u,a.length),this._stringFormat.isZero()&&(l=l.replace(/0/,"")),i.testPosition=f.length+n.length-1,this._stringFormat.deFormatValue(f+n+l),c=this._stringFormat._currentText;try{this.inputWidget.options.showGroup?(h=this.countSubstring(f,this._stringFormat._groupSeparator),p=this.countSubstring(c.substring(0,f.length+n.length),this._stringFormat._groupSeparator),i.testPosition+=p-h):n.length===1&&(d=f.charAt(f.length-1),v=c.charAt(i.testPosition-1),v!==d&&i.testPosition--)}catch(m){}return!0},r.prototype.removeAt=function(t,n,r,i){typeof r=="undefined"&&(r=new e.wijInputResult),typeof i=="undefined"&&(i=!1);var s=this._getCulture().numberFormat,o,u,a,f,l,c;r.testPosition=t;try{o=this._stringFormat._currentText;if(t===n&&o.substring(t,n+1)===this.getDecimalSeparator())return!1;u=o.slice(0,t),a=u,f=o.slice(t,n+1).indexOf(this.getDecimalSeparator())>=0,f&&(a+=this.getDecimalSeparator()),a+=o.slice(n+1),a=a||"0",this._stringFormat.deFormatValue(a),a=this._stringFormat._currentText,this._nullvalue=!1;if(this.inputWidget.options.showGroup)if(f)r.testPosition=a.indexOf(this.getDecimalSeparator());else try{l=this.countSubstring(u,this._stringFormat._groupSeparator),c=this.countSubstring(a.substring(0,Math.max(0,t-1)),this._stringFormat._groupSeparator),r.testPosition-=l-c,(o.indexOf(s.currency.symbol)===r.testPosition||o.indexOf(s.percent.symbol)===r.testPosition)&&r.testPosition++}catch(h){}return!0}catch(p){}return!0},r.prototype.incEnumPart=function(t,n,r){return n||(n=new e.wijInputResult),this._stringFormat.increment(r),this._nullvalue=!1,this.checkAndRepairBounds(!0,!1)},r.prototype.decEnumPart=function(t,n,r){return n||(n=new e.wijInputResult),this._stringFormat.decrement(r),this._nullvalue=!1,this.checkAndRepairBounds(!0,!1)},r.prototype.getValue=function(){return this._stringFormat.getJSFloatValue()},r.prototype.setValue=function(e){try{return e===null?(this._nullvalue=!0,e=0):this._nullvalue=!1,this._stringFormat._setValueFromJSFloat(e),this.checkAndRepairBounds(!0,!1),!0}catch(t){return!1}},r.prototype.updateStringFormat=function(){var e="0";typeof this._stringFormat!="undefined"&&(e=this._stringFormat._currentValueInString),this._stringFormat=new s(this._type,this.inputWidget.options.decimalPlaces,this.inputWidget.options.showGroup,this._getCulture()),this._stringFormat._currentValueInString=e},r}(e.wijTextProvider);e.wijNumberTextProvider=i;var s=function(){function e(e,t,n,r){this.type=e,this.digitsPlaces=t,this.showGroup=n,this.culture=r,this._currentValueInString="0",this._currentText="0",this._groupSeparator=" "}return e.prototype.decimalSeparator=function(){return this.culture.numberFormat["."]},e.prototype.isNegtive=function(e){return e.indexOf("-")!==-1||e.indexOf("(")!==-1},e.prototype.stripValue=function(e){var t=this.culture.numberFormat,n=t[this.type]||t,r=this.isNegtive(e),i=n[","],s=n["."],o=new RegExp("["+i+t.percent.symbol+t.currency.symbol+" ]","g"),u;return this._groupSeparator=i,e=this._removeNegativeSign(e),e=e.replace(o,""),e=e.replace(s,"."),u=/([\d\.])+/.exec(e),u&&(e=u[0]),r&&(e="-"+e),e},e.prototype.tryParseValue=function(e){try{var t=parseFloat(this.stripValue(e));return isNaN(t)&&(t=0),t}catch(n){return 0}},e.prototype.deFormatValue=function(e){e=this.stripValue(e),this._currentValueInString=e,this._currentText=this.formatValue(e)},e.prototype.formatValue=function(e){var t=this.culture.numberFormat,n=t[this.type]||t,r=this.digitsPlaces,i=this.isNegtive(e),s=n.pattern[i?0:1]||"n",o=n[","],u=n["."],a=r!==-2?r:n.decimals,f=this.showGroup?n.groupSizes:[0],l;return e=this._removeLeadingZero(e),l=this.formatDigit(e,o,u,a,f),l=this._removeLeadingZero(l),l.indexOf(u)===0&&(l="0"+l),l===""&&(l="0"),this._currentValueInString=e,this._currentText=this.applyFormatPattern(s,l,t.percent.symbol,t.currency.symbol),this._currentText},e.prototype.getFormattedValue=function(){return this.formatValue(this._currentValueInString)},e.prototype.getJSFloatValue=function(){try{return this._currentValueInString===""?0:parseFloat(this._currentValueInString)}catch(e){return Number.NaN}},e.prototype.clear=function(){this._currentValueInString="0",this._currentText="0"},e.prototype._setValueFromJSFloat=function(e){var t=""+e;try{return this._currentValueInString=t,this.formatValue(t),!0}catch(n){return!1}},e.prototype.isZero=function(e){typeof e=="undefined"&&(e=this._currentValueInString);var t=this._removeNegativeSign(e),n;return t?(n=parseFloat(t),!isNaN(n)&&!n):!0},e.prototype.setPositiveSign=function(){this._currentValueInString=this._removeNegativeSign(this._currentValueInString)},e.prototype._removeNegativeSign=function(e){return e.replace(/[()\-]/g,"")},e.prototype._removeLeadingZero=function(e){return e.replace(/^0+/,"")},e.prototype.isNegative=function(){return this._currentValueInString.indexOf("-")!==-1||this._currentValueInString.indexOf("(")!==-1},e.prototype.invertSign=function(){var e=this.isNegative();e?this.setPositiveSign():this._currentValueInString=this._currentValueInString.length?"-"+this._currentValueInString:"0",this.isZero()&&(this._currentValueInString=e?"0":"-0"),this.formatValue(this._currentValueInString)},e.prototype.parseNumber=function(e){typeof e=="undefined"&&(e=this._currentValueInString);var t=e.split(".",2);return{decimal:parseInt(t[0],10)||0,fraction:(t.length>1?parseInt(t[1],10):0)||0}},e.prototype._change=function(e){var t=this.parseNumber();this._currentValueInString=""+(t.decimal+e)+"."+t.fraction},e.prototype.increment=function(e){typeof e=="undefined"&&(e=1),this._change(e)},e.prototype.decrement=function(e){typeof e=="undefined"&&(e=1),this._change(-e)},e.prototype.checkDigitsLimits=function(e){var t=this._currentValueInString.split("."),n="";if(!t.length||t.length===1&&t[0]==="")return;t.length>1&&(n=t[1]),n=n.substring(0,e);while(n.length<e)n+="0";this._currentValueInString=t[0],n&&(this._currentValueInString+="."+n)},e.prototype.checkMinValue=function(e,t,n){typeof n=="undefined"&&(n=!1);var r=!0,i,s,o,u,a;try{i=this._currentValueInString.split("."),s=parseFloat(i[0]===""||i[0]==="-"?"0":i[0]),o=0,i.length>1&&parseFloat(i[1])>0&&(o=parseFloat("1."+i[1]));if(s<0||i[0]==="-")o*=-1;e=""+e+"",i=e.split("."),u=parseFloat(i[0]),a=0,i.length>1&&parseFloat(i[1])>0&&(a=parseFloat("1."+i[1]));if(s>u)return!0;s<u||n&&s===u&&o<=a?r=!1:s===u&&s<0&&o>a?r=!1:s===u&&s>=0&&o<a&&(r=!1),!r&&t&&(this._currentValueInString=""+e+"")}catch(f){}return r},e.prototype.checkMaxValue=function(e,t){var n=!0,r,i,s,o,u;try{r=this._currentValueInString.split("."),i=parseFloat(r[0]===""||r[0]==="-"?"0":r[0]),s=0,r.length>1&&parseFloat(r[1])>0&&(s=parseFloat("1."+r[1]));if(i<0||r[0]==="-")s*=-1;e=""+e+"",r=e.split("."),o=parseFloat(r[0]),u=0,r.length>1&&parseFloat(r[1])>0&&(u=parseFloat("1."+r[1]));if(i<o)return!0;i>o&&(n=!1),i===o&&i>=0&&s>u&&(n=!1),i===o&&i<0&&s<u&&(n=!1),!n&&t&&(this._currentValueInString=""+e+"")}catch(a){}return n},e.prototype.applyFormatPattern=function(e,t,n,r){return e.replace(/n/g,t).replace(/%/g,n).replace(/\$/g,r)},e.prototype.formatDigit=function(e,t,n,r,i){var s=this._removeNegativeSign(e),o,u,a,f,l,c;o=s.indexOf("."),o===-1&&(o=s.length),u="",a=0,f=0;for(c=s.length-1;c>=0;c--)l=s.charAt(c),c<o&&(u=l+u,f++,f===i[a]*1&&i[a]*1&&c&&(u=t+u,f=0,i.length-1>a&&a++));if(r>0){u+=n;for(c=0;c<r;c++)l="0",c+o+1<s.length&&(l=s.charAt(c+o+1)),u+=l}return r===-1&&o<s.length-1&&(u+=n,u+=s.substr(o+1)),u},e}();e.wijNumberFormat=s})(e.input||(e.input={}));var t=e.input})(wijmo||(wijmo={}));;
var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(t){"use strict";function r(e,t){var r=n.extend(!0,{},e,t);return delete r.constructor,r}var n=jQuery;t.extendWidgetOptions=r;var i=function(r){function i(){r.apply(this,arguments),this._dataOffset=0,this._scrollingState={x:null,y:null,index:0},this._windowResizeTimer=0}return __extends(i,r),i.prototype._createWidget=function(t,n){var i=t&&e.data.util.isClassInstance(t.data)&&!(typeof wijdatasource=="function"&&t.data instanceof wijdatasource)&&t.data;i&&delete t.data,r.prototype._createWidget.apply(this,arguments),i&&(t.data=i,this.option("data",i))},i.prototype._create=function(){var t=this;if(!this.element.is("table"))throw"invalid markup";this._windowResizeTimer=0,this._dataOffset=0,this._scrollingState={x:null,y:null,index:0},this._initialized=!1,this._destroyed=!1,this._rendered=!1,this._eventUID=undefined,this._dataViewWrapper=undefined,this._originalHtml=undefined,this._originalAttr=undefined,this._originalCssText=undefined,this._autoHeight=undefined,this._autoWidth=undefined,this._renderCounter=0,this.$superPanelHeader=undefined,this.$topPagerDiv=undefined,this.$bottomPagerDiv=undefined,this.$groupArea=undefined,this.__uid=undefined,this._wijDataView=undefined,this.outerDiv=undefined,this.sketchTable=undefined,this.cellFormatter=undefined,this.rowStyleFormatter=undefined,this.cellStyleFormatter=undefined,this._eventUID=e.grid.getUID(),this._spinnerIsActivated=!1,this.deficientFilters={};var r="data"in this.options,i=r&&this.options.data;r&&delete this.options.data,this.options=n.extend(!0,{},this.options),r&&(this.options.data=i),window.wijmoApplyWijTouchUtilEvents&&(n=window.wijmoApplyWijTouchUtilEvents(n)),n.isFunction(window.wijmoASPNetParseOptions)&&window.wijmoASPNetParseOptions(this.options),this._initialized=!1,this._destroyed=!1,this._closestCulture=Globalize.findClosestCulture(this.options.culture)||Globalize.findClosestCulture("default"),this._dataViewWrapper=new e.grid.dataViewWrapper(this),this._originalHtml=this.element.html(),this._originalAttr={},this._originalCssText=this.element[0].style.cssText,this.element.addClass("wijmo-wijgrid-root"),this.element.wrap('<div class="'+this.options.wijCSS.widget+" wijmo-wijgrid "+this.options.wijCSS.content+" "+this.options.wijCSS.cornerAll+'"></div>'),this.outerDiv=this.element.parent();var s=this.element[0].style.height,o=this.element[0].style.width;s&&this.outerDiv.css("height",s),this._autoHeight=s==""||s=="auto",o&&this.outerDiv.css("width",this.element[0].style.width),this._autoWidth=o==""||o=="auto",this.element.css({height:"",width:""}),this.options.disabled&&this.disable(),this.cellFormatter=new e.grid.cellFormatterHelper,this.rowStyleFormatter=new e.grid.rowStyleFormatterHelper(this),this.cellStyleFormatter=new e.grid.cellStyleFormatterHelper(this),this._viewPortBounds({start:0,end:0}),this._allowVirtualScrolling()&&(this._viewPortBounds().start=this._scrollingState.index,this._serverSideVirtualScrolling()&&(this._dataOffset=this._scrollingState.index)),this.element.wijAddVisibilityObserver&&this.element.wijAddVisibilityObserver(function(){t._initialized&&!t._destroyed&&t.setSize()},"wijgrid"),this._renderCounter=0},i.prototype._destroy=function(){var t,r=this;try{this._view().dispose(),this._detachEvents(!0),this._resizerui&&(this._resizerui.dispose(),this._resizerui=null),this._frozenerui&&(this._frozenerui.dispose(),this._frozenerui=null),this._selectionui&&(this._selectionui.dispose(),this._selectionui=null),this._dragndropui&&(this._dragndropui.dispose(),this._dragndropui=null),this._dataViewWrapper.dispose(),e.grid.remove$dataByPrefix(this.element,this._data$prefix),this.element.wijRemoveVisibilityObserver&&this.element.wijRemoveVisibilityObserver(),this.element.insertBefore(this.outerDiv),this.outerDiv.remove(),this.element.html(this._originalHtml),n.each(this._originalAttr,function(e,t){t===undefined?r.element.removeAttr(e):r.element.attr(e,t)}),this.element.removeClass("wijmo-wijgrid-root"),this.element[0].style.cssText=this._originalCssText}finally{this._destroyed=!0}},i.prototype._init=function(){this.$superPanelHeader=null,this.$topPagerDiv=null,this.$bottomPagerDiv=null,this.$groupArea=null,this._prevHoveredSketchRowIndex=-1,this._closestCulture=Globalize.findClosestCulture(this.options.culture)||Globalize.findClosestCulture("default"),this.options.data||(this._field("thead")||this._field("thead",e.grid.readTableSection(this.element,1)),this._field("tfoot")||this._field("tfoot",e.grid.readTableSection(this.element,3))),this._initialized=this._initialized||!1,this.ensureControl(!0)},i.prototype._setOption=function(e,t){var n=this["_preset_"+e],i=this.options[e],s,o;n!==undefined&&(t=n.apply(this,[t,i])),s=t!==i,r.prototype._setOption.apply(this,[e,t]),s&&(o=this["_postset_"+e],o!==undefined&&o.apply(this,[t,i]))},i.prototype.columns=function(){return this._field("columns")||[]},i.prototype.currentCell=function(n,r,i){var s,o=this._view(),u=this._rows();if(arguments.length===0)return s=this._field("currentCell"),s||this._field("currentCell",s=e.grid.cellInfo.outsideValue),s;s=typeof n!="number"?n._clone():new e.grid.cellInfo(n,r);if(!s.isEqual(e.grid.cellInfo.outsideValue)){if(!s._isValid())throw"invalid arguments";s._clip(this._getDataCellsRange(t.dataRowsRangeMode.sketch));if(s.rowIndex()>=0&&!(o._getRowInfoBySketchRowIndex(s.rowIndex()).type&e.grid.rowType.data))return}return s._setGridView(this),this._changeCurrentCell(null,s,{changeSelection:i||!1,setFocus:!1}),this._field("currentCell")},i.prototype.data=function(){return this._dataViewWrapper.dataView().getSource()},i.prototype.dataView=function(){return this._dataViewWrapper.dataView()},i.prototype.doRefresh=function(t){n.isPlainObject(t)||(t={});var r,i=this,s=e.grid.EXPANDO,o=t&&t.virtualScrollData;if(!this._initialized)try{this._prepareColumnOptions(this.options.columns,this.options.columnsAutogenerationMode,this._dataViewWrapper.getFieldsInfo(),!0,!0)}catch(u){throw u}finally{this._ownerise(!0),this._initialized=!0}if(!o){this._rebuildLeaves();var a=this._dataViewWrapper.data(),f=this._dataViewWrapper.dataView();n.each(this._field("leaves"),function(){this._totalsValue=a.totals?a.totals[this.dataKey]:undefined}),this.sketchTable=[],a.data&&a.data.length?(r=this._field("leaves"),n.each(a.data,function(e,t){i.sketchTable.push(i._buildSketchRow(t,r))})):a.emptyData&&(r=this._field("visibleLeaves"),n.each(a.emptyData,function(e,t){i.sketchTable.push(i._buildSketchRowEmptyDataItem(t,r,e===a.emptyData.length-1))}))}this._onRendering(t),o?this._refreshVirtual(t):this._refresh(t),t&&n.isFunction(t.beforeOnRendered)&&t.beforeOnRendered.apply(this,[t]),this._onRendered(t),t&&n.isFunction(t.afterRefresh)&&t.afterRefresh.apply(this,[t])},i.prototype.beginEdit=function(){return this._beginEditInternal(null)},i.prototype.endEdit=function(){return this._endEditInternal(null)},i.prototype.ensureControl=function(t,r){this._loading(),n.isPlainObject(r)||(r={data:null,afterRefresh:null,beforeRefresh:null}),r._wijgridMarker=!0,this._initialized?(!r||!r.virtualScrollData)&&this._convertWidgetsToOptions():(this._prepareColumnOptions(this.options.columns,this.options.columnsAutogenerationMode,this._dataViewWrapper.isDataLoaded()&&this._dataViewWrapper.getFieldsInfo(),this._dataViewWrapper.isDataLoaded(),!1),this._dataViewWrapper.isOwnDataView()||(new e.grid.settingsManager(this)).MapDVToWG()),this._ownerise(!0),this._initialized&&r&&n.isFunction(r.beforeRefresh)&&r.beforeRefresh.apply(this),this.mAllowVirtualScrolling=undefined,t===!0?this._dataViewWrapper.load(r):(this.doRefresh(r),this._loaded())},i.prototype.getCellInfo=function(e){var t=null;return e&&(e=this._findUntilOuterDiv(e,{td:!0,th:!0}))&&(t=this._view().getAbsoluteCellInfo(e,!1)),t},i.prototype.getFilterOperatorsByDataType=function(t){return(new e.grid.filterOperatorsCache(this)).getByDataType(t||"string")},i.prototype.pageCount=function(){return this._customPagingEnabled()?Math.ceil(this.options.totalRows/this.options.pageSize)||1:this.options.allowPaging?this._dataViewWrapper.dataView().pageCount():1},i.prototype._serverShaping=function(){return!1},i.prototype._pageIndexForDataView=function(){return this.options.pageIndex},i.prototype.setSize=function(e,t){var r=this._view(),i={type:"",hScrollValue:null,vScrollValue:null},s=this.outerDiv,o=this._field("visibleLeaves"),u=[];r&&r.getScrollValue&&(i=r.getScrollValue());if(e||e===0)this._autoWidth=!1,s.width(e);if(t||t===0)this._autoHeight=!1,s.height(t);n.each(o,function(e,t){var i=r.getHeaderCell(e),s=r.getJoinedCols(e);n(i).css("width",""),n.each(s,function(e,t){n(t).css("width","")})}),this._view().updateSplits(i);var a=this._UIFrozener();a&&a.refresh()},i.prototype.selection=function(){var t=this._field("selection");return t||this._field("selection",t=new e.grid.selection(this)),t},i.prototype._onDataViewCurrentPositionChanged=function(e,t){var n=this._currentCellFromDataView(this.currentCell().cellIndex()),r=this.selection();n=this.currentCell(n,null,!0)},i.prototype._resetDataProperties=function(){this.options.pageIndex=0;var e=this._viewPortBounds();e.start=e.end=0},i.prototype._onDataViewLoading=function(){this._activateSpinner(),this._trigger("dataLoading")},i.prototype._onDataViewReset=function(t){(new e.grid.settingsManager(this)).MapDVToWG(),this._trigger("dataLoaded"),this.doRefresh(t),this._loaded()},i.prototype._onDataViewLoaded=function(){},i.prototype._loading=function(){this._activateSpinner(),this._trigger("loading")},i.prototype._loaded=function(){this._deactivateSpinner(),this._trigger("loaded")},i.prototype._buildSketchRow=function(t,n){var r,i,s,o,u,a,f=[],l=e.data.Expando.getFrom(t.values,!1),c=l?l[e.grid.EXPANDO]:null;for(r=0,i=n.length;r<i;r++)s=n[r],e.grid.validDataKey(s.dataKey)&&(o=c&&c.cellsAttributes?c.cellsAttributes[s.dataKey]:{},u=this._dataViewWrapper.getValue(t.values,s.dataKey),f.push({value:this.parse(s,u),__attr:o||{},__style:{}}));return f.originalRowIndex=t.originalRowIndex,f.rowType=e.grid.rowType.data,t.originalRowIndex%2!==0&&(f.rowType|=e.grid.rowType.dataAlt),f.__style={},f.__attr=c&&c.rowAttributes?c.rowAttributes:{},f},i.prototype._buildSketchRowEmptyDataItem=function(t,n,r){var i,s,o=[],u=n.length;for(i=0,s=t.length;i<s;i++)o.push({html:t[i],__attr:{colSpan:u>0&&r?u:1},__style:{}});return o.rowType=e.grid.rowType.emptyDataRow,o.__style={},o.__attr={},o},i.prototype._prepareColumnOptions=function(r,i,s,o,u){e.grid.traverse(r,function(e){e.isBand=n.isArray(e.columns)||e.clientType==="c1band",e._originalDataKey=e.dataKey,e._originalHeaderText=e.headerText}),(new e.grid.bandProcessor).getVisibleHeight(r,!0);var a=[],f=this._originalHeaderRowData(),l=this._originalFooterRowData(),c=(i||"").toLowerCase(),h=this;o&&e.grid.columnsGenerator.generate(c,s,r),e.grid.setTraverseIndex(r),e.grid.traverse(r,function(r){r.isBand=n.isArray(r.columns)||r.clientType==="c1band",e.grid.shallowMerge(r,t.c1basefield.prototype.options),r.isBand?r.clientType="c1band":(e.grid.shallowMerge(r,t.c1field.prototype.options),r.groupInfo=r.groupInfo||{},e.grid.shallowMerge(r.groupInfo,t.c1field.prototype.options.groupInfo),r.clientType||(r.clientType="c1field")),r.isLeaf&&!r.isBand&&a.push(r)}),this._field("leaves",a),o&&n.each(a,n.proxy(function(t,r){var i=typeof r.dataKey=="number"?r.dataKey:t;(c==="merge"||r.dynamic===!0)&&r.headerText===undefined&&(h._dataViewWrapper&&h._dataViewWrapper.isBoundedToDOM()&&f&&i<f.length?r.headerText=n.trim(f[i]):e.grid.validDataKey(r.dataKey)&&(r.headerText=""+r.dataKey)),h._dataViewWrapper&&h._dataViewWrapper.isBoundedToDOM()&&l&&i<l.length&&(r._footerTextDOM=n.trim(l[i]))},this))},i.prototype._rebuildLeaves=function(){var t=[],r=[],i;this._showRowHeader()&&(i=e.grid.createDynamicField({clientType:"c1basefield",dataIndex:-1,travIdx:-1,parentVis:!0,allowMoving:!1,allowSizing:!1,allowSort:!1,isRowHeader:!0}),i.owner=this,t.push(i)),n.each(this.options.columns,function(e,n){t.push(n)}),this._columnsHeadersTable((new e.grid.bandProcessor).generateSpanTable(t,r)),this._field("leaves",r),this._onLeavesCreated()},i.prototype._onLeavesCreated=function(){var t=this._field("leaves"),r=this._dataViewWrapper.getFieldsInfo(),i,s=0,o=0,u=this;this._field("visibleLeaves",n.grep(t,function(t,u){return t.leavesIdx=u,e.grid.validDataKey(t.dataKey)?t.dataIndex=s++:t.dataIndex=-1,t.isBand||(i=r[t.dataKey],i&&(t._underlyingDataType=i.type,t._underlyingDataFormatString=i.format),n.isFunction(t.dataParser)&&(t.dataParser=new t.dataParser)),t.parentVis?(t.visLeavesIdx=o++,!0):!1}))},i.prototype._allowVirtualScrolling=function(){return this.mAllowVirtualScrolling===undefined&&(this.mAllowVirtualScrolling=!this.options.allowPaging&&this.options.allowVirtualScrolling&&this.options.staticRowIndex<0&&this.options.scrollMode!=="none"&&!this._hasMerging()),this.mAllowVirtualScrolling},i.prototype._headerRows=function(){return this._view().headerRows()},i.prototype._filterRow=function(){return this._view().filterRow()},i.prototype._rows=function(){return this._view().bodyRows()},i.prototype._localizeFilterOperators=function(t){var r=this,i=new e.grid.filterOperatorsCache(this);n.each(t,function(e,t){if(t.name){var n=i.getByName(t.name);n&&(n.displayName=t.displayName)}})},i.prototype._UIDragndrop=function(t){return!this._dragndropui&&t&&(this._dragndropui=new e.grid.uiDragndrop(this)),this._dragndropui},i.prototype._UIFrozener=function(t){return!this._frozenerui&&t&&(this._frozenerui=new e.grid.uiFrozener(this)),this._frozenerui},i.prototype._UIResizer=function(t){return!this._resizerui&&t&&(this._resizerui=new e.grid.uiResizer(this)),this._resizerui},i.prototype._UISelection=function(t){return!this._selectionui&&t&&(this._selectionui=new e.grid.uiSelection(this)),this._selectionui},i.prototype._postset_allowColMoving=function(e,t){var r=this;n.each(this.columns(),function(t,n){e?r._UIDragndrop(!0).attach(n):r._UIDragndrop(!0).detach(n)});var i=this._field("groupedWidgets");i&&n.each(i,function(t,n){e?r._UIDragndrop(!0).attach(n):r._UIDragndrop(!0).detach(n)})},i.prototype._postset_allowSorting=function(e,t){this.ensureControl(!1)},i.prototype._postset_columns=function(e,t){this._initialized=!1,this.ensureControl(!0)},i.prototype._postset_allowPaging=function(e,t){this.ensureControl(!0)},i.prototype._postset_freezingMode=function(e,t){this._frozenerui&&this._frozenerui.refresh()},i.prototype._postset_culture=function(e,t){throw"read-only"},i.prototype._postset_customFilterOperators=function(e,t){var n=this._dataViewWrapper.dataView()},i.prototype._postset_data=function(t,r){this._ownerise(!1),e.grid.traverse(this.options.columns,function(e,t){if(e.dynamic){var r=n.inArray(e,t);r>=0&&t.splice(r,1)}else e.dataKey=e._originalDataKey,e.headerText=e._originalHeaderText}),this._initialized=!1,this._dataViewWrapper&&this._dataViewWrapper.dispose(),this._dataViewWrapper=new e.grid.dataViewWrapper(this),this.ensureControl(!0)},i.prototype._postset_disabled=function(t,n){var r=this,i=this._view();e.grid.iterateChildrenWidgets(this.outerDiv,function(e,n){n!==r&&n.option("disabled",t)}),i&&i.ensureDisabledState()},i.prototype._postset_groupIndent=function(e,t){this.ensureControl(!1)},i.prototype._postset_groupAreaCaption=function(e,t){var n=this._groupedColumns();this.$groupArea&&(!n||!n.length)&&this.$groupArea.html(e||"&nbsp;")},i.prototype._postset_highlightCurrentCell=function(e,t){var n=this.currentCell();n&&n._isValid()&&this._highlightCellPosition(n,e)},i.prototype._preset_pageIndex=function(e,t){if(isNaN(e))throw"out of range";var n=this.pageCount(),r=function(e){return e>n-1&&(e=n-1),e<0&&(e=0),e},i;return e=r(e),this.options.allowPaging&&e!==t&&(i={newPageIndex:e},this._onPageIndexChanging(i)?e=r(i.newPageIndex):e=t),e},i.prototype._postset_pageIndex=function(e,t){if(this.options.allowPaging){var n={newPageIndex:e};this._customPagingEnabled()?(this._convertWidgetsToOptions(),this._onPageIndexChanged(n)):this.ensureControl(!0,{afterRefresh:function(){this._onPageIndexChanged(n)}})}},i.prototype._preset_pageSize=function(e,t){if(isNaN(e))throw"out of range";return e<=0&&(e=1),e},i.prototype._postset_pageSize=function(e,t){this._resetDataProperties(),this.options.allowPaging&&!this._customPagingEnabled()&&this.ensureControl(!0)},i.prototype._postset_pagerSettings=function(e,t){this.ensureControl(!1)},i.prototype._postset_scrollMode=function(e,t){this.ensureControl(!1)},i.prototype._postset_selectionMode=function(t,n){var r=this.selection(),i=this.currentCell(),s=this.selection().selectedCells().length();r.beginUpdate(),r.clear(),i&&i._isValid()&&s&&r._selectRange(new e.grid.cellInfoRange(i,i),!1,!1,e.grid.cellRangeExtendMode.none,null),r.endUpdate(),this._view().toggleDOMSelection(t==="none")},i.prototype._postset_showFilter=function(e,t){this.ensureControl(!1)},i.prototype._postset_showGroupArea=function(e,t){this.ensureControl(!1)},i.prototype._postset_showRowHeader=function(e,t){this.ensureControl(!1)},i.prototype._postset_staticRowIndex=function(){this.options.scrollMode!=="none"&&this.ensureControl(!1)},i.prototype._postset_staticColumnIndex=function(){this.options.scrollMode!=="none"&&this.ensureControl(!1)},i.prototype._postset_allowVirtualScrolling=function(e,t){this.ensureControl(!1)},i.prototype._preset_allowVirtualScrolling=function(e,t){if(isNaN(e)||e<0)throw"out of range";return e},i.prototype._activateSpinner=function(){if(!this._spinnerIsActivated){var e=this.options.wijCSS,t=this.outerDiv.append('<div class="wijmo-wijgrid-overlay '+e.overlay+'"></div>'+'<span class="wijmo-wijgrid-loadingtext '+e.content+" "+e.cornerAll+'">'+'<span class="'+e.icon+' ui-icon-clock"></span>'+this.options.loadingText+"</span>").find("> .wijmo-wijgrid-loadingtext");t.position({my:"center",at:"center center",of:this.outerDiv,collision:"none"}),this._spinnerIsActivated=!0}},i.prototype._customPagingEnabled=function(){return this.options.allowPaging&&this.options.totalRows>=0},i.prototype._deactivateSpinner=function(){if(this._spinnerIsActivated)try{this.outerDiv.find("> .wijmo-wijgrid-overlay, > .wijmo-wijgrid-loadingtext").remove()}finally{this._spinnerIsActivated=!1}},i.prototype._columnWidgetsFactory=function(e,t){var r,i=t.clientType;!i&&t.isBand&&(i="c1band"),t=n.extend({},t,{disabled:this.options.disabled});try{n.data(e[0],"wijgridowner",this);switch(i){case"c1basefield":r=e.c1basefield(t);break;case"c1band":r=e.c1band(t);break;default:r=e.c1field(t)}}finally{n.removeData(e[0],"wijgridowner")}return r},i.prototype._convertWidgetsToOptions=function(){this._initialized&&this._mergeWidgetsWithOptions&&(this._ownerise(!1),this._widgetsToOptions(),this._ownerise(!0))},i.prototype._field=function(t,n){return e.grid.dataPrefix(this.element,this._data$prefix,t,n)},i.prototype._removeField=function(e){var t=this._data$prefix+e;this.element.removeData(t)},i.prototype._prepareTotalsRequest=function(t){var r=this._field("leaves"),i,s;return!r||!this.options.showFooter?[]:(i=n.map(r,function(n,r){return!n.isBand&&e.grid.validDataKey(n.dataKey)&&n.aggregate&&n.aggregate!=="none"?t?[{column:n,aggregate:n.aggregate}]:[{dataKey:n.dataKey,aggregate:n.aggregate}]:null}),i)},i.prototype._widgetsToOptions=function(){var t=e.grid.flatten(this.options.columns);n.each(this.columns(),function(e,r){delete r.options.columns;var i=t[r.options.travIdx];n.extend(!0,i,r.options),i.filterValue=r.options.filterValue,i.filterOperator=r.options.filterOperator})},i.prototype._recreateColumnWidgets=function(){n.each(this.columns(),function(e,t){t.destroy()});var t=[],r=this._headerRows(),i,s,o,u,a,f,l;if(r&&r.length()){i=[],e.grid.traverse(this.options.columns,function(e){e.parentVis&&i.push(e)});for(s=0,o=i.length;s<o;s++)u=i[s],a=r.item(u.thY),f=e.grid.rowAccessor.getCell(a,u.thX),l=this._columnWidgetsFactory(n(f),u),t.push(l.data(e.grid.widgetName(l)))}this._field("columns",t)},i.prototype._groupedColumns=function(e){var t;e=!(t=this._field("groupedColumns"))||e;if(e){t=[];var r=this._field("leaves")||[],i=!1,s=function(e){return e.groupInfo&&e.groupInfo.position&&e.groupInfo.position!=="none"};n.each(r,function(e,n){s(n)?(i=i||n.groupedIndex===undefined,i||t.push(n)):delete n.groupedIndex}),i?n.each(r,function(e,n){s(n)&&(n.groupedIndex=t.length,t.push(n))}):(t.sort(function(e,t){return e.groupedIndex-t.groupedIndex}),n.each(t,function(e,t){t.groupedIndex=e})),this._field("groupedColumns",t)}return t||[]},i.prototype._ownerise=function(t){if(t){var n=this;e.grid.traverse(this.options.columns,function(e){e.owner=n;var t,r,i;if(t=e.groupInfo){t.owner=e;if(t.expandInfo)for(r=0,i=t.expandInfo.length;r<i;r++)t.expandInfo[r].owner=t}})}else e.grid.traverse(this.options.columns,function(e){delete e.owner;var t,n,r;if(t=e.groupInfo){delete t.owner;if(t.expandInfo)for(n=0,r=t.expandInfo.length;n<r;n++)delete t.expandInfo[n].owner}})},i.prototype._ensureVisibleRowsBounds=function(t){return e.grid.ensureBounds(t,this._renderableRowsCount())},i.prototype._ensureSketchTableBounds=function(t){return e.grid.ensureBounds(t,this._totalRowsCount())},i.prototype._ensureViewPortBoundsVisible=function(e){var t=this._renderableRowsCount();return e.end>=t&&(e.start-=e.end-t,e.end=t-1),e},i.prototype._renderableBoundsCollection=function(){return this.mRenderableBoundsCollection},i.prototype._rebuildRenderBoundsCollection=function(){var t=-1,n=-1,r=!1;this.mRenderableBoundsCollection=new e.grid.renderBoundsCollection(this.sketchTable.length);if(!this._allowVirtualScrolling())this.mRenderableBoundsCollection.add({start:0,end:this.sketchTable.length-1});else{for(var i=0;i<this.sketchTable.length;i++){var s=this.sketchTable[i];s.__style&&s.__style.display==="none"?(t>=0&&(this.mRenderableBoundsCollection.add({start:t,end:n}),r=!1),t=n=-1):t<0?(r=!0,t=n=i):n++}r&&this.mRenderableBoundsCollection.add({start:t,end:n})}},i.prototype._refresh=function(t){(new e.grid.grouper).group(this,this.sketchTable,this._field("leaves")),(new e.grid.merger).merge(this.sketchTable,this._field("visibleLeaves")),this._rebuildRenderBoundsCollection(),this.options.scrollMode!=="none"?this.mView=new e.grid.fixedView(this,this._viewPortBounds()):this.mView=new e.grid.flatView(this,this._viewPortBounds()),this._render(),this._ownerise(!1),this._recreateColumnWidgets(),this._ownerise(!0),this.options.allowPaging&&(this.$topPagerDiv&&this.$topPagerDiv.wijpager(this._pagerSettings2PagerWidgetSettings()).css("zIndex",5),this.$bottomPagerDiv&&this.$bottomPagerDiv.wijpager(this._pagerSettings2PagerWidgetSettings()).css("zIndex",5))},i.prototype._refreshVirtual=function(e){var t=e.virtualScrollData,n={top:0,bottom:0};t.data&&(n=this._processVirtualData(t)),this._updateRowInfos(t,n),this._renderVirtualIntoView(t)},i.prototype._updateRowInfos=function(e,t){var n=this._viewPortBounds(),r=this._view(),i=e.newBounds,s=this._view().bodyRows(),o,u,a,f;switch(e.mode){case"reset":break;case"overlapBottom":o={start:i.start-n.start,end:n.end-n.start},a=i.start-n.start;for(u=o.start;u<=o.end;u++)f=r._getRowInfo(s.item(u),!1),f.sectionRowIndex-=a,f.dataItemIndex+=t.top,r._setRowInfo(f.$rows,f);break;case"overlapTop":o={start:n.start-n.start,end:i.end-n.start},a=n.start-i.start;for(u=o.start;u<=o.end;u++)f=r._getRowInfo(s.item(u),!1),f.sectionRowIndex+=a,f.dataItemIndex+=t.top,r._setRowInfo(f.$rows,f)}},i.prototype._renderVirtualIntoView=function(t){var n=this._viewPortBounds(),r=this._view(),i=function(t){return t.rowType&e.grid.rowType.data?t.originalRowIndex:-1},s,o,u,a;switch(t.mode){case"reset":r._clearBody();var f=t.newBounds.end-t.newBounds.start+1,l=this;this._renderableBoundsCollection().forEachIndex2(t.newBounds.start,f,function(e){u=l.sketchTable[e-l._dataOffset],r._insertBodyRow(u,-1,i(u),e)}),r._rebuildOffsets();break;case"overlapBottom":s={start:t.newBounds.start,end:n.end};for(o=0;o<s.start-n.start;o++)r._removeBodyRow(0,!1);for(o=s.end+1;o<=t.newBounds.end;o++)u=this.sketchTable[o-this._dataOffset],r._insertBodyRow(u,-1,i(u),o);break;case"overlapTop":s={start:n.start,end:t.newBounds.end};for(o=0;o<n.end-t.newBounds.end;o++)r._removeBodyRow(s.end-s.start+1,!1);a=0;for(o=t.newBounds.start;o<n.start;o++)u=this.sketchTable[o-this._dataOffset],r._insertBodyRow(u,a++,i(u),o);break;default:}},i.prototype._processVirtualData=function(e){var t=this._dataViewWrapper,n=t.dataView().getSource(),r,i=this._field("leaves"),s,o,u,a=0,f={top:0,bottom:0},l,c=this._serverSideVirtualScrollingMargin();switch(e.mode){case"reset":this.sketchTable.splice(0,this.sketchTable.length),t._unsafeSplice(0,n.length),this._dataOffset=e.request.index;for(s=0;s<e.data.length;s++)t._unsafePush(r=e.data[s]),this.sketchTable.push(this._buildSketchRow(t._wrapDataItem(r,s),i));break;case"overlapBottom":for(s=0;s<e.data.length;s++)t._unsafePush(r=e.data[s]),this.sketchTable.push(this._buildSketchRow(t._wrapDataItem(r,n.length-1),i));f.bottom=e.data.length;break;case"overlapTop":for(s=e.data.length-1;s>=0;s--)t._unsafeSplice(0,0,r=e.data[s]),this.sketchTable.splice(0,0,this._buildSketchRow(t._wrapDataItem(r,s),i));this._dataOffset=e.request.index,f.top=e.data.length}o=this._ensureSketchTableBounds({start:e.newBounds.start,end:e.newBounds.end}),u={start:this._dataOffset,end:this._dataOffset+n.length-1},a=u.end-o.end-c,a>0&&(f.bottom-=a,t._unsafeSplice(n.length-a,a),this.sketchTable.splice(this.sketchTable.length-a,a)),a=o.start-u.start-c,a>0&&(f.top-=a,t._unsafeSplice(0,a),this.sketchTable.splice(0,a),this._dataOffset+=a);for(s=0;s<this.sketchTable.length;s++)this.sketchTable[s].originalRowIndex=s;return t._refreshSilent(),f},i.prototype._needToCreatePagerItem=function(){return this.options.allowPaging===!0},i.prototype._isMobileEnv=function(){return this._isMobile},i.prototype._render=function(){var e=this._view(),t=this.options,r=this.options.wijCSS,i;e.render(),i=this.outerDiv,t.scrollMode!=="none"&&(i=this.outerDiv.find("div.wijmo-wijgrid-scroller:first")),this.$superPanelHeader=null,this.$topPagerDiv&&(this.$topPagerDiv.data("wijmo-wijpager")&&this.$topPagerDiv.wijpager("destroy"),this.$topPagerDiv.remove()),this.$topPagerDiv=null,this._needToCreatePagerItem()&&(t.pagerSettings.position==="top"||t.pagerSettings.position==="topAndBottom")&&(this.$topPagerDiv||(i.prepend(this.$superPanelHeader=n('<div class="wijmo-wijsuperpanel-header"></div>')),this.$superPanelHeader.prepend(this.$topPagerDiv=n('<div class="wijmo-wijgrid-header '+r.header+" "+r.cornerTop+'"></div>')))),t.showGroupArea?this._processGroupArea(i):this.$groupArea=null,this.$bottomPagerDiv&&(this.$bottomPagerDiv.data("wijmo-wijpager")&&this.$bottomPagerDiv.wijpager("destroy"),this.$bottomPagerDiv.remove()),this.$bottomPagerDiv=null,this._needToCreatePagerItem()&&(t.pagerSettings.position==="bottom"||t.pagerSettings.position==="topAndBottom")&&(this.$bottomPagerDiv||i.append(this.$bottomPagerDiv=n('<div class="wijmo-wijgrid-footer wijmo-wijsuperpanel-footer '+r.stateDefault+" "+r.cornerBottom+'"></div>')))},i.prototype._processGroupArea=function(e){var t=this,r=this._groupedColumns(),i=[];this.$groupArea=n('<div class="'+this.options.wijCSS.content+" "+this.options.wijCSS.helperClearFix+'"></div>'),r.length>0?n.each(r,function(e,r){var s=n('<a href="#"></a>').appendTo(t.$groupArea);try{n.data(s[0],"wijgridowner",t),s.c1groupedfield(n.extend({},{allowMoving:r.allowMoving,allowSort:r.allowSort,dataIndex:r.dataIndex,headerText:r.headerText,isBand:r.isBand,isLeaf:r.isLeaf,linearIdx:r.linearIdx,parentIdx:r.parentIdx,sortDirection:r.sortDirection,travIdx:r.travIdx,groupedIndex:r.groupedIndex},{disabled:t.options.disabled}))}finally{n.removeData(s[0],"wijgridowner")}i.push(s.data("wijmo-c1groupedfield"))}):this.$groupArea.addClass("wijmo-wijgrid-group-area").css("padding",0).html(this.options.groupAreaCaption||"&nbsp;"),this._field("groupedWidgets",i),this.$superPanelHeader||e.prepend(this.$superPanelHeader=n('<div class="wijmo-wijsuperpanel-header"></div>')),this.$superPanelHeader.prepend(this.$groupArea),this._UIDragndrop(!0).attachGroupArea(this.$groupArea)},i.prototype._pagerSettings2PagerWidgetSettings=function(){return n.extend({},this.options.pagerSettings,{disabled:this.options.disabled,pageCount:this.pageCount(),pageIndex:this.options.pageIndex,pageIndexChanging:n.proxy(this._onPagerWidgetPageIndexChanging,this),pageIndexChanged:n.proxy(this._onPagerWidgetPageIndexChanged,this)})},i.prototype._showRowHeader=function(){return this.options.showRowHeader===!0&&this.options.staticColumnsAlignment!=="right"},i.prototype._attachEvents=function(){var e=this._view(),t=e.focusableElement(),r=this;t.bind("keydown."+this.widgetName,n.proxy(this._onKeyDown,this)),t.bind("keypress."+this.widgetName,n.proxy(this._onKeyPress,this)),n.each(e.subTables(),function(e,t){var i=t.element();i&&(i.tHead&&n(i.tHead).bind("click."+r.widgetName,n.proxy(r._onClick,r)),i.tBodies.length&&n(i.tBodies[0]).bind("click."+r.widgetName,n.proxy(r._onClick,r)).bind("dblclick."+r.widgetName,n.proxy(r._onDblClick,r)).bind("mousemove."+r.widgetName,n.proxy(r._onMouseMove,r)).bind("mouseout."+r.widgetName,n.proxy(r._onMouseOut,r)))}),n(window).bind("resize."+this.widgetName+"."+this._eventUID,n.proxy(this._onWindowResize,this))},i.prototype._detachEvents=function(e){var t=this._view(),r=this,i;this._windowResizeTimer=0,n(window).unbind("resize."+this.widgetName+"."+this._eventUID),t&&(i=t.focusableElement(),i.unbind("keydown."+this.widgetName),i.unbind("keypress."+this.widgetName),n.each(t.subTables(),function(){var e=this.element();e&&(e.tHead&&n(e.tHead).unbind("."+r.widgetName),e.tBodies.length&&n(e.tBodies[0]).unbind("."+r.widgetName))}))},i.prototype._handleSort=function(t,r){var i=this.options.columns,s=t.travIdx,o,u;t&&this.options.allowSorting&&(o=t.sortDirection==="none"?"ascending":t.sortDirection==="ascending"?"descending":"ascending",u={column:t,sortDirection:o,sortCommand:t.dataKey+" "+(o==="ascending"?"asc":"desc")},this._onColumnSorting(u)&&(t.sortDirection=u.sortDirection,r?t.sortOrder=this._customSortOrder++:(this._customSortOrder=1e3,n.each(this.columns(),function(e,t){t.options.sortOrder=0,t.options.travIdx!==s&&(!t.options.groupInfo||t.options.groupInfo.position==="none")&&(t.options.sortDirection="none")}),e.grid.traverse(i,function(e){e.sortOrder=0,e.travIdx!==s&&(!e.groupInfo||e.groupInfo.position==="none")&&(e.sortDirection="none")})),u={column:t,sortDirection:t.sortDirection,sortCommand:t.dataKey+" "+(t.sortDirection==="ascending"?"asc":"desc")},this._customPagingEnabled()?(this._convertWidgetsToOptions(),this._onColumnSorted(u)):this.ensureControl(!0,{afterRefresh:function(){this._onColumnSorted(u)}})))},i.prototype._handleDragnDrop=function(t,r,i,s,o){var u=e.grid.getColumnByTravIdx(this.options.columns,t),a=e.grid.getColumnByTravIdx(this.options.columns,r),f=s?"groupArea":"columns",l=o?"groupArea":"columns";o?this._onColumnGrouping({drag:u.found,drop:a?a.found:null,dragSource:f,dropSource:l,at:i})&&this.ensureControl(!0,{beforeRefresh:function(){if(!a)u.found.groupedIndex=0;else switch(i){case"left":u.found.groupedIndex=a.found.groupedIndex-.5;break;case"right":u.found.groupedIndex=a.found.groupedIndex+.5}s||n.extend(!0,u.found,{groupInfo:{position:"header"}})},afterRefresh:function(){this._onColumnGrouped({drag:u.found,drop:a?a.found:null,dragSource:f,dropSource:l,at:i})}}):this._onColumnDropping({drag:u.found,drop:a.found,at:i})&&this.ensureControl(!1,{beforeRefresh:function(){u.at.splice(u.found.linearIdx,1);switch(i){case"left":u.at===a.at&&u.found.linearIdx<a.found.linearIdx?a.at.splice(a.found.linearIdx-1,0,u.found):a.at.splice(a.found.linearIdx,0,u.found);break;case"right":u.at===a.at&&u.found.linearIdx<a.found.linearIdx?a.at.splice(a.found.linearIdx,0,u.found):a.at.splice(a.found.linearIdx+1,0,u.found);break;case"center":a.found.columns.push(u.found)}e.grid.setTraverseIndex(this.options.columns)},afterRefresh:function(){this._onColumnDropped({drag:u.found,drop:a.found,at:i})}})},i.prototype._handleFilter=function(t,n,r){var i=(new e.grid.filterOperatorsCache(this)).getByName(n),s,o,u;i&&(i.arity>1?(s=this.parse(t.options,r),o=s!==null&&(e.grid.getDataType(t.options)==="string"||!isNaN(s))):o=!0,o&&(u={column:t.options,operator:i.name,value:s},this._onColumnFiltering(u)&&(t.options.filterValue=u.value,t.options.filterOperator=u.operator,this._resetDataProperties(),this._customPagingEnabled()?(this._convertWidgetsToOptions(),this._onColumnFiltered({column:t.options})):this.ensureControl(!0,{afterRefresh:function(){this._onColumnFiltered({column:t.options})}}))))},i.prototype._handleUngroup=function(t){var r=e.grid.getColumnByTravIdx(this.options.columns,t),i;r&&r.found&&(i=r.found,this._onColumnUngrouping({column:i})&&this.ensureControl(!0,{beforeRefresh:function(){delete i.groupedIndex,n.extend(!0,i,{groupInfo:{position:"none"}})},afterRefresh:function(){this._onColumnUngrouped({column:i})}}))},i.prototype._onVirtualScrolling=function(e,t,r,i,s,o){var u=this;this.ensureControl(this._serverSideVirtualScrolling(),{virtualScrollData:{newBounds:e,request:t,mode:r,data:o},beforeOnRendered:function(e){var t=u._viewPortBounds();n.extend(t,e.virtualScrollData.newBounds)},afterRefresh:function(e){u._view()._adjustRowsHeights(),s&&s(i)}})},i.prototype._handleVirtualScrolling=function(e,t){var n=this._view(),r=this._viewPortBounds(),i=this._ensureVisibleRowsBounds({start:e,end:e+n.getVirtualPageSize()-1}),s=this._ensureSketchTableBounds({start:this._dataOffset,end:this._dataOffset+this._dataViewWrapper.dataView().count()-1}),o=null,u;i.start>r.end||i.end<r.start?u="reset":i.start>r.start?u="overlapBottom":i.start<r.start?u="overlapTop":u=i.start!==r.start||i.end!==r.end?"reset":"none",u="reset";if(this._serverSideVirtualScrolling())switch(u){case"reset":o={index:e,maxCount:this.options.pageSize};break;case"overlapBottom":i.end>s.end&&(o={index:s.end+1,maxCount:this.options.pageSize});break;case"overlapTop":i.start<s.start&&(o={index:Math.max(0,s.start-this.options.pageSize),maxCount:0},o.maxCount=s.start-o.index)}u!=="none"&&this._onVirtualScrolling(i,o,u,e,t)},i.prototype._serverSideVirtualScrolling=function(){return!1},i.prototype._serverSideVirtualScrollingMargin=function(){return this.options.pageSize*2},i.prototype._onColumnDropping=function(e){return this._trigger("columnDropping",null,e)},i.prototype._onColumnDropped=function(e){this._trigger("columnDropped",null,e)},i.prototype._onColumnGrouping=function(e){return this._trigger("columnGrouping",null,e)},i.prototype._onColumnGrouped=function(e){this._trigger("columnGrouped",null,e)},i.prototype._onColumnUngrouping=function(e){return this._trigger("columnUngrouping",null,e)},i.prototype._onColumnUngrouped=function(e){this._trigger("columnUngrouped",null,e)},i.prototype._onColumnFiltering=function(e){return this._trigger("filtering",null,e)},i.prototype._onColumnFiltered=function(e){this._trigger("filtered",null,e)},i.prototype._onFilterOperatorsListShowing=function(e){this._trigger("filterOperatorsListShowing",null,e)},i.prototype._onColumnSorting=function(e){return this._trigger("sorting",null,e)},i.prototype._onColumnSorted=function(e){this._trigger("sorted",null,e)},i.prototype._onCurrentCellChanged=function(t,n){var r=this.options,i=this.currentCell(),s=i.row();this._dataViewWrapper.currentPosition(s.type&e.grid.rowType.data?s.dataItemIndex:-1),r.scrollMode!=="none"&&i&&!i.isEqual(e.grid.cellInfo.outsideValue)&&this._view().scrollTo(i),this._trigger("currentCellChanged");var o=t&&(t.type||"").toLowerCase()||"";if(n.changeSelection){var u=this.selection(),a=this.options.selectionMode.toLowerCase(),f=n.selectionExtendMode||e.grid.cellRangeExtendMode.none;u.beginUpdate();if(o){if(i._isValid())switch(o){case"click":(!t.shiftKey||!u._multipleRangesAllowed()&&a!=="singlerange")&&u._startNewTransaction(i),t.shiftKey&&t.ctrlKey?u._clearRange(new e.grid.cellInfoRange(i,i),f):u._selectRange(new e.grid.cellInfoRange(u._anchorCell(),i),t.ctrlKey,t.shiftKey,f,null);break;case"keydown":(!t.shiftKey||!u._multipleRangesAllowed()&&a!=="singlerange")&&u._startNewTransaction(i),u._selectRange(new e.grid.cellInfoRange(u._anchorCell(),i),!1,t.shiftKey,e.grid.cellRangeExtendMode.none,null)}}else u.clear(),i._isValid()&&(u._startNewTransaction(i),u._selectRange(new e.grid.cellInfoRange(i,i),!1,!1,e.grid.cellRangeExtendMode.none,null));u.endUpdate()}o==="click"&&this._editBySingleClick()&&this._beginEditInternal(t)},i.prototype._onPageIndexChanging=function(e){return this._trigger("pageIndexChanging",null,e)},i.prototype._onPageIndexChanged=function(e){this._trigger("pageIndexChanged",null,e)},i.prototype._onPagerWidgetPageIndexChanging=function(e,t){t.handled=!0},i.prototype._onPagerWidgetPageIndexChanged=function(e,t){this._setOption("pageIndex",t.newPageIndex)},i.prototype._onRendering=function(e){var t=this._view();this._rendered=!1;if(!e.virtualScrollData){t&&t.dispose(),this._detachEvents(!1),this.element.detach(),this.element.empty(),this.outerDiv.empty(),this.outerDiv.append(this.element),this._selectionui&&(this._selectionui.dispose(),this._selectionui=null),this._resizerui&&(this._resizerui.dispose(),this._resizerui=null),this._frozenerui&&(this._frozenerui.dispose(),this._frozenerui=null);var n=this._field("currentCell");this._field("currentCellPrevCycle",n?{x:n.cellIndex(),y:n.rowIndex()}:{x:-1,y:-1}),this._field("currentCell",null)}this._trigger("rendering")},i.prototype._onRendered=function(t){var r=this._view(),i,s=this.selection().selectedCells().length()>0;this._rendered=!0;if(!t.virtualScrollData){this._field("selection",null),this._setAttr(r.focusableElement(),"tabIndex",0);var o=this._field("currentCellPrevCycle");i=this._currentCellFromDataView(o.x),!i._isValid()&&this.options.showSelectionOnRender&&(i=this._getFirstDataRowCell(0)),this.currentCell(i,null,!0),this._attachEvents(),this._UISelection(!0);var u=new e.grid.uiResizer(this);n.each(this.columns(),function(e,t){var n=t.options;n.visible&&n.parentVis&&n.isLeaf&&u.addElement(t)}),this._resizerui=u,r.updateSplits(this._scrollingState),this.options.scrollMode!=="none"&&(this._frozenerui=new e.grid.uiFrozener(this))}else this.selection()._ensureSelection();this._renderCounter++,this._trigger("rendered")},i.prototype._onClick=function(t){if(!this._canInteract()||!t.target)return;var r=this._view(),i=this._findUntilOuterDiv(t.target,{td:!0,th:!0}),s,o,u=e.grid.cellRangeExtendMode.none,a,f;if(i){if(n(t.target).hasClass("wijmo-wijgrid-grouptogglebtn"))return this._onGroupBtnClick(t),t.stopPropagation(),!1;s=n(i).closest("tr");if(!s.length)return;o=r.getAbsoluteCellInfo(i,!1);if(s.hasClass("wijmo-wijgrid-datarow")||s.hasClass("wijmo-wijgrid-headerrow")){if(o.cellIndex()<0||o.rowIndex()<0)o.rowIndex()>=0?(o=new e.grid.cellInfo(0,o.rowIndex()),u=e.grid.cellRangeExtendMode.row):(o=this._getFirstDataRowCell(o.cellIndex()),u=e.grid.cellRangeExtendMode.column);o=r.getAbsoluteCellInfo(i,!0),this._changeCurrentCell(t,o,{changeSelection:!0,setFocus:!n(t.target).is(":focus"),selectionExtendMode:u})}var l={cell:o};this._trigger("cellClicked",null,l)}},i.prototype._onDblClick=function(e){this._editBySingleClick()||this._beginEditInternal(e)},i.prototype._onGroupBtnClick=function(t){if(!this._canInteract())return;var r=n(t.target).closest("tr"),i=e.grid.groupHelper,s=i.getGroupInfo(r[0]),o,u;s&&(o=i.getColumnByGroupLevel(this._field("leaves"),s.level),o&&(u=o.groupInfo.expandInfo[s.index],u.isExpanded?u.collapse():u.expand(t.shiftKey),this._allowVirtualScrolling()&&(this._rebuildRenderBoundsCollection(),this._view().vsUI._changeVisibleRowsCount(this._renderableBoundsCollection().capacity()),this._ensureViewPortBoundsVisible(this._viewPortBounds()),this._handleVirtualScrolling(this._viewPortBounds().start)),this.setSize()))},i.prototype._onKeyDown=function(r){if(!this._canInteract())return!0;var i=r.target.tagName.toLowerCase(),s=this.currentCell(),o=e.getKeyCodeEnum();if(i!=="input"&&i!=="option"&&i!=="select"&&i!=="textarea"||n(r.target).closest("tr.wijmo-wijgrid-datarow").length!==0){if(this.options.allowEditing){if((r.which===o.ESCAPE||r.which===113)&&s._isValid()&&s._isEdit())return this._endEditInternal(r),!1;if(r.which===113)return this._beginEditInternal(r),!1}if(!this.options.allowKeyboardNavigation||r.which===o.TAB)return!0;var u=this._getDataCellsRange(t.dataRowsRangeMode.renderable),a;switch(r.which){case o.DOWN:case o.PAGE_DOWN:case o.UP:case o.PAGE_UP:case o.LEFT:case o.RIGHT:case o.HOME:case o.END:case o.TAB:this._canMoveToAnotherCell(r.target,r.which)&&(a=this._getNextCurrentCell(u,s,r.keyCode,r.shiftKey))}if(a){var f=a._isRendered(),l=this._renderableBoundsCollection().getVisibleIndex(a.rowIndex()),c,h,p=this._allowVirtualScrolling()&&l-this._viewPortBounds().start>=this._rows().length()-1,d=this;return this._allowVirtualScrolling()&&(!f||p&&(c=this._view().getVisibleAreaBounds(!0))&&(h=a.row().$rows)&&h.offset().top+h.outerHeight()>c.top+c.height)?(a.rowIndex()>s.rowIndex()&&(l-=this._rows().length()-1,l+=1),this._view().vsUI.scrollTo(l,function(){d._changeCurrentCell(r,a,{changeSelection:!0,setFocus:!0}),n(d._view().focusableElement()).focus()})):this._changeCurrentCell(r,a,{changeSelection:!0,setFocus:!0}),!1}return!0}return!0},i.prototype._onKeyPress=function(e){if(this._canInteract()&&this.options.allowEditing){var t=e.which,r=this.currentCell(),i,s,o;if(t&&r._isValid()&&!r._isEdit()){i=e.target.tagName.toLowerCase();if(i!=="input"&&i!=="option"&&i!=="select"&&i!=="textarea"){s=n(e.target).closest(".wijmo-wijgrid-table");if(s.length){o=n.map(this._view().subTables(),function(e,t){return e.element()});if(n.inArray(s[0],o)>=0&&n.wij.charValidator.isPrintableChar(String.fromCharCode(t)))return this._beginEditInternal(e),!1}}}}},i.prototype._onMouseMove=function(t){var r=this._view(),i=this._frozenerui,s,o,u,a,f,l=e.grid.renderState;if(!this.options.highlightOnHover||!this._canInteract()||i&&i.inProgress())return;s=this._findUntilOuterDiv(t.target,{td:!0,th:!0});if(s){o=n(s).closest("tr");if(!o.length||!o.hasClass("wijmo-wijgrid-datarow")&&!o.hasClass("wijmo-wijgrid-headerrow"))return;u=r.getAbsoluteCellInfo(s,!0);var c=u.rowIndex();c!==this._prevHoveredSketchRowIndex&&(this._prevHoveredSketchRowIndex!==undefined&&r._isRowRendered(this._prevHoveredSketchRowIndex)>=0&&(f=r._getRowInfoBySketchRowIndex(this._prevHoveredSketchRowIndex),f&&(r._changeRowRenderState(f,l.hovered,!1),this.rowStyleFormatter.format(f))),this._prevHoveredSketchRowIndex=c,c>=0&&(f=r._getRowInfoBySketchRowIndex(c),f&&(r._changeRowRenderState(f,l.hovered,!0),this.rowStyleFormatter.format(f))))}},i.prototype._onMouseOut=function(t){if(!this._canInteract())return;var r=this._findUntilOuterDiv(t.relatedTarget,{tr:!0});if(!r||!n(r).hasClass("wijmo-wijgrid-datarow")){var i=this._prevHoveredSketchRowIndex,s=this._view();if(i>=0){var o=s._getRowInfoBySketchRowIndex(i);o&&o.$rows&&(s._changeRowRenderState(o,e.grid.renderState.hovered,!1),this.rowStyleFormatter.format(o)),this._prevHoveredSketchRowIndex=-1}}},i.prototype._onWindowResize=function(e){var t=this;this._windowResizeTimer>0&&(window.clearTimeout(this._windowResizeTimer),this._windowResizeTimer=0),this._windowResizeTimer!==-1&&(this._windowResizeTimer=window.setTimeout(function(){t._windowResizeTimer=-1;try{!t._destroyed&&t._initialized&&t.element.parent().length&&t.setSize()}finally{t._windowResizeTimer=0}},50))},i.prototype._fieldResized=function(e,t,n){t<0&&(t=0),n<=0&&(n=1);var r={column:e.options,oldWidth:t,newWidth:n};if(this._trigger("columnResizing",null,r)!==!1){if(isNaN(r.newWidth)||r.newWidth<0)r.newWidth=1;e.option("width",r.newWidth);var i={column:e.options};this._trigger("columnResized",null,i)}},i.prototype._changeCurrentCell=function(r,i,s){var o=this.currentCell(),u=this._getDataCellsRange(t.dataRowsRangeMode.sketch),a,f,l=this.options.highlightCurrentCell,c;if(u._isValid()&&u._containsCellInfo(i)||i.isEqual(e.grid.cellInfo.outsideValue))if(o.cellIndex()!==i.cellIndex()||o.rowIndex()!==i.rowIndex()){a={cellIndex:i.cellIndex(),rowIndex:i.rowIndex(),oldCellIndex:o.cellIndex(),oldRowIndex:o.rowIndex()};if(!this._trigger("currentCellChanging",null,a))return!1;f=!1;if(!this.options.allowEditing||!o._isEdit()||(f=this._endEditInternal(null))){u._containsCellInfo(o)&&(l&&this._highlightCellPosition(o,!1),(c=o.tableCell())&&n(c).removeAttr("tabIndex")),o=i._clone(),o._setGridView(this),l&&this._highlightCellPosition(o,!0);if(c=o.tableCell())n(c).attr("tabIndex",0),s.setFocus&&!o._isEdit();this._field("currentCell",o),this._onCurrentCellChanged(r,s)}}else l&&this._highlightCellPosition(o,!0),(c=o.tableCell())&&n(c).attr("tabIndex",0),r&&!o._isEdit()&&this._editBySingleClick()&&this._beginEditInternal(r);return!0},i.prototype._highlightCellPosition=function(t,r){if(t&&t._isValid()&&t._isRendered()){var i=t.cellIndexAbs(),s=t.rowIndexAbs(),o=e.grid.renderState,u=this._view(),a,f,l;f=u.getHeaderCell(i),f&&(a=u._getRowInfo(this._headerRows().item(t.column().thY)),f=n(f),l=u._changeCellRenderState(f,o.current,r),this.cellStyleFormatter.format(f,i,t.column(),a,l)),f=u.getJoinedRows(s,0),f&&(a=u._getRowInfo(f),u._changeRowRenderState(a,o.current,r),this.rowStyleFormatter.format(a)),f=u.getCell(i,s),f&&(f=n(f),l=u._changeCellRenderState(f,o.current,r),this.cellStyleFormatter.format(f,i,t.column(),a,l))}},i.prototype._beginEditInternal=function(t){if(this._canInteract()&&this.options.allowEditing){var n=this.currentCell().column(),r;if(n&&!n.readOnly)return r=(new e.grid.cellEditorHelper).currentCellEditStart(this,t),r,r}return!1},i.prototype._endEditInternal=function(t){if(this._canInteract()&&this.options.allowEditing){var n=(new e.grid.cellEditorHelper).currentCellEditEnd(this,t);return n&&!this._allowVirtualScrolling()&&this._view().ensureHeight(this.currentCell().rowIndex()),n}return!1},i.prototype._onViewInsertEmptyRow=function(e,t,n,r,i){return null},i.prototype._onViewCreateEmptyCell=function(e,t,n){return null},i.prototype._onViewCellRendered=function(e,t,n,r){},i.prototype._onViewRowRendered=function(e){},i.prototype._getDataParser=function(t){return t.dataParser||e.data.defaultParsers[t.dataType]||e.data.defaultParsers.string},i.prototype.parse=function(t,r){var i=e.grid.getDataType(t),s=e.grid.getDataType(t);return n.isFunction(r)&&(r=r()),r=e.data.convert(r,i,s,{culture:this._closestCulture,format:t.dataFormatString||t._underlyingDataFormatString,nullString:this.options.nullString,parser:t.dataParser}),r},i.prototype.toStr=function(t,n){var r=this._dataViewWrapper.dataView(),i=e.grid.getDataType(t),s="string";return n=e.data.convert(n,i,s,{culture:this._closestCulture,format:t.dataFormatString||t._underlyingDataFormatString,nullString:this.options.nullString,parser:t.dataParser}),n},i.prototype.parseFailed=function(e,t,n,r){return t},i.prototype._funcOptions=function(){return["cellStyleFormatter","rowStyleFormatter","afterCellEdit","afterCellUpdate","beforeCellEdit","beforeCellUpdate","cellClicked","columnDragging","columnDragged","columnDropping","columnDropped","columnResizing","columnResized","columnGrouping","columnGrouped","columnUngrouping","columnUngrouped","currentCellChanging","currentCellChanged","filtering","filtered","filterOperatorsListShowing","groupAggregate","groupText","invalidCellValue","pageIndexChanging","pageIndexChanged","selectionChanged","sorting","sorted","dataLoading","dataLoaded","loading","loaded","rendering","rendered"]},i.prototype._canInteract=function(){return!this.options.disabled},i.prototype._canMoveToAnotherCell=function(t,r){var i=t.tagName.toLowerCase(),s,o,u,a;switch(i){case"input":if(n(t).hasClass("wijgridinput")){var f=t;return f.type==="text"?(s=f.value.length,o=(new e.grid.domSelection(f)).getSelection(),u=e.getKeyCodeEnum(),a=r===u.UP||r===u.DOWN||r===u.PAGE_DOWN||r===u.PAGE_UP||o.length===0&&(o.start===0&&(r===u.LEFT||r===u.HOME)||o.end>=s&&(r===u.RIGHT||r===u.END)),a):!0}return!1;case"textarea":case"select":return!1}return!0},i.prototype._editBySingleClick=function(){var e=(this.options.editingInitOption||"").toLowerCase();switch(e){case"click":case"doubleclick":break;case"auto":default:e=this._isMobileEnv()?"click":"doubleclick"}return e==="click"},i.prototype._getDataToAbsOffset=function(){var e=0,t=0,n=this._headerRows();return this._showRowHeader()&&e++,n&&(t+=n.length()),this._filterRow()&&t++,{x:e,y:t}},i.prototype._currentCellFromDataView=function(t){var n=this._dataViewWrapper.currentPosition(),r=new e.grid.cellInfo(t,this._dataViewDataRowIndexToGrid(n),null);return r.rowIndex()<0?r.cellIndex(-1):r.cellIndex()<0&&r.cellIndex(0),r},i.prototype._dataViewDataRowIndexToGrid=function(t){var n=e.grid.rowType,r=this._view(),i=this._rows(),s,o,u;if(t<0)return-1;for(s=0,o=i.length();s<o;s++){u=r._getRowInfo(i.item(s));if(u.type&n.data&&u.dataItemIndex===t)return u.sectionRowIndex}return-1},i.prototype._getDataCellsRange=function(n,r){typeof r=="undefined"&&(r=!1);var i=0,s=0,o=this._field("visibleLeaves").length-1,u;switch(n){case t.dataRowsRangeMode.rendered:if(this._rendered){u=this._rows().length()-1;break};case t.dataRowsRangeMode.sketch:u=this._totalRowsCount()-1;break;case t.dataRowsRangeMode.renderable:u=this._renderableRowsCount()-1}this._showRowHeader()&&o--,r&&u>0&&u--;if(o<0||u<0)i=s=o=u=-1;return new e.grid.cellInfoRange(new e.grid.cellInfo(i,s,null),new e.grid.cellInfo(o,u,null))},i.prototype._getDataItem=function(e){return this.dataView().item(e)},i.prototype._getFirstDataRowCell=function(t){var n,r,i,s=this._view(),o=this._rows(),u=e.grid.rowType;for(n=0,r=o.length();n<r;n++){i=s._getRowInfo(o.item(n));if(i.type&u.data)return new e.grid.cellInfo(t,n)}return e.grid.cellInfo.outsideValue},i.prototype._getNextCurrentCell=function(t,n,r,i){var s=n.cellIndex(),o=n.rowIndex(),u=this._renderableBoundsCollection().getVisibleIndex(o),a,f=e.getKeyCodeEnum();switch(r){case f.PAGE_UP:u-=this._pageSizeKey,u<(a=t.topLeft().rowIndex())&&(u=a);break;case f.PAGE_DOWN:u+=this._pageSizeKey,u>(a=t.bottomRight().rowIndex())&&(u=a);break;case f.END:s=t.bottomRight().cellIndex();break;case f.HOME:s=t.topLeft().cellIndex();break;case f.LEFT:s>t.topLeft().cellIndex()&&s--;break;case f.UP:u>t.topLeft().rowIndex()&&u--;break;case f.RIGHT:s<t.bottomRight().cellIndex()&&s++;break;case f.ENTER:case f.DOWN:u<t.bottomRight().rowIndex()&&u++;break;case f.TAB:}return o=this._renderableBoundsCollection().getAbsIndex(u),new e.grid.cellInfo(s,o,this)},i.prototype._findUntilOuterDiv=function(e,t){var n=e,r,i,s=null;for(;n;n=n.parentNode){i=n.nodeName.toLowerCase();if(i){if(n===this.outerDiv[0]){r=n;break}t[i]&&(s=n)}}return r?s:null},i.prototype._getStaticIndex=function(e){var n,r=this._getDataCellsRange(t.dataRowsRangeMode.rendered);return this._hasSpannedCells()?-1:(e?n=Math.min(this.options.staticRowIndex,r.bottomRight().rowIndex()):n=Math.min(this.options.staticColumnIndex,r.bottomRight().cellIndex()),n<-1&&(n=-1),n)},i.prototype._getStaticOffsetIndex=function(e){var t=0;return e?this._showRowHeader()&&t++:(t=this._columnsHeadersTable().length,this.options.showFilter&&t++),t},i.prototype._getRealStaticColumnIndex=function(){var e,t,n=this._getStaticOffsetIndex(!0),r=this._getStaticIndex(!1),i,s;i=r+n;if(r>=0){e=this._field("visibleLeaves"),t=e.length,s=i;for(;i<t;i++)if(e[i].parentIdx===-1){i>s&&i--;break}i>=t&&(i=t-1)}return i},i.prototype._getRealStaticRowIndex=function(){var e=this._getStaticOffsetIndex(!1);return this._getStaticIndex(!0)+e},i.prototype._hasMerging=function(){var e=this._field("leaves"),t,n,r,i=!1;if(e)for(t=0,n=e.length;t<n&&!i;t++)r=e[t],i=i||r.parentVis&&r.rowMerge!=="none";return i},i.prototype._hasGrouping=function(){var e=this._field("leaves"),t,n,r,i=!1;for(t=0,n=e.length;t<n&&!i;t++)r=e[t],i=r.groupInfo&&r.groupInfo.position!=="none";return i},i.prototype._hasSpannedCells=function(){return this._hasGrouping()||this._hasMerging()},i.prototype._columnsHeadersTable=function(e){return arguments.length&&this._field("columnsHeadersTable",e),this._field("columnsHeadersTable")},i.prototype._view=function(){return this.mView},i.prototype._originalFooterRowData=function(){var e=this._field("tfoot");return e&&e.length?e[0]:null},i.prototype._originalHeaderRowData=function(){var e=this._field("thead");return e&&e.length?e[0]:null},i.prototype._setAttr=function(e,t,r){var i=this;return e===this.element?arguments.length===2?(n.each(t,function(t,n){t in i._originalAttr||(i._originalAttr[t]=e.attr(t))}),e.attr(t)):(t in this._originalAttr||(this._originalAttr[t]=e.attr(t)),e.attr(t,r)):arguments.length===3?e.attr(t,r):e.attr(t)},i.prototype._totalRowsCount=function(){return this.sketchTable.length},i.prototype._renderableRowsCount=function(){return this._renderableBoundsCollection().capacity()},i.prototype._trackScrollingPosition=function(e,t){this._scrollingState.x=e,this._scrollingState.y=t},i.prototype._trackScrollingIndex=function(e){this._scrollingState.index=e},i.prototype._uid=function(){return this.__uid===undefined&&(this.__uid=e.grid.getUID()),"wijgrid"+this.__uid},i.prototype._viewPortBounds=function(e){return arguments.length&&(this.mViewPortBounds=e),this.mViewPortBounds},i.prototype._viewPortBoundsOfEntirelyShownRows=function(){var e=this._viewPortBounds(),t=!1,r=e.end-e.start+1;if(this._allowVirtualScrolling()){var i=this._view();r<i.getVirtualPageSize()&&(t=!0)}return t||(e=n.extend({},e),e.end--),e},i}(e.wijmoWidget);t.wijgrid=i,i.prototype.widgetEventPrefix="wijgrid",i.prototype._data$prefix="wijgrid",i.prototype._customSortOrder=1e3,i.prototype._pageSizeKey=10,i.prototype._mergeWidgetsWithOptions=!0;var s=function(){function e(){this.wijMobileCSS={header:"ui-header ui-bar-a",content:"ui-body-c",stateHover:"ui-btn-down-c",stateActive:"ui-btn-down-c"},this.allowColMoving=!1,this.allowColSizing=!1,this.allowEditing=!1,this.allowKeyboardNavigation=!0,this.allowPaging=!1,this.allowSorting=!1,this.allowVirtualScrolling=!1,this.cellStyleFormatter=undefined,this.columns=[],this.columnsAutogenerationMode="merge",this.culture="",this.customFilterOperators=[],this.data=null,this.editingInitOption="auto",this.ensureColumnsPxWidth=!1,this.filterOperatorsSortMode="alphabeticalCustomFirst",this.freezingMode="none",this.groupAreaCaption="Drag a column here to group by that column.",this.groupIndent=10,this.highlightCurrentCell=!1,this.highlightOnHover=!0,this.loadingText="Loading...",this.nullString="",this.pageIndex=0,this.pageSize=10,this.pagerSettings={mode:"numeric",pageButtonCount:10,position:"bottom"},this.readAttributesFromData=!1,this.rowHeight=undefined,this.rowStyleFormatter=undefined,this.scrollMode="none",this.selectionMode="singleRow",this.showFilter=!1,this.showFooter=!1,this.showGroupArea=!1,this.showSelectionOnRender=!0,this.showRowHeader=!1,this.staticColumnIndex=-1,this.staticColumnsAlignment="left",this.staticRowIndex=-1,this.totalRows=-1,this.afterCellEdit=null,this.afterCellUpdate=null,this.beforeCellEdit=null,this.beforeCellUpdate=null,this.cellClicked=null,this.columnDragging=null,this.columnDragged=null,this.columnDropping=null,this.columnDropped=null,this.columnGrouping=null,this.columnGrouped=null,this.columnResizing=null,this.columnResized=null,this.columnUngrouping=null,this.columnUngrouped=null,this.currentCellChanging=null,this.currentCellChanged=null,this.filterOperatorsListShowing=null,this.filtering=null,this.filtered=null,this.groupAggregate=null,this.groupText=null,this.invalidCellValue=null,this.pageIndexChanging=null,this.pageIndexChanged=null,this.selectionChanged=null,this.sorting=null,this.sorted=null,this.dataLoading=null,this.dataLoaded=null,this.loading=null,this.loaded=null,this.rendering=null,this.rendered=null}return e}();i.prototype.options=e.grid.extendWidgetOptions(e.wijmoWidget.prototype.options,new s),n.wijmo.registerWidget("wijgrid",i.prototype)})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(t){function r(){t.apply(this,arguments)}return __extends(r,t),r.prototype._create=function(){var t=n.data(this.element[0],"wijgridowner");this._field("owner",t),e.grid.widgetName(this.element[0],this.widgetFullName),this._destroyed=!1,this.element.addClass(t.options.wijCSS.widget+" wijmo-c1basefield "+t.options.wijCSS.stateDefault),this.options.disabled&&this.disable(),t.options.allowColMoving&&t._UIDragndrop(!0).attach(this)},r.prototype._init=function(){this.element.wrapInner("<div class='wijmo-wijgrid-innercell'></div>"),this._refreshHeaderCell()},r.prototype.destroy=function(){try{t.prototype.destroy.apply(this,arguments)}finally{this._destroyed=!0}},r.prototype._destroy=function(){if(this._isDestroyed())return;var t=this._owner();t&&t._UIDragndrop()&&t._UIDragndrop().detach(this),e.grid.remove$dataByPrefix(this.element,this._data$prefix),this.element.removeClass(t.options.wijCSS.widget+" wijmo-c1basefield "+t.options.wijCSS.stateDefault).html(this.element.find(".wijmo-wijgrid-headertext").html())},r.prototype._field=function(t,n){return e.grid.dataPrefix(this.element,this._data$prefix,t,n)},r.prototype._removeField=function(e){var t=this._data$prefix+e;this.element.removeData(t)},r.prototype._setOption=function(e,n){var r=this["_preset_"+e],i=this.options[e],s,o;r!==undefined&&(n=r.apply(this,[n,i])),s=n!==i,t.prototype._setOption.apply(this,[e,n]);if(s){if(this.options.groupedIndex!==undefined){var u=this._owner()._field("groupedWidgets")[this.options.groupedIndex];u&&e in u.options&&u._setOption(e,n)}o=this["_postset_"+e],o!==undefined&&o.apply(this,[n,i])}},r.prototype._postset_allowMoving=function(e,t){},r.prototype._preset_clientType=function(e,t){throw"read-only"},r.prototype._postset_headerText=function(e,t){this._refreshHeaderCell()},r.prototype._postset_visible=function(e,t){this._owner().ensureControl(!1)},r.prototype._postset_width=function(t,n){var r=this._owner();if(r){this.options.ensurePxWidth=!0;var i=e.grid.getColumnByTravIdx(r.options.columns,this.options.travIdx);i&&(i.found.width=t,i.found.ensurePxWidth=!0),r.setSize()}},r.prototype._owner=function(){return this._field("owner")},r.prototype._canSize=function(){return this.options.allowSizing&&this._owner().options.allowColSizing},r.prototype._canDrag=function(){return this.options.allowMoving===!0},r.prototype._canDropTo=function(t){return e.grid.isChildOf(this._owner().options.columns,t,this)?!1:!0},r.prototype._createHeaderContent=function(e){return e.html(this.options.headerText||"&nbsp;")},r.prototype._decorateHeaderContent=function(e){return e.wrapInner('<span class="wijmo-wijgrid-headertext" />')},r.prototype._refreshHeaderCell=function(){var e=this.element.children(".wijmo-wijgrid-innercell").empty();this._createHeaderContent(e),this._decorateHeaderContent(e)},r.prototype._isDestroyed=function(){return this._destroyed},r}(e.wijmoWidget);t.c1basefield=r,r.prototype._data$prefix="c1basefield";var i=function(){function e(){this.allowMoving=!0,this.allowSizing=!0,this.cellFormatter=undefined,this.dataKey=undefined,this.ensurePxWidth=undefined,this.footerText=undefined,this.headerText=undefined,this.textAlignment=undefined,this.visible=!0,this.width=undefined}return e}();t.c1basefield_options=i,r.prototype.options=e.grid.extendWidgetOptions(e.wijmoWidget.prototype.options,new i),n.wijmo.registerWidget("c1basefield",r.prototype)})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(t){function r(){t.apply(this,arguments)}return __extends(r,t),r.prototype._create=function(){t.prototype._create.apply(this,arguments);var e=this._owner();this.element.addClass(e.options.wijCSS.widget+" wijmo-c1field")},r.prototype._destroy=function(){if(this._isDestroyed())return;var e=this._owner();this.element.find("*").unbind("."+this.widgetName);if(this.$filterEditor){this.$filterEditor.closest("td").find("*").unbind("."+this.widgetName);switch(this._getInputEditorType(this.options)){case"date":this.$filterEditor.data("wijmo-wijinputdate")&&this.$filterEditor.wijinputdate("destroy");break;case"mask":this.$filterEditor.data("wijmo-wijinputmask")&&this.$filterEditor.wijinputmask("destroy");break;case"numberCurrency":case"numberNumber":case"numberPercent":this.$filterEditor.data("wijmo-wijinputnumber")&&this.$filterEditor.wijinputnumber("destroy")}this.$filterEditor=null}this.element.removeClass(e.options.wijCSS.widget+" wijmo-c1field"),this._removeDropDownFilterList(),t.prototype._destroy.apply(this,arguments)},r.prototype._init=function(){t.prototype._init.apply(this,arguments),this.$filterEditor=null;var e=this._owner();this.filterRow=e._filterRow(),e.options.showFilter&&this.options.showFilter&&this.options.dataIndex>=0&&this._prepareFilterCell()},r.prototype._postset_aggregate=function(e,t){this._owner().ensureControl(!1)},r.prototype._postset_allowSort=function(e,t){this._refreshHeaderCell()},r.prototype._postset_dataType=function(e,t){throw"read-only"},r.prototype._postset_dataParser=function(e,t){this._owner().ensureControl(!1)},r.prototype._postset_dataFormatString=function(e,t){this._owner().ensureControl(!1)},r.prototype._postset_filterOperator=function(e,t){this._owner().ensureControl(!0)},r.prototype._postset_filterValue=function(e,t){this._owner().ensureControl(!0)},r.prototype._postset_groupInfo=function(e,t){this._owner().ensureControl(!0)},r.prototype._postset_rowMerge=function(e,t){this._owner().ensureControl(!1)},r.prototype._postset_showFilter=function(e,t){this._owner().ensureControl(!1)},r.prototype._postset_sortDirection=function(e,t){this.options.sortOrder=0,this._owner().ensureControl(!0)},r.prototype._postset_width=function(e,n){t.prototype._postset_width.apply(this,arguments)},r.prototype._canDropTo=function(e){return t.prototype._canDropTo.apply(this,arguments)?this.options.groupedIndex!==undefined&&e instanceof n.wijmo.c1groupedfield?!1:!0:!1},r.prototype._canSort=function(){var e=this._owner();return e&&e.options.allowSorting&&this.options.allowSort&&this.options.dataIndex>=0},r.prototype._decorateHeaderContent=function(e){if(this._canSort()){var r=this._owner(),i=e.wrapInner('<a class="wijmo-wijgrid-headertext" href="#" role="button" />').children("a");i.bind("click."+this.widgetName,this,n.proxy(this._onHrefClick,this));switch(this.options.sortDirection){case"ascending":e.append(n('<span class="wijmo-wijgrid-sort-icon '+r.options.wijCSS.icon+" "+r.options.wijCSS.iconArrowUp+'">ascending</span>'));break;case"descending":e.append(n('<span class="wijmo-wijgrid-sort-icon '+r.options.wijCSS.icon+" "+r.options.wijCSS.iconArrowDown+'">descending</span>'))}}else t.prototype._decorateHeaderContent.apply(this,arguments)},r.prototype._prepareFilterCell=function(){var t=this.options.visLeavesIdx,r=this._owner(),i=null,s,o,u=this,a,f=e.grid.HTML5InputSupport.getDefaultInputType(r._isMobileEnv(),this.options);if(t>=0){r=this._owner();if(!this.filterRow)throw"exception";i=n(e.grid.rowAccessor.getCell(this.filterRow,t)),this.$filterEditor=i.find("input"),i.bind(n.support.selectstart?"selectstart":"mousedown",function(e){e.stopPropagation()}),s=r.parse(this.options,e.grid.filterHelper.getSingleValue(this.options.filterValue));if(s===null||s==="undefined")switch(e.grid.getDataType(this.options)){case"boolean":s=!1;break;case"number":case"currency":case"datetime":s=0;break;default:s=""}o={culture:r.options.culture,disabled:r.options.disabled,decimalPlaces:function(e){var t=/^(n|p|c){1}(\d*)$/.exec(e);return t&&t[2]?parseInt(t[2],10):(t=/^(d){1}(\d*)$/.exec(e),t?0:2)}(this.options.dataFormatString)};switch(a=this._getInputEditorType(this.options)){case"date":f==="text"?this.$filterEditor.wijinputdate(n.extend(o,{date:s,dateFormat:this.options.dataFormatString||undefined,showTrigger:!0})):this._createHtmlEditor(this.$filterEditor,f,e.grid.HTML5InputSupport.toStr(s||new Date,f));break;case"mask":this.$filterEditor.wijinputmask({text:s+""});break;case"numberCurrency":this.$filterEditor.wijinputnumber(n.extend(o,{type:"currency",value:s}));break;case"numberNumber":f==="text"?this.$filterEditor.wijinputnumber(n.extend(o,{value:s})):this._createHtmlEditor(this.$filterEditor,f,e.grid.HTML5InputSupport.toStr(s,f));break;case"numberPercent":this.$filterEditor.wijinputnumber(n.extend(o,{type:"percent",value:s*100}));break;default:throw e.grid.stringFormat('Unsupported editor type: "{0}"',a)}i.find(".wijmo-wijgrid-filter-trigger").attr({role:"button","aria-haspopup":"true"}).bind("mouseenter."+this.widgetName,function(e){u.options.disabled||n(this).addClass(r.options.wijCSS.stateHover)}).bind("mouseleave."+this.widgetName,function(e){u.options.disabled||n(this).removeClass(r.options.wijCSS.stateHover+" "+r.options.wijCSS.stateActive)}).bind("mouseup."+this.widgetName,this,function(e){u.options.disabled||n(this).removeClass(r.options.wijCSS.stateActive)}).bind("mousedown."+this.widgetName,{column:this},this._onFilterBtnClick).bind("click."+this.widgetName,function(e){e.preventDefault()})}},r.prototype._createHtmlEditor=function(e,t,n){return e.wrap('<span class="wijgrid-input-wrapper"></span').attr("type",t).val(n)},r.prototype._onFilterBtnClick=function(t){var r=t.data.column,i=8,s=r._owner(),o,u,a,f,l,c,h,p,d,v=e.grid.HTML5InputSupport.getDefaultInputType(s._isMobileEnv(),r.options);if(r.options.disabled)return!1;if(r.$dropDownFilterList)return r._removeDropDownFilterList(),!1;t.target.focus(),o=e.grid.filterHelper.getSingleOperatorName(r.options.filterOperator).toLowerCase(),u=s.getFilterOperatorsByDataType(e.grid.getDataType(r.options)),a={operators:n.extend(!0,[],u),column:r.options},s._onFilterOperatorsListShowing(a),f=[],a.operators&&n.each(a.operators,function(e,t){f.push({label:t.displayName||t.name,value:t.name,selected:t.name.toLowerCase()===o})}),r.$dropDownFilterList=n('<div class="wijmo-wijgrid-filterlist"></div').appendTo(document.body).wijlist({autoSize:!0,maxItemsCount:i,selected:function(t,n){var i,o;switch(o=r._getInputEditorType(r.options)){case"date":v==="text"?i=r.$filterEditor.wijinputdate("option","date")||new Date:i=e.grid.HTML5InputSupport.parse(r.$filterEditor.val(),v)||new Date;break;case"mask":i=r.$filterEditor.wijinputmask("option","text");break;case"numberNumber":if(v!=="text"){i=e.grid.HTML5InputSupport.parse(r.$filterEditor.val(),v)||0;break};case"numberCurrency":case"numberPercent":i=r.$filterEditor.wijinputnumber("option","value"),o==="numberPercent"&&(i/=100)}r._removeDropDownFilterList(),s._handleFilter(r,n.item.value,i)}}),n.ui&&n.fn.zIndex&&(d=s.outerDiv.zIndex(),d&&d++),r.$dropDownFilterList.css("z-index",Math.max(d||0,9999)),r.$dropDownFilterList.wijlist("setItems",f).wijlist("renderList"),h=r.$dropDownFilterList.width()|150,r.$dropDownFilterList.width(f.length>i?h+20:h).wijlist("refreshSuperPanel").position({of:n(this),my:"left top",at:"left bottom"}),r.$dropDownFilterList.$button=n(this),p=r.$dropDownFilterList.eventUID=e.grid.getUID(),n(document).bind("mousedown."+r.widgetName+"."+p,{column:r},r._onDocMouseDown)},r.prototype._onDocMouseDown=function(e){var t=n(e.target),r=t.parents(".wijmo-wijgrid-filterlist:first"),i=t.is(".wijmo-wijgrid-filter-trigger")?t:t.parents(".wijmo-wijgrid-filter-trigger:first");i.length&&i[0]===e.data.column.$dropDownFilterList.$button[0]||r.length&&r[0]===e.data.column.$dropDownFilterList[0]||e.data.column._removeDropDownFilterList()},r.prototype._onHrefClick=function(e){if(e.data.options.disabled)return!1;if(e.data.options.allowSort){var t=e.data._owner();t._handleSort(e.data.options,e.ctrlKey)}return!1},r.prototype._removeDropDownFilterList=function(){if(this.$dropDownFilterList){var e=this.$dropDownFilterList.eventUID;this.$dropDownFilterList.remove(),this.$dropDownFilterList=null,n(document).unbind("mousedown."+this.widgetName+"."+e,this._onDocMouseDown)}},r.prototype._getInputEditorType=function(t){switch(e.grid.getDataType(t)){case"number":return t.dataFormatString&&t.dataFormatString.indexOf("p")===0?"numberPercent":"numberNumber";case"currency":return"numberCurrency";case"datetime":return"date";default:return"mask"}},r}(t.c1basefield);t.c1field=r;var i=function(e){function t(){e.apply(this,arguments),this.aggregate="none",this.allowSort=!0,this.dataType=undefined,this.inputType=undefined,this.dataParser=undefined,this.dataFormatString=undefined,this.filterOperator="nofilter",this.filterValue=undefined,this.groupInfo={expandInfo:[],level:undefined,groupSingleRow:!0,collapsedImageClass:n.wijmo.wijCSS.iconArrowRight,expandedImageClass:n.wijmo.wijCSS.iconArrowRightDown,position:"none",outlineMode:"startExpanded",headerText:undefined,footerText:undefined},this.readOnly=!1,this.rowMerge="none",this.showFilter=!0,this.sortDirection="none",this.valueRequired=!1}return __extends(t,e),t}(t.c1basefield_options);t.c1field_options=i,r.prototype.options=e.grid.extendWidgetOptions(t.c1basefield.prototype.options,new i),n.wijmo.registerWidget("c1field",n.wijmo.c1basefield,r.prototype)})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype._create=function(){e.prototype._create.apply(this,arguments);var t=this._owner();this.element.addClass(t.options.wijCSS.widget+" wijmo-c1band")},t.prototype._canDropTo=function(t){return e.prototype._canDropTo.apply(this,arguments)?!(t instanceof n.wijmo.c1groupedfield):!1},t}(t.c1basefield);t.c1band=r;var i=function(e){function t(){e.apply(this,arguments),this.columns=[]}return __extends(t,e),t}(t.c1field_options);r.prototype.options=e.grid.extendWidgetOptions(t.c1basefield.prototype.options,new i),n.wijmo.registerWidget("c1band",n.wijmo.c1basefield,r.prototype)})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(t){function r(){t.apply(this,arguments)}return __extends(r,t),r.prototype._create=function(){var t=n.data(this.element[0],"wijgridowner");this._field("owner",t),e.grid.widgetName(this.element[0],this.widgetFullName),this._destroyed=!1,this.element.addClass("wijmo-wijgrid-group-button "+t.options.wijCSS.stateDefault+" "+t.options.wijCSS.cornerAll),this.options.disabled&&this.disable(),t.options.allowColMoving&&t._UIDragndrop(!0).attach(this)},r.prototype._init=function(){this._refreshHeaderCell()},r.prototype.destroy=function(){try{t.prototype.destroy.apply(this,arguments)}finally{this._destroyed=!0}},r.prototype._destroy=function(){if(this._isDestroyed())return;this.element.find("*").unbind("."+this.widgetName);var t=this._owner();t&&t._dragndrop(!1)&&t._dragndrop(!1).detach(this),e.grid.remove$dataByPrefix(this.element,this._data$prefix)},r.prototype._field=function(t,n){return e.grid.dataPrefix(this.element,this._data$prefix,t,n)},r.prototype._removeField=function(e){var t=this._data$prefix+e;this.element.removeData(t)},r.prototype._setOption=function(e,n){var r=this["_preset_"+e],i=this.options[e],s,o;r!==undefined&&(n=r.apply(this,[n,i])),s=n!==i,t.prototype._setOption.apply(this,[e,n]),s&&(o=this["_postset_"+e],o!==undefined&&o.apply(this,[n,i]))},r.prototype._postset_headerText=function(e,t,n){this._refreshHeaderCell()},r.prototype._postset_allowSort=function(e,t,n){this._refreshHeaderCell()},r.prototype._owner=function(){return this._field("owner")},r.prototype._canSize=function(){return this.options.allowSizing&&this._owner().options.allowColSizing},r.prototype._canDrag=function(){return this.options.allowMoving===!0},r.prototype._canDropTo=function(t){return t instanceof n.wijmo.c1groupedfield?e.grid.isChildOf(this._owner().options.columns,t,this)?!1:!0:!1},r.prototype._canSort=function(){var e=this._owner();return e&&e.options.allowSorting&&this.options.allowSort&&this.options.dataIndex>=0},r.prototype._refreshHeaderCell=function(){var e=this._owner().options.wijCSS,t=n('<span class="wijmo-wijgrid-group-button-close '+e.stateDefault+" "+e.cornerAll+'"><span class="'+e.icon+" "+e.iconClose+'"></span></span>').bind("click."+this.widgetName,this,this._onCloseClick);this.element.html(this.options.headerText||"").prepend(t).bind("click."+this.widgetName,this,n.proxy(this._onHrefClick,this));if(this._canSort())switch(this.options.sortDirection){case"ascending":this.element.append(n('<span class="wijmo-wijgrid-group-button-sort '+e.icon+" "+e.iconArrowUp+'"></span>'));break;case"descending":this.element.append(n('<span class="wijmo-wijgrid-group-button-sort '+e.icon+" "+e.iconArrowDown+'"></span>'))}},r.prototype._onCloseClick=function(e){var t=e.data.options;return t.disabled||e.data._owner()._handleUngroup(e.data.options.travIdx),!1},r.prototype._onHrefClick=function(t){var n=t.data._owner(),r=t.data.options,i;return!r.disabled&&r.allowSort&&(i=e.grid.search(n.columns(),function(e){return e.options.travIdx===r.travIdx}),i=i.found?i.found.options:e.grid.getColumnByTravIdx(n.options.columns,r.travIdx).found,i&&n._handleSort(i,t.ctrlKey)),!1},r.prototype._isDestroyed=function(){return this._destroyed},r}(e.wijmoWidget);t.c1groupedfield=r,r.prototype._data$prefix="c1groupedfield",r.prototype.options=n.extend(!0,{},e.wijmoWidget.prototype.options,{wijMobileCSS:{header:"ui-header ui-bar-a",content:"ui-body-c",stateDefault:"ui-btn-up-c",stateHover:"ui-btn-down-c",stateActive:"ui-btn-down-c"},allowMoving:!0,allowSort:!0,headerText:undefined,sortDirection:"none"}),n.wijmo.registerWidget("c1groupedfield",r.prototype)})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){"use strict";function i(e){var t=[];return s(e,t),t}function s(e,t){var n,r,i,o;if(e)for(n=0,r=e.length;n<r;n++)i=e[n],i.options&&(i=i.options),o=i.columns,o&&o.length?s(o,t):t.push(i)}function o(e,t){var n,r,i,s=null;if(e&&t>=0)for(n=0,r=e.length;n<r&&!s;n++){i=e[n],i.options&&(i=i.options);if(i.travIdx===t)return{found:i,at:e};i.columns&&(s=this.getColumnByTravIdx(i.columns,t))}return s}function u(e,t,n){t.options&&(t=t.options),n.options&&(n=n.options);if(n.isBand&&t.parentIdx>=0){if(t.parentIdx===n.travIdx)return!0;if(t.parentIdx>n.travIdx){var r=this.flatten(e);for(;;){t=r[t.parentIdx];if(t.travIdx===n.travIdx)return!0;if(t.parentIdx===-1)break}}}return!1}function a(e){var t=[];return f(e,t),t}function f(e,t){var n,r,i;if(e)for(n=0,r=e.length;n<r;n++)i=e[n],i.isLeaf&&t.push(i),i.columns&&f(i.columns,t)}function l(e){return c(e,0,-1)}function c(e,t,n){var r,i,s;if(e)for(r=0,i=e.length;r<i;r++)s=e[r],s.options&&(s=s.options),s.linearIdx=r,s.travIdx=t++,s.parentIdx=n,s.columns&&(t=c(s.columns,t,t-1));return t}function h(t){var n=[];return e.grid.traverse(t,function(e){n.push(e)}),n}function p(t,r){var i,s,o;if(t&&n.isFunction(r))for(i=0;i<t.length;i++){o=t[i],o.options&&(o=o.options),s=t.length,r(o,t);if(t.length!==s){i--;continue}o.columns&&e.grid.traverse(o.columns,r)}}var n=jQuery,r=function(){function t(){}return t.prototype.generateSpanTable=function(e,t){this._height=this._width=this._inc=this._shift=0,this._table=[],this._traverseList=[],this._savedXPos=[];var n=this._generateSpanTable(e,t,!0);return n},t.prototype._generateSpanTable=function(t,n,r){var i,s,o=this;this._height=this.getVisibleHeight(t,r),n=n||[],e.grid.traverse(t,function(e){e.isLeaf&&n.push(e),o._traverseList.push(e)}),this._width=n.length;for(i=0;i<this._height;i++){this._table[i]=[];for(s=0;s<this._width;s++)this._table[i][s]={column:null,colSpan:0,rowSpan:0}}return this._setTableValues(t,0,0),this._table},t.prototype.getVisibleHeight=function(e,t){var r,i,s,o,u=0;if(n.isArray(e))for(r=0,i=e.length;r<i;r++)o=this.getVisibleHeight(e[r],t),u=Math.max(u,o);else{s=e.visible===undefined?!0:e.visible,e.parentVis=s&&t;if(e.isBand){for(r=0,i=e.columns.length;r<i;r++)o=this.getVisibleHeight(e.columns[r],e.parentVis),u=Math.max(u,o);if(!e.parentVis)return u;e.isLeaf=u===0,u++}else e.isLeaf=!0,e.parentVis&&(u=1)}return u},t.prototype._getVisibleParent=function(e){while(e){e=this._traverseList[e.parentIdx];if(e&&(e.parentVis||e.parentVis===undefined))return e}return null},t.prototype._setTableValues=function(e,t,r){var i,s,o,u,a,f;if(n.isArray(e))for(i=0,s=e.length;i<s;i++)this._setTableValues(e[i],t,r);else{if(e.travIdx===undefined)throw"undefined travIdx";o=r+this._shift,e.parentVis&&(u=o+this._inc,this._table[t][u].column=e,this._savedXPos[e.travIdx]=u);if(e.isBand)for(i=0,s=e.columns.length;i<s;i++)this._setTableValues(e.columns[i],t+1,r);e.parentVis?this._shift-o===0?(this._table[t][this._savedXPos[e.travIdx]].rowSpan=this._height-t,this._shift++):this._table[t][this._savedXPos[e.travIdx]].colSpan=this._shift-o:!e.isBand&&this._height>0&&(f=this._getVisibleParent(e),a=f?f.isLeaf:!1,a&&this._inc++,t>=this._height&&(t=this._height-1),u=r+this._shift+this._inc,this._table[t][u].column=e,a||(f&&this._savedXPos[f.travIdx]===u&&this._shiftTableElements(u,t),this._inc++))}},t.prototype._shiftTableElements=function(e,t){var n;for(n=0;n<t;n++)this._table[n][e+1]=this._table[n][e],this._table[n][e]={column:null,colSpan:0,rowSpan:0},this._table[n][e+1].column&&this._savedXPos[this._table[n][e+1].column.travIdx]++},t}();t.bandProcessor=r,t.getAllLeaves=i,t.getColumnByTravIdx=o,t.isChildOf=u,t.getLeaves=a,t.setTraverseIndex=l,t.flatten=h,t.traverse=p})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(){function t(t){this._dvFilteringSettings=undefined,this._dvPagingSettings=undefined,this._dvSortingSettings=undefined,this._wgFilteringSettings=undefined,this._wgPagingSettings=undefined,this._wgSortingSettings=undefined;if(!t)throw"exception";this._wijgrid=t,this._dataView=t._dataViewWrapper.dataView(),this._filterCache=new e.grid.filterOperatorsCache(t)}return t.prototype.compareSettings=function(){var t=!0,n,r,i,s;t=(n=this.DVPagingSettings())===(r=this.WGPagingSettings()),!t&&n&&r&&(t=n.pageSize===r.pageSize&&n.pageIndex===r.pageIndex);if(t){t=(n=this.DVSortingSettings())===(r=this.WGSortingSettings());if(!t&&n&&r&&(s=n.length)===r.length){t=!0;for(i=0;i<s&&t;i++)t=n[i].dataKey===r[i].dataKey&&n[i].sortDirection===r[i].sortDirection}}return t&&(n=this.DVFilteringSettings(),r=this.WGFilteringSettings(),t=e.grid.compareObj(n,r)),t},t.prototype.DVFilteringSettings=function(){function e(t,r){var i;n.each(t,function(t,s){typeof s=="string"?i=s:n.isArray(s)?e(s,r):(r.filterValue.push(s.value),r.filterOperator.push({name:s.originalOperator||s.operator,condition:i}))})}if(this._dvFilteringSettings===undefined){var t=[],r=this._dataView.filter();r&&n.each(r,function(r,i){var s={dataKey:r};n.isArray(i)?(s.filterValue=[],s.filterOperator=[],e(i,s)):n.isPlainObject(i)?(s.filterValue=i.value,s.filterOperator=i.originalOperator||i.operator||"Equals"):(s.filterValue=i,s.filterOperator="Equals"),t.push(s)}),this._dvFilteringSettings=t.length?t:null}return this._dvFilteringSettings},t.prototype.DVPagingSettings=function(){if(this._dvPagingSettings===undefined){var t=e.grid.asPagedDataView(this._dataView);if(t){var n=t.pageSize();this._dvPagingSettings=n>0?{pageSize:t.pageSize(),pageIndex:t.pageIndex()}:null}}return this._dvPagingSettings},t.prototype.DVSortingSettings=function(){if(this._dvSortingSettings===undefined){var t=[],r=e.data.sorting.compile(this._dataView.sort()).normalized;r&&n.each(r,function(e,n){n!==null&&t.push({dataKey:typeof n=="string"?n:n.property,sortDirection:n.asc||n.asc===undefined?"ascending":"descending"})}),this._dvSortingSettings=t.length?t:null}return this._dvSortingSettings},t.prototype.WGFilteringSettings=function(){if(this._wgFilteringSettings===undefined){var t=[],r=this._wijgrid._field("leaves"),i=this;r&&n.each(r,function(n,r){if(e.grid.validDataKey(r.dataKey)&&r.filterOperator){var s=e.grid.deepExtend({},{foo:r.filterValue}).foo,o=e.grid.deepExtend({},{foo:r.filterOperator}).foo,u=e.grid.filterHelper.verify(o,s,r.dataType,i._filterCache);u&&t.push({owner:r,dataKey:r.dataKey,filterValue:u.filterValue,filterOperator:u.filterOperator})}}),this._wgFilteringSettings=t.length?t:null}return this._wgFilteringSettings},t.prototype.WGPagingSettings=function(){return this._wgPagingSettings===undefined&&(this._wgPagingSettings=this._wijgrid.options.allowPaging?{pageSize:this._wijgrid.options.pageSize,pageIndex:this._wijgrid.options.pageIndex}:null),this._wgPagingSettings},t.prototype.WGSortingSettings=function(){if(this._wgSortingSettings===undefined){var t={},r=[],i=this._wijgrid._groupedColumns(!0),s=this._wijgrid._field("leaves")||[],o=function(t){return!t.isBand&&t.allowSort&&e.grid.validDataKey(t.dataKey)},u=0;this._wijgrid.options.allowSorting&&(n.each(i,function(e,n){o(n)&&(n.sortDirection==="none"&&(n.sortDirection="ascending"),t[n.dataKey]={dataKey:n.dataKey,sortDirection:n.sortDirection,sortOrder:u++})}),u++,n.each(s,function(e,n){o(n)&&(n.sortDirection==="ascending"||n.sortDirection==="descending")&&(t[n.dataKey]||(t[n.dataKey]={dataKey:n.dataKey,sortDirection:n.sortDirection,sortOrder:(n.sortOrder||0)+u}))}),n.each(t,function(e,t){r.push(t)}),r.sort(function(e,t){return e.sortOrder-t.sortOrder}),n.each(r,function(e,t){delete t.sortOrder})),this._wgSortingSettings=r.length?r:null}return this._wgSortingSettings},t.prototype.MapWGToDV=function(){var t=this,r={},i,s;this._mapPagingParams()&&(i=this.WGPagingSettings())?(r.pageIndex=i.pageIndex,r.pageSize=i.pageSize):r.pageSize=-1;if(this._mapSortingParams()){r.sort=[];if(i=this.WGSortingSettings())r.sort=[],n.each(i,function(e,t){r.sort.push({property:t.dataKey,asc:t.sortDirection==="ascending"})})}this._wijgrid.deficientFilters={};if(this._mapFilteringParams()){n.each(this._wijgrid._field("leaves"),function(n,r){e.grid.validDataKey(r.dataKey)&&r.filterOperator===undefined^r.filterValue===undefined&&(t._wijgrid.deficientFilters[r.dataKey]={filterOperator:r.filterOperator,filterValue:r.filterValue})}),r.filter={};if(i=this.WGFilteringSettings())r.filter=this._convertFilterToDV(i);n.isEmptyObject(r.filter)&&(r.filter=null)}return r},t.prototype.MapDVToWG=function(){var t,r={},i=this._mapSortingParams(),s=this._mapPagingParams(),o=this._mapFilteringParams(),u=e.grid.asPagedDataView(this._dataView),a=this;n.each(this._wijgrid._field("leaves"),function(e,t){i&&(t.sortOrder=0,t.sortDirection="none"),o&&(t.filterOperator="nofilter",t.filterValue=undefined),r[t.dataKey]=t}),s&&u&&(this._wijgrid.options.pageSize=u.pageSize(),this._wijgrid.options.pageIndex=u.pageIndex()),i&&(t=this.DVSortingSettings())&&n.each(t,function(e,t){var n;if(n=r[t.dataKey])n.sortDirection=t.sortDirection,n.sortOrder=e}),o&&((t=this.DVFilteringSettings())&&n.each(t,function(e,t){var i;if(i=r[t.dataKey])i.filterValue=t.filterValue,i.filterOperator=t.filterOperator,n.isPlainObject(i.filterOperator)&&(i.filterOperator=i.filterOperator.name),delete a._wijgrid.deficientFilters[i.dataKey]}),n.each(this._wijgrid.deficientFilters,function(e,t){r[e].filterOperator=t.filterOperator,r[e].filterValue=t.filterValue}))},t.prototype._mapPagingParams=function(){return this._wijgrid.options.allowPaging&&!this._wijgrid._customPagingEnabled()&&!this._wijgrid._serverShaping()},t.prototype._mapSortingParams=function(){return this._wijgrid.options.allowSorting&&!this._wijgrid._serverShaping()},t.prototype._mapFilteringParams=function(){return!this._wijgrid._serverShaping()},t.prototype.makeProxyFilter=function(t,r,i,s){i=i.toLowerCase();var o=this,u=t.dataType==="datetime",a={originalOperator:undefined,property:r,operator:i,value:s},f=this._filterCache.getByNameInt(i),l=e.data.filtering.ops[i];if(i!=="nofilter"&&(f.isCustom||u)){a.originalOperator=a.operator;if(f.isCustom)a.operator=n.extend(!0,{},f.op),a.operator.apply=a.operator.operator;else{a.operator=n.extend(!0,{},l);var c=t.inputType?e.grid.TimeUnitConverter.convertInputType(t.inputType):e.grid.TimeUnitConverter.convertFormatString(t.dataFormatString||"d");a.operator.apply=function(n,r){return n instanceof Date||(n=o._wijgrid.parse(t,n)),r instanceof Date||(r=o._wijgrid.parse(t,r)),e.grid.TimeUnitConverter.cutDate(n,c),e.grid.TimeUnitConverter.cutDate(r,c),l.apply(n,r)}}}return a},t.prototype._convertFilterToDV=function(e){var t={},r=this;return n.each(e,function(e,i){var s=i.dataKey,o=[],u="and",a,f,l,c;if(!n.isPlainObject(i))return;f=i.filterOperator,l=i.filterValue;if(f==null)return;n.isArray(f)||(f=[f]),n.isArray(l)||(l=[l]);if(f.length!=l.length)throw"The number of filter operators must match the number of filter values";if(f.length==0)return;n.each(f,function(e,t){function h(){c.length>1?c.splice(0,0,"or"):c=c[0]}function p(){u==null&&(u=a,o.splice(0,0,a))}var f;typeof t=="string"&&(t={name:t});if(!n.isPlainObject(t)||!t.name)throw"Invalid filter operator";f=l[e],n.isArray(f)||(f=[f]),c=n.map(f,function(e){return r.makeProxyFilter(i.owner,s,t.name,e)}),u=null,a=t.condition||"or",o.length<=1||u==a?c.length==1||o.length<=1||u=="or"?(o=o.concat(c),p()):(h(),o.push(c),p()):(h(),o=[o,c],p())}),n.each(o,function(e,t){n.isArray(t)&&t.length==2&&(o[e]=t[1])}),o.length==2&&typeof (o[0]==="string")&&o.shift(),o.length==1&&(o=o[0]),t[s]=o}),t},t}();t.settingsManager=r})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){"use strict";function i(e){return e&&"pageCount"in e?e:null}function s(e){return e&&"commitEdit"in e?e:null}var n=jQuery,r=function(){function t(e){this._domSource=null,this._ignoreAllEvents=!1,this._ignoreChangeEvent=!1,this._ignoreCurrentChangedEvent=!1,this._sharedDataItems=null,this._userData=null,this._totals=null,this._changeTimer=0,this._toDispose=[],this._isOwnDataView=!1,this._isWijdatasource=!1,this._isDynamicWijdatasource=!1,this._wijgrid=e,this._createDataViewWrapper()}return t.prototype.data=function(){var t=this._getDataViewInst(),n=e.grid.asPagedDataView(t);return{data:this._getSharedDataItems(),totalRows:n!=null?n.totalItemCount():(t.getSource()||[]).length,totals:this._getTotals(),emptyData:this.isBoundedToDOM()?this._domSource.emptyData:null}},t.prototype.dataView=function(){return this._getDataViewInst()},t.prototype.dispose=function(){var e=this._getDataViewInst();this._propChangeListener.dispose(),n.each(this._toDispose,function(e,t){t.dispose()}),e&&this._isOwnDataView&&e.dispose(),this._wijgrid._wijDataView=null},t.prototype.ignoreChangeEvent=function(e){if(!arguments.length)return this._ignoreChangeEvent;this._ignoreChangeEvent=e===!0},t.prototype.ignoreCurrentChangedEvent=function(e){if(!arguments.length)return this._ignoreCurrentChangedEvent;this._ignoreCurrentChangedEvent=e===!0},t.prototype.isDataLoaded=function(){var e=this._getDataViewInst();return e.isLoaded()},t.prototype.isOwnDataView=function(){return this._isOwnDataView},t.prototype.getFieldsInfo=function(){var e=this._getDataViewInst();return this._propDescriptorsToFieldsInfo(e.getProperties())},t.prototype._propDescriptorsToFieldsInfo=function(e){var t={};return e&&n.each(e,function(e,n){if(n.name==="$$hash")return;t[n.name]={name:n.name,type:n.type||"string"}}),t},t.prototype.isBoundedToDOM=function(){return this._domSource!==null},t.prototype.load=function(t){this._userData=t;var n=this._getDataViewInst();n||(this._createDataViewWrapper(),n=this._getDataViewInst()),this._onDataViewLoading();var r=new e.grid.settingsManager(this._wijgrid);if(this._needToLoad(r)){var i=r.MapWGToDV(),s=!1;this._isWijdatasource&&!this._isDynamicWijdatasource&&n.isLoaded()&&(s=!0),this.ignoreCurrentChangedEvent(!0),n.refresh(i,s)}else this.isDataLoaded()&&(this._onDataViewLoaded(),this._onDataViewReset())},t.prototype.currentPosition=function(e){var t=this._getDataViewInst();if(!arguments.length)return t.currentPosition();this.ignoreCurrentChangedEvent(!0);try{t.currentPosition(e)}finally{this.ignoreCurrentChangedEvent(!1)}},t.prototype.getValue=function(e,t){var n=this._getDataViewInst();return typeof t=="number"&&(t+=""),n.getProperty(e,t)},t.prototype.setValue=function(e,t,n){var r=this._getDataViewInst();this.ignoreChangeEvent(!0);try{typeof t=="number"&&(t+=""),r.setProperty(e,t,n)}finally{this.ignoreChangeEvent(!1)}},t.prototype.makeDirty=function(){this._propChangeListener.removeAll(),this._totals=null,this._sharedDataItems=null},t.prototype._createDataViewWrapper=function(){var t,r=this._wijgrid.options.data,i=this._getDataViewInst(),s=!1;if(i)return;r||(this._domSource=this._processDOM(this._wijgrid.element,this._wijgrid.options.readAttributesFromData),r=this._domSource.items),s=typeof wijdatasource!="undefined"&&r instanceof wijdatasource,this._isOwnDataView=n.isArray(r)||s,this._isWijdatasource=!!this._isOwnDataView&&!!s,this._isDynamicWijdatasource=!!(this._isOwnDataView&&s&&r.dynamic);if(this._isOwnDataView){!this._domSource&&this._wijgrid.options.readAttributesFromData&&this._moveAttributesToExpando(r);var o=this.isBoundedToDOM()&&e.grid.getTableSection(this._wijgrid.element,e.grid.rowScope.body);i=e.grid.GridDataView.create(e.data.asDataView(this._parseOwnData(r,o)))}else i=r;this._wijgrid._wijDataView=i,this._toDispose.push(i.isLoading.subscribe(n.proxy(this._onDataViewLoadingInternal,this))),this._toDispose.push(i.isLoaded.subscribe(n.proxy(this._onDataViewLoadedInternal,this))),this._toDispose.push(i.subscribe(n.proxy(this._onDataViewChangeInternal,this))),this._toDispose.push(i.currentPosition.subscribe(n.proxy(this._onDataViewCurrentChangedInternal,this))),this._propChangeListener=new e.grid.propChangeListener(n.proxy(this._onPropertyChanged,this))},t.prototype._parseOwnData=function(t,r){var i=this;if(t&&t.length){var s=n.extend(!0,[],this._wijgrid.options.columns),o=e.data.ArrayDataViewBase._getProps(t[0])||[],u=this._propDescriptorsToFieldsInfo(o),a=[];this._wijgrid._prepareColumnOptions(s,"merge",u,!0,!0),e.grid.traverse(s,function(t){e.grid.validDataKey(t.dataKey)&&a.push(t)}),s.length&&n.each(t,function(t,n){e.grid.dataViewWrapper._parseDataItem(i._wijgrid,n,r&&r.rows[t],a)})}return t},t._parseDataItem=function(r,i,s,o){return n.each(o,function(t,n){if(e.grid.getDataType(n)!=="string"&&e.grid.validDataKey(n.dataKey)){var o=i[n.dataKey],u=r.parse(n,o);if(isNaN(u)){var a=null;s&&(a=s.cells[n.dataKey]),u=r.parseFailed(n,o,i,a)}i[n.dataKey]=u}}),i},t.prototype._getDataViewInst=function(){return this._wijgrid._wijDataView},t.prototype._needToLoad=function(e){var t=this._getDataViewInst();return this._isDynamicWijdatasource||this._isWijdatasource&&!t.isLoaded()?!0:this._isOwnDataView&&!this._isWijdatasource&&this.isDataLoaded()?!0:this.isDataLoaded()||t.isLoading()?!e.compareSettings():!0},t.prototype._validateSettings=function(e){if(!this._isOwnDataView&&this._wijgrid.options.allowPaging&&(e.DVPagingSettings()||{}).pageSize!==(e.WGPagingSettings()||{}).pageSize)throw"The pageSize option of the external dataView can't be changed."},t.prototype._onDataViewLoadingInternal=function(e){if(this._ignoreAllEvents)return;e&&(this._userData||this._onDataViewLoading())},t.prototype._onDataViewLoadedInternal=function(e){if(this._ignoreAllEvents)return;e&&this._onDataViewLoaded()},t.prototype._onDataViewChangeInternal=function(e){var t=this;if(this._ignoreAllEvents||this._ignoreChangeEvent)return;if(e.changes){if(e.length&&e[0].entityState()==="detached")return;n.each(e.changes,function(e,n){switch(n.changeType){case"remove":t._propChangeListener.remove(n.index);break;case"add":t._propChangeListener.insert(n.index,n.element)}})}this._onDataViewChange.apply(this,arguments)},t.prototype._onDataViewCurrentChangedInternal=function(){if(this._ignoreAllEvents||this._ignoreCurrentChangedEvent)return;this._onDataViewCurrentChanged.apply(this,arguments)},t.prototype._onDataViewReset=function(){try{this.ignoreCurrentChangedEvent(!1),this.makeDirty(),this._wijgrid._onDataViewReset(this._userData)}finally{this._userData=null}},t.prototype._onPropertyChanged=function(e){var t=this;this._changeTimer>0&&(window.clearTimeout(this._changeTimer),this._changeTimer=0),this._changeTimer!=-1&&(this._changeTimer=window.setTimeout(function(){t._changeTimer=-1,t._wijgrid._destroyed||t._onDataViewChange(),t._changeTimer=0},100))},t.prototype._onDataViewChange=function(e){this._onDataViewReset()},t.prototype._onDataViewCurrentChanged=function(e,t){this._wijgrid._onDataViewCurrentPositionChanged(e,t)},t.prototype._onDataViewLoading=function(){this._wijgrid._onDataViewLoading()},t.prototype._onDataViewLoaded=function(){this._wijgrid._onDataViewLoaded()},t.prototype._getSharedDataItems=function(){if(!this._sharedDataItems){var e=this._getDataViewInst(),t=e.count();this._sharedDataItems=[];var n=!0;for(var r=0;r<t;r++){var i=e.item(r);n&&!this._propChangeListener.insert(r,i)&&r===0&&(n=!1),this._sharedDataItems.push(this._wrapDataItem(i,r))}}return this._sharedDataItems||(this._sharedDataItems=[]),this._sharedDataItems},t.prototype._getTotals=function(){if(!this._totals){var e=this._getDataViewInst();this._totals=this._prepareTotals(e,this._wijgrid._prepareTotalsRequest(!0))}return this._totals||(this._totals={}),this._totals},t.prototype._prepareTotals=function(t,n){if(!n||n.length===0)return{};var r,i,s,o,u=[],a={};for(r=0,i=n.length;r<i;r++)u.push(new e.grid.tally);for(r=0,i=t.count();r<i;r++)for(s=0,o=u.length;s<o;s++)u[s].add(this._wijgrid.parse(n[s].column,this.getValue(r,n[s].column.dataKey)));for(r=0,i=u.length;r<i;r++)a[n[r].column.dataKey]=u[r].getValueString(n[r].column);return a},t.prototype._processDOM=function(t,r){var i={items:[],emptyData:[],header:e.grid.readTableSection(t,e.grid.rowScope.head)};return e.grid.getTableSectionLength(t,2)===1&&n(e.grid.getTableSectionRow(t,2,0)).hasClass("wijmo-wijgrid-emptydatarow")?i.emptyData=e.grid.readTableSection(t,e.grid.rowScope.body):i.items=e.grid.readTableSection(t,e.grid.rowScope.body,r),i},t.prototype._moveAttributesToExpando=function(t){n.each(t,function(t,r){var i=e.data.Expando.getFrom(r,!0),s;s=i[e.grid.EXPANDO]={cellsAttributes:{},rowAttributes:{}},r.rowAttributes&&(s.rowAttributes=r.rowAttributes,delete r.rowAttributes),n.each(r,function(e,t){n.isArray(t)&&(s.cellsAttributes[e]=t[1],r[e]=t[0])})})},t.prototype._wrapDataItem=function(e,t){return{values:e,originalRowIndex:t}},t.prototype._refreshSilent=function(){var e=this._getDataViewInst();if(e)try{this._ignoreAllEvents=!0,e.refresh()}finally{this._ignoreAllEvents=!1}},t.prototype._unsafeReplace=function(t,n){var r=this._getDataViewInst();r instanceof e.grid.GridDataView||"operation is not supported",r._unsafeReplace(t,n)},t.prototype._unsafeSplice=function(t,n,r){var i=this._getDataViewInst();i instanceof e.grid.GridDataView||"operation is not supported",arguments.length===2?i._unsafeSplice(t,n):i._unsafeSplice(t,n,r)},t.prototype._unsafePush=function(t){var n=this._getDataViewInst();n instanceof e.grid.GridDataView||"operation is not supported",n._unsafePush(t)},t}();t.dataViewWrapper=r,t.asPagedDataView=i,t.asEditableDataView=s;var o=function(){function e(e){this._subscriptions=[],this._callback=e}return e.prototype.insert=function(e,t){var r=null,i=this;return n.each(t,function(e,t){i._isValidPropName(e)&&t&&n.isFunction(t.subscribe)&&(r=r||[],r.push(t.subscribe(i._callback)))}),r?(this._subscriptions.length<e&&(this._subscriptions.length=e),this._subscriptions.splice(e,0,r),!0):!1},e.prototype.remove=function(e){var t=this._subscriptions[e];t&&n.each(t,function(e,n){n.dispose(),t[e]=null}),this._subscriptions[e]=null,this._subscriptions.splice(e,1)},e.prototype.removeAll=function(){var e,t;while(e=this._subscriptions.length)this.remove(e-1);this._subscriptions=[]},e.prototype.dispose=function(){this.removeAll()},e.prototype._isValidPropName=function(e){return e&&typeof e=="string"?e.match(/^entityState|jQuery/)===null:!0},e}();t.propChangeListener=o})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(){function r(t,n,r,i,s){this.cr=new e.grid.cellRange(-1,-1),this.isExpanded=!1,this._value=-1,this._sum=-1,this._position="none",this._hasHeaderOrFooter=!0,t!==undefined&&(this.isExpanded=t),n!==undefined&&(this.cr=n),r!==undefined&&(this._sum=r),i!==undefined&&(this._position=i),s!==undefined&&(this._hasHeaderOrFooter=s)}return r.prototype.isSubRange=function(e){return this.cr.r1>=e.cr.r1&&this.cr.r2<=e.cr.r2},r.prototype.toString=function(){return this.cr.r1+"-"+this.cr.r2},r.prototype.getHeaderImageClass=function(e){var n=this.owner;return n?e?n.expandedImageClass||t.c1field.prototype.options.groupInfo.expandedImageClass:n.collapsedImageClass||t.c1field.prototype.options.groupInfo.collapsedImageClass:null},r.prototype.collapse=function(){var t,n,r,i,s;(t=this.owner)&&(n=t.owner)&&(r=n.owner)&&(i=r._field("leaves"),e.grid.groupHelper.isParentExpanded(i,this.cr,t.level)&&t.position!=="footer"&&t.outlineMode!=="none"&&(s=e.grid.groupHelper.getGroupedColumnsCount(i),this._collapse(r,r._rows(),i,this,s,r._allowVirtualScrolling())))},r.prototype.expand=function(t){var n,r,i,s,o;(n=this.owner)&&(r=n.owner)&&(i=r.owner)&&(s=i._field("leaves"),e.grid.groupHelper.isParentExpanded(s,this.cr,n.level)&&(o=e.grid.groupHelper.getGroupedColumnsCount(s),this._expand(i,i._rows(),s,this,o,t,!0,i._allowVirtualScrolling())))},r.prototype._collapse=function(t,n,r,i,s,o){var u=i.owner,a=i.cr.r1,f=i.cr.r2,l,c,h,p,d;switch(u.position){case"header":case"headerAndFooter":o?this._toggleSketchRowVisibility(t.sketchTable[i.cr.r1],undefined):this._toggleRowVisibility(n.item(i.cr.r1),undefined,!1),a++}for(l=a;l<=f;l++)o?this._toggleSketchRowVisibility(t.sketchTable[l],!1):this._toggleRowVisibility(n.item(l),!1);i.isExpanded=!1,o||this._updateHeaderIcon(n,i);for(l=u.level+1;l<=s;l++){h=e.grid.groupHelper.getChildGroupRanges(r,i.cr,l-1);for(d=0,c=h.length;d<c;d++){p=h[d],p.isExpanded=!1;switch(p.owner.position){case"header":case"headerAndFooter":o?this._toggleSketchRowVisibility(t.sketchTable[p.cr.r1],!1):this._toggleRowVisibility(n.item(p.cr.r1),undefined,!1)}o||this._updateHeaderIcon(n,p)}}},r.prototype._expand=function(t,n,r,i,s,o,u,a){var f=i.owner,l=i.cr.r1,c=i.cr.r2,h,p,d,v,m;switch(f.position){case"header":a?this._toggleSketchRowVisibility(t.sketchTable[l],!0):this._toggleRowVisibility(n.item(l),!0,u||o),l++;break;case"footer":a?this._toggleSketchRowVisibility(t.sketchTable[c],!0):this._toggleRowVisibility(n.item(c),!0),c--;break;case"headerAndFooter":a?this._toggleSketchRowVisibility(t.sketchTable[l],!0):this._toggleRowVisibility(n.item(l),!0,u||o),u&&(a?this._toggleSketchRowVisibility(t.sketchTable[c],!0):this._toggleRowVisibility(n.item(c),!0)),l++,c--}if(!u)return;i.isExpanded=!0,a||this._updateHeaderIcon(n,i);if(i.owner.level===s)for(h=l;h<=c;h++)a?this._toggleSketchRowVisibility(t.sketchTable[h],!0):this._toggleRowVisibility(n.item(h),!0);else{d=e.grid.groupHelper.getChildGroupRanges(r,i.cr,i.owner.level);if(d.length&&l!==d[0].cr.r1)for(h=l;h<d[0].cr.r1;h++)a?this._toggleRowVisibility(h,!0):this._toggleRowVisibility(n.item(h),!0);if(o)for(h=0,p=d.length;h<p;h++)v=d[h],this._expand(t,n,r,v,s,o,!0,a);else for(h=0,p=d.length;h<p;h++)v=d[h],m=v.owner.position==="footer"||v.owner.outlineMode==="none"?!0:!1,this._expand(t,n,r,v,s,!1,m,a)}},r.prototype._toggleRowVisibility=function(e,t,n){e&&(e[0]&&(t!==undefined&&(e[0].style.display=t?"":"none",e[0]["aria-hidden"]=t?"false":"true"),n!==undefined&&(e[0]["aria-expanded"]=n?"true":"false")),e[1]&&(t!==undefined&&(e[1].style.display=t?"":"none",e[1]["aria-hidden"]=t?"false":"true"),n!==undefined&&(e[1]["aria-expanded"]=n?"true":"false")))},r.prototype._toggleSketchRowVisibility=function(e,t){e&&t!==undefined&&(t?e.__style&&delete e.__style.display:e.__style?e.__style.display="none":e.__style={display:"none"})},r.prototype._updateHeaderIcon=function(e,t){if(t.owner.position!=="footer"){var r=e.item(t.cr.r1);r&&n.each(r,function(e,r){if(r){var i=n(r).find("div.wijmo-wijgrid-grouptogglebtn:first-child");i&&i.length&&(i.toggleClass(t.getHeaderImageClass(!t.isExpanded),!1),i.toggleClass(t.getHeaderImageClass(t.isExpanded),!0))}})}},r}();t.groupRange=r;var i=function(){function t(){this._groupRowIdx=0}return t.prototype.group=function(e,t,r){var i=this;this._grid=e,this._data=t,this._leaves=r,this._groupRowIdx=0,n.each(r,function(e,t){t.groupInfo&&(delete t.groupInfo.level,delete t.groupInfo.expandInfo)});var s=this._grid._groupedColumns(!0),o=1;n.each(s,function(e,t){i._groupRowIdx=0,t.groupInfo&&t.groupInfo.position&&t.groupInfo.position!=="none"&&t.dataIndex>=0&&(t.groupInfo.level=o,t.groupInfo.expandInfo=[],i._processRowGroup(t,o++))}),delete this._grid,delete this._data,delete this._leaves},t.prototype._processRowGroup=function(t,r){var i,s,o,u,a,f,l,c,h,p,d=0,v=!0;n.each(this._leaves,function(e,t){if(t.parentVis)return d=e,!1});for(i=0;i<this._data.length;i++){if(!(this._data[i].rowType&e.grid.rowType.data))continue;s=this._getGroupCellRange(i,t,r),o=!0,u=t.groupInfo.outlineMode==="startCollapsed";if(u||e.grid.groupHelper.isParentCollapsed(this._leaves,s,r)){if(t.groupInfo.groupSingleRow===!1&&s.r1===s.r2)continue;o=!1}if(r&&this._grid.options.groupIndent)for(a=s.r1;a<=s.r2;a++)this._addIndent(this._data[a][d],r);v=t.groupInfo.groupSingleRow!==!1||s.r1!==s.r2;switch(t.groupInfo.position){case"header":f=this._addGroupRange(t.groupInfo,s,o,v);for(p=s.r1;p<=s.r2;p++)this._data[p].__attr["aria-level"]=r+1,o||(this._data[p].__style.display="none",this._data[p].__attr["aria-hidden"]=!0);if(!v)break;this._updateByGroupRange(f,r),l=e.grid.groupHelper.isParentCollapsed(this._leaves,f.cr,r),c=this._buildGroupRow(f,s,!0,l),this._data.splice(s.r1,0,c),c.__attr["arial-level"]=r,c.__attr["aria-expanded"]=o,l&&(c.__style.display="none",c.__attr["aria-hidden"]=!0),i=s.r2+1;break;case"footer":f=this._addGroupRange(t.groupInfo,s,!0,v);if(!v)break;this._updateByGroupRange(f,r),h=this._buildGroupRow(f,s,!1,!1),h.__attr["aria-level"]=r,this._data.splice(s.r2+1,0,h),i=s.r2+1,l=e.grid.groupHelper.isParentCollapsed(this._leaves,f.cr,r),l&&(h.__style.display="none",h.__attr["aria-hidden"]=!0);break;case"headerAndFooter":f=this._addGroupRange(t.groupInfo,s,o,v);for(p=s.r1;p<=s.r2;p++)this._data[p].__attr["aria-level"]=r+1,o||(this._data[p].__style.display="none",this._data[p].__attr["aria-hidden"]=!0);if(!v)break;this._updateByGroupRange(f,r),l=e.grid.groupHelper.isParentCollapsed(this._leaves,f.cr,r),c=this._buildGroupRow(f,s,!0,l),h=this._buildGroupRow(f,s,!1,!1),this._data.splice(s.r2+1,0,h),h.__attr["aria-level"]=r;if(l||!o)h.__style.display="none",h.__attr["aria-hidden"]=!0;this._data.splice(s.r1,0,c),c.__attr["aria-level"]=r,c.__attr["aria-expanded"]=o,l&&(c.__style.display="none",c.__attr["aria-hidden"]=!0),i=s.r2+2;break;default:throw e.grid.stringFormat('Unknown Position value: "{0}"',t.groupInfo.position)}this._groupRowIdx++}},t.prototype._buildGroupRow=function(t,n,r,i){var s=t.owner,o=s.owner,u=o.owner,a=[],f="",l="",c,h,p,d,v,m,g,y;a.__style={},a.__attr={},a.__attr.id=(r?"GH":"GF")+this._groupRowIdx+"-"+s.level,a.rowType=r?e.grid.rowType.groupHeader:e.grid.rowType.groupFooter,o.dataIndex>=0&&(c=this._data[n.r1][o.dataIndex].value)!==null&&(f=u.toStr(o,c)),this._grid._showRowHeader()&&a.push({html:"&nbsp;"}),h={html:"",__attr:{},__style:{}},r&&s.outlineMode!=="none"&&(t.isExpanded?h.html='<div class="'+u.options.wijCSS.icon+" "+t.getHeaderImageClass(!0)+' wijmo-wijgrid-grouptogglebtn">&nbsp;</div>':h.html='<div class="'+u.options.wijCSS.icon+" "+t.getHeaderImageClass(!1)+' wijmo-wijgrid-grouptogglebtn">&nbsp;</div>'),a.push(h),o.aggregate&&o.aggregate!=="none"&&(l=this._getAggregate(n,o,o,r,f)),p=r?s.headerText:s.footerText;if(p==="custom")d={data:this._data,column:o,groupByColumn:s.owner,groupText:f,text:"",groupingStart:n.r1,groupingEnd:n.r2,isGroupHeader:r,aggregate:l},this._grid._trigger("groupText",null,d)&&(p=d.text);else{if(p===undefined||p===null){r&&(p="{1}: {0}");if(l||l===0)p=p?p+" {2}":"{2}"}p=e.grid.stringFormat(p,f,o&&o.headerText?o.headerText:"",l.toString())}p||(p="&nbsp;"),h.html+="<span>"+p+"</span>",this._addIndent(h,s.level-1),v=1,m=this._grid._showRowHeader()?1:0,g=!0;for(;m<this._leaves.length;m++){c=this._leaves[m];if(c.parentVis){if(g){g=!1;continue}if(c.dynamic!==!0&&c.aggregate&&c.aggregate!=="none")break;v++}}for(;m<this._leaves.length;m++)c=this._leaves[m],c.parentVis&&(y=this._getAggregate(n,c,s.owner,r,f),!y&&y!==0&&(y="&nbsp;"),a.push({html:y.toString(),__attr:{groupInfo:{leafIndex:c.leavesIdx,purpose:e.grid.groupRowCellPurpose.aggregateCell}}}));return h.__attr.colSpan=v,h.__attr.groupInfo={leafIndex:o.leavesIdx,purpose:e.grid.groupRowCellPurpose.groupCell},a},t.prototype._getAggregate=function(t,n,r,i,s){var o="",u,a,f;if(!n.aggregate||n.aggregate==="none")return o;if(n.aggregate==="custom")u={data:this._data,column:n,groupByColumn:r,groupText:s,text:"",groupingStart:t.r1,groupingEnd:t.r2,isGroupHeader:i},this._grid._trigger("groupAggregate",null,u)&&(o=u.text);else{a=new e.grid.tally;for(f=t.r1;f<=t.r2;f++)a.add(this._data[f][n.dataIndex].value);o=a.getValueString(n)}return o},t.prototype._getGroupCellRange=function(t,n,r){var i=n.leavesIdx,s=new e.grid.cellRange(t,i),o=e.grid.groupHelper.getParentGroupRange(this._leaves,s,r),u,a,f;if(this._data[t].rowType&e.grid.rowType.data){u=this._data[t][n.dataIndex].value,u instanceof Date&&(u=u.getTime());for(s.r2=t,f=this._data.length-1;s.r2<f;s.r2++){if(!(this._data[s.r2+1].rowType&e.grid.rowType.data)||o&&s.r2+1>o.cr.r2)break;a=this._data[s.r2+1][n.dataIndex].value,a instanceof Date&&(a=a.getTime());if(u!==a)break}}return s},t.prototype._addGroupRange=function(t,n,r,i){var s=null,o=e.grid.groupHelper.getChildGroupIndex(n,t.expandInfo),u,a,f,l;return o>=0&&o<t.expandInfo.length?s=t.expandInfo[o]:(u=new e.grid.cellRange(n.r1,n.r1,n.r2,n.r2),a=t.position==="footer"||!i?!0:r&&t.outlineMode!=="startCollapsed",s=new e.grid.groupRange(a,u,-1,t.position,i),s.owner=t,t.expandInfo.push(s)),s&&i&&(f=n.r1,l=n.r2,t.position==="headerAndFooter"&&(l+=2),t.position!=="headerAndFooter"&&l++,s.cr.r2=l),s},t.prototype._updateByGroupRange=function(e,t){var n,r,i,s,o,u,a;for(n=0,r=this._leaves.length;n<r;n++){i=this._leaves[n].groupInfo;if(i&&i.level<t){s=i.expandInfo?i.expandInfo.length:0;for(o=0;o<s;o++)u=i.expandInfo[o],a=e.position==="headerAndFooter"?2:1,u.cr.r1>=e.cr.r1&&(u.cr.r1!==e.cr.r1||u.position!=="footer")&&(u.cr.r1+=a),u.cr.r2>=e.cr.r1&&(u.cr.r2+=a)}}},t.prototype._addIndent=function(e,t){var n;t>0&&(n=this._grid.options.groupIndent)&&(e.__style.paddingLeft=n*t+"px")},t}();t.grouper=i})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(){function t(){}return t._getGroupInfoRegExp=new RegExp(".*G([HF]){1}(\\d+)-(\\d+)$"),t.getGroupInfo=function(n){if(n){var r=e.grid.groupHelper._getGroupInfoRegExp.exec(n.id),i,s,o;if(r)return i=parseInt(r[3],10),s=parseInt(r[2],10),o=r[1]==="H",{level:i,index:s,isHeader:o,toString:function(){return(o?"GH":"GF")+s+"-"+i}}}return null},t.getColumnByGroupLevel=function(t,n){var r,i,s;for(r=0,i=t.length;r<i;r++){s=t[r];if(s.groupInfo&&s.groupInfo.level===n)return s}return null},t.getGroupedColumnsCount=function(t){var n=0,r,i,s;for(r=0,i=t.length;r<i;r++)s=t[r].groupInfo,s&&(s.position==="header"||s.position==="headerAndFooter"||s.position==="footer")&&n++;return n},t.getChildGroupIndex=function(t,n){var r=0,i=n.length-1,s,o;while(r<=i){s=(i-r>>1)+r,o=n[s].cr.r1-t.r1;if(o===0)return s;o<0?r=s+1:i=s-1}return r},t.getParentGroupIndex=function(n,r){var i=e.grid.groupHelper.getChildGroupIndex(n,r);return i>0&&i--,i<r.length?i:-1},t.getChildGroupRanges=function(n,r,i){var s=[],o,u,a,f,l,c=e.grid.groupHelper.getColumnByGroupLevel(n,i+1);if(c){o=c.groupInfo.expandInfo,l=e.grid.groupHelper.getChildGroupIndex(r,o);for(a=l,f=o.length;a<f;a++){u=o[a];if(!(u.cr.r2<=r.r2))break;s.push(u)}}return s},t.getParentGroupRange=function(n,r,i){var s,o,u;i===undefined&&(i=65535);if(i-2>=0)for(s=n.length-1;s>=0;s--){o=n[s].groupInfo;if(!o||!o.expandInfo||o.level<0||o.level!==i-1)continue;u=e.grid.groupHelper.getParentGroupIndex(r,o.expandInfo);if(u>=0)return o.expandInfo[u]}return null},t.isParentCollapsed=function(n,r,i){var s,o;if(i===1)return!1;for(s=i;s>1;s--){o=e.grid.groupHelper.getParentGroupRange(n,r,s);if(o&&!o.isExpanded)return!0;r=o.cr}return!1},t.isParentExpanded=function(n,r,i){var s,o;if(i===1)return!0;for(s=i;s>1;s--){o=e.grid.groupHelper.getParentGroupRange(n,r,s);if(o&&o.isExpanded)return!0;r=o.cr}return!1},t}();t.groupHelper=r})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(){function e(e,t,n,r){switch(arguments.length){case 2:this.r1=this.r2=e,this.c1=this.c2=t;break;case 4:this.r1=e,this.r2=n,this.c1=t,this.c2=r;break;default:this.r1=0,this.r2=0,this.c1=0,this.c2=0}}return e.prototype.isSingleCell=function(){return this.r1===this.r2&&this.c1===this.c2},e}();t.cellRange=r;var i=function(){function t(){}return t.prototype.merge=function(e,t){this._leaves=t,this._data=e;var n,r,i;for(n=0,r=this._leaves.length;n<r;n++)i=this._leaves[n],i.dataIndex>=0&&!i.isBand&&(i.rowMerge==="free"||i.rowMerge==="restricted")&&this._mergeColumn(i);delete this._data,delete this._leaves},t.prototype._mergeColumn=function(t){var n=t.dataIndex,r,i,s,o,u;for(r=0,i=this._data.length;r<i;r++){if(!(this._data[r].rowType&e.grid.rowType.data))continue;s=this._getCellRange(r,t);if(s.r1!==s.r2){o=s.r2-s.r1+1,this._data[s.r1][n].__attr.rowSpan=o;for(u=s.r1+1;u<=s.r2;u++)this._data[u][n].visible=!1}r=s.r2}},t.prototype._getCellRange=function(t,n){var r=n.dataIndex,i=new e.grid.cellRange(t,r),s=(this._data[t][r].value||"").toString(),o=this._data.length,u,a,f,l;for(i.r2=t;i.r2<o-1;i.r2++){u=this._data[i.r2+1];if(!(u.rowType&e.grid.rowType.data)||(u[r].value||"").toString()!==s)break}return a=n.leavesIdx,a>0&&n.rowMerge==="restricted"&&(f=this._leaves[a-1],f.dataIndex>=0&&(l=this._getCellRange(t,f),i.r1=Math.max(i.r1,l.r1),i.r2=Math.min(i.r2,l.r2))),i},t}();t.merger=i})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){"use strict";function l(t,r){var i,s,o;if(n.isArray(t)&&n.isArray(r)){if(t.length===r.length){o=!0;for(i=0,s=t.length;i<s&&o;i++)o=e.grid.compareObj(t[i],r[i]);return o}}else{if(n.isPlainObject(t)&&n.isPlainObject(r)){for(i in t)if(t.hasOwnProperty(i)&&!e.grid.compareObj(t[i],r[i]))return!1;for(i in r)if(r.hasOwnProperty(i)&&!e.grid.compareObj(t[i],r[i]))return!1;return!0}t instanceof Date&&(t=t.getTime()),r instanceof Date&&(r=r.getTime())}return t===r}function c(e){var t=[];for(var n=0;n<arguments.length-1;n++)t[n]=arguments[n+1];var r,i;if(!e)return"";for(r=0,i=t.length;r<i;r++)e=e.replace(new RegExp("\\{"+r+"\\}","gm"),t[r]);return e}function h(e){return e&&!(e<0)||e===0}function p(e){return e&&e instanceof Date?!isNaN(e.getTime()):!1}function d(e){return e.dataType||e._underlyingDataType||"string"}function v(e,t){e&&t&&e.find(".ui-widget").each(function(e,r){return n.each(n(r).data(),function(n,r){r.widgetName&&t(e,r)}),!0})}function m(e,t){var r=[];n.each(e.data(),function(e){e.indexOf(t)===0&&r.push(e)}),n.each(r,function(t,n){e.removeData(n)})}function y(e){return n.extend(!0,{},t.c1basefield.prototype.options,t.c1field.prototype.options,{dynamic:!0,isLeaf:!0,isBand:!1,parentIdx:-1},e)}function b(e,t){if(e){var r=e.nodeType?n(e):e,i=r.offset();if(i)return t?{top:i.top,left:i.left,width:r[0].clientWidth||0,height:r[0].clientHeight||0}:{top:i.top,left:i.left,width:r.outerWidth(),height:r.outerHeight()}}return null}function w(e,t){return e&&(e.start<0&&(e.start=0),e.end<0&&(e.end=0),e.start=Math.min(e.start,t),e.end=Math.min(e.end,t)),e}function E(t,n,r){n===undefined&&(n=3);if(t&&n!==0){if(!r&&t.nodeType===3)return t.nodeValue;if(t.nodeType===1){switch(t.type){case"button":case"text":case"textarea":case"select-one":return t.value;case"checkbox":return t.checked.toString()}var i="",s=0,o;while(o=t.childNodes[s++])i+=e.grid._getDOMText(o,n-1);return i}}return""}function S(e,t,r,i){var s=e.jquery||n.isArray(e),o,u,a,f=t+r;if(arguments.length===3)return s?n.data(e[0],f):n.data(e,f);if(s){for(o=0,u=e.length;o<u;o++)a=n.data(e[o],f,i);return a}return n.data(e,f,i)}function x(e,t){if(t&&e){var n,r,i;for(n in t)t.hasOwnProperty(n)&&(r=t[n],i=typeof r,(i==="string"||i==="boolean"||i==="number")&&e[n]===undefined&&(e[n]=r))}}function T(e){return e&&typeof e=="object"&&!(e instanceof Date)}function N(e,t){var r,i,s=n.isFunction(t);for(r in e)if(e.hasOwnProperty(r)){i=s?t(e[r]):e[r]===t;if(i===!0)return{at:r,found:e[r]}}return{at:null,found:null}}function C(e,t){if(e){var n,r,i=0,s={},o,u;for(n=0,r=e.attributes.length;n<r;n++)u=e.attributes[n].name,u&&(!t||!t(u))&&(o=e.getAttribute(u),u==="style"&&(o=typeof o=="object"?o.cssText:o),!o&&u==="class"&&(o=e.getAttribute("className")),o&&typeof o!="function"&&(s[u]=o,i++));if(i)return s}return null}function k(t,r){var i,s,o,u,a;if(t){typeof r!="object"&&!n.isFunction(r)&&(r={});for(i in t){s=t[i],o=r[o];if(s===r)continue;s&&(n.isPlainObject(s)||(u=n.isArray(s)))?(u?(u=!1,a=o&&n.isArray(o)?o:[]):a=o&&n.isPlainObject(o)?o:{},r[i]=e.grid.deepExtend(s,a)):r[i]=s}}return r}function L(e,t){return e&&e.jquery&&(e=e[0]),e?arguments.length===1?n.data(e,"wijgridwidgetName"):n.data(e,"wijgridwidgetName",t):undefined}function O(e,t,n){return e>t&&e<t+n}function M(t,n,r,i,s,o){return e.grid.isOverAxis(t,r,s)&&e.grid.isOverAxis(n,i,o)}function D(){return"uid"+_++}var n=jQuery;t.EXPANDO="__wijgrid",function(e){e._map=[],e.header=1,e.data=2,e.dataAlt=4,e.filter=8,e.groupHeader=16,e.groupFooter=32,e.footer=64,e.emptyDataRow=128}(t.rowType||(t.rowType={}));var r=t.rowType;(function(e){e._map=[],e.none=0,e.rendering=1,e.current=2,e.hovered=4,e.selected=8})(t.renderState||(t.renderState={}));var i=t.renderState;(function(e){e._map=[],e.table=0,e.head=1,e.body=2,e.foot=3})(t.rowScope||(t.rowScope={}));var s=t.rowScope;(function(e){e._map=[],e.none=0,e.column=1,e.row=2})(t.cellRangeExtendMode||(t.cellRangeExtendMode={}));var o=t.cellRangeExtendMode;(function(e){e._map=[],e.createIfNull=0,e.createAlways=1,e.dispose=2})(t.objectMode||(t.objectMode={}));var u=t.objectMode;(function(e){e._map=[],e.groupCell=0,e.aggregateCell=1})(t.groupRowCellPurpose||(t.groupRowCellPurpose={}));var a=t.groupRowCellPurpose;(function(e){e._map=[],e.sketch=0,e.rendered=1,e.renderable=2})(t.dataRowsRangeMode||(t.dataRowsRangeMode={}));var f=t.dataRowsRangeMode;t.compareObj=l,t.stringFormat=c,t.validDataKey=h,t.validDate=p,t.getDataType=d,t.iterateChildrenWidgets=v,t.remove$dataByPrefix=m;var g=function(){function e(e){this._dom=e}return e.prototype.getSelection=function(){var e=0,t=0,n;return this._dom.selectionStart!==undefined?(e=this._dom.selectionStart,t=this._dom.selectionEnd):document.selection&&(n=document.selection.createRange().duplicate(),t=n.text.length,e=Math.abs(n.moveStart("character",-this._dom.value.length)),t+=e),{start:e,end:t,length:t-e}},e.prototype.setSelection=function(e){if(this._dom.selectionStart!==undefined)this._dom.setSelectionRange(e.start,e.end);else{var t=this._dom.createTextRange();t.collapse(!0),t.moveStart("character",e.start),t.moveEnd("character",e.end),t.select()}},e.prototype.toggleSelection=function(e){var t=n(this._dom),r="onselectstart"in this._dom;e?r?t.unbind(".wijgrid-disableSelection"):t.css({MozUserSelect:"",WebkitUserSelect:""}):r?t.bind("selectstart.wijgrid-disableSelection",function(e){e.preventDefault()}):t.css({MozUserSelect:"-moz-none",WebkitUserSelect:"none"})},e}();t.domSelection=g,t.createDynamicField=y,t.bounds=b,t.ensureBounds=w,t._getDOMText=E,t.dataPrefix=S,t.shallowMerge=x,t.isCustomObject=T,t.search=N,t.getAttributes=C,t.deepExtend=k,t.widgetName=L;var A=function(){function t(){}return t._requiresExtendedSupport={date:"",datetime:"","datetime-local":"",month:"",time:""},t.isExtendSupportRequired=function(n){return n=(n||"").toLowerCase(),n in e.grid.HTML5InputSupport._requiresExtendedSupport},t.getDefaultInputType=function(n,r){var i=r.inputType;if(!i){i="text";if(n)switch(e.grid.getDataType(r)){case"number":case"currency":i="number";break;case"datetime":i="datetime"}}return i},t.toStr=function(n,r){var i=n;r=(r||"").toLowerCase();if(e.grid.HTML5InputSupport.isExtendSupportRequired(r))switch(r){case"datetime":i=n?i=Globalize.format(n,"yyyy-MM-ddTHH:mm:ssZ"):"";break;case"datetime-local":i=n?i=Globalize.format(n,"yyyy-MM-ddTHH:mm:ss"):"";break;case"date":i=n?i=Globalize.format(n,"yyyy-MM-dd"):"";break;case"month":i=n?i=Globalize.format(n,"yyyy-MM"):"";break;case"time":i=n?i=Globalize.format(n,"HH:mm:ss"):""}else i=n+"";return i},t.parse=function(n,r){var i,s=function(t){return t=new Date(t),e.grid.validDate(t)||(t=null),t};r=(r||"").toLowerCase();if(e.grid.HTML5InputSupport.isExtendSupportRequired(r))switch(r){case"datetime":i=Globalize.parseDate(n,"yyyy-MM-ddTHH:mm:ssZ")||Globalize.parseDate(n,"yyyy-MM-ddTHH:mmZ")||s(n);break;case"datetime-local":i=Globalize.parseDate(n,"yyyy-MM-ddTHH:mm:ss")||Globalize.parseDate(n,"yyyy-MM-ddTHH:mm")||s(n);break;case"date":i=Globalize.parseDate(n,"yyyy-MM-dd")||s(n);break;case"month":i=Globalize.parseDate(n,"yyyy-MM");break;case"time":i=Globalize.parseDate(n,"HH:mm:ss")||Globalize.parseDate(n,"HH:mm");break;case"number":i=parseFloat(n)}else i=n;return i},t.extend=function(t,n,r){if(!t)t=n;else{r=(r||"").toLowerCase();switch(r){case"date":t.setFullYear(n.getFullYear(),n.getMonth(),n.getDate());break;case"month":t.setFullYear(n.getFullYear(),n.getMonth());break;case"time":t.setHours(n.getHours()),t.setMinutes(n.getMinutes()),t.setSeconds(n.getSeconds());break;default:t=n}}return t},t}();t.HTML5InputSupport=A,t.isOverAxis=O,t.isOver=M;var _=0;t.getUID=D,n.extend(n.wijmo.wijgrid,{rowType:e.grid.rowType,renderState:e.grid.renderState,bounds:e.grid.bounds})})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){(function(e){e._map=[],e.Millisecond=1,e.Second=2,e.Minute=4,e.Hour=8,e.Day=16,e.Month=32,e.Year=64,e.DATE=e.Year|e.Month|e.Day,e.TIME=e.Hour|e.Minute|e.Second|e.Millisecond,e.ALL=e.DATE|e.TIME})(t.TimeUnit||(t.TimeUnit={}));var n=t.TimeUnit,r=function(){function t(){}return t.convertInputType=function(n){var r=e.grid.TimeUnitConverter.convertInputTypeToFormatString(n),i=e.grid.TimeUnitConverter.convertFormatString(r);return i},t.convertInputTypeToFormatString=function(t){switch((t||"").toLowerCase()){case"datetime":case"datetime-local":return"f";case"date":return"d";case"month":return"Y";case"time":return"t"}return""},t.convertFormatString=function(t){var r=0;if(t){if(t.length===1)switch(t[0]){case"t":return n.Hour|n.Minute;case"T":return n.TIME;case"d":case"D":return n.DATE;case"Y":return n.Month|n.Year;case"M":return n.Month|n.Day;case"f","F","S":return n.ALL}var i,s;(i=t.indexOf("'"))>=0&&(s=t.lastIndexOf("'"))>=0&&i!==s&&(t=t.substr(0,i)+t.substring(s+1,t.length-1));for(var o=0,u=t.length;o<u;o++)switch(t[o]){case"d":r|=n.Day;break;case"M":r|=n.Month;break;case"y":r|=n.Year;break;case"m":r|=n.Minute;break;case"h":case"H":r|=n.Hour;break;case"s":r|=n.Second;break;case"f":r|=n.Millisecond}}return r||n.ALL},t.cutDate=function(t,r){return t&&(r=~r,r&n.Millisecond&&t.setMilliseconds(0),r&n.Second&&t.setSeconds(0),r&n.Minute&&t.setMinutes(0),r&n.Hour&&t.setHours(0),r&n.Day&&t.setDate(1),r&n.Month&&t.setMonth(0),r&n.Year&&t.setFullYear(0)),t},t}();t.TimeUnitConverter=r})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(){function e(){}return e.NoFilterOp={applicableTo:null,name:"NoFilter",arity:1,operator:function(){return!0}},e}(),i=function(){function t(t){this._cache={};var i=this;this._wijgrid=t,this._addOperator(null,r.NoFilterOp),n.each(e.data.filtering.ops,function(e,t){i._addOperator(e,t)}),n.each(t.options.customFilterOperators,function(e,t){i._addOperator(null,t,!0)})}return t.prototype.getByName=function(e){var t=this.getByNameInt(e);return t?t.op:null},t.prototype.getByNameInt=function(e){return this._cache[(e||"").toLowerCase()]},t.prototype.getByDataType=function(e){var t=[],r;n.each(this._cache,function(r,i){var s=i.op;(!s.applicableTo||n.inArray(e,s.applicableTo)>=0)&&t.push(i)});switch(this._wijgrid.options.filterOperatorsSortMode.toLowerCase()){case"alphabetical":t.sort(this._sortAlpha);break;case"alphabeticalcustomfirst":t.sort(this._sortAlphaCustomFirst);break;case"alphabeticalembeddedFirst":t.sort(this._sortAlphaEmbeddedFirst);break;case"none":break;default:}return r=n.map(t,function(e,t){return e.op}),r},t.prototype._addOperator=function(e,t,n){typeof n=="undefined"&&(n=!1),e&&!t.name&&(t.name=e),e=(e||t.name).toLowerCase(),this._cache[e]||(this._cache[e]={op:t,isCustom:n===!0})},t.prototype._sortAlpha=function(e,t){var n=e.op.name.toLowerCase(),r=t.op.name.toLowerCase();if(n!==r){if(n==="nofilter")return-1;if(r==="nofilter")return 1}return n===r?0:n<r?-1:1},t.prototype._sortAlphaEmbeddedFirst=function(e,t){var n=e.op.name.toLowerCase(),r=t.op.name.toLowerCase();if(n!==r){if(n==="nofilter")return-1;if(r==="nofilter")return 1}if(e.isCustom!==t.isCustom){if(e.isCustom)return 1;if(t.isCustom)return-1}return n===r?0:n<r?-1:1},t.prototype._sortAlphaCustomFirst=function(e,t){var n=e.op.name.toLowerCase(),r=t.op.name.toLowerCase();if(n!==r){if(n==="nofilter")return-1;if(r==="nofilter")return 1}if(e.isCustom!==t.isCustom){if(e.isCustom)return-1;if(t.isCustom)return 1}return n===r?0:n<r?-1:1},t}();t.filterOperatorsCache=i;var s=function(){function t(){}return t.marker="_wijgrid",t.getSingleValue=function(t){return n.isArray(t)&&(t=t[0],n.isArray(t)&&(t=t[0])),t},t.getSingleOperatorName=function(t){return n.isArray(t)&&(t=t[0]),t.name||t||""},t.verify=function(r,i,s,o){if(r)if(n.isArray(r)){var u,a,f=[],l=[];n.isArray(i)||(i=[i]);for(u=0,a=r.length;u<a;u++)e.grid.filterHelper._verifySingleOp(r[u],i[u],s,o)&&(f.push({name:r[u].name||r[u],condition:r[u].condition||"or"}),l.push(i?i[u]:undefined));if(f.length)return{filterOperator:f,filterValue:l}}else if(e.grid.filterHelper._verifySingleOp(r,i,s,o))return{filterOperator:r,filterValue:i};return null},t._verifySingleOp=function(r,i,s,o){if(r&&(r=r.name||r)){var u;r=(r||"").toLowerCase();if((r!=="nofilter"||i!==undefined)&&(u=o.getByName(r)))if(u.applicableTo===null||n.inArray(s||"string",u.applicableTo)>=0)if(u.arity===1||u.arity>1&&e.grid.filterHelper.getSingleValue(i)!==undefined)return!0}return!1},t}();t.filterHelper=s})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){"use strict";function r(t,n){t&&!t.nodeType&&(t=t[0]);if(t)switch(n){case e.grid.rowScope.head:return t.tHead;case e.grid.rowScope.body:if(t.tBodies)return t.tBodies[0]||null;break;case e.grid.rowScope.foot:return t.tFoot;default:return t}return null}function i(e,t){var n;return e&&!e.nodeType&&(e=e[0]),e&&(n=this.getTableSection(e,t))?n.rows.length:0}function s(e,t,n){var r;return e&&!e.nodeType&&(e=e[0]),e&&(r=this.getTableSection(e,t))?r.rows[n]||null:null}function o(t,r,i){var s,o,u,a,f,l,c,h,p=[],d=function(e){return e=e.toLowerCase(),e==="rowspan"||e==="colspan"},v;t&&!t.nodeType&&(t=t[0]);if(t&&(v=this.getTableSection(t,r)))for(s=0,o=v.rows.length;s<o;s++){f=v.rows[s],l=[],i&&(c=e.data.Expando.getFrom(l,!0),h=c[e.grid.EXPANDO]={cellsAttributes:{},rowAttributes:e.grid.getAttributes(f)||{}});for(u=0,a=f.cells.length;u<a;u++)l[u]=n.trim(f.cells[u].innerHTML),i&&(h.cellsAttributes[u]=e.grid.getAttributes(f.cells[u],d)||{});p[s]=l}return p}function u(t){var n=t.parentNode.parentNode;switch(n.tagName.toLowerCase()){case"thead":return e.grid.rowScope.head;case"tbody":return e.grid.rowScope.body;case"tfoot":return e.grid.rowScope.foot}return null}var n=jQuery;t.getTableSection=r,t.getTableSectionLength=i,t.getTableSectionRow=s,t.readTableSection=o,t.determineSection=u;var a=function(){function t(e,t,n,r){this._width=0,this._table=e,this._offsets=[],r&&this.ensureColGroup(),n&&this.ensureTBody(),t||this._buildOffsets()}return t.prototype.element=function(){return this._table},t.prototype.width=function(){return this._width},t.prototype.getCellIdx=function(e,t){return e<this._width?this._offsets[t][e].cellIdx:-1},t.prototype.getColumnIdx=function(e,t){if(typeof e!="number"){var n=e;e=n.cellIndex,t=n.parentNode.rowIndex}return e<this._width?this._offsets[t][e].colIdx:-1},t.prototype.clearSection=function(t){var n,r,i=e.grid.getTableSection(this._table,t);switch(t){case e.grid.rowScope.body:n=this.getSectionLength(e.grid.rowScope.table),r=n+this.getSectionLength(t)-1;break;case e.grid.rowScope.foot:n=this.getSectionLength(e.grid.rowScope.table)+this.getSectionLength(e.grid.rowScope.head),r=n+this.getSectionLength(t)-1;break;default:n=0,r=this.getSectionLength(t)-1}while(i.rows.length)i.deleteRow(0);this._offsets.splice(n,r-n+1)},t.prototype.getSectionLength=function(t){return e.grid.getTableSectionLength(this._table,t)},t.prototype.getSectionRow=function(t,n){return e.grid.getTableSectionRow(this._table,n,t)},t.prototype.forEachColumnCellNatural=function(e,t,n){var r,i,s,o;for(r=0,i=this._table.rows.length;r<i;r++){s=this._table.rows[r];if(e<s.cells.length){o=t(s.cells[e],r,n);if(o!==!0)return o}}return!0},t.prototype.forEachColumnCell=function(e,t,n){var r,i,s,o,u;for(r=0,i=this._offsets.length;r<i;r++){s=this._table.rows[r],o=this.getCellIdx(e,r);if(o>=0){u=t(s.cells[o],r,n);if(u!==!0)return u}}return!0},t.prototype.forEachRowCell=function(e,t,n){var r=this._table.rows[e],i,s,o;for(i=0,s=r.cells.length;i<s;i++){o=t(r.cells[i],i,n);if(o!==!0)return o}return!0},t.prototype.colGroupTag=function(){var e=this._table.getElementsByTagName("colgroup");return e&&e[0]||null},t.prototype.colTags=function(){var e=this.colGroupTag();return e&&e.getElementsByTagName("col")||[]},t.prototype.ensureTBody=function(){return this._table.tBodies&&this._table.tBodies[0]||this._table.appendChild(document.createElement("tbody"))},t.prototype.ensureTHead=function(){return this._table.tHead&&this._table.tHead[0]||this._table.createTHead()},t.prototype.ensureTFoot=function(){return this._table.tFoot&&this._table.tFoot[0]||this._table.createTFoot()},t.prototype.ensureColGroup=function(){var e=this._table.getElementsByTagName("colgroup");return e&&e[0]||this._table.appendChild(document.createElement("colgroup"))},t.prototype.appendCol=function(e){var t=this.ensureColGroup();return e&&t.appendChild(e)||t.appendChild(document.createElement("col"))},t.prototype.removeOffset=function(e){if(e>=0&&e<this._offsets.length){if(e<0||!e&&e!==0)e=this._offsets.length-1;this._offsets.splice(e,1)}},t.prototype.insertOffset=function(e){var t,n;if(this._width>0){t=[];for(n=0;n<this._width;n++)t.push({cellIdx:n,colIdx:n});if(e<0||!e&&e!==0)e=this._offsets.length;this._offsets.splice(e,0,t)}},t.prototype.rebuildOffsets=function(){this._offsets=[],this._width=0,this._buildOffsets()},t.prototype._buildOffsets=function(){var e=[],t,n,r,i,s,o,u,a,f,l;for(n=0,r=this._table.rows.length;n<r;n++){t=[],this._offsets[n]=t,i=this._table.rows[n];for(s=0,o=0,u=i.cells.length;s<u;s++,o++){a=i.cells[s];for(;e[o]>1;o++)e[o]--,t[o]={cellIdx:-1,colIdx:-1};e[o]>1||(e[o]=a.rowSpan),t[o]={cellIdx:s,colIdx:-1},t[s].colIdx=o,f=a.colSpan;for(;f>1;f--)t[++o]={cellIdx:-1,colIdx:-1}}l=e.length;for(;o<l;o++)e[o]--,t[o]={cellIdx:-1,colIdx:-1};this._width=Math.max(this._width,l)}},t}();t.htmlTableAccessor=a})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(){function t(e,t,n,r,i){typeof n=="undefined"&&(n=null),typeof r=="undefined"&&(r=!1),typeof i=="undefined"&&(i=!0),this.__isEdit=!1,this._wijgrid=n,this._virtualize=i,r?(this._ci=e-this._wijgrid._getDataToAbsOffset().x,this._ri=t-this._wijgrid._getDataToAbsOffset().y,this._virtualize&&(this._ri=this._wijgrid._renderableBoundsCollection().getAbsIndex(this._ri+this._wijgrid._viewPortBounds().start))):(this._ci=e,this._ri=t)}return t.outsideValue=new t(-1,-1,null),t.prototype.cellIndexAbs=function(){return this._ci+this._wijgrid._getDataToAbsOffset().x},t.prototype.rowIndexAbs=function(){var e=this._virtualize?this._wijgrid._renderableBoundsCollection().getVisibleIndex(this._ri)-this._wijgrid._viewPortBounds().start:this._ri;return e+=this._wijgrid._getDataToAbsOffset().y,e},t.prototype.cellIndex=function(e){if(!arguments.length)return this._ci;this._ci=e},t.prototype.column=function(){return this._wijgrid&&this._isValid()?this._wijgrid._field("visibleLeaves")[this.cellIndexAbs()]:null},t.prototype.container=function(){var e=this.tableCell(),t;if(e){t=n(e).children("div.wijmo-wijgrid-innercell");if(t)return t}return null},t.prototype.isEqual=function(e){return e&&e.rowIndex()===this.rowIndex()&&e.cellIndex()===this.cellIndex()},t.prototype.row=function(){var e=null,t=null;if(this._wijgrid){if(this._virtualize)return this._wijgrid._view()._getRowInfoBySketchRowIndex(this.rowIndex());e=this._wijgrid._view().rows().item(this.rowIndexAbs()),e&&e.length&&(t=this._wijgrid._view()._getRowInfo(e))}return t},t.prototype.rowIndex=function(e){if(!arguments.length)return this._ri;this._ri=e},t.prototype.tableCell=function(){if(this._wijgrid&&this._isValid())if(!this._virtualize||this._isRendered())return this._wijgrid._view().getCell(this.cellIndexAbs(),this.rowIndexAbs());return null},t.prototype.value=function(t){var n,r,i;if(this._wijgrid&&this._isValid()){r=this.row();if(r.type&e.grid.rowType.data){n=this.column();if(arguments.length===0)return i=this._wijgrid._dataViewWrapper.getValue(r.data,n.dataKey),this._wijgrid.parse(n,i);t=this._wijgrid.parse(n,t);if(t===null&&n.valueRequired||e.grid.getDataType(n)!=="string"&&isNaN(t))throw"invalid value";this._wijgrid._dataViewWrapper.setValue(r.dataItemIndex,n.dataKey,t)}}},t.prototype.toString=function(){return this.cellIndex()+":"+this.rowIndex()},t.prototype._clip=function(e,t){typeof t=="undefined"&&(t=!1);var n=!1,r;return t?(this.cellIndexAbs()<(r=e.topLeft().cellIndexAbs())&&(n=!0,this._ci=e.topLeft().cellIndex()),this.cellIndexAbs()>(r=e.bottomRight().cellIndexAbs())&&(n=!0,this._ci=e.bottomRight().cellIndex()),this.rowIndexAbs()<(r=e.topLeft().rowIndexAbs())&&(n=!0,this._ri=e.topLeft().rowIndex()),this.rowIndexAbs()>(r=e.bottomRight().rowIndexAbs())&&(n=!0,this._ri=e.bottomRight().rowIndex())):(this.cellIndex()<(r=e.topLeft().cellIndex())&&(n=!0,this._ci=r),this.cellIndex()>(r=e.bottomRight().cellIndex())&&(n=!0,this._ci=r),this.rowIndex()<(r=e.topLeft().rowIndex())&&(n=!0,this._ri=r),this.rowIndex()>(r=e.bottomRight().rowIndex())&&(n=!0,this._ri=r)),n},t.prototype._clone=function(){return new e.grid.cellInfo(this.cellIndex(),this.rowIndex(),this._wijgrid,!1,this._virtualize)},t.prototype._isValid=function(){return this.cellIndex()>=0&&this.rowIndex()>=0},t.prototype._isRendered=function(){var e=this._wijgrid._view()._isRowRendered(this.rowIndex());return e>=0},t.prototype._isEdit=function(e){if(!arguments.length)return this.__isEdit;this.__isEdit=e},t.prototype._setGridView=function(e){this._wijgrid=e},t}();t.cellInfo=r;var i=function(){function t(e,t){if(!e||!t)throw"invalid arguments";this._topLeft=e._clone(),this._bottomRight=t._clone()}return t.prototype.bottomRight=function(){return this._bottomRight},t.prototype.isEqual=function(e){return e&&this._topLeft.isEqual(e.topLeft())&&this._bottomRight.isEqual(e.bottomRight())},t.prototype.topLeft=function(){return this._topLeft},t.prototype.toString=function(){return this._topLeft.toString()+" - "+this._bottomRight.toString()},t.prototype._isIntersect=function(e){var t,n,r,i;if(e){t=e.bottomRight().rowIndex()-e.topLeft().rowIndex()+1,n=this._bottomRight.rowIndex()-this._topLeft.rowIndex()+1;if(e.topLeft().rowIndex()+t-this._topLeft.rowIndex()<t+n)return r=e.bottomRight().cellIndex()-e.topLeft().cellIndex()+1,i=this._bottomRight.cellIndex()-this._topLeft.cellIndex()+1,e.topLeft().cellIndex()+r-this._topLeft.cellIndex()<r+i}return!1},t.prototype._isValid=function(){return this._topLeft._isValid()&&this._bottomRight._isValid()},t.prototype._clip=function(e,t){typeof t=="undefined"&&(t=!1);var n=this._topLeft._clip(e,t),r=this._bottomRight._clip(e,t);return n||r},t.prototype._clone=function(){return new t(this._topLeft._clone(),this._bottomRight._clone())},t.prototype._containsCellInfo=function(e){return e&&e.cellIndex()>=this._topLeft.cellIndex()&&e.cellIndex()<=this._bottomRight.cellIndex()&&e.rowIndex()>=this._topLeft.rowIndex()&&e.rowIndex()<=this._bottomRight.rowIndex()},t.prototype._containsCellRange=function(e){return e&&this._containsCellInfo(e.topLeft())&&this._containsCellInfo(e.bottomRight())},t.prototype._extend=function(t,n){return t===e.grid.cellRangeExtendMode.column?(this._topLeft.rowIndex(n.topLeft().rowIndex()),this._bottomRight.rowIndex(n.bottomRight().rowIndex())):t===e.grid.cellRangeExtendMode.row&&(this._topLeft.cellIndex(n.topLeft().cellIndex()),this._bottomRight.cellIndex(n.bottomRight().cellIndex())),this},t.prototype._normalize=function(){var e=this._topLeft.cellIndex(),t=this._topLeft.rowIndex(),n=this._bottomRight.cellIndex(),r=this._bottomRight.rowIndex();this._topLeft.cellIndex(Math.min(e,n)),this._topLeft.rowIndex(Math.min(t,r)),this._bottomRight.cellIndex(Math.max(e,n)),this._bottomRight.rowIndex(Math.max(t,r))},t.prototype._height=function(){return this._bottomRight.rowIndex()-this._topLeft.rowIndex()},t.prototype._width=function(){return this._bottomRight.cellIndex()-this._topLeft.cellIndex()},t}();t.cellInfoRange=i,n.extend(n.wijmo.wijgrid,{cellInfo:e.grid.cellInfo,cellInfoRange:e.grid.cellInfoRange})})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(){function r(e,t){this._rowHeaderSize=22,this._sizesAdjCache={th:0,col:0,subTable:0};if(!e)throw"'wijgrid' must be specified";this._wijgrid=e,this._bounds=t,this._wijgrid.element.addClass("wijmo-wijgrid-table")}return r.prototype.dispose=function(){this.toggleDOMSelection(!0),this._wijgrid.element.removeClass("wijmo-wijgrid-table")},r.prototype.ensureDisabledState=function(){var e="wijmo-wijgrid-disabled "+this._wijgrid.options.wijCSS.stateDisabled,t=this._wijgrid.options.disabled,r=this;n.each(this.subTables(),function(i,s){if(s){var o=n(s.element());t?(o.addClass(e),r._wijgrid._setAttr(o,"aria-disabled",!0)):(o.removeClass(e),r._wijgrid._setAttr(o,"aria-disabled",!1))}})},r.prototype.ensureWidth=function(e,t,n){this._setColumnWidth(e,t)},r.prototype.ensureHeight=function(e){},r.prototype.getScrollValue=function(){return null},r.prototype.getVisibleAreaBounds=function(e){throw"not implemented"},r.prototype.getVisibleContentAreaBounds=function(){throw"not implemented"},r.prototype.getFixedAreaVisibleBounds=function(){throw"not implemented"},r.prototype.render=function(){this._ensureRenderBounds(),this._preRender();var e=this._wijgrid.outerDiv.css("display");this._wijgrid.outerDiv.css("display","none"),this._renderContent(),this._wijgrid.outerDiv.css("display",e),this._postRender()},r.prototype.toggleDOMSelection=function(t){n.each(this.subTables(),function(n,r){(new e.grid.domSelection(r.element())).toggleSelection(t)}),(new e.grid.domSelection(this._wijgrid.outerDiv)).toggleSelection(t)},r.prototype.updateSplits=function(e){throw"not implemented"},r.prototype.bodyRows=function(){return this._bodyRowsAccessor||(this._bodyRowsAccessor=new e.grid.rowAccessor(this,e.grid.rowScope.body,0,0)),this._bodyRowsAccessor},r.prototype.filterRow=function(){if(this._wijgrid.options.showFilter){var t=new e.grid.rowAccessor(this,e.grid.rowScope.head,0,0);return t.item(t.length()-1)}return null},r.prototype.footerRow=function(){if(this._wijgrid.options.showFooter){var t=new e.grid.rowAccessor(this,e.grid.rowScope.foot,0,0);return t.item(0)}},r.prototype.headerRows=function(){var t;return this._headerRowsAccessor||(t=this._wijgrid.options.showFilter?1:0,this._headerRowsAccessor=new e.grid.rowAccessor(this,e.grid.rowScope.head,0,t)),this._headerRowsAccessor},r.prototype.rows=function(){return this._rowsAccessor||(this._rowsAccessor=new e.grid.rowAccessor(this,e.grid.rowScope.table,0,0)),this._rowsAccessor},r.prototype.focusableElement=function(){throw"not implemented"},r.prototype.forEachColumnCell=function(e,t,n){throw"not implemented"},r.prototype.forEachRowCell=function(e,t,n){throw"not implemented"},r.prototype.getAbsoluteCellInfo=function(e,t){throw"not implemented"},r.prototype.getAbsoluteRowIndex=function(e){throw"not implemented"},r.prototype.getCell=function(e,t){throw"not implemented"},r.prototype.getColumnIndex=function(e){throw"not implemented"},r.prototype.getHeaderCell=function(e){throw"not implemented"},r.prototype.getJoinedCols=function(e){throw"not implemented"},r.prototype.getJoinedRows=function(e,t){throw"not implemented"},r.prototype.getJoinedTables=function(e,t){throw"not implemented"},r.prototype.subTables=function(){throw"not implemented"},r.prototype._getMappedScrollMode=function(){var e=this._wijgrid.options.scrollMode,t="auto",n="auto";switch(e){case"horizontal":t="hidden",n="visible";break;case"vertical":t="visible",n="hidden";break;case"both":t="visible",n="visible"}return{vScrollBarVisibility:t,hScrollBarVisibility:n}},r.prototype._postRender=function(){this.ensureDisabledState(),this._sizesAdjCache.col=0,this._sizesAdjCache.th=0,this._sizesAdjCache.subTable=0;var e=this._wijgrid._field("visibleLeaves");if(e.length>0){var t=this.getHeaderCell(0),r=this.getJoinedCols(0);t&&(this._sizesAdjCache.th=n(t).leftBorderWidth()+n(t).rightBorderWidth()),r&&r.length&&(this._sizesAdjCache.col=n(r[0]).leftBorderWidth()+n(r[0]).rightBorderWidth())}var i=this.subTables()[0];this._sizesAdjCache.subTable=n(i.element()).leftBorderWidth()+n(i.element()).rightBorderWidth()},r.prototype._preRender=function(){throw"not implemented"},r.prototype._ensureRenderBounds=function(){var e=this._wijgrid._getDataCellsRange(t.dataRowsRangeMode.sketch);this._bounds.start=0,this._bounds.end=e.bottomRight().rowIndex()},r.prototype._renderContent=function(){this._renderCOLS(),this._renderHeader(),this._wijgrid.options.showFilter&&this._renderFilter(),this._renderBody(),this._wijgrid.options.showFooter&&this._renderFooter()},r.prototype._renderCOLS=function(){var e=this._wijgrid._field("visibleLeaves"),t,n,r,i;for(r=0,i=e.length;r<i;r++)t=e[r],n=this._createCol(t,r),this._appendCol(n,t,r)},r.prototype._renderHeader=function(){var t=e.grid.rowType,n=this._wijgrid._columnsHeadersTable(),r,i,s;if(n&&(i=n.length))for(r=0;r<i;r++)s=this._insertEmptyRow(t.header,r,-1,-1,-1),this._renderRow(s,null,n[r])},r.prototype._renderFilter=function(){var t=this._insertEmptyRow(e.grid.rowType.filter,-1,-1,-1,-1);this._renderRow(t,this._wijgrid._field("visibleLeaves"),null)},r.prototype._renderBody=function(){var t=e.grid.rowType,n=this._wijgrid._field("visibleLeaves"),r=this._wijgrid.sketchTable,i=-1,s=0,o=0,u,a,f,l,c=this._wijgrid._dataOffset,h=this;this._wijgrid._renderableBoundsCollection().forEachIndex2(this._bounds.start,this._bounds.end-this._bounds.start+1,function(e){f=r[e-c],l=(f.rowType&t.data)!==0,a=h._insertEmptyRow(f.rowType,o++,l?++i:-1,l?f.originalRowIndex:-1,l?s+f.originalRowIndex:-1),h._renderRow(a,n,f)})},r.prototype._renderFooter=function(){var t=this._insertEmptyRow(e.grid.rowType.footer,-1,-1,-1,-1);this._renderRow(t,this._wijgrid._field("visibleLeaves"),null)},r.prototype._insertEmptyRow=function(t,n,r,i,s){var o=this._wijgrid._onViewInsertEmptyRow.apply(this._wijgrid,arguments),u=this._insertRow(t,n,o);return this._createRowInfo(u,t,e.grid.renderState.rendering,n,r,i,s)},r.prototype._createEmptyCell=function(t,n,r){var i=e.grid.rowType,s=this._wijgrid._onViewCreateEmptyCell.apply(this._wijgrid,arguments);return this._createCell(t.type,s)},r.prototype._insertRow=function(e,t,n){throw"not implemented"},r.prototype._createCell=function(t,r){var i=e.grid.rowType,s;r||(t===i.header?r=document.createElement("th"):r=document.createElement("td"));if(t!==i.filter){s=document.createElement("div"),s.className="wijmo-wijgrid-innercell";if(r.firstChild)while(r.firstChild)s.appendChild(r.firstChild);r.appendChild(s)}return n(r)},r.prototype._appendCell=function(e,t,n){throw"not implemented"},r.prototype._createCol=function(e,t){throw"not implemented"},r.prototype._appendCol=function(e,t,n){throw"not implemented"},r.prototype._renderRow=function(t,n,r){var i=e.grid.rowType,s,o;switch(t.type){case i.filter:this._renderFilterRow(t,n);break;case i.footer:this._renderFooterRow(t,n);break;case i.header:this._renderHeaderRow(t,r);break;case i.data:case i.data|i.dataAlt:this._renderDataRow(t,n,r),s=r.__attr,o=r.__style;break;case i.emptyDataRow:case i.groupHeader:case i.groupFooter:this._renderSpannedRow(t,n,r),s=r.__attr,o=r.__style;break;default:throw"unknown rowType"}this._rowRendered(t,s,o)},r.prototype._renderCell=function(t,r,i,s,o,u,a){var f=this._createEmptyCell(t,o.dataIndex,o),l=t.type===e.grid.rowType.filter?f:n(f[0].firstChild);this._appendCell(t,r,f),s?l.html(i):this._wijgrid.cellFormatter.format(l,o,i,t),this._cellRendered(t,f,r,o,u,a)},r.prototype._renderDataRow=function(e,t,n){var r,i,s,o,u,a,f;for(r=0,i=t.length;r<i;r++){s=t[r],o=s.dataIndex,u=null;if(o>=0&&(!n[o]||n[o].visible===!1))continue;u=o>=0?this._wijgrid.toStr(s,n[o].value):null,a=o>=0?n[o].__attr:null,f=o>=0?n[o].__style:null,this._renderCell(e,r,u,!1,s,a,f)}},r.prototype._renderFilterRow=function(t,n){var r,i,s;for(r=0,i=n.length;r<i;r++)s=n[r],this._renderCell(t,r,e.grid.filterHelper.getSingleValue(s.filterValue),!1,s)},r.prototype._renderFooterRow=function(e,t){var n,r;for(n=0,r=t.length;n<r;n++)this._renderCell(e,n,"",!1,t[n])},r.prototype._renderHeaderRow=function(e,t){var n,r,i=0,s;for(n=0,r=t.length;n<r;n++)s=t[n],s.column&&s.column.parentVis&&(s.column.thX=i++,s.column.thY=e.sectionRowIndex,this._renderCell(e,n,s.column.headerText,!1,s.column,{colSpan:s.colSpan,rowSpan:s.rowSpan}))},r.prototype._renderSpannedRow=function(t,n,r){var i,s,o=Math.min(n.length,r.length);for(i=0;i<o;i++){var u=t.type===e.grid.rowType.emptyDataRow;this._renderCell(t,i,r[i].html,u,n[i],r[i].__attr,r[i].__style)}},r.prototype._cellRendered=function(t,n,r,i,s,o){this._wijgrid.cellStyleFormatter.format(n,r,i,t,e.grid.renderState.rendering,s,o),this._changeCellRenderState(n,e.grid.renderState.rendering,!1),this._wijgrid._onViewCellRendered(t,n,r,i)},r.prototype._rowRendered=function(t,n,r){this._wijgrid.rowStyleFormatter.format(t,n,r),t.state&=~e.grid.renderState.rendering,this._setRowInfo(t.$rows,t),this._wijgrid._onViewRowRendered(t)},r.prototype._isBodyRow=function(t){var n=e.grid.rowType,r=t.type;return r&n.data||r===n.groupHeader||r===n.groupFooter||r===n.emptyDataRow},r.prototype._changeRowRenderState=function(e,t,n){n?e.state|=t:e.state&=~t,this._setRowInfo(e.$rows,e)},r.prototype._changeCellRenderState=function(t,n,r){var i=e.grid.dataPrefix,s=this._wijgrid._data$prefix,o=i(t,s,"renderState");return r?(n=o|n,i(t,s,"renderState",n)):(n=o&~n,i(t,s,"renderState",n)),n},r.prototype._adjustWidthArray=function(e,t,r,i){var s=this._sumWidthArray(e),o=this._sumWidthArray(t),u=[],a,f=0,l,c,h=!0;if(s<=r){n.extend(!0,u,e);if(s===r||i)return u;a=r-s}else{n.extend(!0,u,t);if(o>=r)return u;a=r-o}return n.each(u,function(e,t){t.real||f++}),f!==0&&(l=Math.floor(a/f),c=a-l*f,n.each(u,function(e,t){t.real||(t.width+=l,h&&(t.width+=c,h=!1))})),u},r.prototype._getColumnWidth=function(e){var t,r,i,s,o,u,a,f,l,c,h;r=this._wijgrid._field("visibleLeaves")[e];if(r._realWidth!==undefined)t={width:r._realWidth,real:!0};else if(r.isRowHeader)t={width:this._rowHeaderSize,real:!0};else{var p=0;i=this.getJoinedTables(!0,e),s=i[2];for(o=0;o<2;o++){u=i[o];if(u!==null){a=u.element().rows;if(h=a.length){for(c=h-1,l=null;c>=0;c--)if(a[c].cells.length===u.width()){l=a[c];break}l&&(f=l.cells[s],p=Math.max(p,n(f).outerWidth()))}}}t={width:p,real:!1}}return t},r.prototype._setColumnWidth=function(e,t){var r=this.getHeaderCell(e),i=this.getJoinedCols(e),s;if(t){var o=this;r&&(s=t-this._sizesAdjCache.th,s<0&&(s=0),r.style.width=s+"px"),n.each(i,function(e,n){n&&(s=t-o._sizesAdjCache.col,s<0&&(s=0),n.style.width=s+"px")})}},r.prototype._setTableWidth=function(e,t,r,i){var s,o,u=this;n.each(e,function(e,n){n[0].style.tableLayout="fixed",n[0].style.width=t-u._sizesAdjCache.subTable+"px"}),s=e[0].outerWidth(),o=s-t,o!==0&&this._setColumnWidth(i,r-o)},r.prototype._sumWidthArray=function(e,t,r){var i=0;return n.each(e,function(e,n){if(t!==undefined&&r!==undefined&&(e<t||e>r))return!0;i+=n.width}),i},r.prototype._clearBody=function(){n.each(this.subTables(),function(e,t){t.clearSection(2)})},r.prototype._rebuildOffsets=function(){n.each(this.subTables(),function(e,t){t.rebuildOffsets()})},r.prototype._removeBodyRow=function(t,n){var r=e.grid.rowType,i=this._wijgrid._rows(),s,o,u,a,f,l,c;if(t>=0&&t<(o=i.length())){if(n)for(s=0;s<o;s++)u=this._getRowInfo(i.item(s)),f=u.sectionRowIndex-t,u.sectionRowIndex>t&&(u.sectionRowIndex--,u.type&r.data&&(u.type&r.dataAlt?u.type&=~r.dataAlt:u.type|=r.dataAlt,u.dataItemIndex--,u.dataRowIndex--,u.virtualDataItemIndex--),this._setRowInfo(u.$rows,u));u=this._getRowInfo(i.item(t),!1),l=this.getAbsoluteRowIndex(u.$rows[0]),u.$rows.remove(),c=this.getJoinedTables(!1,l),c[0]&&c[0].removeOffset(c[2]),c[1]&&c[1].removeOffset(c[2])}},r.prototype._insertBodyRow=function(t,n,r,i){var s=this._wijgrid._field("visibleLeaves"),o=e.grid.rowType,u=this._wijgrid._view(),a=this._wijgrid._rows(),f=a.length(),l=(t.rowType&o.data)!==0,c,h,p;if(n<0||n>=f||!n&&n!==0)n=f;return c=this._insertEmptyRow(t.rowType,n,-1,r,i),this._renderRow(c,s,t),h=this.getAbsoluteRowIndex(c.$rows[0]),p=this.getJoinedTables(!1,h),p[0]&&p[0].insertOffset(h),p[1]&&p[1].insertOffset(h),c},r.prototype._findRowInfo=function(e){var t=this.bodyRows(),r=0,i=t.length(),s;if(n.isFunction(e))for(r=0;r<i;r++){s=this._getRowInfo(t.item(r));if(e(s)===!0)return s}return null},r.prototype._setRowInfo=function(t,n){var r="$rows"in n,i="data"in n,s,o;r&&(s=n.$rows,delete n.$rows),i&&(o=n.data,delete n.data),e.grid.dataPrefix(t,this._wijgrid._data$prefix,"rowInfo",n),r&&(n.$rows=s),i&&(n.data=o)},r.prototype._getRowInfo=function(t,r){typeof r=="undefined"&&(r=!0);var i=this._wijgrid,s=t[1]?n(t):n(t[0]),o=e.grid.dataPrefix(s,i._data$prefix,"rowInfo"),u;o.$rows=s;if(r&&o.dataItemIndex>=0&&o.type&e.grid.rowType.data)try{o.data=i._getDataItem(o.dataItemIndex)}catch(a){o.data=null}return o},r.prototype._getRowInfoBySketchRowIndex=function(t,n){typeof n=="undefined"&&(n=!0);var r=this._isRowRendered(t);if(r>=0){var i=this.bodyRows().item(r);return i?this._getRowInfo(i,n):null}var s=this._wijgrid.sketchTable[t],o=s.originalRowIndex,u={type:s.rowType,state:null,sectionRowIndex:null,dataRowIndex:null,virtualDataItemIndex:null,dataItemIndex:s.originalRowIndex,$rows:null};if(n&&u.dataItemIndex>=0&&u.type&e.grid.rowType.data)try{u.data=this._wijgrid._getDataItem(u.dataItemIndex)}catch(a){u.data=null}return u},r.prototype._createRowInfo=function(t,r,i,s,o,u,a){var f,l={type:r,state:i,sectionRowIndex:s,dataRowIndex:o,dataItemIndex:u,virtualDataItemIndex:a,$rows:t?n(t):null};return u>=0&&r&e.grid.rowType.data&&(l.data=this._wijgrid._getDataItem(u)),l},r.prototype._isRowRendered=function(e){var t=this._wijgrid._renderableBoundsCollection().getVisibleIndex(e);return t>=0&&t>=this._bounds.start&&t<=this._bounds.end?t-this._bounds.start:-1},r}();t.baseView=r})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(t){function r(e,n){t.call(this,e,n),this._dataTable=null,this._contentArea=null}return __extends(r,t),r.prototype.ensureWidth=function(e,r,i){var s=n(this._dataTable.element()),o=s.width()+r-i;t.prototype.ensureWidth.call(this,e,r,i),this._setTableWidth([s],o,r,e)},r.prototype.getVisibleAreaBounds=function(t){var n=e.grid.bounds(this._dataTable.element(),t);return n},r.prototype.getVisibleContentAreaBounds=function(){return this.getVisibleAreaBounds()},r.prototype.updateSplits=function(e){var t=this,r=this._wijgrid,i=r.options,s=r.element,o=[],u=[],a=[],f=r._field("visibleLeaves"),l=r.outerDiv,c,h;s.css({"table-layout":"",width:""}),n.each(f,function(e,n){var r,s=n.width;if(s||s===0){r=typeof s=="string"&&s.length>1&&s[s.length-1]==="%",r?s=l.width()*parseFloat(s)/100:s=parseFloat(s);if(n.ensurePxWidth||n.ensurePxWidth===undefined&&i.ensureColumnsPxWidth)n._realWidth=s;t._setColumnWidth(e,s)}}),n.each(f,function(e,n){o.push(t._getColumnWidth(e))}),s.css("width","1px"),n.each(f,function(e,n){u.push(t._getColumnWidth(e))}),c=l.width(),a=this._adjustWidthArray(o,u,c,i.ensureColumnsPxWidth),n.each(a,function(e,n){var r=f[e];if(r._realWidth!==undefined){delete r._realWidth;return}t._setColumnWidth(e,n.width)}),h=a.length-1,h!==-1&&this._setTableWidth([s],this._sumWidthArray(a,0,h),a[h].width,h)},r.prototype.focusableElement=function(){return n(this._dataTable.element())},r.prototype.forEachColumnCell=function(e,t,n){return this._dataTable.forEachColumnCell(e,t,n)},r.prototype.forEachRowCell=function(e,t,n){return this._dataTable.forEachRowCell(e,t,n)},r.prototype.getAbsoluteCellInfo=function(t,n){return new e.grid.cellInfo(this.getColumnIndex(t),t.parentNode.rowIndex,this._wijgrid,!0,n)},r.prototype.getAbsoluteRowIndex=function(e){return e.rowIndex},r.prototype.getCell=function(e,t){var n=this._dataTable.getCellIdx(e,t),r;if(n>=0){r=this.getJoinedRows(t,0);if(r[0])return r[0].cells[n]}return null},r.prototype.getColumnIndex=function(e){return this._dataTable.getColumnIdx(e)},r.prototype.getHeaderCell=function(t){var n=this._wijgrid._field("visibleLeaves")[t],r;return n&&(r=this._wijgrid._headerRows())?e.grid.rowAccessor.getCell(r.item(n.thY),n.thX):null},r.prototype.getJoinedCols=function(e){var t=n(this._dataTable.element()).find("> colgroup");return t.length&&e<t[0].childNodes.length?[t[0].childNodes[e],null]:[null,null]},r.prototype.getJoinedRows=function(e,t){return[this._dataTable.getSectionRow(e,t),null]},r.prototype.getJoinedTables=function(e,t){return[this._dataTable,null,t]},r.prototype.subTables=function(){return[this._dataTable]},r.prototype._preRender=function(){this._dataTable=new e.grid.htmlTableAccessor(this._wijgrid.element[0],!0,!0,!0)},r.prototype._postRender=function(){this._wijgrid.element.find("> tbody").addClass(this._wijgrid.options.wijCSS.content+" wijmo-wijgrid-data"),this._dataTable=new e.grid.htmlTableAccessor(this._wijgrid.element[0]),this._wijgrid._setAttr(this._wijgrid.element,{role:"grid",cellpadding:"0",border:"0",cellspacing:"0"}),this._wijgrid.element.css("border-collapse","separate"),t.prototype._postRender.call(this)},r.prototype._insertRow=function(t,n,r){var i=e.grid.rowType,s;switch(t){case i.header:case i.filter:s=this._dataTable.ensureTHead();break;case i.footer:s=this._dataTable.ensureTFoot();break;default:s=this._dataTable.ensureTBody()}return r?[s.appendChild(r)]:(n>s.rows.length&&(n=-1),[s.insertRow(n)])},r.prototype._rowRendered=function(e,n,r){var i=e.$rows[0];!i.cells.length&&this._isBodyRow(e)?i.parentNode.removeChild(i):t.prototype._rowRendered.call(this,e,n,r)},r.prototype._appendCell=function(e,t,n){e.$rows[0].appendChild(n[0])},r.prototype._createCol=function(e,t){return[document.createElement("col")]},r.prototype._appendCol=function(e,t,n){this._dataTable.appendCol(e[0])},r}(t.baseView);t.flatView=r})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(t){function r(e,i){t.call(this,e,i),this._verScrollBarSize=18,this._viewTables={},this._splitAreas={},this._rowHeight=r.defaultRowHeight,this.element=e.element,this._staticDataRowIndex=e._getStaticIndex(!0),this._staticRowIndex=e._getRealStaticRowIndex(),this._staticColumnIndex=e._getRealStaticColumnIndex(),this._staticAllColumnIndex=this._staticColumnIndex===-1?-1:e._field("visibleLeaves")[this._staticColumnIndex].leavesIdx,this._mouseWheelHandler=n.proxy(this._onMouseWheel,this)}return __extends(r,t),r.defaultRowHeight=22,r.prototype.dispose=function(){t.prototype.dispose.call(this),this._wijgrid.outerDiv.unbind("mousewheel",this._mouseWheelHandler)},r.prototype.ensureWidth=function(e,r,i){var s=this._wijgrid,o=s.options,u=this._staticColumnIndex,a=e<=u,f=n(this._viewTables.nw.element()),l=n(this._viewTables.ne.element()),c=n(this._viewTables.sw.element()),h=n(this._viewTables.se.element()),p=a?[f,c]:[l,h],d=(a?f.width():l.width())+r-i,v=this.getScrollValue();this._destroySuperPanel(),t.prototype.ensureWidth.call(this,e,r,i),this._setTableWidth(p,d,r,e);try{u>=0?o.splitDistanceX=f[0].offsetWidth:o.splitDistanceX=0}catch(m){}this._updateSplitAreaBounds(0),this._adjustRowsHeights();try{this._staticRowIndex>=0?o.splitDistanceY=Math.max(f[0].offsetHeight,l[0].offsetHeight):o.splitDistanceY=0}catch(m){}this._updateSplitAreaBounds(1),this.refreshPanel(v);var g=s._UIFrozener();g&&g.refresh()},r.prototype.ensureHeight=function(e){var t,r=this._wijgrid,i=r.options,s=n(this._viewTables.nw.element()),o=n(this._viewTables.ne.element()),u=n(this._viewTables.sw.element()),a=n(this._viewTables.se.element()),f=this.getScrollValue(),l;this._destroySuperPanel(),arguments.length>0&&(t=this.getJoinedRows(e,2),this._setRowHeight(t,this._getRowHeight(t))),a.css("height",""),u.css("height",""),l=Math.max(a.height(),u.height()),a.height(l),u.height(l);try{this._staticRowIndex>=0?i.splitDistanceY=Math.max(s[0].offsetHeight,o[0].offsetHeight):i.splitDistanceY=0}catch(c){}this._updateSplitAreaBounds(1),this.refreshPanel(f);var h=r._UIFrozener();h&&h.refresh()},r.prototype.getScrollValue=function(){var e=this._getSuperPanel();return e?{x:e.options.hScroller.scrollValue,y:e.options.vScroller.scrollValue}:null},r.prototype.getPanelContentWrapper=function(){return this._wijgrid.outerDiv.find(".wijmo-wijsuperpanel-contentwrapper:first")},r.prototype.getVisibleAreaBounds=function(t){var n=e.grid.bounds(this.getPanelContentWrapper(),t);return n||(n=e.grid.bounds(this._wijgrid.outerDiv,t)),n},r.prototype.getVisibleContentAreaBounds=function(){var t=this.getVisibleAreaBounds(),n=e.grid.bounds(this._viewTables.nw.element())||{},r=e.grid.bounds(this._viewTables.ne.element())||{},i=e.grid.bounds(this._viewTables.sw.element())||{},s=e.grid.bounds(this._viewTables.se.element())||{},o={top:t.top,left:t.left,width:Math.max(n.width+r.width,i.width+s.width),height:Math.max(n.height+i.height,r.height+s.height)};return o.width=Math.min(t.width,o.width),o.height=Math.min(t.height,o.height),o},r.prototype.getRowAreaHeight=function(){var e=this.getPanelContentWrapper();e.length==0&&(e=this._wijgrid.outerDiv);var t=e.height(),r=this._wijgrid.options.splitDistanceY;r&&(t-=r);var i=this.footerRow();return i&&(t-=n(i).height()),t},r.prototype.getVirtualPageSize=function(){return Math.ceil(this.getRowAreaHeight()/this._rowHeight)},r.prototype.getFixedAreaVisibleBounds=function(){var t=this.getVisibleAreaBounds(),n=e.grid.bounds(this._splitAreas.ne),r=e.grid.bounds(this._splitAreas.nw),i=null,s=null;if(n.height||r.height)i={left:t.left,top:t.top,width:t.width,height:Math.min(n.height||r.height,t.height)};return r.width&&(s={left:r.left,top:t.top,width:Math.min(r.width,t.width),height:t.height}),[i,s]},r.prototype.refreshPanel=function(t){var i=this,s=this._wijgrid,o=s.options,u=this._getGridWidth(o.scrollMode),a=this._getMappedScrollMode(),f=this._testNeedVBar(s.outerDiv,s.element,n(this._viewTables.ne.element()),o.scrollMode,s._autoHeight),l=f&&!p,c=t?t.x:null,h=t?t.y:null,p=n.support.isTouchEnabled&&n.support.isTouchEnabled(),d=s._rows().item(0);this._rowHeight=d&&d[0]?n(d[0]).outerHeight():r.defaultRowHeight,this._splitAreas.ne.width(u-o.splitDistanceX-(l?this._verScrollBarSize:0)),o.staticColumnsAlignment==="right"&&(this._splitAreas.nw.css({left:"",right:l?this._verScrollBarSize:0}),this._splitAreas.sw.css({left:"",right:l?this._verScrollBarSize:0})),this._scroller.data("wijmo-wijsuperpanel")?this._scroller.wijsuperpanel("paintPanel"):(this._wijgrid._allowVirtualScrolling()&&(this.vsUI=new e.grid.uiVirtualScroller(s,this._splitAreas.se,o.splitDistanceY,this._rowHeight)),this._scroller.wijsuperpanel({disabled:s.options.disabled,scroll:n.proxy(this._onScroll,this),bubbleScrollingEvent:!0,customScrolling:this._wijgrid._allowVirtualScrolling(),vScroller:{scrollBarVisibility:a.vScrollBarVisibility,scrollValue:t?t.y:null},hScroller:{scrollBarVisibility:a.hScrollBarVisibility,scrollValue:t?t.x:null},hScrollerActivating:function(e,t){var n;if(s._autoHeight){n=s.element.height()+o.splitDistanceY-t.contentLength;if(n>0)return i._scroller.height(i._scroller.height()+n),i._scroller.wijsuperpanel("paintPanel"),!1}i._splitAreas.sw.height(t.contentLength-o.splitDistanceY)}}),this._wijgrid._allowVirtualScrolling()&&this.vsUI.attach(this._scroller)),this._scroller.find(".wijmo-wijsuperpanel-hbarcontainer, .wijmo-wijsuperpanel-vbarcontainer").css("zIndex",5),this._wijgrid._allowVirtualScrolling()&&this._wijgrid._handleVirtualScrolling(this._bounds.start)},r.prototype.scrollTo=function(e){if(!e.tableCell())return;var t=this._wijgrid,r=t.options,i=this._getSuperPanel(),s=e.tableCell(),o=s.nodeType?n(s):s,u=null,a=null;if(i&&o.is(":visible")){var f=i.getContentElement(),l=f.parent(),c=parseInt((f.css("left")+"").replace("px",""),10)*-1,h=parseInt((f.css("top")+"").replace("px",""),10)*-1,p=l.outerWidth()-r.splitDistanceX,d=l.outerHeight()-r.splitDistanceY,v=o.position(),m=v.left,g=v.top,y=o.outerWidth(),b=o.outerHeight(),w=t._getStaticIndex(!0),E=t._getStaticIndex(!1),S=e.rowIndex(),x=e.cellIndex();S<=w?x<=E?(u=0,a=0):(m+=c,m+y>c+p&&(c=u=m+y-p),m<c&&(u=m),a=0):x<=E?(g+=this._splitAreas.sw.scrollTop(),g+b>h+d&&(h=a=g+b-d),g<h&&(a=g),u=0):(m-=r.splitDistanceX,g+b>h+d&&(h=a=g+b-d),m+y>c+p&&(c=u=m+y-p),g<h&&(a=g),m<c&&(u=m)),u!==null&&i.hScrollTo(u),a!==null&&(this._wijgrid._allowVirtualScrolling()||i.vScrollTo(a))}},r.prototype.updateSplits=function(e){var t=this._wijgrid,r=t.options,i,s=this,o=[],u=[],a=[],f=this._staticColumnIndex,l,c=r.scrollMode,h=t._field("visibleLeaves"),p=n(this._viewTables.se.element()),d=n(this._viewTables.ne.element()),v=n(this._viewTables.sw.element()),m=n(this._viewTables.nw.element()),g=t.outerDiv,y,b,w;this._destroySuperPanel(),g.unbind("mousewheel",this._mouseWheelHandler);if((y=s._viewTables.se.element().tBodies)&&(y=y[0])){w=!1;for(b=0;b<y.rows.length;b++)if(!n(y.rows[b]).hasClass("wijmo-wijgrid-groupheaderrow")){w=!0;break}w||t.element.css("width","100%")}n.each([p,d,v,m],function(e,t){t.css({"table-layout":"",width:""})}),n.each(h,function(e,t){var n,i=t.width;if(i||i===0){n=typeof i=="string"&&i.length>1&&i[i.length-1]==="%",n?i=g.width()*parseFloat(i)/100:i=parseFloat(i);if(t.ensurePxWidth||t.ensurePxWidth===undefined&&r.ensureColumnsPxWidth)t._realWidth=i;s._setColumnWidth(e,i)}}),n.each(h,function(e,t){a.push(s._getColumnWidth(e))}),n.each([m,d,v,p],function(e,t){t.css({width:"1px"})}),n.each(h,function(e,t){u.push(s._getColumnWidth(e))}),i=g.width(),o=this._adjustWidthArray(a,u,i,r.ensureColumnsPxWidth),n.each(o,function(e,t){var n=h[e];if(n._realWidth!==undefined){delete n._realWidth;return}s._setColumnWidth(e,t.width)}),f>=0&&(l=f,this._setTableWidth([m,v],this._sumWidthArray(o,0,l),o[l].width,l));try{f>=0?r.splitDistanceX=m[0].offsetWidth:r.splitDistanceX=0}catch(E){}this._updateSplitAreaBounds(0),r.ensureColumnsPxWidth||d.parent().width(i-r.splitDistanceX),l=o.length-1,l!==-1&&this._setTableWidth([d,p],this._sumWidthArray(o,f+1,l),o[l].width,l),this._adjustRowsHeights();try{this._staticRowIndex>=0?r.splitDistanceY=Math.max(m[0].offsetHeight,d[0].offsetHeight):r.splitDistanceY=0}catch(E){}this._updateSplitAreaBounds(1);if(!r.ensureColumnsPxWidth&&this._testNeedVBar(t.outerDiv,p,d,c,t._autoHeight)){i-=this._verScrollBarSize,o=this._adjustWidthArray(a,u,i,r.ensureColumnsPxWidth),n.each(o,function(e,t){t.real||s._setColumnWidth(e,t.width)}),f>=0&&(l=f,this._setTableWidth([m,v],this._sumWidthArray(o,0,l),o[l].width,l));try{f>=0?r.splitDistanceX=m[0].offsetWidth:r.splitDistanceX=0}catch(E){}this._updateSplitAreaBounds(0),d.parent().width(i-r.splitDistanceX),l=o.length-1,l!==-1&&this._setTableWidth([d,p],this._sumWidthArray(o,f+1,l),o[l].width,l),this._adjustRowsHeights();try{this._staticRowIndex>=0?r.splitDistanceY=Math.max(m[0].offsetHeight,d[0].offsetHeight):r.splitDistanceY=0}catch(E){}this._updateSplitAreaBounds(1)}this.refreshPanel(e),g.bind("mousewheel",n.proxy(this._mouseWheelHandler,this))},r.prototype._clearBody=function(){t.prototype._clearBody.call(this)},r.prototype.bodyRows=function(){var e=t.prototype.bodyRows.call(this);return e},r.prototype.focusableElement=function(){return this._wijgrid.outerDiv},r.prototype.forEachColumnCell=function(e,t,n){var r=this.getJoinedTables(!0,e),i,s;if(r[0]!==null){i=r[2],s=r[0].forEachColumnCell(i,t,n);if(s!==!0)return s;if(r[1]!==null){s=r[1].forEachColumnCell(i,t,n);if(s!==!0)return s}}return!0},r.prototype.forEachRowCell=function(e,t,n){var r=this.getJoinedTables(!1,e),i=r[0],s=r[1],o,u;if(i!==null){o=r[2];if(o<i.element().rows.length){u=i.forEachRowCell(o,t,n);if(u!==!0)return u}if(s!==null&&o<s.element().rows.length){u=s.forEachRowCell(o,t,n);if(u!==!0)return u}}return!0},r.prototype.getAbsoluteCellInfo=function(t,n){return new e.grid.cellInfo(this.getColumnIndex(t),this.getAbsoluteRowIndex(t.parentNode),this._wijgrid,!0,n)},r.prototype.getAbsoluteRowIndex=function(e){var t=e.rowIndex,n=e.parentNode;while(n.tagName.toLowerCase()!=="table")n=n.parentNode;return n===this._viewTables.nw.element()||n===this._viewTables.ne.element()?t:t+this._staticRowIndex+1},r.prototype.getCell=function(e,t){var n=this.getJoinedTables(!1,t),r,i,s,o,u;if(n[0]!==null){r=this.getJoinedTables(!0,e);if(r[0]!==null){i=n[2],s=r[2],o=null,n[1]!==null?o=e===s?n[0]:n[1]:o=n[0],u=o.getCellIdx(s,i);if(u>=0)return o.element().rows[i].cells[u]}}return null},r.prototype.getColumnIndex=function(e){var t=null,n=null,r=!1,i;for(t=e.parentNode;t.tagName.toLowerCase()!=="table";t=t.parentNode);if(t!==null){t===this._viewTables.nw.element()?n=this._viewTables.nw:t===this._viewTables.ne.element()?(n=this._viewTables.ne,r=!0):t===this._viewTables.sw.element()?n=this._viewTables.sw:t===this._viewTables.se.element()&&(n=this._viewTables.se,r=!0);if(n!==null)return i=n.getColumnIdx(e),r&&(i+=this._staticColumnIndex+1),i}return-1},r.prototype.getHeaderCell=function(t){var n=this._wijgrid._field("visibleLeaves")[t],r;return n&&(r=this._wijgrid._headerRows())?e.grid.rowAccessor.getCell(r.item(n.thY),n.thX):null},r.prototype.getJoinedCols=function(e){var t=[],r=this.getJoinedTables(!0,e),i=r[2];return r.splice(r.length-1,1),n.each(r,function(e,r){t.push(r?n(r.element()).find("col")[i]:null)}),t},r.prototype.getJoinedRows=function(e,t){var n=null,r=null,i=null,s=null,o=this._staticRowIndex,u=this._staticColumnIndex,a=this._wijgrid._field("visibleLeaves").length-1,f=this._rowsCountRaw()-1,l=o===f,c=o<0,h=!l&&!c,p=0;if(l||h)u>=0&&u<a?(i=this._viewTables.nw,s=this._viewTables.ne):i=u<0?this._viewTables.ne:this._viewTables.nw,p=i.getSectionLength(t),e<p&&(n=i.getSectionRow(e,t),s!==null&&(r=s.getSectionRow(e,t)));if(c||h&&n===null)c||(e-=p),u>=0&&u<a?(i=this._viewTables.sw,s=this._viewTables.se):i=u<0?this._viewTables.se:this._viewTables.sw,n=i.getSectionRow(e,t),s!==null&&(r=s.getSectionRow(e,t));return n===null&&r===null?null:[n,r]},r.prototype.getJoinedTables=function(e,t){var n=null,r=null,i=t,s=this._wijgrid,o=this._staticRowIndex,u=this._staticColumnIndex;return e?(t<=u?(n=this._viewTables.nw,r=this._viewTables.sw):(n=this._viewTables.ne,r=this._viewTables.se,i-=u+1),o<0&&(n=null),o===this._rowsCountRaw()-1&&(r=null)):(t<=o?(n=this._viewTables.nw,r=this._viewTables.ne):(n=this._viewTables.sw,r=this._viewTables.se,i-=o+1),u<0&&(n=null),u===s._field("leaves").length-1&&(r=null)),n===null&&(n=r,r=null),[n,r,i]},r.prototype.subTables=function(){return[this._viewTables.nw,this._viewTables.ne,this._viewTables.sw,this._viewTables.se]},r.prototype._getGridWidth=function(e){var t=this._wijgrid,r=t.element.outerWidth(!0)+t.options.splitDistanceX,i=t.outerDiv.innerWidth();return this._testNeedVBar(t.outerDiv,t.element,n(this._viewTables.ne.element()),e,t._autoHeight)&&(r+=this._verScrollBarSize),r>i&&(r=i),r},r.prototype._getSuperPanel=function(){return this._scroller?this._scroller.data("wijmo-wijsuperpanel"):null},r.prototype._ensureRenderBounds=function(){this._wijgrid._allowVirtualScrolling()?(this._wijgrid._ensureVisibleRowsBounds(this._bounds),this._wijgrid._serverSideVirtualScrolling(),this._bounds.end=this._bounds.start+this.getVirtualPageSize()-1,this._wijgrid._ensureVisibleRowsBounds(this._bounds)):t.prototype._ensureRenderBounds.call(this)},r.prototype._renderContent=function(){t.prototype._renderContent.call(this)},r.prototype._preRender=function(){var t=document.createDocumentFragment(),r=e.grid.htmlTableAccessor;this._wijgrid.outerDiv.wrapInner('<div class="wijmo-wijgrid-fixedview"><div class="wijmo-wijgrid-scroller"><div class="wijmo-wijgrid-split-area-se wijmo-wijgrid-content-area"></div></div></div>'),this._scroller=this._wijgrid.outerDiv.find(".wijmo-wijgrid-scroller"),this._scroller.css("padding",0),this._scroller.after(this._splitAreas.nw=n('<div class="wijmo-wijgrid-split-area wijmo-wijgrid-split-area-nw" style="overflow:hidden;position:absolute;z-index:4;top:0px;left:0px;"></div>')),this._scroller.after(this._splitAreas.ne=n('<div class="wijmo-wijgrid-split-area wijmo-wijgrid-split-area-ne" style="overflow:hidden;position:absolute;z-index:4;top:0px;left:0px;"></div>')),this._scroller.after(this._splitAreas.sw=n('<div class="wijmo-wijgrid-split-area wijmo-wijgrid-split-area-sw" style="overflow:hidden;position:absolute;z-index:4;top:0px;left:0px;"></div>')),this._splitAreas.se=this._scroller.find(".wijmo-wijgrid-split-area-se:first"),this._viewTables={nw:new r(t.appendChild(document.createElement("table")),!0,!0,!0),ne:new r(t.appendChild(document.createElement("table")),!0,!0,!0),sw:new r(t.appendChild(document.createElement("table")),!0,!0,!0),se:new r(t.appendChild(this._wijgrid.element[0]),!0,!0,!0)}},r.prototype._postRender=function(){var r,i,s,o,u=e.grid.htmlTableAccessor,a=this;this._viewTables={nw:new u(r=this._viewTables.nw.element()),ne:new u(i=this._viewTables.ne.element()),sw:new u(s=this._viewTables.sw.element()),se:new u(o=this._viewTables.se.element())},this._splitAreas.nw.empty().append(r),this._splitAreas.ne.empty().append(i),this._splitAreas.sw.empty().append(s),this._splitAreas.se.empty().append(o),n.each(this._viewTables,function(e,t){var r=n(t.element());a._wijgrid._setAttr(r,{role:"grid",border:"0",cellpadding:"0",cellspacing:"0"}),r.addClass("wijmo-wijgrid-table").css("border-collapse","separate").find("> tbody").addClass(a._wijgrid.options.wijCSS.content+" wijmo-wijgrid-data")}),t.prototype._postRender.call(this)},r.prototype._rowsCountRaw=function(){var e=this._viewTables.nw.element(),t=this._viewTables.ne.element(),n=this._viewTables.sw.element(),r=this._viewTables.se.element(),i;return i=Math.max(e.rows.length,t.rows.length)+Math.max(n.rows.length,r.rows.length),i},r.prototype._createCol=function(e,t){return[document.createElement("col"),document.createElement("col")]},r.prototype._appendCol=function(e,t,n){n<=this._staticColumnIndex?(this._viewTables.nw.appendCol(e[0]),this._viewTables.sw.appendCol(e[1])):(this._viewTables.ne.appendCol(e[0]),this._viewTables.se.appendCol(e[1]))},r.prototype._insertRow=function(t,n,r){var i=e.grid.rowType,s,o,u=this._viewTables;switch(t){case i.header:case i.filter:s=u.nw.ensureTHead(),o=u.ne.ensureTHead();break;case i.footer:s=u.sw.ensureTFoot(),o=u.se.ensureTFoot();break;default:n<=this._staticDataRowIndex?(s=u.nw.ensureTBody(),o=u.ne.ensureTBody()):(n-=this._staticDataRowIndex+1,s=u.sw.ensureTBody(),o=u.se.ensureTBody())}return r?[s.appendChild(r),o.appendChild(r.cloneNode(!1))]:[s.insertRow(n>s.rows.length?-1:n),o.insertRow(n>o.rows.length?-1:n)]},r.prototype._rowRendered=function(e,r,i){var s=e.$rows[0],o=e.$rows[1];!s.cells.length&&this._isBodyRow(e)&&(s.parentNode.removeChild(s),s=null),!o.cells.length&&this._isBodyRow(e)&&(o.parentNode.removeChild(o),o=null);if(s||o){if(!s||!o)e.$rows=s?n(s):n(o);t.prototype._rowRendered.call(this,e,r,i)}},r.prototype._appendCell=function(t,n,r){var i=t.type!==e.grid.rowType.header?this._staticColumnIndex:this._staticAllColumnIndex;n<=i?t.$rows[0].appendChild(r[0]):t.$rows[1].appendChild(r[0])},r.prototype._getRowHeight=function(e,t){if(e[0]&&e[1]){var r=e[0],i=e[1],s=n(r),o=n(i),u,a,f,l=function(e){var t,r=e[0],i;for(t=0;t<r.cells.length;t++){i=r.cells[t];if(!i.rowSpan||i.rowSpan===1)return n(i).outerHeight()}return e.height()};return(f=n.data(r,"customHeight"))?u=a=parseInt(f):(s.css("height",""),o.css("height",""),t?(u=l(s),a=l(o)):(u=s.height(),a=o.height())),Math.max(u,a)}return null},r.prototype._setRowHeight=function(e,t){if(e[0]&&e[1]){var r=[n(e[0]),n(e[1])],i;if(t===null)return;t+=1,n.each(r,function(e,n){n.height(t),i=t-n.height(),i&&n.height(t+i)})}},r.prototype._adjustRowHeight=function(){var e=this._wijgrid,t=this._staticColumnIndex,n=e._field("visibleLeaves").length-1,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b=[];if(t>-1&&t<n){r=this._staticRowIndex,i=this._rowsCountRaw()-1,s=this._viewTables;if(r>-1&&r<=i){o=s.ne.element(),u=o.parentNode,a=s.nw.element(),f=a.parentNode,g=a.rows,y=o.rows,d=g.length;for(v=0;v<d;v++)b.push(this._getRowHeight([g[v],y[v]],!0))}if(r>=-1&&r<i){l=s.se.element(),c=l.parentNode,h=s.sw.element(),p=h.parentNode,g=h.rows,y=l.rows,d=g.length;for(v=0;v<d;v++)b.push(this._getRowHeight([g[v],y[v]]))}r>-1&&r<=i&&(f.removeChild(a),u.removeChild(o)),r>=-1&&r<i&&(p.removeChild(h),c.removeChild(l));if(r>-1&&r<=i){g=a.rows,y=o.rows,d=g.length;for(v=0,m=0;v<d;v++)this._setRowHeight([g[v],y[v]],b[m++])}if(r>=-1&&r<i){g=h.rows,y=l.rows,d=g.length;for(v=0;v<d;v++)this._setRowHeight([g[v],y[v]],b[m++])}r>-1&&r<=i&&(f.appendChild(a),u.appendChild(o)),r>=-1&&r<i&&(p.appendChild(h),c.appendChild(l))}},r.prototype._adjustRowsHeights=function(){var e=n(this._viewTables.sw.element()),t=n(this._viewTables.se.element()),r;t.css("height",""),e.css("height",""),this._adjustRowHeight(),r=Math.max(t.height(),e.height()),e.height(r),t.height(r)},r.prototype._destroySuperPanel=function(){this._scroller.data("wijmo-wijsuperpanel")&&(this.vsUI&&this.vsUI.dispose(),this._scroller.wijsuperpanel("destroy"))},r.prototype._onScroll=function(e,t){var n=this._getSuperPanel();this._wijgrid._allowVirtualScrolling()?t.dir==="h"&&(this._setFixedAreaPosition(n.getContentElement(),t.dir,t.position,t.animationOptions,!1),this._setFixedAreaPosition(this._splitAreas.ne,t.dir,t.position,t.animationOptions,!0)):this._setFixedAreaPosition(t.dir==="h"?this._splitAreas.ne:this._splitAreas.sw,t.dir,t.position,t.animationOptions,!0),this._wijgrid._trackScrollingPosition(n.options.hScroller.scrollValue,n.options.vScroller.scrollValue)},r.prototype._onMouseWheel=function(t,r){var i,s=r>0?"top":"bottom",o=!1,u;this._wijgrid._canInteract()&&(i=this.getFixedAreaVisibleBounds(),n.each(i,function(n,r){if(r&&e.grid.isOver(t.pageY,t.pageX,r.top,r.left,r.height,r.width))return o=!0,!1}),o&&this._scroller.data("wijmo-wijsuperpanel")&&(u=this._scroller.wijsuperpanel("option","vScroller").scrollValue,this._scroller.wijsuperpanel("doScrolling",s),u!==this._scroller.wijsuperpanel("option","vScroller").scrollValue&&(t.stopPropagation(),t.preventDefault())))},r.prototype._setFixedAreaPosition=function(e,t,n,r,i){var s={},o;t==="h"?o=i?"scrollLeft":"left":o=i?"scrollTop":"top",i||(n=-n),r?(s[o]=n,e.animate(s,r)):i?e[0][o]=n:e.css(o,n)},r.prototype._testNeedVBar=function(e,t,n,r,i){var s,o=this._wijgrid,u=n.width()+o.options.splitDistanceX,a=t.height()+o.options.splitDistanceY,f=e.width(),l=e.height(),c,h=0,p=0;return this._wijgrid._allowVirtualScrolling()&&o._totalRowsCount()>1?!0:(o.$superPanelHeader!==null&&(h=o.$superPanelHeader.outerHeight(!0)),o.$bottomPagerDiv!==null&&(p=o.$bottomPagerDiv.outerHeight(!0)),c=l-h-p,r==="both"||r==="vertical"?s=!0:s=r==="auto"&&(a>c||!i&&u>f&&a>c-this._verScrollBarSize),s)},r.prototype._updateSplitAreaBounds=function(e){var t=this._wijgrid,n=t.options,r,i,s=0,o=0;if(e===0||e===2)this._splitAreas.nw.width(n.splitDistanceX),this._splitAreas.sw.width(n.splitDistanceX),t.options.staticColumnsAlignment==="right"?(this._splitAreas.se.css("marginRight",n.splitDistanceX),this._splitAreas.ne.css("marginRight",n.splitDistanceX)):(this._splitAreas.se.css("marginLeft",n.splitDistanceX),this._splitAreas.ne.css("marginLeft",n.splitDistanceX));if(e===1||e===2)this._scroller.css("height",""),this._splitAreas.se.css("marginTop",0),r=t.outerDiv.height(),t._autoHeight?this._scroller.height(r+n.splitDistanceY):this._scroller.height(r),this._splitAreas.nw.height(n.splitDistanceY),this._splitAreas.ne.height(n.splitDistanceY),t.$superPanelHeader!==null&&(s=t.$superPanelHeader.outerHeight(!0)),t.$bottomPagerDiv!==null&&(o=t.$bottomPagerDiv.outerHeight(!0)),i=r-s-o,t.$superPanelHeader!==null&&(this._splitAreas.nw.css("top",s+"px"),this._splitAreas.ne.css("top",s+"px")),t._autoHeight?this._splitAreas.sw.height(i):this._splitAreas.sw.height(i-n.splitDistanceY),this._splitAreas.sw.css("top",n.splitDistanceY+s),this._splitAreas.se.css("marginTop",n.splitDistanceY)},r}(t.baseView);t.fixedView=r})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(){function r(e){this._updates=0,this._selectedColumns=null,this._selectedRows=null,this._extend_rules={singlecell:[0,0,0],singlecolumn:[1,1,1],singlerow:[2,2,2],singlerange:[0,1,2],multicolumn:[1,1,1],multirow:[2,2,2],multirange:[0,1,2]};if(!e)throw"invalid arguments";this._wijgrid=e,this._addedCells=new i(e),this._removedCells=new i(e),this._selectedCells=new i(e),this._addedDuringCurTransactionCells=new i(e)}return r.prototype.selectedCells=function(){return this._selectedCells},r.prototype.addColumns=function(e,t){!t&&t!==0&&(t=e),this.addRange(e,0,t,16777215)},r.prototype.addRange=function(t,n,r,i){if(!t&&arguments.length===1)throw"invalid argument";var s=arguments.length===4?new e.grid.cellInfoRange(new e.grid.cellInfo(t,n),new e.grid.cellInfo(r,i)):t._clone();s._normalize();if(!s._isValid())throw"invalid argument";this.beginUpdate(),this._startNewTransaction(this._wijgrid._field("currentCell")),this._selectRange(s,!1,!0,e.grid.cellRangeExtendMode.none,null),this.endUpdate()},r.prototype.addRows=function(e,t){!t&&t!==0&&(t=e),this.addRange(0,e,16777215,t)},r.prototype.removeRange=function(t,n,r,i){if(!t&&arguments.length===1)throw"invalid argument";var s=arguments.length===4?new e.grid.cellInfoRange(new e.grid.cellInfo(t,n),new e.grid.cellInfo(r,i)):t._clone();s._normalize();if(!s._isValid())throw"invalid argument";this.beginUpdate(),this._startNewTransaction(this._wijgrid._field("currentCell")),this._clearRange(s,e.grid.cellRangeExtendMode.none),this.endUpdate()},r.prototype.removeColumns=function(e,t){!t&&t!==0&&(t=e),this.removeRange(e,0,t,16777215)},r.prototype.removeRows=function(e,t){!t&&t!==0&&(t=e),this.removeRange(0,e,16777215,t)},r.prototype.clear=function(){this.beginUpdate(),this._removedCells._clear(),this._removedCells._addFrom(this._selectedCells),this.endUpdate()},r.prototype.selectAll=function(){this.beginUpdate(),this._selectRange(this._wijgrid._getDataCellsRange(t.dataRowsRangeMode.sketch),!1,!1,e.grid.cellRangeExtendMode.none,null),this.endUpdate()},r.prototype.beginUpdate=function(){this._updates++},r.prototype.endUpdate=function(){if(this._updates>0){this._updates--;if(this._updates===0){this.doSelection();if(this._addedCells.length()||this._removedCells.length())this._selectedColumns!==null&&this._selectedColumns.UnderlyingDataChanged(),this._selectedRows!==null&&this._selectedRows.UnderlyingDataChanged(),this._wijgrid._trigger("selectionChanged",null,{addedCells:this._addedCells,removedCells:this._removedCells});this._addedCells=new e.grid.cellInfoOrderedCollection(this._wijgrid),this._removedCells._clear()}}},r.prototype._multipleRangesAllowed=function(){var e=this._wijgrid.options.selectionMode;return e&&((e=e.toLowerCase())==="multicolumn"||e==="multirow"||e==="multirange")},r.prototype._anchorCell=function(){return this.__anchorCell},r.prototype._startNewTransaction=function(t){t&&(this.__anchorCell=t._clone(),this._addedDuringCurTransactionCells=new e.grid.cellInfoOrderedCollection(this._wijgrid))},r.prototype._clearRange=function(e,n){var r=this._wijgrid.options.selectionMode.toLowerCase(),i,s,o,u,a,f,l,c,h,p=this._wijgrid._getDataCellsRange(t.dataRowsRangeMode.sketch);if(e._isValid()&&r!=="none"&&this._selectedCells.length()>0){i=e._clone(),i._normalize(),i._clip(p);if(!e._isValid())return;i._extend(this._extend_rules[r][n],p),this.beginUpdate();for(l=0,c=this._selectedCells.length();l<c;l++)h=this._selectedCells.item(l),i._containsCellInfo(h)&&this._removedCells._add(h);this.endUpdate()}},r.prototype._selectRange=function(n,r,i,s,o){var u=this._wijgrid.options.selectionMode.toLowerCase(),a,f=this._wijgrid._getDataCellsRange(t.dataRowsRangeMode.sketch);if(u!=="none"&&n._isValid()){a=n._clone(),a._normalize(),a._clip(f);if(!a._isValid())return;this.beginUpdate(),this._multipleRangesAllowed()?r||i?i&&(this._removedCells._clear(),this._removedCells._addFrom(this._addedDuringCurTransactionCells)):this.clear():this.clear();switch(u){case"singlecell":case"singlecolumn":case"singlerow":a=o===null?new e.grid.cellInfoRange(a.topLeft(),a.topLeft()):new e.grid.cellInfoRange(o,o)}a._extend(this._extend_rules[u][s],f),this.doRange(a,!0),this.endUpdate()}},r.prototype._ensureSelection=function(){var e=this._wijgrid._view(),t=-2,n;for(var r=0;r<this._selectedCells.length();r++){var i=this._selectedCells.item(r);i._isRendered()&&(t!==i.rowIndex()&&(n=i.row(),t=i.rowIndex()),this.selectCell(i,n,e,!0))}},r.prototype.doSelection=function(){var t=this._wijgrid._view(),n,r,i,s,o,u,a=e.grid.renderState,f,l,c=-1;for(n=0,r=this._removedCells.length();n<r;n++)i=this._removedCells.item(n),this._addedCells.indexOf(i)<0?(c!==i.rowIndex()&&(f=i.row(),c=i.rowIndex()),this.selectCell(i,f,t,!1),this._selectedCells._remove(i),this._addedDuringCurTransactionCells._remove(i)):(this._removedCells._removeAt(n),n--,r--);c=-1;for(n=0,r=this._addedCells.length();n<r;n++)i=this._addedCells.item(n),u=this._selectedCells.indexOf(i),u<0?(c!==i.rowIndex()&&(f=i.row(),c=i.rowIndex()),this.selectCell(i,f,t,!0),this._selectedCells._insertUnsafe(i,~u),this._addedDuringCurTransactionCells._add(i)):(this._addedCells._removeAt(n),n--,r--)},r.prototype.selectCell=function(t,r,i,s){if(t._isRendered()){var o=this._wijgrid._viewPortBounds(),u=i.getCell(t.cellIndexAbs(),t.rowIndexAbs());if(u){var a=n(u),f=i._changeCellRenderState(a,e.grid.renderState.selected,s===!0);this._wijgrid.cellStyleFormatter.format(a,t.cellIndex(),t.column(),r,f)}}},r.prototype.doRange=function(t,n){var r=t.topLeft().cellIndex(),i=t.topLeft().rowIndex(),s=t.bottomRight().cellIndex(),o=t.bottomRight().rowIndex(),u,a,f,l,c=this._wijgrid._view(),h,p,d=this._wijgrid._viewPortBounds();if(n){u=this._addedCells.length(),p=this._wijgrid._rows();for(a=i;a<=o;a++){h=c._getRowInfoBySketchRowIndex(a);if(h.type&e.grid.rowType.data)for(f=r;f<=s;f++)l=new e.grid.cellInfo(f,a),u===0?this._addedCells._appendUnsafe(l):this._addedCells._add(l)}}else{u=this._removedCells.length();for(a=i;a<=o;a++)for(f=r;f<=s;f++)l=new e.grid.cellInfo(f,a),u===0?this._removedCells._appendUnsafe(l):this._removedCells._add(l)}},r}();t.selection=r;var i=function(){function t(e){this._clear=function(){this._list.length=0};if(!e)throw"invalid arguments";this._wijgrid=e,this._list=[]}return t.prototype.item=function(e){return this._list[e]},t.prototype.length=function(){return this._list.length},t.prototype.indexOf=function(e,t){arguments.length===1&&(t=e.rowIndex(),e=e.cellIndex());var n=0,r=this._list.length-1,i,s,o;while(n<=r){i=n+(r-n>>1),s=this._list[i],o=s.rowIndex()-t,o===0&&(o=s.cellIndex()-e);if(o<0)n=i+1;else{if(!(o>0))return i;r=i-1}}return~n},t.prototype.toString=function(){var e="",t,n;for(t=0,n=this._list.length;t<n;t++)e+=this._list[t].toString()+"\n";return e},t.prototype._add=function(e){var t=this.indexOf(e);return t<0?(this._list.splice(~t,0,e),e._setGridView(this._wijgrid),!0):!1},t.prototype._addFrom=function(e){if(e){var t=e.length(),n=this._list.length,r;if(n===0){this._list.length=t;for(r=0;r<t;r++)this._list[r]=e.item(r),this._list[r]._setGridView(this._wijgrid)}else for(r=0;r<t;r++)this._add(e.item(r))}},t.prototype._appendUnsafe=function(e){this._list[this._list.length]=e,e._setGridView(this._wijgrid)},t.prototype._insertUnsafe=function(e,t){this._list.splice(t,0,e)},t.prototype._remove=function(e){var t=this.indexOf(e);return t>=0?(this._list.splice(t,1),!0):!1},t.prototype._removeAt=function(e){this._list.splice(e,1)},t.prototype._getColumnsIndicies=function(){var e=[],t=this._list.length,n,r,i;if(t){n=[];for(r=0;r<t;r++)n[this._list[r].cellIndex()]=1;t=n.length,i=0;for(r=0;r<t;r++)n[r]&&(e[i++]=r)}return e},t.prototype._getSelectedRowsIndicies=function(){var e=[],t=this._list.length,n,r,i;if(t){n=[];for(r=0;r<t;r++)n[this._list[r].rowIndex()]=1;t=n.length,i=0;for(r=0;r<t;r++)n[r]&&(e[i++]=r)}return e},t.prototype._rectangulate=function(){var t=this._list.length,n=4294967295,r=4294967295,i=0,s=0,o,u;if(t){for(o=0;o<t;o++)u=this._list[o],n=Math.min(n,u.cellIndex()),r=Math.min(r,u.rowIndex()),i=Math.max(i,u.cellIndex()),s=Math.max(s,u.rowIndex());return new e.grid.cellInfoRange(new e.grid.cellInfo(n,r),new e.grid.cellInfo(i,s))}return null},t}();t.cellInfoOrderedCollection=i})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(){function r(t){this._gap_to_start=10,this._inProgress=!1,this._additionalEventsAttached=!1,this._wijgrid=t,this._evntFormat="{0}."+this._wijgrid.widgetName+".selectionui",this._addedCells=new e.grid.cellInfoOrderedCollection(this._wijgrid),this._view=this._wijgrid._view(),this._rootElement=this._view.focusableElement(),this._visLeavesLen=this._wijgrid._field("visibleLeaves").length,this._rootElement.bind(this._eventKey("mousedown"),n.proxy(this._onGridMouseDown,this))}return r.prototype.dispose=function(){this._rootElement.unbind(this._eventKey("mousedown"),this._onGridMouseDown),this._detachAdditionalEvents()},r.prototype._onGridMouseDown=function(e){if(!this._wijgrid._canInteract()||this._wijgrid.options.selectionMode.toLowerCase()==="none")return;var t=this._view.getVisibleContentAreaBounds(),r={x:e.pageX,y:e.pageY},i=e.target&&e.target.tagName!==undefined?e.target.tagName.toLowerCase():undefined,s=n(e.target);(!i||s.is("td.wijgridtd, th.wijgridtd, div.wijmo-wijgrid-innercell"))&&r.x>t.left&&r.x<t.left+t.width&&r.y>t.top&&r.y<t.top+t.height&&(this._attachAdditionalEvents(),this._startPos=r,this._startCellInfo=this._coordToDataCellInfo(this._startPos))},r.prototype._onDocumentMouseMove=function(r){if(!this._startCellInfo||!this._startCellInfo._isValid())return;var i={x:r.pageX,y:r.pageY},s,o,u,a,f,l,c,h,p,d,v,m,g,y,b=this._wijgrid._view(),w=this._wijgrid._rows(),E=e.grid.renderState;this._inProgress||(this._inProgress=Math.abs(this._startPos.x-i.x)>this._gap_to_start||Math.abs(this._startPos.y-i.y)>this._gap_to_start);if(this._inProgress){s=this._coordToDataCellInfo(i);if(!s._isValid())return;this._endCellInfo=s,u=new e.grid.cellInfoRange(this._startCellInfo,this._endCellInfo),u._normalize(),u._clip(this._wijgrid._getDataCellsRange(t.dataRowsRangeMode.sketch));if(u._isValid()&&!u.isEqual(this._prevMouseMoveRange)){this._prevMouseMoveRange=u,a=new e.grid.cellInfoOrderedCollection(this._wijgrid),f=u.bottomRight().rowIndex(),l=u.bottomRight().cellIndex();for(c=u.topLeft().rowIndex();c<=f;c++){m=b._getRowInfoBySketchRowIndex(c);if(m.type&e.grid.rowType.data)for(h=u.topLeft().cellIndex();h<=l;h++)a._appendUnsafe(new e.grid.cellInfo(h,c))}g=-1;for(p=0,d=this._addedCells.length();p<d;p++)o=this._addedCells.item(p),a.indexOf(o)<0&&(this._wijgrid.selection().selectedCells().indexOf(o)<0&&(h=this._view.getCell(o.cellIndexAbs(),o.rowIndexAbs()),h&&(g!==o.rowIndex()&&(m=o.row(),g=o.rowIndex()),v=n(h),y=b._changeCellRenderState(v,E.selected,!1),this._wijgrid.cellStyleFormatter.format(v,o.cellIndex(),o.column(),m,y))),this._addedCells._removeAt(p),p--,d--);g=-1;for(p=0,d=a.length();p<d;p++)o=a.item(p),this._addedCells.indexOf(o)<0&&this._wijgrid.selection().selectedCells().indexOf(o)<0&&this._addedCells._add(o)&&(h=this._view.getCell(o.cellIndexAbs(),o.rowIndexAbs()),h&&(g!==o.rowIndex()&&(m=o.row(),g=o.rowIndex()),v=n(h),y=b._changeCellRenderState(v,E.selected,!0),this._wijgrid.cellStyleFormatter.format(v,o.cellIndex(),o.column(),m,y)))}}},r.prototype._onDocumentMouseUp=function(t){this._detachAdditionalEvents();if(this._inProgress){this._inProgress=!1;if(this._prevMouseMoveRange&&this._prevMouseMoveRange._isValid()){this._wijgrid._changeCurrentCell(t,this._endCellInfo,{changeSelection:!1,setFocus:!1}),(!t.shiftKey||!this._wijgrid.selection()._multipleRangesAllowed()&&this._wijgrid.options.selectionMode.toLowerCase()!=="singleRange")&&this._wijgrid.selection()._startNewTransaction(this._startCellInfo),this._wijgrid.selection().beginUpdate(),this._wijgrid.selection()._selectRange(this._prevMouseMoveRange,t.shiftKey,t.ctrlKey,e.grid.cellRangeExtendMode.none,this._endCellInfo),this._wijgrid.selection().endUpdate();var r=this._wijgrid._view(),i=-1,s,o=e.grid.renderState;for(var u=0,a=this._addedCells.length();u<a;u++){var f=this._addedCells.item(u);if(this._wijgrid.selection().selectedCells().indexOf(f)<0){var l=r.getCell(f.cellIndexAbs(),f.rowIndexAbs());if(l!==null){i!==f.rowIndex()&&(s=f.row(),i=f.rowIndex());var c=n(l),h=r._changeCellRenderState(c,o.selected,!1);this._wijgrid.cellStyleFormatter.format(c,f.cellIndex(),f.column(),s,h)}}}return this._addedCells._clear(),this._startCellInfo=this._endCellInfo=this._prevMouseMoveRange=null,!1}}},r.prototype._attachAdditionalEvents=function(){if(!this._additionalEventsAttached)try{this._view.toggleDOMSelection(!1),n(document).bind(this._eventKey("mousemove"),n.proxy(this._onDocumentMouseMove,this)).bind(this._eventKey("mouseup"),n.proxy(this._onDocumentMouseUp,this))}finally{this._additionalEventsAttached=!0}},r.prototype._detachAdditionalEvents=function(){if(this._additionalEventsAttached)try{this._view.toggleDOMSelection(!0),n(document).unbind(this._eventKey("mousemove"),this._onDocumentMouseMove).unbind(this._eventKey("mouseup"),this._onDocumentMouseUp)}finally{this._additionalEventsAttached=!1}},r.prototype._eventKey=function(t){return e.grid.stringFormat(this._evntFormat,t)},r.prototype._coordToDataCellInfo=function(t){var n=0,r=this._visLeavesLen-1,i=0,s=-1,o,u=new e.grid.rowAccessor(this._view,2,0,0),a,f,l,c;while(n<=r){i=(r-n>>1)+n,o=e.grid.bounds(this._view.getHeaderCell(i)),o||(f=u.item(0),o=e.grid.bounds(e.grid.rowAccessor.getCell(f,i)));if(!o)break;if(t.x<o.left)r=i-1;else{if(!(t.x>o.left+o.width)){s=i;break}n=i+1}}if(s===-1)return e.grid.cellInfo.outsideValue;u=new e.grid.rowAccessor(this._view,0,0,0),a=-1,n=0,r=u.length()-1,i=0;while(n<=r){i=(r-n>>1)+n,f=u.item(i),o=e.grid.bounds(e.grid.rowAccessor.getCell(f,0));if(t.y<o.top)r=i-1;else{if(!(t.y>o.top+o.height)){a=i;break}n=i+1}}return a===-1?e.grid.cellInfo.outsideValue:(c=new e.grid.cellInfo(s,a,this._wijgrid,!0),c)},r}();t.uiSelection=r})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(e){"use strict";var t=jQuery,n=function(){function e(e,t,n,r){this._view=e,this._scope=t,this._offsetBottom=r,this._offsetTop=n}return e.prototype.item=function(e){var t=this.length();return e<t?this._view.getJoinedRows(e+this._offsetTop,this._scope):null},e.prototype.length=function(){var e=this._view.getJoinedTables(!0,0),t=0,n;if(n=e[0])t=n.getSectionLength(this._scope);if(n=e[1])t+=n.getSectionLength(this._scope);return t-=this._offsetTop+this._offsetBottom,t<0&&(t=0),t},e.iterateCells=function(t,n,r){if(t&&n){var i=0,s,o,u,a,f,l;for(s=0,o=t.length;s<o;s++){u=t[s];if(u)for(a=0,f=u.cells.length;a<f;a++){l=n(u.cells[a],i++,r);if(l!==!0)return}}}},e.getCell=function(t,n){var r,i;if(t&&(r=t[0])){i=r.cells.length;if(n<i)return r.cells[n];n-=i;if(r=t[1]){i=r.cells.length;if(n<i)return r.cells[n]}}return null},e.cellsCount=function(t){var n=0,r;if(t&&(r=t[0])){n=r.cells.length;if(r=t[1])n+=r.cells.length}return n},e}();e.rowAccessor=n})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(){function t(){this._timeout=25}return t.prototype.currentCellEditStart=function(t,r){var i=!1,s=t.currentCell(),o=t._view(),u,a,f,l;if(s._isValid()&&!s._isEdit()&&s.column().dataIndex>=0){u=s.row();if(u){l=u.type;if(l&e.grid.rowType.data){a={cell:s,event:r,handled:!1};if(i=t._trigger("beforeCellEdit",null,a))a.handled||(i=this._defaultBeforeCellEdit(t,a));i&&(s._isEdit(!0),t._showRowHeader()&&(f=n(u.$rows[0].cells[0]).children("div.wijmo-wijgrid-innercell"),f.length&&(f.empty(),f.append(n("<div>&nbsp;</div>").addClass(t.options.wijCSS.icon+" ui-icon-pencil")))))}}}return i},t.prototype.currentCellEditEnd=function(t,r){var i=t.currentCell(),s=i.column(),o=!1,u=t._view(),a,f,l,c,h,p,d=e.getKeyCodeEnum(),v;if(!i._isValid()||!i._isEdit())return;a=i.row();if(a){f=a.type;if(!(f&e.grid.rowType.data))return o;l=r&&r.which===d.ESCAPE;if(!r||!l){var m={cell:i,value:undefined};if(o=t._trigger("beforeCellUpdate",null,m)){m.value===undefined&&(m.value=this._getCellValue(t,i)),c=m.value,h=i.value();try{v=this._getHTMLInputElementType(i),e.grid.HTML5InputSupport.isExtendSupportRequired(v)?(m.value=e.grid.HTML5InputSupport.parse(m.value,v),m.value=e.grid.HTML5InputSupport.extend(h,m.value,v)):m.value=t.parse(i.column(),m.value),c=m.value}catch(g){m.value=c}e.grid.getDataType(s)==="datetime"&&(c instanceof Date&&(c=c.getTime()),h instanceof Date&&(h=h.getTime()));if(c!==h){try{i.value(m.value)}catch(g){var y={cell:i,value:m.value};o=!1,t._trigger("invalidCellValue",null,y)}if(o){var b={cell:i};t._trigger("afterCellUpdate",null,b)}}}}else o=!0;if(o){var w={cell:i,event:r,handled:!1};t._trigger("afterCellEdit",null,w),w.handled||(o=this._defaultAfterCellEdit(t,w)),o&&i._isEdit(!1),t._showRowHeader()&&n(a.$rows[0].cells[0]).children("div.wijmo-wijgrid-innercell").html("&nbsp;"),window.setTimeout(function(){t._destroyed||(i=t.currentCell(),(p=i.tableCell())?n(p).attr("tabIndex",0).focus():n(t._view().focusableElement()).focus())},this._timeout)}}return o},t.prototype._defaultBeforeCellEdit=function(t,r){var i=r.cell.column(),s=!1,o,u,a,f,l,c,h=e.getKeyCodeEnum(),p=e.grid.HTML5InputSupport.getDefaultInputType(t._isMobileEnv(),i);if(i.dataIndex>=0){o=r.cell.value(),s=!0;try{a=r.cell.container();if(e.grid.getDataType(i)==="boolean"){var d=a.children("span");d.length&&d.prop("disabled")&&(n.data(d[0],"disabledSpan",!0),d.prop("disabled",!1)),f=a.find(":checkbox"),f.prop("disabled",!1),f.focus(),r.event&&r.event.type==="keypress"&&f.one("keyup",function(e){e.which===h.SPACE&&(e.preventDefault(),f[0].checked=!o)})}else{f=n("<input />").attr("type",p).addClass("wijgridinput wijmo-wijinput "+t.options.wijCSS.stateFocus).bind("keydown",t,n.proxy(this._checkBoxOrInputKeyDown,this)),f.bind(n.support.selectstart?"selectstart":"mousedown",function(e){e.stopPropagation()});if(r.event&&r.event.type==="keypress"&&r.event.which)f.val(String.fromCharCode(r.event.which));else switch(e.grid.getDataType(i)){case"currency":case"number":if(o!==null){f.val(o);break};case"datetime":if(e.grid.HTML5InputSupport.isExtendSupportRequired(p)){f.val(e.grid.HTML5InputSupport.toStr(o,p));break};default:f.val(t.toStr(i,o))}a.empty().append(f),l=f.val().length,p==="text"&&(new e.grid.domSelection(f[0])).setSelection({start:l,end:l}),f.focus(),setTimeout(function(){f.focus()},this._timeout*2)}}catch(v){alert(v.message),s=!1}}return s},t.prototype._defaultAfterCellEdit=function(t,r){var i=r.cell.column(),s=!1,o,u,a,f,l;if(i.dataIndex>=0){s=!0,l=t._view();try{o=r.cell.container(),u=t.toStr(i,r.cell.value()),f=l._getRowInfoBySketchRowIndex(r.cell.rowIndex());if(e.grid.getDataType(i)==="boolean"){var c=o.children("span"),h=c.length&&n.data(c[0],"disabledSpan");a=o.find(":checkbox"),u==="true"?a.attr("checked","checked"):a.removeAttr("checked"),h&&(c.prop("disabled",!0),a.prop("disabled",!0))}else t.cellFormatter.format(o,i,u,f)}catch(p){alert("defaultAfterCellEdit: "+p.message),s=!1}}return s},t.prototype._checkBoxOrInputKeyDown=function(t){var n=e.getKeyCodeEnum();if(t.which===n.ENTER){var r=t.data;if(r)return r._endEditInternal(t),!1}},t.prototype._getCellValue=function(e,t){var n=t.container().find(":input:first"),r=null;return n.length&&(r=n.attr("type")==="checkbox"?n[0].checked:n.val()),r},t.prototype._getHTMLInputElementType=function(e){return e.container().find(":input:first").attr("type")},t}();t.cellEditorHelper=r})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(){function t(){}return t._div=document.createElement("div"),t.prototype.format=function(t,r,i,s){s.type&e.grid.rowType.footer&&(r.aggregate&&r.aggregate!=="none"?i=e.grid.stringFormat(r.footerText||"{0}",r._totalsValue||""):i=r.footerText||r._footerTextDOM||"");var o=!0,u=null,a={$container:t,column:r,formattedValue:i,row:s,afterDefaultCallback:null},f;n.isFunction(r.cellFormatter)&&(o=!r.cellFormatter(a));if(o){if(s.type===e.grid.rowType.groupHeader||s.type===e.grid.rowType.groupFooter)u=this._defFormatGroupCell;else switch(e.grid.getDataType(r)){case"boolean":u=this._boolFormatter;break;default:u=this._textFormatter}u&&(u.call(this,a),n.isFunction(f=a.afterDefaultCallback)&&f(a))}},t.prototype._textFormatter=function(t){var n;switch(t.row.type){case e.grid.rowType.filter:this._defFormatFilterCell(t);break;default:this._updateHTML(t)}},t.prototype._boolFormatter=function(t){var n,r,i="disabled='disabled'",s,o,u=e.grid.rowType,a=e.getKeyCodeEnum();switch(t.row.type){case u.data:case u.data|u.dataAlt:n=t.column.owner,r=n.options.allowEditing&&t.column.readOnly!==!0,r&&(i=""),n.parse(t.column,n._dataViewWrapper.getValue(t.row.data,t.column.dataKey))===!0?t.$container.html("<input class='wijgridinput' type='checkbox' checked='checked' "+i+" />"):t.$container.html("<input class='wijgridinput' type='checkbox' "+i+" />"),r&&t.$container.children("input").bind("mousedown",function(e){s=t.$container.parent()[0],o=n.currentCell(),o.tableCell()!==s&&n._onClick({target:s}),o._isEdit()||n.beginEdit()}).bind("keydown",function(e){if(e.which===a.ENTER)return n._endEditInternal(e),!1});break;default:this._textFormatter(t)}},t.prototype._defFormatFilterCell=function(e){var t=e.column.owner,n=t.options.wijCSS;e.$container.addClass(n.widget+" "+n.stateDefault),e.column.dataIndex>=0&&!e.column.isBand&&e.column.showFilter?e.$container.html('<table cellPadding="0" cellSpacing="0" class="wijmo-wijgrid-filter '+n.cornerAll+'"><tr><td style="width:100%"><input type="text" class="wijmo-wijgrid-filter-input" style="width:100%" /></td><td class="wijmo-wijgrid-filter-trigger '+n.cornerRight+" "+n.stateDefault+'"><span class="'+n.icon+" "+n.iconArrowDown+'"></span></td></tr></table>'):e.$container.html("&nbsp;")},t.prototype._defFormatGroupCell=function(e){this._updateHTML(e)},t.prototype._updateHTML=function(t){var n=t.$container[0];if(n.firstChild)while(n.firstChild)n.removeChild(n.firstChild);e.grid.cellFormatterHelper._div.innerHTML=t.formattedValue||"&nbsp;";while(e.grid.cellFormatterHelper._div.firstChild)n.appendChild(e.grid.cellFormatterHelper._div.firstChild)},t}();t.cellFormatterHelper=r})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(){function t(e){this.MIN_WIDTH=5,this._elements=[],this._gap=10,this._step=1,this._inProgress=!1,this._hoveredField=null,this._startLocation=null,this._lastLocation=null,this._proxy=null,this._wijgrid=e,this._evntFormat="{0}."+this._wijgrid.widgetName+".resizer"}return t.prototype.addElement=function(e){e&&e.element&&(e.element.bind(this._eventKey("mousemove"),n.proxy(this._onMouseMove,this)).bind(this._eventKey("mousedown"),n.proxy(this._onMouseDown,this)).bind(this._eventKey("mouseout"),n.proxy(this._onMouseOut,this)),this._elements.push(e))},t.prototype.dispose=function(){var e=this;n.each(this._elements,function(t,n){n.element.unbind(e._eventKey("mousemove"),e._onMouseMove).unbind(e._eventKey("mousedown"),e._onMouseDown).unbind(e._eventKey("mouseout"),e._onMouseOut)}),this._detachDocEvents()},t.prototype.inProgress=function(){return this._inProgress},t.prototype._onMouseMove=function(e){if(!this._inProgress){var t=this._getFieldByPos({x:e.pageX,y:e.pageY});t&&t._canSize()&&this._wijgrid._canInteract()?(t.element.css("cursor","e-resize"),this._hoveredField=t,e.stopPropagation()):this._onMouseOut(e)}},t.prototype._onMouseOut=function(e){this._inProgress||this._hoveredField&&(this._hoveredField.element.css("cursor",""),this._hoveredField=null)},t.prototype._onMouseDown=function(t){this._hoveredField=this._getFieldByPos({x:t.pageX,y:t.pageY});if(this._hoveredField&&this._hoveredField._canSize()&&this._wijgrid._canInteract())try{this._hoveredField.element.css("cursor",""),this._docCursor=document.body.style.cursor,document.body.style.cursor="e-resize",this._startLocation=this._lastLocation=e.grid.bounds(this._hoveredField.element),this._proxy=n('<div class="wijmo-wijgrid-resizehandle '+this._wijgrid.options.wijCSS.stateHightlight+'">&nbsp;</div>');var r=this._wijgrid._view().getVisibleAreaBounds();this._proxy.css({left:t.pageX,top:this._startLocation.top,height:r.height+r.top-this._startLocation.top}),n(document.body).append(this._proxy)}finally{this._attachDocEvents(),this._inProgress=!0,t.stopPropagation()}},t.prototype._onDocumentMouseMove=function(e){var t=this._step*Math.round((e.pageX-this._lastLocation.left)/this._step);this._lastLocation={left:this._lastLocation.left+t,top:e.pageY,width:undefined,height:undefined},this._proxy.css("left",this._lastLocation.left)},t.prototype._onDocumentMouseUp=function(e){try{document.body.style.cursor=this._docCursor,this._proxy.remove(),this._startLocation!==this._lastLocation&&this._wijgrid._fieldResized(this._hoveredField,this._startLocation.width,Math.max(this._lastLocation.left-this._startLocation.left,this.MIN_WIDTH))}finally{this._hoveredField=null,this._proxy=null,this._detachDocEvents(),this._inProgress=!1}},t.prototype._onSelectStart=function(e){e.preventDefault()},t.prototype._attachDocEvents=function(){this._inProgress||(n(document).bind(this._eventKey("mousemove"),n.proxy(this._onDocumentMouseMove,this)).bind(this._eventKey("mouseup"),n.proxy(this._onDocumentMouseUp,this)),n.fn.disableSelection&&n(document.body).disableSelection(),"onselectstart"in document&&n(document.body).bind("selectstart",this._onSelectStart))},t.prototype._detachDocEvents=function(){this._inProgress&&(n(document).unbind(this._eventKey("mousemove"),this._onDocumentMouseMove).unbind(this._eventKey("mouseup"),this._onDocumentMouseUp),n.fn.enableSelection&&n(document.body).enableSelection(),"onselectstart"in document&&n(document.body).unbind("selectstart",this._onSelectStart))},t.prototype._getFieldByPos=function(t){var n,r,i,s,o;for(n=0,r=this._elements.length;n<r;n++){i=this._elements[n],s=e.grid.bounds(i.element),o=e.grid.isOver(t.y,t.x,s.top,s.left+s.width-this._gap,s.height,this._gap);if(o)return i}return null},t.prototype._eventKey=function(t){return e.grid.stringFormat(this._evntFormat,t)},t}();t.uiResizer=r})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(){function t(t){this._scope_guid="scope_"+e.grid.getUID(),this._dragEnd=!1,this._wijgrid=t,this._wijCSS=this._wijgrid.options.wijCSS,this._wrapHtml='<div class="'+this._wijCSS.widget+" wijmo-wijgrid "+this._wijCSS.content+" "+this._wijCSS.cornerAll+'">'+'<table class="wijmo-wijgrid-root wijmo-wijgrid-table">'+'<tr class="wijmo-wijgrid-headerrow">'+"</tr>"+"</table>"+"</div>"}return t.prototype.attachGroupArea=function(e){var t,r=this;if(!n.ui.droppable||!n.ui.draggable)return;e.droppable({scope:this._scope_guid,tolerance:"pointer",greedy:!0,accept:function(e){if(r._wijgrid.options.allowColMoving){t=r._getWijFieldInstance(e);if(t)return t instanceof n.wijmo.c1groupedfield&&t.options.groupedIndex===r._wijgrid._groupedColumns().length-1?!1:!t.options.isBand&&(t.options.groupedIndex===undefined||t instanceof n.wijmo.c1groupedfield)}return!1},drop:function(e,n){!r._isInElement(e,n.draggable)&&(t=r._getWijFieldInstance(n.draggable))&&(r._dragEnd=!0)},over:function(t,n){var i=r._wijgrid._field("groupedWidgets").length;r._dropTargetRedirected=i>0,r._droppableWijField=i>0?r._wijgrid._field("groupedWidgets")[i-1]:e,e.data("thisDroppableWijField",r._droppableWijField)},out:function(t,n){r._droppableWijField===e.data("thisDroppableWijField")&&(r._droppableWijField=null)}})},t.prototype.attach=function(t){var r,i,s=this;if(!n.ui.droppable||!n.ui.draggable)return;if(!t||!(r=t.element))return;r.draggable({helper:function(e){return t instanceof n.wijmo.c1groupedfield?r.clone().addClass("wijmo-wijgrid-dnd-helper"):r.clone().wrap(s._wrapHtml).width(r.width()).height(r.height()).closest(".wijmo-wijgrid").addClass("wijmo-wijgrid-dnd-helper")},appendTo:"body",scope:s._scope_guid,drag:function(e,n){s._hideArrows();if(s._droppableWijField&&!s._isInElement(e,r)){var i=s._droppableWijField.element;i||(i=s._droppableWijField),s._showArrows(i,s._getPosition(t,s._droppableWijField,e,n))}},start:function(r,i){if(s._wijgrid._canInteract()&&s._wijgrid.options.allowColMoving&&(s._wijgrid._UIResizer()==null||!s._wijgrid._UIResizer().inProgress())){var o=t.options,u=t.options.travIdx,a=t instanceof n.wijmo.c1groupedfield,f=a?"groupArea":"columns";a&&(o=e.grid.search(s._wijgrid.columns(),function(e){return e.options.travIdx===u}),o=o.found?o.found.options:e.grid.getColumnByTravIdx(s._wijgrid.options.columns,u).found);if(t._canDrag()&&s._wijgrid._trigger("columnDragging",null,{drag:o,dragSource:f}))return s._wijgrid._trigger("columnDragged",null,{drag:o,dragSource:f}),!0}return!1},stop:function(e,r){s._hideArrows();try{s._dragEnd&&(s._droppableWijField.element?s._wijgrid._handleDragnDrop(t.options.travIdx,s._droppableWijField.options.travIdx,s._getPosition(t,s._droppableWijField,e,r),t instanceof n.wijmo.c1groupedfield,s._droppableWijField instanceof n.wijmo.c1groupedfield):s._wijgrid._handleDragnDrop(t.options.travIdx,-1,"left",t instanceof n.wijmo.c1groupedfield,!0))}finally{s._droppableWijField=null,s._dragEnd=!1}}}).droppable({hoverClass:s._wijCSS.stateHover,scope:s._scope_guid,tolerance:"pointer",greedy:!0,accept:function(e){if(s._wijgrid.options.allowColMoving&&r[0]!==e[0]){i=s._getWijFieldInstance(e);if(i)return i._canDropTo(t)}return!1},drop:function(e,t){if(i=s._getWijFieldInstance(t.draggable))s._dragEnd=!0},over:function(e,n){s._dropTargetRedirected=!1,s._droppableWijField=t,r.data("thisDroppableWijField",s._droppableWijField)},out:function(e,n){s._droppableWijField===t.element.data("thisDroppableWijField")&&(s._droppableWijField=null)}})},t.prototype.detach=function(e){var t;e&&(t=e.element)&&(t.data("ui-draggable")&&t.draggable("destroy"),t.data("ui-droppable")&&t.droppable("destroy"))},t.prototype.dispose=function(){this._$topArrow&&(this._$topArrow.remove(),this._$topArrow=null),this._$bottomArrow&&(this._$bottomArrow.remove(),this._$bottomArrow=null)},t.prototype._getWijFieldInstance=function(t){var n=e.grid.widgetName(t);if(!n)throw"widgetName is undedined";return t.data(n)},t.prototype._showArrows=function(e,t){this._topArrow().show().position({my:"center",at:t+" top",of:e,collision:"none"}),this._bottomArrow().show().position({my:"center",at:t+" bottom",of:e,collision:"none"})},t.prototype._hideArrows=function(){this._topArrow().hide(),this._bottomArrow().hide()},t.prototype._topArrow=function(){return this._$topArrow||(this._$topArrow=n("<div />").addClass("wijmo-wijgrid-dnd-arrow-top").append(n("<span />").addClass(this._wijCSS.icon+" ui-icon-arrowthick-1-s")).hide().appendTo(document.body)),this._$topArrow},t.prototype._bottomArrow=function(){return this._$bottomArrow||(this._$bottomArrow=n("<div />").addClass("wijmo-wijgrid-dnd-arrow-bottom").append(n("<span />").addClass(this._wijCSS.icon+" ui-icon-arrowthick-1-n")).hide().appendTo(document.body)),this._$bottomArrow},t.prototype._isInElement=function(t,n){var r=e.grid.bounds(n,!1);return t.pageX>r.left&&t.pageX<r.left+r.width&&t.pageY>r.top&&t.pageY<r.top+r.height},t.prototype._getPosition=function(t,r,i,s){if(!r.element)return"left";if(this._dropTargetRedirected)return"right";var o=e.grid.bounds(r.element,!1),u=o.width/6,a=o.left+o.width/2,f="right",l;return i.pageX<a&&(f="left"),r instanceof n.wijmo.c1groupedfield?(t instanceof n.wijmo.c1groupedfield&&(l=r.options.groupedIndex-t.options.groupedIndex,Math.abs(l)===1&&(f=l<0?"left":"right")),f):(l=r.options.linearIdx-t.options.linearIdx,r.options.isBand&&t.options.parentIdx!==r.options.travIdx&&Math.abs(i.pageX-a)<u?"center":(t.options.parentIdx===r.options.parentIdx&&Math.abs(l)===1&&(f=l<0?"left":"right"),f))},t}();t.uiDragndrop=r})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(){function t(e){if(!e)throw"invalid arguments";this._wijgrid=e}return t.prototype.format=function(t,r,i,s,o,u,a){var f=e.grid.renderState,l=e.grid.rowType,c=s.type,h,p=null;r===0&&this._wijgrid._showRowHeader()&&(i=null);if(c===l.groupHeader||c===l.groupFooter)i=null,u&&(p=u.groupInfo)&&(i=this._wijgrid._field("leaves")[p.leafIndex],delete u.groupInfo);h={$cell:t,state:o,row:s,column:i,_cellIndex:r,_purpose:p?p.purpose:undefined},o===f.rendering?this._renderingStateFormatter(h,u,a):(this._currentStateFormatter(h,o&f.current),this._selectedStateFormatter(h,o&f.selected)),n.isFunction(this._wijgrid.options.cellStyleFormatter)&&this._wijgrid.options.cellStyleFormatter(h)},t.prototype._renderingStateFormatter=function(t,n,r){var i=e.grid.rowType,s,o,u=t.column,a=t.row.type;switch(a){case i.header:t.$cell.addClass("wijgridth");break;default:t.$cell.addClass("wijgridtd")}if(a&i.data&&u&&u.textAlignment)switch(u.textAlignment.toLowerCase()){case"left":t.$cell.addClass("wijalign-left");break;case"right":t.$cell.addClass("wijalign-right");break;case"center":t.$cell.addClass("wijalign-center")}if(n)for(s in n)if(n.hasOwnProperty(s)){o=n[s];if(!(s!=="colSpan"&&s!=="rowSpan"||o>1))continue;s==="class"?t.$cell.addClass(o):t.$cell.attr(s,o)}if(r)for(s in r)if(r.hasOwnProperty(s)){if(s==="paddingLeft"){t.$cell.children(".wijmo-wijgrid-innercell").css(s,r[s]);continue}t.$cell.css(s,r[s])}if(t._cellIndex===0&&this._wijgrid._showRowHeader())t.$cell.attr({role:"rowheader",scope:"row"}).addClass(this._wijgrid.options.wijCSS.stateDefault+" "+this._wijgrid.options.wijCSS.content+" wijmo-wijgrid-rowheader");else switch(a){case i.header:t.$cell.attr({role:"columnheader",scope:"col"});break;case i.footer:t.$cell.attr({role:"columnfooter",scope:"col"});break;default:t.$cell.attr("role","gridcell")}a&i.data&&t._cellIndex>=0&&u&&(t.$cell.attr("headers",window.escape(u.headerText)),u.readOnly&&t.$cell.attr("aria-readonly",!0),u.dataIndex>=0&&t.$cell.addClass("wijdata-type-"+e.grid.getDataType(u))),(a===i.groupHeader||a===i.groupFooter)&&u&&t._purpose===e.grid.groupRowCellPurpose.aggregateCell&&t.$cell.addClass("wijdata-type-"+e.grid.getDataType(u))},t.prototype._currentStateFormatter=function(t,n){var r=e.grid.rowType;n?(t.$cell.addClass(this._wijgrid.options.wijCSS.stateActive),t.row.type===r.header?t.$cell.addClass("wijmo-wijgrid-current-headercell"):t.$cell.addClass("wijmo-wijgrid-current-cell")):(t.$cell.removeClass(this._wijgrid.options.wijCSS.stateActive),t.row.type===r.header?t.$cell.removeClass("wijmo-wijgrid-current-headercell"):t.$cell.removeClass("wijmo-wijgrid-current-cell"))},t.prototype._hoveredStateFormatter=function(e,t){t},t.prototype._selectedStateFormatter=function(e,t){t?e.$cell.addClass(this._wijgrid.options.wijCSS.stateHightlight).attr("aria-selected","true"):e.$cell.removeClass(this._wijgrid.options.wijCSS.stateHightlight).removeAttr("aria-selected")},t}();t.cellStyleFormatterHelper=r})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(){function t(e){if(!e)throw"invalid arguments";this._wijgrid=e}return t.prototype.format=function(t,r,i){var s=e.grid.renderState,o=e.grid.rowType,u=t.state,a=t;u===s.rendering?this._renderingStateFormatter(a,r,i):(this._currentStateFormatter(a,(u&s.current)!==0),this._hoveredStateFormatter(a,(u&s.hovered)!==0),this._selectedStateFormatter(a,(u&s.selected)!==0)),n.isFunction(this._wijgrid.options.rowStyleFormatter)&&this._wijgrid.options.rowStyleFormatter(a)},t.prototype._renderingStateFormatter=function(t,r,i){var s="wijmo-wijgrid-row "+this._wijgrid.options.wijCSS.content,o="wijmo-wijgrid-row "+this._wijgrid.options.wijCSS.content,u=e.grid.rowType,a;t.$rows.attr("role","row");if(r)for(a in r)r.hasOwnProperty(a)&&(a==="class"?t.$rows.addClass(r[a]):(t.$rows.attr(a,r[a]),t.$rows[0].style.height&&t.$rows.each(function(){return n.data(this,"customHeight",this.style.height),!0})));if(i)for(a in i)i.hasOwnProperty(a)&&t.$rows.css(a,i[a]);switch(t.type&~u.dataAlt){case u.header:s="wijmo-wijgrid-headerrow";break;case u.data:s=o+" wijmo-wijgrid-datarow",t.type&u.dataAlt&&(s+=" wijmo-wijgrid-alternatingrow"),this._wijgrid.options.rowHeight&&t.$rows.height(this._wijgrid.options.rowHeight);break;case u.emptyDataRow:s=o+" wijmo-wijgrid-emptydatarow";break;case u.filter:s="wijmo-wijgrid-filterrow";break;case u.groupHeader:s=o+" wijmo-wijgrid-groupheaderrow";break;case u.groupFooter:s=o+" wijmo-wijgrid-groupfooterrow";break;case u.footer:s="wijmo-wijgrid-footerrow "+this._wijgrid.options.wijCSS.stateHightlight;break;default:throw e.grid.stringFormat("unknown rowType: {0}",t.type)}t.$rows.addClass(s)},t.prototype._currentStateFormatter=function(e,t){this._wijgrid._showRowHeader()&&(t?n(e.$rows[0].cells[0]).addClass(this._wijgrid.options.wijCSS.stateActive+" wijmo-wijgrid-current-rowheadercell"):n(e.$rows[0].cells[0]).removeClass(this._wijgrid.options.wijCSS.stateActive+" wijmo-wijgrid-current-rowheadercell"))},t.prototype._hoveredStateFormatter=function(e,t){t?e.$rows.addClass(this._wijgrid.options.wijCSS.stateHover):e.$rows.removeClass(this._wijgrid.options.wijCSS.stateHover)},t.prototype._selectedStateFormatter=function(e,t){t},t}();t.rowStyleFormatterHelper=r})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(e){"use strict";var t=jQuery,n=function(){function e(){this._sum=0,this._sum2=0,this._cntNumbers=0,this._cntStrings=0,this._cntDates=0,this._max=0,this._min=0,this._minDate=0,this._maxDate=0}return e.prototype.add=function(e){if(e===null||e==="")return;var t,n=e instanceof Date?"datetime":typeof e;t=e.toString(),this._cntStrings++===0&&(this._minString=this._maxString=t),t<this._minString&&(this._minString=t),t>this._maxString&&(this._maxString=t),n==="number"?(this._cntNumbers++===0&&(this._min=this._max=e),this._sum+=e,this._sum2+=e*e,e<this._min&&(this._min=e),e>this._max&&(this._max=e)):n==="datetime"&&(t=e.getTime(),this._cntDates++===0&&(this._minDate=this._maxDate=t),t<this._minDate&&(this._minDate=t),t>this._maxDate&&(this._maxDate=t))},e.prototype.getValueString=function(e){var t=e.owner;if(!this._cntNumbers||e.dataType!=="number"&&e.dataType!=="currency"){if(this._cntDates&&e.dataType==="datetime")switch(e.aggregate){case"max":return t.toStr(e,new Date(this._maxDate));case"min":return t.toStr(e,new Date(this._minDate));case"count":return this._cntStrings+""}if(this._cntStrings)switch(e.aggregate){case"max":return this._maxString;case"min":return this._minString;case"count":return this._cntStrings+""}return""}var n=this._getValue(e.aggregate);return t.toStr(e,n)},e.prototype._getValue=function(e){switch(e){case"average":return this._cntNumbers===0?0:this._sum/this._cntNumbers;case"count":return this._cntStrings;case"max":return this._max;case"min":return this._min;case"sum":return this._sum;case"std":if(this._cntNumbers<=1)return 0;return Math.sqrt(this._getValue("var"));case"stdPop":if(this._cntNumbers<=1)return 0;return Math.sqrt(this._getValue("varPop"));case"var":if(this._cntNumbers<=1)return 0;return this._getValue("varPop")*this._cntNumbers/(this._cntNumbers-1);case"vapPop":if(this._cntNumbers<=1)return 0;var t=this._sum/this._cntNumbers;return this._sum2/this._cntNumbers-t*t}return 0},e}();e.tally=n})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(){function t(t){this._docEventsUID="wijgridfrozener"+e.grid.getUID(),this._docEventsAttached=!1,this._newStaticIndex=-1,this._staticColumnIndex=-1,this._staticRowIndex=-1,this._staticOffsetH=0,this._staticOffsetV=0,this._inProgress=!1,this._wijgrid=t,this.refresh()}return t.prototype.inProgress=function(){return this._inProgress},t.prototype.refresh=function(){this.dispose();var t=this._wijgrid.options.freezingMode;if(t!=="none"){this._$outerDiv=this._wijgrid.outerDiv.find(".wijmo-wijgrid-fixedview"),this._superPanel=this._wijgrid._view()._getSuperPanel(),this._staticOffsetH=this._wijgrid._getStaticOffsetIndex(!1),this._staticOffsetV=this._wijgrid._getStaticOffsetIndex(!0),this._staticColumnIndex=this._wijgrid._getStaticIndex(!1),this._staticRowIndex=this._wijgrid._getStaticIndex(!0),this._visibleBounds=this._wijgrid._view().getVisibleContentAreaBounds();var n=e.grid.bounds(this._$outerDiv.find(".wijmo-wijgrid-split-area-nw")),r=e.grid.bounds(this._$outerDiv);(t==="both"||t==="columns")&&(this._wijgrid.options.staticColumnsAlignment!=="right"||this._staticColumnIndex>=0)&&this._createVBar(this._visibleBounds,n,r),(t==="both"||t==="rows")&&!this._wijgrid._serverSideVirtualScrolling()&&this._createHBar(this._visibleBounds,n,r)}},t.prototype.dispose=function(){this._$hBar&&(this._$hBar.remove(),this._$hBar=null),this._$vBar&&(this._$vBar.remove(),this._$vBar=null),this._$proxy&&(this._$proxy.remove(),this._$proxy=null),this._$outerDiv=null,this._superPanel=null,this._detachDocEvents()},t.prototype._createVBar=function(e,t,r){var i=this._wijgrid.options.staticColumnsAlignment!=="right",s=i?t.width+t.left:t.left-2,o=this;s<=e.left+e.width&&(this._$vBar=n("<div><div></div></div>").addClass("wijmo-wijgrid-freezing-handle-v").addClass(i?"":"not-allowed").css({left:s-r.left,top:t.top-r.top,height:e.height+e.top-t.top}).bind("mousedown",function(e){e.data=!0,o._onBarMouseDown.apply(o,arguments)}).appendTo(this._$outerDiv),this._$vBar.find("div").addClass(this._wijgrid.options.wijCSS.header).css({width:0,height:"100%"}))},t.prototype._createHBar=function(e,t,r){var i=t.top+t.height,s=this._wijgrid.options.staticColumnsAlignment!=="right",o=this;i<=e.top+e.height&&(this._$hBar=n("<div><div></div></div>").addClass("wijmo-wijgrid-freezing-handle-h").css({left:s?t.left-r.left:0,top:i-r.top,width:s?e.width+e.left-t.left:e.width}).bind("mousedown",function(e){e.data=!1,o._onBarMouseDown.apply(o,arguments)}).appendTo(this._$outerDiv),this._$hBar.find("div").addClass(this._wijgrid.options.wijCSS.header).css({width:"100%",height:0}))},t.prototype._onBarMouseDown=function(e){if(this._wijgrid.options.disabled||this._wijgrid.options.staticColumnsAlignment==="right"&&e.data)return!1;this._visibleBounds=this._wijgrid._view().getVisibleContentAreaBounds(),this._newStaticIndex=e.data?this._staticColumnIndex:this._staticRowIndex,this._$proxy=n('<div class="wijmo-wijgrid-resizehandle '+this._wijgrid.options.wijCSS.header+'"></div>').appendTo(document.body),this._attachDocEvents(e.data),this._inProgress=!0,e.stopPropagation()},t.prototype._onDocumentMouseMove=function(e){e.data&&this._superPanel.options.hScroller.scrollValue?this._superPanel.hScrollTo(0):!e.data&&this._superPanel.options.vScroller.scrollValue&&this._superPanel.vScrollTo(0),this._showPosition(e)},t.prototype._onDocumentMouseUp=function(e){try{this._$proxy&&this._$proxy.remove(),this._detachDocEvents(),e.data?this._newStaticIndex!==this._staticColumnIndex&&this._wijgrid.option("staticColumnIndex",this._newStaticIndex):this._newStaticIndex!==this._staticRowIndex&&this._wijgrid.option("staticRowIndex",this._newStaticIndex)}finally{this._$proxy=null,this._inProgress=!1}},t.prototype._attachDocEvents=function(e){if(!this._docEventsAttached)try{n.fn.disableSelection&&n(document.body).disableSelection(),this._wijgrid._view().toggleDOMSelection(!1),n(document).bind(this._docEventKey("mousemove"),e,n.proxy(this._onDocumentMouseMove,this)).bind(this._docEventKey("mouseup"),e,n.proxy(this._onDocumentMouseUp,this))}finally{this._docEventsAttached=!0}},t.prototype._detachDocEvents=function(){if(this._docEventsAttached)try{n.fn.enableSelection&&n(document.body).enableSelection(),this._wijgrid._view().toggleDOMSelection(!0),n(document).unbind("."+this._docEventsUID)}finally{this._docEventsAttached=!1}},t.prototype._docEventKey=function(t){return e.grid.stringFormat("{0}.{1}",t,this._docEventsUID)},t.prototype._showPosition=function(t){var n,r,i,s,o,u,a,f,l=this._wijgrid.options.staticColumnsAlignment!=="right";if(t.data){f=e.grid.bounds(this._$vBar);if(Math.abs(t.pageX-(f.left+f.width/2))<f.width){this._$proxy.hide();return}if(n=this._getFieldByPos({x:t.pageX,y:t.pageY})){r=e.grid.bounds(n.element),i=r.left+r.width/2,s=n.options.visLeavesIdx-this._staticOffsetV,o=Math.max(s-1,-1),u=t.pageX<i?o!==this._staticColumnIndex:s===this._staticColumnIndex,a=u?r.left:r.left+r.width;if(!e.grid.isOverAxis(a,this._visibleBounds.left-1,this._visibleBounds.width+2))return;this._newStaticIndex=u?o:s,this._$proxy.show().css({left:a,top:r.top,width:3,height:this._visibleBounds.height+this._visibleBounds.top-r.top})}}else{f=e.grid.bounds(this._$hBar);if(Math.abs(t.pageY-(f.top+f.height/2))<f.height){this._$proxy.hide();return}if(n=this._getRowByPos({x:t.pageX,y:t.pageY})){r=e.grid.bounds(n),i=r.top+r.height/2,s=this._wijgrid._view().getAbsoluteRowIndex(n)-this._staticOffsetH,o=Math.max(s-1,-1),u=t.pageY<i?o!==this._staticRowIndex:s===this._staticRowIndex,a=u?r.top:r.top+r.height;if(!e.grid.isOverAxis(a,this._visibleBounds.top-1,this._visibleBounds.height+2))return;this._newStaticIndex=u?o:s,this._$proxy.show().css({left:l?r.left:this._visibleBounds.left,top:a,width:l?this._visibleBounds.width+this._visibleBounds.left-r.left:this._visibleBounds.width,height:3})}}},t.prototype._getFieldByPos=function(t){var n=this._wijgrid.columns(),r,i,s,o,u;for(r=0,i=n.length;r<i;r++){s=n[r],o=s.options;if(o.isLeaf){u=e.grid.bounds(s.element);if(e.grid.isOverAxis(t.x,u.left,u.width))return s}}return null},t.prototype._getRowByPos=function(t){var r=this._wijgrid._rows(),i,s,o,u;for(i=0,s=r.length();i<s;i++){o=r.item(i)[0],u=e.grid.bounds(n(o));if(e.grid.isOverAxis(t.y,u.top,u.height))return o}return null},t}();t.uiFrozener=r})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(){function t(){}return t.generate=function(r,i,s){switch(r){case"append":t._processAppendMode(i,s);break;case"merge":t._processMergeMode(i,s);break;case"none":break;default:throw e.grid.stringFormat('Unsupported value: "{0}"',r)}},t._processAppendMode=function(i,s){var o={};e.grid.traverse(s,function(t){t.dynamic&&e.grid.validDataKey(t.dataKey)&&(o[t.dataKey]=!0)}),n.each(i,function(e,n){if("name"in n&&!o[n.name]){var r=t._createAutoField(n);s.push(r)}})},t._processMergeMode=function(i,s){var o=[],u;e.grid.traverse(s,function(t){if(t.isLeaf&&!t.isBand){var n=t.dataKey;e.grid.validDataKey(n)?i[n]!==undefined&&delete i[n]:n!==null&&o.push(t)}}),o.length&&(u=0,n.each(i,function(e,t){var n=o[u++];n&&(n.dataKey=t.name,delete i[e])})),n.each(i,function(e,n){var r=t._createAutoField(n);s.push(r)})},t._createAutoField=function(n){return e.grid.createDynamicField({dataKey:n.name})},t}();t.columnsGenerator=r})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(e){"use strict";var t=jQuery,n=function(){function e(e,t,n,r){this._timer=0,this._timeout=50,this._ignoreScrollEvents=!1,this._wijgrid=e,this._fixedAreaHeight=n,this._$content=t,this._view=this._wijgrid._view(),this._N=this._wijgrid._renderableRowsCount(),this._updateContentHeight(),this._rowHeight=r;var i=this._wijgrid.outerDiv.height()+this._N*this._rowHeight;this._view._splitAreas.sw.height(i)}return e.prototype.scrollTo=function(e,t){this._completeListener=t,this._panelInst.vScrollTo(e*this._panelInst.options.vScroller.scrollSmallChange,!0)},e.prototype._updateContentHeight=function(){this._$content.height(this._rowHeight*this._N-this._fixedAreaHeight)},e.prototype.attach=function(e){this._$scroller=e,this._panelInst=e.data("wijmo-wijsuperpanel"),this._updateContentHeight(),this._updateVerticalScroller(),e.bind("wijsuperpanelscrolled.wijgrid",t.proxy(this._onSuperpanelScrolled,this)),e.bind("wijsuperpanelscrolling.wijgrid",t.proxy(this._onSuperpanelScrolling,this)),e.bind("wijsuperpanelscrolled.wijgrid",t.proxy(this._onSuperpanelPostScrolled,this))},e.prototype._updateVerticalScroller=function(){var e=Math.max(0,this._N-(this._view.getVirtualPageSize()-1));this._setVerticalScrollerOptions(1,e)},e.prototype._setVerticalScrollerOptions=function(e,t){var n=this._panelInst.options.vScroller;n.scrollSmallChange=e,n.scrollLargeChange=e*4,t+=n.scrollLargeChange-1,n.scrollMax=t,this._panelInst.option("vScroller",n)},e.prototype._changeVisibleRowsCount=function(e){this._N=e,this._updateContentHeight(),this._updateVerticalScroller()},e.prototype.dispose=function(){this._$scroller.unbind(".wijgrid"),this._clearTimer()},e.prototype._clearTimer=function(){window.clearTimeout(this._timer),this._timer=0},e.prototype._onSuperpanelScrolling=function(e,t){if(this._ignoreScrollEvents||t.dir!=="v")return;if(this._timer===-1)return!1},e.prototype._onSuperpanelScrolled=function(e,n){var r=this;if(this._ignoreScrollEvents||n.dir!=="v")return;this._timer>0&&this._clearTimer();if(this._timer!==-1){r._timer=-1;var i=Math.floor(n.newValue/r._panelInst.options.vScroller.scrollSmallChange),s=r._view._bounds.start;i<0&&(i=0),i>=r._N&&(i=r._N-1),i!==s?r._wijgrid._handleVirtualScrolling(i,t.proxy(r._scrollingCompleted,r)):(r._log(),r._clearTimer())}},e.prototype._scrollingCompleted=function(e){this._wijgrid._trackScrollingIndex(e),this._log(),this._completeListener&&(this._completeListener(),this._completeListener=null),this._clearTimer()},e.prototype._onSuperpanelPostScrolled=function(){t.isFunction(this._postScrolled)&&this._postScrolled.apply(this,arguments)},e.prototype._log=function(){},e}();e.uiVirtualScroller=n})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(e){var t=function(){function e(e){this._items=[],this._capacity=null,this._maxRowIndex=e}return e.prototype.add=function(e){this._capacity=null;var t=this._items.length,n;if(!t||(n=this._items[t-1]).end<e.start)t&&e.start-n.end===1?n.end=e.end:this._items.push(e);else{var r=this._binSearchByStartVal(e.start),i=this._binSearchByEndVal(e.end),s=r<0?~r:r,o=i<0?~i:i,u=r>=0||s>0&&e.start<=this._items[s-1].end,a=i>=0||o<t&&e.end<=this._items[o].end&&e.end>=this._items[o].start,f;u?a?r>=0?(this._items[o].start=this._items[s].start,(f=o-s)&&this._items.splice(s,f)):(this._items[o].start=this._items[s-1].start,(f=o-s+1)&&this._items.splice(s-1,f)):r>=0?(this._items[s].end=e.end,(f=o-s-1)&&this._items.splice(s,f)):(this._items[s-1].end=e.end,(f=o-s)&&this._items.splice(s,f)):a?(this._items[o].start=e.start,(f=o-s)&&this._items.splice(s,f)):this._items.splice(s,o-s,e)}},e.prototype.remove=function(e){this._capacity=null;var t=this._items.length;if(t){var n=this._binSearchByStartVal(e.start),r=this._binSearchByEndVal(e.end),i=n<0?~n:n,s=r<0?~r:r,o=n>=0||i>0&&e.start<=this._items[i-1].end,u=r>=0||s<t&&e.end<=this._items[s].end&&e.end>=this._items[s].start;if(o)if(u){var a=n>=0?n:i-1,f=r>=0?r:s;if(n>=0&&r>=0)this._items.splice(i,s-i+1);else if(n>=0)this._items[s].start=e.end+1,this._items.splice(i,s-i);else if(r>=0)a===f?this._items[i-1].end=e.start-1:(this._items[i].end=e.start-1,this._items.splice(i,s-i+1));else if(a===f){var l=this._items[i-1].end;this._items[i-1].end=e.start-1,this._items.splice(i,0,{start:e.end+1,end:l})}else this._items[i-1].end=e.start-1,this._items[s].start=e.end+1,this._items.splice(i,s-i)}else n>=0?this._items.splice(i,s-i):(this._items[i].end=e.start-1,this._items.splice(i,s-i-1));else u?r>=0?this._items.splice(i,s-i+1):(this._items[s].start=e.end+1,this._items.splice(i,s-i)):this._items.splice(i,s-i)}},e.prototype.clear=function(){this._capacity=0,this._items=[]},e.prototype.item=function(e){return this._items[e]},e.prototype.forEachIndex=function(e){if(e)for(var t=0,n=this._items.length;t<n;t++){var r=this._items[t];for(var i=r.start,s=r.end;i<=s;i++)e(i)}},e.prototype.forEachIndex2=function(e,t,n){var r=this._items.length,i=this._getIteratorStateFor(e),s=0,o=!0;if(i){var u=i.j;for(var a=i.i;a<r;a++){var f=this._items[a];o||(u=f.start);for(u;u<=f.end;u++){if(++s>t)return;n(u)}o=!1}}},e.prototype._getIteratorStateFor=function(e){var t=this._items.length,n=0;for(var r=0;r<t;r++){var i=this._items[r];n+=i.end-i.start+1;var s=n-e;if(s>=0)return{i:r,j:i.end-s+1}}return null},e.prototype.getAbsIndex=function(e){for(var t=0,n=this._items.length;t<n;t++){var r=this._items[t],i=r.end-r.start;if(e<=i)return r.start+e;e-=i+1}return-1},e.prototype.getVisibleIndex=function(e){var t=this.hasAbsIndex(e);if(t>=0){var n=0;for(var r=0;r<t;r++){var i=this._items[r];n+=i.end-i.start+1}return n+(e-this._items[t].start)}return-1},e.prototype.hasAbsIndex=function(e){if(this._items.length){var t=this._binSearchByStartVal(e);if(t>=0)return t;t=~t;if(t>0&&e<=this._items[t-1].end)return t-1}return-1},e.prototype.length=function(){return this._items.length},e.prototype.capacity=function(){if(this._capacity===null){var e=0;for(var t=0,n=this._items.length;t<n;t++){var r=this._items[t];e+=r.end-r.start+1}this._capacity=e}return this._capacity},e.prototype.truncate=function(e,t){this.truncateByStart(e),this.truncateByStart(t)},e.prototype.truncateByCount=function(e){var t=0;if(e===0)this._items=[];else for(var n=0,r=this._items.length;n<r;n++){var i=this._items[n];t+=i.end-i.start+1;if(t>=e){t>e&&(i.end-=t-e),this._items.splice(n+1,this._items.length-(n+1));break}}},e.prototype.truncateByStart=function(e,t){var n=this._binSearchByStartVal(e),r=this._items.length;n<0?(n=~n,n<r?n>0&&this._items[n-1].end>=e?(this._items[n-1].start=e,this._items.splice(0,n-1)):(t&&(this._items[n].start=e),this._items.splice(0,n)):this._items=[]):this._items.splice(0,n)},e.prototype.truncateByEnd=function(e,t){var n=this._binSearchByEndVal(e),r=this._items.length;n<0?(n=~n,n<r?(this._items[n].end=e,this._items.splice(n+1,this._items.length-n+1)):this._items=[]):this._items.splice(n+1,this._items.length-n+1)},e.prototype.deleteFromTop=function(e){var t=0,n=0;for(t=0;t<this._items.length;t++){var r=this._items[t];n+=r.end-r.start+1;if(n>=e)break}n>=e&&(this._items[t].start=n-e+1),this._items.splice(0,t)},e.prototype.deleteFromBottom=function(e){var t=0,n=0;for(t=this._items.length-1;t>=0;t--){var r=this._items[t];n+=r.end-r.start+1;if(n>=e)break}n>=e&&(this._items[t].start=n-e+1),this._items.splice(t,this._items.length-t)},e.prototype._binSearchByStartVal=function(e){var t=0,n=this._items.length-1;while(t<=n){var r=n+t>>1,i=this._items[r].start-e;if(i===0)return r;i<0?t=r+1:n=r-1}return~t},e.prototype._binSearchByEndVal=function(e){var t=0,n=this._items.length-1;while(t<=n){var r=n+t>>1,i=this._items[r].end-e;if(i<0)t=r+1;else{if(!i)return r;n=r-1}}return~t},e}();e.renderBoundsCollection=t})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));var wijmo;(function(e){(function(e){function r(n,r,i,s){function u(t){return s.parser=s.parser||e.defaultParsers[t],!s.parser&&n!=null&&e.errors.noParser(t),s.parser}var o=n;s=t.extend({nullString:"",format:""},s),r=r||n!=null&&typeof n,i=i||r;if(!i)return n;if(i=="string")return u(r),s.parser?s.parser.toStr(n,s.culture,s.format,s.nullString,!0):n;u(i);if(!s.parser)return n;n=s.parser.parse(n,s.culture,s.format,s.nullString,!0);if(isNaN(n)&&n!=null&&e.util.isNumeric(n)){if(s.ignoreError)return o;e.errors.cantConvert(i,o)}return n}function i(t){return function(){return n||e.util.logError(e.errors.noGlobalize.create().message),t.apply(this,arguments)}}var t=jQuery,n=Globalize;e.convert=r,e.defaultParsers={string:{parse:function(e,t,n,r,i){switch(e){case null:return null;case r:if(i)return null;case undefined:case"&nbsp":return"";default:return""+e}},toStr:function(e,t,n,r,i){return e===null&&i?r:""+e}},number:{parse:function(e,t,r,i,s){var o=typeof e;return o==="number"?isNaN(e)?NaN:e:!e&&e!==0||e==="&nbsp;"||e===i&&s?null:n.parseFloat(e,10,t.name)},toStr:function(e,t,r,i,s){return e===null&&s?i:n.format(e,r||"n",t.name)}},currency:{parse:function(e,t,r,i,s){var o=typeof e;return o==="number"?isNaN(e)?NaN:e:!e&&e!==0||e==="&nbsp;"||e===i&&s?null:(o==="string"&&(e=e.replace(t.numberFormat.currency.symbol,"")),n.parseFloat(e,10,t.name))},toStr:function(e,t,r,i,s){return e===null&&s?i:n.format(e,r||"c",t.name)}},datetime:{parse:function(e,t,r,i,s){var o;if(e instanceof Date)return e;if(!e||e==="&nbsp;"||e===i&&s)return null;o=/^\/Date\((\d+)\)\/$/.exec(e);if(o)return new Date(parseInt(o[1],10));var u=n.parseDate(e,r,t.name);if(u==null||isNaN(u))u=Date.parse(e),u=isNaN(u)?NaN:new Date(u);return u},toStr:function(e,t,r,i,s){return e===null&&s?i:n.format(e,r||"d",t.name)}},"boolean":{parse:function(e,n,r,i,s){var o=typeof e;if(o==="number")return e!=0;if(o==="boolean")return e;o==="string"&&(e=t.trim(e));if(!e||e==="&nbsp;"||e===i&&s)return null;switch(e.toLowerCase()){case"true":return!0;case"false":return!1}return NaN},toStr:function(e,t,n,r,i){return e===null&&i?r:e?"true":"false"}}},t.each(e.defaultParsers,function(e,t){t.parse=t.parse&&i(t.parse),t.toStr=t.toStr&&i(t.toStr)})})(e.data||(e.data={}));var t=e.data})(wijmo||(wijmo={}));var wijmo;(function(e){(function(e){(function(t){(function(n){function r(r){function i(r){var s=[];if(r.length===0)return s;var o=n.Connective.AND;return e.util.each(r,function(r,u){if(r==0&&e.util.isString(u)){var a=u.toLowerCase();if(a==n.Connective.AND||a==n.Connective.OR){o=a;return}}if($.isArray(u)){u=i(u);if(!u)return;if(u[0]===o||u.length==2){u.shift(),s=s.concat(u);return}}else{var f=t.normalizeCondition(u);if(!f)return;f.property=u.property,u=f}s.push(u)}),s.length==0?null:(s.unshift(o),s)}return i(r)}function i(t){if(!$.isArray(t))return null;var i={original:t,normalized:r(t),func:null};return i.normalized==null?i.func=function(e){return!0}:i.func=function(t){function r(i){var s=i[0]===n.Connective.AND,o=s?e.util.every:e.util.some;return o(i,function(n,i){if(i===0)return s;if($.isArray(n))return r(n);var o=e.util.getProperty(t,n.property);return n.op.apply(o,n.value)})}return r(i.normalized)},i}function s(t){return i(t)||e.filtering.compile(t)}n.Connective={AND:"and",OR:"or"},n.compile=s})(t.extended||(t.extended={}));var n=t.extended})(e.filtering||(e.filtering={}));var t=e.filtering})(e.data||(e.data={}));var t=e.data})(wijmo||(wijmo={}));var wijmo;(function(e){(function(t){var n=jQuery,r=e.data,i=r.filtering.extended,s=function(){function e(e){this.real=e,this._updatingFilter=!1,this._overrideFilter(),this._makeMemberProxies()}return e.prototype._overrideFilter=function(){var e=this;this.filter=r.observable(this.real.filter()),this.filter.subscribe(function(t){e.real.filter()!==t&&!e._updatingFilter&&e.refresh({filter:t})}),this.real.filter.subscribe(function(t){t!==e._lastSetFilter&&e.filter(t)})},e.prototype.refresh=function(e,t){typeof t=="undefined"&&(t=!1),e=n.extend({},e);var r=e.filter;e.filter=this._coerceFilter(e.filter),this._lastSetFilter=e.filter,this._updatingFilter=!0;try{n.isFunction(e.filter)&&!n.isFunction(r)?this.filter(r):this.filter(e.filter)}finally{this._updatingFilter=!1}return this.real.refresh(e,t)},e.prototype._makeMemberProxies=function(){var e=this;r.util.each(this.real,function(t,r){if(!n.isFunction(r)||e[t]||t.charAt(0)==="_")return;e[t]=n.isFunction(r.subscribe)?r:function(){return r.apply(e.real,arguments)}})},e.create=function(n){return new e(n)},e.prototype._convertComplexPropertyFilterToExtendedFilterFormat=function(e){var t=[];return n.each(e,function(e,s){if(!n.isArray(s))s=[s];else{var o=r.util.isString(s[0])&&s[0].toLowerCase();if(o===i.Connective.AND||o===i.Connective.OR){t.push(s);return}}var u=[];n.each(s,function(t,n){var i=r.filtering.normalizeCondition(n);i&&(i.property=e,u.push(i))}),u.length>0&&t.push(u)}),t.length>0?t:null},e.prototype._coerceFilter=function(e){if(n.isArray(e))return i.compile(e).func;if(!n.isPlainObject(e))return e;e=n.extend(!0,{},e);var t={};n.each(e,function(i,s){n.isArray(s)||(s=[s]);if(t){var o=r.util.isString(s[0])&&s[0].toLowerCase();if(s.length==1||s.length==2&&(o==="and"||o==="or")){t[i]=s[s.length-1];return}}e[i]=s,t=null});if(t)return t;var s=this._convertComplexPropertyFilterToExtendedFilterFormat(e);return i.compile(s).func},e.prototype._unsafeReplace=function(e,t){this.real.sourceArray[e]=t,this.real.local[e]=t},e.prototype._unsafeSplice=function(e,t,n){arguments.length===2?(this.real.sourceArray.splice(e,t),this.real.local.splice(e,t)):(this.real.sourceArray.splice(e,t,n),this.real.local.splice(e,t,n))},e.prototype._unsafePush=function(e){this.real.sourceArray.push(e),this.real.local.push(e)},e}();t.GridDataView=s})(e.grid||(e.grid={}));var t=e.grid})(wijmo||(wijmo={}));;
var wijmo;(function(e){var t=jQuery,n=function(){function e(){}return e.prototype.round=function(e,t){return e?Globalize.parseFloat(e.toFixed(t),10,Globalize.culture("en")):0},e.prototype.toOADate=function(e){var t=864e5,n=e-new Date(1900,0,1)+2*t;return n},e.prototype.fromOADate=function(e){var t=864e5,n=new Date(e-2*t+(new Date(1900,0,1)).getTime());return n},e.prototype.arrayClone=function(e){var n=[];return t.each(e,function(e,r){n.push(t.extend(!0,{},r))}),n},e}(),r=function(){function e(){}return e.prototype.isSVGElem=function(e){var t="http://www.w3.org/2000/svg";return e.nodeType===1&&e.namespaceURI===t},e.prototype.addClass=function(e,n){n=n||"";var r=this;t.each(e,function(){if(r.isSVGElem(this)){var e=this;t.each(n.split(/\s+/),function(n,r){var i=e.className?e.className.baseVal:e.getAttribute("class");t.inArray(r,i.split(/\s+/))===-1&&(i+=(i?" ":"")+r,e.className?e.className.baseVal=i:e.setAttribute("class",i))})}else t(this).addClass(n)})},e.prototype.clearRaphaelCache=function(){},e.prototype.getPositionByAngle=function(e,t,n,r){var i={x:0,y:0},s=Raphael.rad(r);return i.x=e+n*Math.cos(-1*s),i.y=t+n*Math.sin(-1*s),i},e.prototype.hasClass=function(e,n){if(!n||n.length===0)return!1;if(this.isSVGElem(e)){var r=e.className?e.className.baseVal:e.getAttribute("class"),i=!1;return t.each(r.split(/\s+/),function(e,t){if(t===n)return i=!0,!1}),i}return t(e).hasClass(n)},e.prototype.sector=function(e,t,n,r,i){var s=this.getPositionByAngle(e,t,n,r),o=this.getPositionByAngle(e,t,n,i);return["M",e,t,"L",s.x,s.y,"A",n,n,0,+(i-r>180),0,o.x,o.y,"z"]},e}();t.extend(n.prototype),t.extend({wijraphael:r.prototype});var i="[\\x20\\t\\r\\n\\f]",s=t.expr.filter.CLASS,o=function(e,t){var n=e.split("."),r=t.split("."),i=Math.max(n.length,r.length),s=0,o,u,a;for(o=0;o<i;o++){u=n[o]?parseInt(n[o]):0,a=r[o]?parseInt(r[o]):0;if(u>a){s=1;break}if(u<a){s=-1;break}}return s};t.expr.filter.CLASS=function(e,n){if(o(t.fn.jquery,"1.8")<0){var r=!t.wijraphael||!t.wijraphael.isSVGElem(e)?e.className:e.className?e.className.baseVal:e.getAttribute("class");return(" "+r+" ").indexOf(n)>-1}var s=new RegExp("(^|"+i+")"+e+"("+i+"|$)");return function(e){var n=!t.wijraphael||!t.wijraphael.isSVGElem(e)?e.className:e.className?e.className.baseVal:e.getAttribute("class");return s.test(n)}},o(t.fn.jquery,"1.8")<0&&(t.expr.preFilter.CLASS=function(e,n,r,i,s,o){var u=0,a=null,f=null;e=" "+e[1].replace(/\\/g,"")+" ";if(o)return e;for(u=0,a={};a;u++){a=n[u];if(!a)try{a=n.item(u)}catch(l){}a&&(f=!t.wijraphael||!t.wijraphael.isSVGElem(a)?a.className:(a.className?a.className.baseVal:"")||a.getAttribute("class"),s^(f&&(" "+f+" ").indexOf(e)>-1)?r||i.push(a):r&&(n[u]=!1))}return!1}),Raphael.fn.tri=function(e,t,n){var r=e,i=t-n,s=Math.cos(30*Math.PI/180)*n,o=Math.tan(60*Math.PI/180)*s,u=e+s,a=t+o,f=e-s,l=t+o,c=["M",r.toString(),i.toString(),"L",u.toString(),a.toString(),"L",f.toString(),l.toString(),"z"];return this.path(c.join(" "))},Raphael.fn.invertedTri=function(e,t,n){var r=e,i=t+n,s=Math.cos(30*Math.PI/180)*n,o=Math.tan(60*Math.PI/180)*s,u=e+s,a=t-o,f=e-s,l=t-o,c=["M",r.toString(),i.toString(),"L",u.toString(),a.toString(),"L",f.toString(),l.toString(),"z"];return this.path(c.join(" "))},Raphael.fn.box=function(e,t,n){var r=Math.cos(45*Math.PI/180)*n,i=["M",e-r,t-r,"L",e+r,t-r,"L",e+r,t+r,"L",e-r,t+r,"z"];return this.path(i.join(" "))},Raphael.fn.diamond=function(e,t,n){var r=["M",e,t-n,"L",e+n,t,"L",e,t+n,"L",e-n,t,"z"];return this.path(r.join(" "))},Raphael.fn.cross=function(e,t,n){var r=Math.cos(45*Math.PI/180)*n,i=["M",e-r,t-r,"L",e+r,t+r,"M",e-r,t+r,"L",e+r,t-r];return this.path(i.join(" "))},Raphael.fn.paintMarker=function(e,t,n,r){var i=this,s=null;e||(e="circle");switch(e){case"circle":s=i.circle(t,n,r);break;case"tri":s=i.tri(t,n,r);break;case"invertedTri":s=i.invertedTri(t,n,r);break;case"box":s=i.box(t,n,r);break;case"diamond":s=i.diamond(t,n,r);break;case"cross":s=i.cross(t,n,r)}return s},Raphael.fn.htmlText=function(e,n,r,i,s,o){var u=function(e,t,n){var r=/<(b|strong)>/,i=/<(i|em)>/,s=/href=[\"\']([^\"\']+)[\"\']/,o=/<a/;n&&e.attr(n),r.test(t)&&e.attr("font-weight","bold"),i.test(t)&&e.attr("font-style","italic"),o.test(t)&&t.match(s)[1]&&e.attr("href",t.match(s)[1])},a=r.toString().split(/<br\s?\/>|\\r/i),f=this,l=f.set(),c=0,h=0;return s=s||3,o=o||5,t.each(a,function(e,n){var r=0,a=n.split("|||");n=n.replace(/<([A-Za-z]+(.|\n)*?)>/g,"|||<$1>").replace(/<\/([A-Za-z]*)>/g,"</$1>|||"),t.each(a,function(e,n){var o=null,a=null,p=0,d,v=0;n!==""&&(o=n,o=t.trim(o.replace(/<(.|\n)*?>/g,"")),d=f.text(0,0,o),u(d,n,i),a=d.wijGetBBox(),p=a.width/2+c,v=-a.height/2+h,c=c+a.width+s,d.translate(p,v),l.push(d),r<a.height&&(r=a.height))}),h+=r+o,c=r=0}),h=0,l.transform(Raphael.format("...t{0},{1}",e-l.getBBox().x,n-l.getBBox().y)),l},Raphael.fn.line=function(e,t,n,r){return this.path(["M",e.toString(),t.toString(),"L",n.toString(),r.toString()])},Raphael.fn.roundRect=function(e,n,r,i,s,o,u,a){var f=[],l=[-1,1,1,1,1,-1,-1,-1],c=["v","h","v","h"],h=null,p=null;return t.each([s,o,u,a],function(e,t){typeof t=="number"?f=f.concat([{x:t,y:t}]):typeof t=="object"?f=f.concat(t):f=f.concat([{x:0,y:0}])}),h=["M",e+f[0].x,n],p=[i-f[0].y-f[1].y,r-f[1].x-f[2].x,f[2].y+f[3].y-i,f[3].x+f[0].x-r],t.each(f,function(e,t){t.x&&t.y&&(h=h.concat("a",t.x,t.y,0,0,0,l[2*e]*t.x,l[2*e+1]*t.y)),h=h.concat(c[e],p[e])}),h.push("z"),this.path(h)},Raphael.fn.wrapText=function(e,n,r,i,s,o){function v(e,t,n){var r=null,i=null,s=e.toString().split(" "),o=[],a=[],f="";while(s.length)f+=" "+s[0],r=u.text(-1e3,-1e3,f),r.attr(n),i=r.wijGetBBox(),i.width>t?(a.length&&(o.push(a),f=s[0]),a=[s.shift()]):a.push(s.shift()),s.length===0&&o.push(a),r.wijRemove(),r=null;return o}var u=this,a=o.rotation,f=a?t.extend(!0,{},o,{rotation:0}):o,l=n,c=u.set(),h=null,p=null,d=[];return typeof r=="undefined"&&(r=""),t.each(v(r,i,f),function(t,n){var r=n.join(" "),o=s||"near",p=u.text(e,l,r),v=0,m=0;p.attr(f),h=p.wijGetBBox();switch(o){case"near":v=i-h.width/2;break;case"center":v+=i/2;break;case"far":v+=h.width/2}a?(m+=h.height/2/Math.abs(Math.sin(a)),l+=h.height/Math.abs(Math.sin(a))):(m+=h.height/2,l+=h.height),h.x+=v,h.y+=m,a?p.attr({x:p.attr("x")+v,y:p.attr("y")+m}):p.transform(Raphael.format("...T{0},{1}",v,m)),c.push(p),d.push(h)}),a&&(h=c.wijGetBBox(),c.length>1?(t.each(c,function(e,t){t.attr({y:t.attr("y")-h.height/2}),d[e].y-=h.height/2}),p={x:h.x+h.width/2,y:h.y+h.height/2},t.each(c,function(e,n){var r=Math,i=d[e],s={x:i.x+i.width/2,y:i.y+i.height/2},o=r.sqrt(r.pow(s.x-p.x,2)+r.pow(s.y-p.y,2)),u=0,f=null,l=null;n.attr({rotation:a});if(o===0)return!0;f=n.wijGetBBox(),u=Raphael.deg(r.asin(r.abs(s.y-p.y)/o)),s.y>p.y?s.x>p.x?u-=360:u=-1*(u+180):s.x>p.x?u*=-1:u=-1*(180-u),l=t.wijraphael.getPositionByAngle(p.x,p.y,o,-1*(a+u)),n.attr({y:n.attr("y")+l.y-f.y-f.height/2})})):c[0].transform(Raphael.format("...R{0}",a))),c},Raphael.fn.getSVG=function(){function e(e,n){var r="<"+e+" ",i=null,s=!1;return t.each(n,function(e,t){if(e==="text"||e==="opacity"||e==="transform"||e==="path"||e==="w"||e==="h"||e==="translation")return!0;t&&(e==="stroke"&&t===0&&(t="none"),r+=e+"='"+t+"' ")}),n.opacity&&(i=n.opacity,r+="opacity='"+i+"' style='opacity:"+i+";",s=!0),n.transform&&n.transform.length>0&&(i=n.transform,s?r+="transform:"+i:(r+="style='transform:"+i,s=!0)),s&&(r+="'"),n.text?(i=n.text,r+="><tspan>"+i+"</tspan>"):r+=">",r+="</"+e+">",r}var n=this,r='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1" width="'+n.canvas.offsetWidth+'" height="'+n.canvas.offsetHeight+'"><desc>Created with Raphael</desc><defs></defs>',i,s="",o,u,a,f=0,l=0,c=0,h=0;for(i=n.bottom;i;i=i.next)if(i&&i.type)switch(i.type){case"path":for(f=0,l=i.attrs.path.length;f<l;f++){u=i.attrs.path[f];for(c=0,h=u.length;c<h;c++)a=u[c],c<1?s+=a:c===h-1?s+=a:s+=a+","}s&&s.length>0&&(i.attrs.d=s.replace(/,/g," "));break;case"text":i.attrs["text-anchor"]||(i.attrs["text-anchor"]="middle");break;case"image":o=i.transformations,i.attrs.transform=o?o.join(" "):"";break;case"ellipse":case"rect":r+=e(i.type,i.attrs)}return r+="</svg>",r},Raphael.el.wijRemove=function(){var e=this,n;if(e.removed)return;e.node.parentNode&&(n=t(e.node),e.stop().remove(),n.remove())},Raphael.el.wijGetBBox=function(){return this.getBBox()},Raphael.el.wijAnimate=function(e,n,r,i){if(!e||t.isEmptyObject(e))return;var s=this.shadow,o=0,u={easeInCubic:">",easeOutCubic:"<",easeInOutCubic:"<>",easeInBack:"backIn",easeOutBack:"backOut",easeOutElastic:"elastic",easeOutBounce:"bounce"};u[r]&&(r=u[r]),this.animate(e,n,r,i),u=null,s&&s.offset&&(o=s.offset,e.x&&(e.x+=o),e.y&&(e.y+=o),this.shadow.animate(e,n,r,i))},Raphael.el.wijAttr=function(e,n){this.attr(e,n);if(this.shadow)if(typeof e=="object"){var r=t.extend(!0,{},e);r.fill&&delete r.fill,r.stroke&&delete r.stroke,r["stroke-width"]&&delete r["stroke-width"],this.shadow.attr(r,n)}else if(typeof e=="string")switch(e){case"clip-rect":case"cx":case"cy":case"fill-opacity":case"font":case"font-family":case"font-size":case"font-weight":case"height":case"opacity":case"path":case"r":case"rotation":case"rx":case"ry":case"scale":case"stroke-dasharray":case"stroke-linecap":case"stroke-linejoin":case"stroke-miterlimit":case"stroke-opacity":case"stroke-width":case"translation":case"width":this.shadow.attr(e,n);break;case"x":this.shadow.attr(e,n),this.shadow.attr("transform","...t1,0");break;case"y":this.shadow.attr(e,n),this.shadow.attr("transform","...t0,1");break;default:}},Raphael.st.wijRemove=function(){t.each(this,function(e,t){t.wijRemove&&!t.removed&&t.wijRemove()})},Raphael.st.wijAttr=function(e,n){return t.each(this.items,function(t,r){r.wijAttr(e,n)}),this},Raphael.st.wijAnimate=function(e,t,n,r){var i=0,s=0,o=null;for(i=0,s=this.items.length;i<s;i++)o=this.items[i],o.removed||o.wijAnimate(e,t,n,r);return this},Raphael.st.wijGetBBox=function(){var e=[],t=[],n=[],r=[],i,s,o=Math.max,u=Math.min,a="push",f="apply",l=null,c=0;for(c=this.items.length-1;c>=0;c--)l=this.items[c].wijGetBBox(),e[a](l.x),t[a](l.y),n[a](l.x+l.width),r[a](l.y+l.height);return i=u[f](0,e),s=u[f](0,t),{x:i,y:s,x2:undefined,y2:undefined,width:o[f](0,n)-i,height:o[f](0,r)-s}};var u=Raphael.el.attr;Raphael.el.attr=function(e,n){return t.isPlainObject(e)&&t.each(e,function(t,n){(t==="width"||t==="height"||t==="r")&&!isNaN(n)&&n<0&&(e[t]=0)}),(e==="width"||e==="height"||e==="r")&&!isNaN(n)&&n<0&&(n=0),u.apply(this,arguments)}})(wijmo||(wijmo={}));;
var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(t){var n=jQuery,r=function(){function e(){}return e.getDiffAttrs=function(t,r){var i={};return n.each(r,function(e,n){if(typeof t=="undefined")return!0;typeof t[e]=="undefined"?i[e]=r[e]:t[e]!==r[e]&&(i[e]=r[e])}),i},e.paintShadow=function(t,r,i){if(t.removed||n(t.node).parent().length===0)return;var s=t.clone(),o=r||1,u=i||"#cccccc";s.insertBefore(t),s.attr({transform:Raphael.format("...T{0},{1}",o,o),stroke:u,"stroke-width":o}),s.toBack(),s.offset=o,t.shadow=s},e.getScaling=function(t,n,r,i){var s=n-r;return s===0&&(s=1),t&&(s=-s),i/s},e.getTranslation=function(t,n,r,i,s){var o=0;return t?(o=n.y,o-=s*r):(o=n.x,o-=s*i),o},e.getXSortedPoints=function(t){function a(e,t){return e-t}var r=t.data.x,i=[].concat(r),s=[].concat(t.data.y),o=[],u=r;if(r===undefined||r.length===0)return;return typeof r[0]=="number"&&(u=[].concat(r).sort(a)),n.each(u,function(e,t){n.each(i,function(n,r){if(t===r)return typeof r!="number"&&(r=e),o.push({x:r,y:s[n]}),i.splice(n,1),s.splice(n,1),!1})}),o},e.sector=function(t,r,i,s,o){var u=n.wijraphael.getPositionByAngle(t,r,i,s),a=n.wijraphael.getPositionByAngle(t,r,i,o);return["M",t,r,"L",u.x,u.y,"A",i,i,0,+(o-s>180),0,a.x,a.y,"z"]},e.donut=function(t,r,i,s,o,u){var a=n.wijraphael.getPositionByAngle(t,r,i,o),f=n.wijraphael.getPositionByAngle(t,r,i,u),l=n.wijraphael.getPositionByAngle(t,r,s,o),c=n.wijraphael.getPositionByAngle(t,r,s,u),h=u-o>180;return["M",a.x,a.y,"A",i,i,0,+h,0,f.x,f.y,"L",c.x,c.y,"A",s,s,0,+h,1,l.x,l.y,"L",a.x,a.y,"z"]},e.getFirstValidListValue=function(t){var r;return n.each(t,function(e,t){return t===null?!0:typeof t=="undefined"?!0:typeof t=="number"&&isNaN(t)?!0:(r=t,!1)}),r},e.getLastValidListValue=function(n){var r=[].concat(n).reverse();return e.getFirstValidListValue(r)},e.isHolefunction=function(t,n){return t===null?!0:typeof t=="undefined"?!0:typeof t=="number"&&isNaN(t)?!0:n===null?!1:typeof t!="undefined"?t-n===0?!0:!1:!1},e}();t.ChartUtil=r;var i=function(){function e(){}return e.roundTime=function(t,r,i){var s=this,o=r,u=n.fromOADate(t),a,f,l,c;return o>0?(a={year:u.getFullYear(),month:u.getMonth(),day:u.getDate(),hour:u.getHours(),minute:u.getMinutes(),second:u.getSeconds()},o<s.tmInc.minute?(a.second=s.tround(a.second,o,i),s.getTimeAsDouble(a)):(a.second=0,o<s.tmInc.hour?(o/=s.tmInc.minute,a.minute=s.tround(a.minute,o,i),s.getTimeAsDouble(a)):(a.minute=0,o<s.tmInc.day?(o/=s.tmInc.hour,a.hour=s.tround(a.hour,o,i),s.getTimeAsDouble(a)):(a.hour=0,o<s.tmInc.month?(o/=s.tmInc.day,a.day=s.tround(a.day,o,i),s.getTimeAsDouble(a)):(a.day=1,o<s.tmInc.year?(o/=s.tmInc.month,a.month=s.tround(a.month,o,i),s.getTimeAsDouble(a)):(a.month=0,o/=s.tmInc.year,a.year=s.tround(a.year,o,i),s.getTimeAsDouble(a))))))):(f=u,l=f-o,c=parseInt((l/r).toString(),10)*r,i&&c!==l&&(c+=r),f=o+c,f)},e.tround=function(t,n,r){var i=parseInt((t/n*n).toString(),10);return r&&i!==t&&(i+=parseInt(n,10)),i},e.getTimeAsDouble=function(t){var r=0,i=0,s=null;return t.day<1?(i=-1-t.day,t.day=1):t.day>28&&(i=t.day-28,t.day=28),t.month<0?(r=-1-t.day,t.month=0):t.month>11&&(r=t.month-11,t.month=11),s=new Date(t.year,t.month,t.day,t.hour,t.minute,t.second),s.setDate(s.getDate()+i),s.setMonth(s.getMonth()+r),n.toOADate(s)},e.getTimeDefaultFormat=function(t,n){var r=this,i=t-n,s="d";return i>2*r.tmInc.year?s="yyyy":i>r.tmInc.year?s="MMM yy":i>3*r.tmInc.month?s="MMM":i>2*r.tmInc.week?s="MMM d":i>2*r.tmInc.day?s="ddd d":i>r.tmInc.day?s="ddd H:mm":i>r.tmInc.hour?s="H:mm":i>=1e3&&(s="H:mm:ss"),s},e.niceTimeUnit=function(t,n){var r=this,i=t;return i=r.niceTimeSpan(i,n),i},e.niceTimeSpan=function(t,n){var r=this,i=r.manualTimeInc(n),s=0,o=0;s=Math.ceil(t);if(s===0)return r.timeSpanFromTmInc(i);o=1;if(i<r.tmInc.minute){if(s<r.tmInc.minute){o=r.getNiceInc([1,2,5,10,15,30],s,i);if(o!==0)return o}i=r.tmInc.minute}if(i<r.tmInc.hour){if(s<r.tmInc.hour){o=r.getNiceInc([1,2,5,10,15,30],s,i);if(o!==0)return o}i=r.tmInc.hour}if(i<r.tmInc.day){if(s<r.tmInc.day){o=r.getNiceInc([1,3,6,12],s,i);if(o!==0)return o}i=r.tmInc.day}if(i<r.tmInc.month){if(s<r.tmInc.month){o=r.getNiceInc([1,2,7,14],s,i);if(o!==0)return o}i=r.tmInc.month}if(i<r.tmInc.year){if(s<r.tmInc.year){o=r.getNiceInc([1,2,3,4,6],s,i);if(o!==0)return o}i=r.tmInc.year}return o=100*r.tmInc.year,s<o&&(o=r.getNiceInc([1,2,5,10,20,50],s,i),o===0&&(o=100*r.tmInc.year)),o},e.getNiceInc=function(t,n,r){var i=0,s=0,o=t.length;for(i=0;i<o;i++){s=t[i]*r;if(n<=s)return s}return 0},e.timeSpanFromTmInc=function(t){var n=1e3,r=t,i=1;if(t!==this.tmInc.maxtime)if(t>this.tmInc.tickf1)n=t;else{t+=7;while(r>0)i*=10,r--;n=i}return n},e.manualTimeInc=function(t){var n=this,r=n.tmInc.second;return!t||t.length===0?r:(t.indexOf("s")>=0?r=n.tmInc.second:t.indexOf("m")>=0?r=n.tmInc.minute:t.indexOf("h")>=0||t.indexOf("H")>=0?r=n.tmInc.hour:t.indexOf("d")>=0?r=n.tmInc.day:t.indexOf("M")>=0?r=n.tmInc.month:t.indexOf("y")>=0&&(r=n.tmInc.year),r)},e.tmInc={tickf7:-7e3,tickf6:-6e3,tickf5:-5e3,tickf4:-4e3,tickf3:-3e3,tickf2:-2e3,tickf1:-1,second:1e3,minute:6e4,hour:36e5,day:864e5,week:6048e5,month:26784e5,year:31536e6,maxtime:2147483647},e.niceTickNumber=function(t){if(parseFloat(t)===0)return t;t<0&&(t=-t);var n=Math.log(t)/Math.log(10),r=parseInt(this.signedFloor(n).toString(),10),i=t/Math.pow(10,r),s=10;return i<=1?s=1:i<=2?s=2:i<=5&&(s=5),s*Math.pow(10,r)},e.niceNumber=function(t,n,r){if(parseFloat(t)===0)return t;t<0&&(t=-t);var i=t/Math.pow(10,n),s=10;return r?i<1.5?s=1:i<3?s=2:i<7&&(s=5):i<=1?s=1:i<=2?s=2:i<=5&&(s=5),s*Math.pow(10,n)},e.nicePrecision=function(t){if(t<=0||typeof t!="number")return 0;var n=Math.log(t)/Math.log(10),r=parseInt(this.signedFloor(n).toString(),10),i=t/Math.pow(10,r);return i<3&&(r=-r+1),r},e.precCeil=function(t,n){var r=Math.pow(10,t),i=n/r;return i=Math.ceil(i),i*r},e.precFloor=function(t,n){var r=Math.pow(10,t),i=n/r;return i=Math.floor(i),i*r},e.signedCeiling=function(t){return t<0?Math.floor(t):Math.ceil(t)},e.signedFloor=function(t){return t<0?Math.ceil(t):Math.floor(t)},e}();t.ChartDataUtil=i,Raphael.fn.closeBtn=function(e,t,n){var r=Math.cos(45*Math.PI/180)*n,i=this.set(),s=["M",e-r,t-r,"L",e+r,t+r,"M",e-r,t+r,"L",e+r,t-r],o=this.path(s.join(" ")),u=null;return o.attr({cursor:"pointer"}),i.push(o),u=this.rect(e-n,t-n,n*2,n*2),u.attr({fill:"white","fill-opacity":0,cursor:"pointer",stroke:"none"}),i.push(u),i};var s=function(){function e(e,t,r){this.options={content:"",contentStyle:{},title:"",titleStyle:{},style:{fill:"white","fill-opacity":.5},closeBehavior:"auto",mouseTrailing:!0,triggers:"hover",animated:"fade",showAnimated:null,hideAnimated:null,duration:500,showDuration:500,hideDuration:500,easing:null,showEasing:null,hideEasing:null,showDelay:150,hideDelay:150,relativeTo:"mouse",compass:"east",offsetX:0,offsetY:0,showCallout:!0,calloutFilled:!1,calloutFilledStyle:{fill:"black"},calloutLength:12,calloutOffset:0,calloutAnimation:{easing:null,duration:500},windowCollisionDetection:"flip",calloutSide:null,width:null,height:null,beforeShowing:null},this.paper=e,this.targets=t,n.extend(this.options,r),this.init()}return e.prototype.init=function(){var e=this.options;this.calloutOffset=e.calloutOffset,this.offsetLength=0,this.gapLength=e.calloutLength/2,this.width=e.width,this.height=e.height,this.offset={x:0,y:0},this.targets&&this._bindLiveEvent(this.targets),this.selector&&this._bindLiveEventBySelector(this.selector)},e.prototype._getShowPoint=function(e,t){var n=e.getBBox(),r={x:0,y:0};switch(t.toLowerCase()){case"east":r.x=n.x+n.width,r.y=n.y+n.height/2;break;case"eastnorth":r.x=n.x+n.width,r.y=n.y;break;case"eastsouth":r.x=n.x+n.width,r.y=n.y+n.height;break;case"west":r.x=n.x,r.y=n.y+n.height/2;break;case"westnorth":r.x=n.x,r.y=n.y;break;case"westsouth":r.x=n.x,r.y=n.y+n.height;break;case"north":r.x=n.x+n.width/2,r.y=n.y;break;case"northeast":r.x=n.x+n.width,r.y=n.y;break;case"northwest":r.x=n.x,r.y=n.y;break;case"south":r.x=n.x+n.width/2,r.y=n.y+n.height;break;case"southeast":r.x=n.x+n.width,r.y=n.y+n.height;break;case"southwest":r.x=n.x,r.y=n.y+n.height}return r},e.prototype._clearIntentTimer=function(e){e&&(window.clearTimeout(e),e=null)},e.prototype._removeTooltip=function(t){var n=this,r=this,i=this.elements,s=r.options,o,u,a;if(i){if(s.hideAnimated||s.animated)o=s.hideAnimated,o||(o=s.animated),o&&e.animations[o]&&(a={animated:o,duration:s.hideDuration||s.duration,easing:s.hideEasing||s.easing,context:i,show:!1},e.animations[o](a));u=s.hideDuration||s.duration,t&&(u=t),window.setTimeout(function(){var e,t;n.content&&(n.content.wijRemove(),n.content=null),n.title&&(n.title.wijRemove(),n.title=null),n.container&&(n.container.wijRemove(),n.container=null);if(n.closeBtn){for(e=0,t=n.closeBtn.length;e<t;e++)n.closeBtn[e].unclick();n.closeBtn.wijRemove(),n.closeBtn=null}n.callout&&(n.callout.wijRemove(),n.callout=null),r.lastPoint=null,i=null},u)}},e.prototype._clearTimers=function(){this.intentShowTimer&&this._clearIntentTimer(this.intentShowTimer),this.intentHideTimer&&this._clearIntentTimer(this.intentHideTimer)},e.prototype._hide=function(e){var t=this;t._clearTimers(),t.options.hideDelay?t.intentHideTimer=window.setTimeout(function(){t._removeTooltip()},t.options.hideDelay):t._removeTooltip()},e.prototype._convertCompassToPosition=function(e){var t="",n={x:0,y:0};switch(e.toLowerCase()){case"east":t="right-middle",n.x=2,n.y=0;break;case"eastnorth":t="right-top",n.x=2,n.y=-2;break;case"eastsouth":t="right-bottom",n.x=2,n.y=2;break;case"west":t="left-middle",n.x=-2,n.y=0;break;case"westnorth":t="left-top",n.x=-2,n.y=-2;break;case"westsouth":t="left-bottom",n.x=-2,n.y=2;break;case"north":t="top-middle",n.x=0,n.y=-2;break;case"northeast":t="top-right",n.x=2,n.y=-2;break;case"northwest":t="top-left",n.x=-2,n.y=-2;break;case"south":t="bottom-middle",n.x=0,n.y=2;break;case"southeast":t="bottom-right",n.x=2,n.y=2;break;case"southwest":t="bottom-left",n.x=-2,n.y=2}return this.offset=n,t},e.prototype._getCalloutArr=function(e,t){var n=[],r=this.options,i=r.compass;r.calloutSide&&(i=r.calloutSide);switch(i.toLowerCase()){case"east":case"eastsouth":case"eastnorth":n=["M",e.x+t,e.y+t,"l",-t,-t,"l",t,-t,"Z"];break;case"west":case"westsouth":case"westnorth":n=["M",e.x-t,e.y-t,"l",t,t,"l",-t,t,"Z"];break;case"north":case"northeast":case"northwest":n=["M",e.x-t,e.y-t,"l",t,t,"l",t,-t,"Z"];break;case"south":case"southeast":case"southwest":n=["M",e.x-t,e.y+t,"l",t,-t,"l",t,t,"Z"]}return n},e.prototype._getFuncText=function(e,t){if(n.isFunction(e)){var r=null,i,s={target:null,fmt:e},o;if(t&&t.target){o=t.target;if(!o.raphael||!o.raphaelid)o=o.parentNode;o.raphael&&o.raphaelid?(i=this.paper.getById(o.raphaelid),s.target=i):s.target=t.target}return r=n.proxy(s.fmt,s),r().toString()}return e},e.prototype._translateCallout=function(e){var t=this.options,n=this.width,r=this.height,i=this.gapLength,s=this.offsetLength,o=this.calloutOffset,u=this.tooltipElements.callout;if(t.calloutSide){var a=i||s;switch(t.calloutSide){case"south":case"north":e?u.animate({translation:-n/2+a+o+",0"},e):u.translate(-n/2+a+o,0);break;case"east":case"west":e?u.animate({translation:"0,"+(-r/2+a+o)},e):u.translate(0,-r/2+a+o)}}},e.replacer=function(t,n,r){var i=r,s=/(?:(?:^|\.)(.+?)(?=\[|\.|$|\()|\[('|")(.+?)\2\])(\(\))?/g;return n.replace(s,function(e,t,n,r,s){t=t||r,i&&(i[t]!=="string"&&(i=i[t]),typeof i=="function"&&s&&(i=i()))}),i=(i===null||i===r?t:i).toString(),i},e.fill=function(n,r){var i=/\{([^\}]+)\}/g;return String(n).replace(i,function(t,n){return e.replacer(t,n,r)})},e.prototype._createPath=function(t,n,r){var i=n.split("-"),s=5,o=r.getBBox(),u=this.options,a=u.padding,f=this.gapLength,l=this.offsetLength,c=a&&!isNaN(a)?parseInt(a):0,h=Math.round(o.width+c*2),p=Math.round(o.height+c*2),d=Math.round(o.x-c)-s,v=Math.round(o.y-c)-s,m=0,g=0,y=0,b=0,w=null,E=null,S=null;u.width&&(h=h>u.width?h:u.width),u.height&&(p=p>u.height?p:u.height),this.width=h,this.height=p,m=Math.min(p/4,h/4,f),l&&(l=Math.min(p/4,h/4,l)),l?(g=l,w={top:"M{x},{y}h{w4},{w4},{w4},{w4}a{r},{r},0,0,1,{r},{r}v{h4},{h4},{h4},{h4}a{r},{r},0,0,1,-{r},{r}l-{right},0-{offset},0,-{left},0a{r},{r},0,0,1-{r}-{r}v-{h4}-{h4}-{h4}-{h4}a{r},{r},0,0,1,{r}-{r}z",bottom:"M{x},{y}l{left},0,{offset},0,{right},0a{r},{r},0,0,1,{r},{r}v{h4},{h4},{h4},{h4}a{r},{r},0,0,1,-{r},{r}h-{w4}-{w4}-{w4}-{w4}a{r},{r},0,0,1-{r}-{r}v-{h4}-{h4}-{h4}-{h4}a{r},{r},0,0,1,{r}-{r}z",right:"M{x},{y}h{w4},{w4},{w4},{w4}a{r},{r},0,0,1,{r},{r}v{h4},{h4},{h4},{h4}a{r},{r},0,0,1,-{r},{r}h-{w4}-{w4}-{w4}-{w4}a{r},{r},0,0,1-{r}-{r}l0-{bottom},0-{offset},0-{top}a{r},{r},0,0,1,{r}-{r}z",left:"M{x},{y}h{w4},{w4},{w4},{w4}a{r},{r},0,0,1,{r},{r}l0,{top},0,{offset},0,{bottom}a{r},{r},0,0,1,-{r},{r}h-{w4}-{w4}-{w4}-{w4}a{r},{r},0,0,1-{r}-{r}v-{h4}-{h4}-{h4}-{h4}a{r},{r},0,0,1,{r}-{r}z"}):w={top:"M{x},{y}h{w4},{w4},{w4},{w4}a{r},{r},0,0,1,{r},{r}v{h4},{h4},{h4},{h4}a{r},{r},0,0,1,-{r},{r}l-{right},0-{gap},{gap}-{gap}-{gap}-{left},0a{r},{r},0,0,1-{r}-{r}v-{h4}-{h4}-{h4}-{h4}a{r},{r},0,0,1,{r}-{r}z",bottom:"M{x},{y}l{left},0,{gap}-{gap},{gap},{gap},{right},0a{r},{r},0,0,1,{r},{r}v{h4},{h4},{h4},{h4}a{r},{r},0,0,1,-{r},{r}h-{w4}-{w4}-{w4}-{w4}a{r},{r},0,0,1-{r}-{r}v-{h4}-{h4}-{h4}-{h4}a{r},{r},0,0,1,{r}-{r}z",right:"M{x},{y}h{w4},{w4},{w4},{w4}a{r},{r},0,0,1,{r},{r}v{h4},{h4},{h4},{h4}a{r},{r},0,0,1,-{r},{r}h-{w4}-{w4}-{w4}-{w4}a{r},{r},0,0,1-{r}-{r}l0-{bottom}-{gap}-{gap},{gap}-{gap},0-{top}a{r},{r},0,0,1,{r}-{r}z",left:"M{x},{y}h{w4},{w4},{w4},{w4}a{r},{r},0,0,1,{r},{r}l0,{top},{gap},{gap}-{gap},{gap},0,{bottom}a{r},{r},0,0,1,-{r},{r}h-{w4}-{w4}-{w4}-{w4}a{r},{r},0,0,1-{r}-{r}v-{h4}-{h4}-{h4}-{h4}a{r},{r},0,0,1,{r}-{r}z"},E=[{x:d+s,y:v,w:h,w4:h/4,h4:p/4,left:0,right:h-m*2-g*2,top:0,bottom:p-m*2-g*2,r:s,h:p,gap:m,offset:g*2},{x:d+s,y:v,w:h,w4:h/4,h4:p/4,left:h/2-m-g,right:h/2-m-g,top:p/2-m-g,bottom:p/2-m-g,r:s,h:p,gap:m,offset:g*2},{x:d+s,y:v,w:h,w4:h/4,h4:p/4,right:0,left:h-m*2-g*2,bottom:0,top:p-m*2-g*2,r:s,h:p,gap:m,offset:g*2}][i[1]==="middle"?1:(i[1]==="left"||i[1]==="top"?1:0)*2],S=this.paper.path(e.fill(w[i[0]],E));switch(i[0]){case"top":y=t.x-(d+s+E.left+m+l),b=t.y-(v+s+p+s+m+l);break;case"bottom":y=t.x-(d+s+E.left+m+l),b=t.y-(v-m-l);break;case"left":y=t.x-(d+s+h+s+m+l),b=t.y-(v+s+E.top+m+l);break;case"right":y=t.x-(d-m-g),b=t.y-(v+s+E.top+m+g)}return S.translate(y,b),r.transform(Raphael.format("...t{0},{1}",y,b)),S},e.prototype._isWindowCollision=function(e,t,r,i,s,o,u){var a=e.getBBox(),f=0,l=t.toLowerCase(),c=a.x+s,h=a.y+o,p=this.paper.width,d=this.paper.height,v=r,m=i,g=e.attr("stroke-width"),y=u===!0||u==="flip";return Raphael.vml&&(p=n(this.paper.canvas).width(),d=n(this.paper.canvas).height()),c-g<0&&(y?l.toLowerCase().indexOf("west")===-1?c+a.width/2+a.width-r<=p&&(f++,l=l.toLowerCase()+"east",v=0-r):c+a.width+a.width-r<=p&&(f++,l=l.toLowerCase().replace("west","east"),v=0-r):(f++,v=0-c+g+r)),h-g<0&&(y?l.toLowerCase().indexOf("north")===-1?h+a.height/2+a.height-i<=d&&(f++,l=l.toLowerCase()+"south",m=0-i):h+a.height+a.height-i<=d&&(f++,l=l.toLowerCase().replace("north","south"),m=0-i):(f++,m=0-h+g+i)),c+a.width+g>p&&(y?l.toLowerCase().indexOf("east")===-1?c-a.width/2-r>=0&&(f++,l=l.toLowerCase()+"west",v=0-r):c-a.width-r>=0&&(f++,l=l.toLowerCase().replace("east","west"),v=0-r):(f++,v=p-(c+a.width+g)+r)),h+a.height+g>d&&(y?l.toLowerCase().indexOf("south")===-1?h-a.height/2-i>=0&&(f++,l=l.toLowerCase()+"north",m=0-i):h-a.height-i>=0&&(f++,l=l.toLowerCase().replace("south","north"),m=0-i):(f++,m=d-(h+a.height+g)+i)),f?{compass:l,offsetX:v,offsetY:m}:!1},e.prototype._createTooltipEles=function(t,r,i,s,o,u,a){var f=this,l,c,h,p=this.paper.set(),d=null,v=null,m=this.options,g=this.closeBtnLength,y=this.calloutOffset,b=null,w=0,E=0,S=250,x=0,T=0,N,C={x:t.x,y:t.y},k=this.offset,L=null,A=null;n.wijraphael.clearRaphaelCache(),h=this._convertCompassToPosition(o),C.x+=u+k.x,C.y+=a+k.y,this.elements=this.paper.set(),this.title&&(n.each(this.title,function(e,t){n(t.node).unbind(".Rtooltip")}),this.title.wijRemove()),r&&r.length>0?(this.title=this.paper.htmlText(-1e3,-1e3,r,m.titleStyle),this.elements.push(this.title),l=this.title.getBBox()):l={left:-1e3,top:-1e3,width:0,height:0},this.content&&(n.each(this.content,function(e,t){n(t.node).unbind(".Rtooltip")}),this.content.wijRemove()),i&&i.length>0?(this.content=this.paper.htmlText(-1e3,-1e3,i,m.contentStyle),this.elements.push(this.content),c=this.content.getBBox()):c={left:-1e3,top:-1e3,width:0,height:0};if(this.closeBtn){for(x=0,T=this.closeBtn.length;x<T;x++)this.closeBtn[x].unclick();this.closeBtn.wijRemove()}this.content&&this.content.transform(Raphael.format("T0,{0}",l.height/2+c.height/2)),this.title&&this.title.transform(Raphael.format("T0,{0}",0)),m.closeBehavior==="sticky"&&(this.closeBtn=this.paper.closeBtn(-1e3,-1e3,g),this.elements.push(this.closeBtn),m.width&&m.width>l.width+g*2&&m.width>c.width+g*2?this.closeBtn.transform(Raphael.format("T{0},{1}",m.width-g,g)):l.width>=c.width-g*2?this.closeBtn.transform(Raphael.format("T{0},{1}",l.width+g,g)):this.closeBtn.transform(Raphael.format("T{0},{1}",c.width-g,g)),n.each(this.closeBtn,function(e,t){var n=f;t.click(function(e){n._hide(e)})})),this.title&&(p.push(this.title),m.relatedElement&&this.title.insertBefore(m.relatedElement)),this.content&&(p.push(this.content),m.relatedElement&&this.content.insertBefore(m.relatedElement)),this.closeBtn&&(p.push(this.closeBtn),m.relatedElement&&this.closeBtn.insertBefore(m.relatedElement)),m.showCallout||(this.gapLength=0);if(m.calloutSide||m.calloutFilled)this.gapLength=0,this.offsetLength=m.calloutLength/2,m.calloutSide&&(h=this._convertCompassToPosition(m.calloutSide));m.calloutSide&&p.length===0&&(this.content=this.paper.htmlText(-1e3,-1e3," "),p.push(this.content),m.relatedElement&&this.content.insertBefore(m.relatedElement)),this.callout&&(n(this.callout.node).unbind(".Rtooltip"),this.callout.wijRemove()),this.container&&(n(this.container.node).unbind(".Rtooltip"),this.container.wijRemove());if(this.lastPoint){m.showCallout&&(m.calloutSide||m.calloutFilled)&&(d=this._getCalloutArr(this.lastPoint,this.offsetLength),this.callout=this.paper.path(d.concat(" ")),m.relatedElement&&this.callout.insertBefore(m.relatedElement),m.calloutFilled&&this.callout.attr(m.calloutFilledStyle),m.calloutSide&&this._translateCallout(0)),this.container=this._createPath(this.lastPoint,h,p),m.relatedElement&&this.container.insertBefore(m.relatedElement);if(s){N=this._isWindowCollision(this.container,o,u,a,C.x-this.lastPoint.x,C.y-this.lastPoint.y,s);if(N){this._createTooltipEles(t,r,i,!1,N.compass,N.offsetX,N.offsetY);return}}this.elements.push(this.callout),this.elements.push(this.container),w=C.x-this.lastPoint.x,E=C.y-this.lastPoint.y,A=Raphael.format("...T{0},{1}",w,E),L=Raphael.animation({transform:A},S),this.container&&(m.showAnimated||m.animated?this.container.animate(L):this.container.attr("transform",A)),this.title&&(m.showAnimated||m.animated?this.title.animate(L):this.title.attr("transform",A)),this.content&&(m.showAnimated||m.animated?this.content.animate(L):this.content.attr("transform",A)),this.closeBtn&&(m.showAnimated||m.animated?this.closeBtn.animate(L):this.closeBtn.attr("transform",A)),this.callout&&(m.showAnimated||m.animated?this.callout.animate(L):this.callout.attr("transform",A))}else{m.showCallout&&(m.calloutSide||m.calloutFilled)&&(d=this._getCalloutArr(C,this.offsetLength),this.callout=this.paper.path(d.concat(" ")),m.relatedElement&&this.callout.insertBefore(m.relatedElement),m.calloutFilled&&this.callout.attr(m.calloutFilledStyle),m.calloutSide&&this._translateCallout(0)),this.container=this._createPath(C,h,p),m.relatedElement&&this.container.insertBefore(m.relatedElement);if(s){N=this._isWindowCollision(this.container,o,u,a,0,0,s);if(N){this._createTooltipEles(t,r,i,!1,N.compass,N.offsetX,N.offsetY);return}}this.elements.push(this.callout),this.elements.push(this.container);if(m.showAnimated||m.animated)v=m.showAnimated,v||(v=m.animated),v&&e.animations[v]&&(b={animated:v,duration:m.showDuration||m.duration,easing:m.showEasing||m.easing,context:this.elements,show:!0},e.animations[v](b))}this.lastPoint=C,this.container.attr(m.style),m.relatedElement?(this.title&&this.title.insertBefore(m.relatedElement),this.content&&this.content.insertBefore(m.relatedElement),this.closeBtn&&this.closeBtn.insertBefore(m.relatedElement)):p.toFront()},e.prototype._createTooltip=function(e,t){var r=null,i=null,s=null,o=null,u=this.options,a,f;if(n.isFunction(u.beforeShowing)){s=null,o={target:null,options:u,fmt:u.beforeShowing};if(t&&t.target){f=t.target;if(!f.raphael||!f.raphaelid)f=f.parentNode;f.raphael&&f.raphaelid?(a=this.paper.getById(f.raphaelid),o.target=a):(a=t.target,o.target=a)}s=n.proxy(o.fmt,o);if(s()===!1)return}r=u.title,i=u.content,r=this._getFuncText(r,t),i=this._getFuncText(i,t);if(!r&&!i)return;this._createTooltipEles(e,r,i,u.windowCollisionDetection,u.compass,u.offsetX,u.offsetY)},e.prototype._showAt=function(e,t){var n=this.options,r=this;this._clearTimers(),n.showDelay?this.intentShowTimer=window.setTimeout(function(){r._createTooltip(e,t)},n.showDelay):this._createTooltip(e,t)},e.prototype._show=function(e){var t=n(this.paper.canvas.parentNode).offset(),r=t.left,i=t.top,s=this.options,o=s.relativeTo,u={x:0,y:0},a=null,f=e.target;switch(o){case"mouse":u.x=e.pageX-r,u.y=e.pageY-i;break;case"element":if(!f.raphael||!f.raphaelid)f=f.parentNode;f.raphael&&f.raphaelid&&(a=this.paper.getById(f.raphaelid),u=this._getShowPoint(a,s.compass))}this._showAt(u,e)},e.prototype._bindEvent=function(e){var t=this.options,r=this;switch(t.triggers){case"hover":n(e.node).bind("mouseover.Rtooltip",function(e){r._show(e)}).bind("mouseout.Rtooltip",function(e){t.closeBehavior==="auto"&&r._hide(e)}),t.mouseTrailing&&t.relativeTo==="mouse"&&n(e.node).bind("mousemove.Rtooltip",function(e){r._show(e)});break;case"click":n(e.node).bind("click.Rtooltip",function(e){r._show(e)});break;case"custom":}},e.prototype._bindLiveEvent=function(e){var t,n;if(e)if(e.length)for(t=0,n=e.length;t<n;t++)this._bindEvent(e[t]);else this._bindEvent(e)},e.prototype._bindLiveEventBySelector=function(e){var t=this.options,n=this;if(e)switch(t.triggers){case"hover":e.on("mouseover.Rtooltip",function(e){n._show(e)}).on("mouseout.Rtooltip",function(e){t.closeBehavior==="auto"&&n._hide(e)}),t.mouseTrailing&&t.relativeTo==="mouse"&&e.on("mousemove.Rtooltip",function(e){n._show(e)});break;case"click":e.on("click.Rtooltip",function(e){n._show(e)});break;case"custom":}},e.prototype._unbindLiveEvent=function(e,t){var r,i;if(e)if(e.length)for(r=0,i=e.length;r<i;r++)n(e[r].node).unbind(".Rtooltip");else n(e.node).unbind(".Rtooltip");t&&t.off("Rtooltip").off(".Rtooltip")},e.prototype._destroy=function(){this._unbindLiveEvent(this.targets,this.selector),this._removeTooltip(0)},e.prototype.hide=function(){this._hide()},e.prototype.showAt=function(e,t){this._showAt(e,t)},e.prototype.resetCalloutOffset=function(e){var t=this.options,n=t.calloutOffset,r=t.calloutSide,i=t.calloutAnimation,s=this.tooltipElements;s.callout&&(r==="south"||r==="north"?s.callout.animate({translation:e-n+",0"},i.duration,i.easing):(r==="east"||r==="west")&&s.callout.animate({translation:"0,"+(e-n)},i.duration,i.easing)),t.calloutOffset=e},e.prototype.destroy=function(){this._destroy()},e.prototype.getOptions=function(){return this.options},e.prototype.setTargets=function(e){this.targets=e,this._bindLiveEvent(e)},e.prototype.setSelector=function(e){this.selector=e,this._bindLiveEventBySelector(e)},e.prototype.setOptions=function(e){n.extend(!0,this.options,e)},e.animations={fade:function(e){var t=e.context;e.show?(t.attr({opacity:0}),t.wijAnimate({opacity:1},e.duration,e.easing)):t.wijAnimate({opacity:0},e.duration,e.easing)}},e}();t.ChartTooltip=s,Raphael.fn.tooltip={animations:s.animations};var o=function(){function e(e){this.labels=[],this.crossLabels={},this.bBox=e}return e.prototype.push=function(e){var t=e.wijGetBBox();this.labels.push({ele:e,x:t.x,y:t.y,width:t.width,height:t.height,overlaps:[],bakBBox:t})},e.prototype.pushCross=function(e,t){var n,r,i,s,o;!this.crossLabels[Raphael.format("{0}-{1}",e,t)]&&!this.crossLabels[Raphael.format("{0}-{1}",t,e)]&&(n=this.labels[e],r=this.labels[t],this.crossLabels[Raphael.format("{0}-{1}",e,t)]={label1:n,label2:r,dx:this._getAdjust(n,r,"h"),dy:this._getAdjust(n,r,"v")})},e.prototype._detect=function(e,t){return(e.x+e.width>t.x&&e.x<t.x||t.x+t.width>e.x&&t.x<e.x)&&(e.y+e.height>t.y&&e.y<t.y||t.y+t.height>e.y&&t.y<e.y)},e.prototype._resetOverlaps=function(){this.crossLabels={}},e.prototype._detects=function(){var e=this.labels.length,t,n;for(var r=0;r<e;r++)for(var i=r+1;i<e;i++)t=this.labels[r],n=this.labels[i],this._detect(t,n)&&this.pushCross(r,i)},e.prototype._getAdjust=function(e,t,n){var r={dx:0,needRevert:!1};return n==="h"?e.x<t.x?r.dx=e.x+e.width-t.x:(r.dx=t.x+t.width-e.x,r.needRevert=!0):e.y<t.y?r.dx=e.y+e.height-t.y:(r.dx=t.y+t.height-e.y,r.needRevert=!0),r},e.prototype._adjustlabel=function(e,t,n,r){r==="h"?(e.x-=n/2,t.x+=n/2,this.bBox&&(e.x<this.bBox.x?(e.x=this.bBox.x,t.x=t.x+(this.bBox.x-e.x)):t.x>this.bBox.x+this.bBox.width&&(t.x=this.bBox.x+this.bBox.width,e.x-=t.x-this.bBox.x+this.bBox.width))):(e.y-=n/2,t.y+=n/2,this.bBox&&(e.y<this.bBox.y?(e.y=this.bBox.y,t.y=t.y+(this.bBox.y-e.y)):t.y>this.bBox.y+this.bBox.height&&(t.y=this.bBox.y+this.bBox.height,e.y-=t.y-this.bBox.y+this.bBox.height)))},e.prototype._adjustInternal=function(){var e=this;n.each(this.crossLabels,function(t,n){var r=n.label1,i=n.label2,s=n.dx,o=n.dy;s.dx<o.dx?o.needRevert?e._adjustlabel(i,r,o.dx,"v"):e._adjustlabel(r,i,o.dx,"v"):s.needRevert?e._adjustlabel(i,r,s.dx,"h"):e._adjustlabel(r,i,s.dx,"h")})},e.prototype._adjustTheEdge=function(){var e=this;this.bBox&&n.each(this.labels,function(t,n){n.x<e.bBox.x?n.x=e.bBox.x:n.x+n.width>e.bBox.x+e.bBox.width&&(n.x=e.bBox.x+e.bBox.width-n.width),n.y<e.bBox.y?n.y=e.bBox.y:n.y+n.height>e.bBox.y+e.bBox.height&&(n.y=e.bBox.y+e.bBox.height-n.height)})},e.prototype._translateLabels=function(){n.each(this.labels,function(e,t){t.x!==t.bakBBox.x&&(t.ele.attr("x",t.x+t.width/2),t.bakBBox.x=t.x),t.y!==t.bakBBox.y&&(t.ele.attr("y",t.y+t.height/2),t.bakBBox.y=t.y)})},e.prototype.adjust=function(){var e=1e3;while(e>0){this._resetOverlaps(),this._adjustTheEdge(),this._detects();if(n.isEmptyObject(this.crossLabels))break;e--,this._adjustInternal()}this._translateLabels()},e}();t.AdjustLabel=o;var u=function(e){function t(){e.apply(this,arguments),this.innerState={}}return __extends(t,e),t.prototype._setOption=function(r,i){var s=this,o=s.options,u=null,a=0,f=0,l=o.axis.x.tickMajor.factor,c=o.axis.x.tickMinor.factor,h,p,d,v,m,g=t.prototype.options.axis,y;if(r==="dataSource")s.seriesTransition=!0,o.dataSource=i,s.seriesList&&(o.seriesList=n.arrayClone(s.seriesList)),s._init();else if(r==="data")s.seriesTransition=!0,o.data=i,s.seriesList&&(o.seriesList=n.arrayClone(s.seriesList)),s._init();else if(r==="seriesList"){i||(i=[]),u=n.Event("beforeserieschange");if(s._trigger("beforeSeriesChange",u,{oldSeriesList:o.seriesList,newSeriesList:i})===!1)return!1;o.seriesList=i,s.seriesList=n.arrayClone(i),s._trigger("seriesChanged",null,i),s.seriesTransition=!0,s._init()}else n.isPlainObject(o[r])?(r==="axis"&&(n.isArray(o.axis.y)?d=n.arrayClone(o.axis.y):d=n.extend(!0,{},o.axis.y)),r==="axis"?(n.extend(!0,o.axis.x,i.x||{}),n.isArray(o.axis.y)||n.isArray(i.y)?y={}:y=o.axis.y,n.isArray(i.y)?(n.each(i.y,function(e,t){i.y[e]=n.extend(!0,{},g.y,y,t)}),o.axis.y=i.y):o.axis.y=n.extend(!0,{},g.y,y,i.y)):n.extend(!0,o[r],i),r==="indicator"&&(this._unbindCanvasEvents(),this._bindCanvasEvents()),r==="axis"&&(v=o.axis.y,o.axis.x.tickMajor.factor<0&&(o.axis.x.tickMajor.factor=l),o.axis.x.tickMinor.factor<0&&(o.axis.x.tickMinor.factor=c),n.isArray(v)?(n.isArray(d)||(d=[d]),n.each(v,function(e,t){var n=d[e]||{};n.tickMajor&&n.tickMajor.factor&&t.tickMajor&&t.tickMajor.factor&&t.tickMajor.factor<0&&(t.tickMajor.factor=n.tickMajor.factor),n.tickMinor&&n.tickMinor.factor&&t.tickMinor&&t.tickMinor.factor&&t.tickMinor.factor<0&&(t.tickMinor.factor=n.tickMinor.factor)})):(n.isArray(d)?(h=d[0].tickMajor.factor,p=d[0].tickMinor.factor):(l=d.tickMajor.factor,c=d.tickMinor.factor),o.axis.y.tickMajor&&o.axis.y.tickMajor.factor!==undefined&&o.axis.y.tickMajor.factor<0&&(o.axis.y.tickMajor.factor=h),o.axis.y.tickMinor&&o.axis.y.tickMinor.factor!==undefined&&o.axis.y.tickMinor.factor<0&&(o.axis.y.tickMinor.factor=p)))):e.prototype._setOption.call(this,r,i);r==="disabled"&&s._handleDisabledOption(i,s.chartElement);if(r==="seriesTransition"||r==="animation")return;if(r==="hint"){s._resetTooltip();return}a=o.seriesList.length;if(r==="seriesList"||r==="seriesStyles"||r==="seriesHoverStyles")r!=="seriesList"&&s._handleChartStyles(),s.styles={style:[].concat(o.seriesStyles.slice(0,o.seriesStyles.length)),hoverStyles:[].concat(o.seriesHoverStyles.slice(0,o.seriesHoverStyles.length))},s._initStyles();if(r==="seriesList"||r==="seriesHoverStyles"){m=o.seriesHoverStyles.length;for(f=m;f<a;f++)o.seriesHoverStyles[f]=o.seriesHoverStyles[f%m]}(r==="height"||r==="width")&&s.chartElement[r](i),s.redraw()},t.prototype._preHandleSeriesData=function(){},t.prototype._initStyles=function(){var e=this.options,t=e.seriesStyles,n=e.seriesHoverStyles,r,i,s,o;e.seriesList&&(i=e.seriesList.length||0),e.seriesStyles&&(r=e.seriesStyles.length||0),e.seriesHoverStyles&&(s=e.seriesHoverStyles.length||0);if(i>r&&r)for(o=r;o<i;o++)t[o]=t[o%r];if(i>s&&s)for(o=s;o<i;o++)n[o]=n[o%s]},t.prototype._create=function(){var e=this,t=e.options,r=t.width||e.element.width(),i=t.height||e.element.height(),s=null,o;window.wijmoApplyWijTouchUtilEvents&&(n=window.wijmoApplyWijTouchUtilEvents(n)),e.updating=0,e.innerState={},e.axisCompass={},e.element.is(":hidden")&&e.element.wijAddVisibilityObserver&&e.element.wijAddVisibilityObserver(function(){e.redraw(),e.element.wijRemoveVisibilityObserver&&e.element.wijRemoveVisibilityObserver()},"wijchart"),n.isFunction(window.wijmoASPNetParseOptions)&&window.wijmoASPNetParseOptions(t),e.styles={style:[].concat(t.seriesStyles.slice(0,t.seriesStyles.length)),hoverStyles:[].concat(t.seriesHoverStyles.slice(0,t.seriesHoverStyles.length))},e._initStyles(),t.hint&&typeof t.hint.content=="string"&&window[t.hint.content]&&(t.hint.content=window[t.hint.content]),t.hint&&typeof t.hint.title=="string"&&window[t.hint.title]&&(t.hint.title=window[t.hint.title]),e.headerEles=[],e.footerEles=[],e.legendEles=[],e.axisEles=[],e.legends=[],e.legendIcons=[],e.legendDots=[],e.chartLabelEles=[],e.seriesEles=[];if(e.element.length>0){e.element.is("table")?(e._parseTable(),s=n("<div></div>"),r&&s.css("width",r),i&&s.css("height",i),e.element.after(s),e.chartElement=s):e.chartElement=e.element,e.chartElement.addClass("ui-widget");try{o=Raphael(e.chartElement[0],r,i)}catch(u){var a=e.chartElement.css("display");s=n("<div></div>").insertBefore(e.chartElement).append(e.chartElement),e.chartElement.addClass("ui-helper-hidden-accessible").appendTo(n("body")),a==="none"&&e.chartElement.css("display","block"),o=Raphael(e.chartElement[0],r,i),e.chartElement.appendTo(s).unwrap().removeClass("ui-helper-hidden-accessible"),a==="none"&&e.chartElement.css("display","none")}e.canvas=o,i===0&&t.height!==0&&e.element.height(o.height),t.disabled&&e.disable(),o.customAttributes.rotation=function(e){this.transform("...R"+e)},o.customAttributes.scale=function(e){this.transform("...S"+e)},o.customAttributes.translation=function(e,t){this.transform(Raphael.format("...T{0},{1}",e,t))},e._bindLiveEvents()}},t.prototype._handleChartStyles=function(){this._extendArrayFromBase("seriesStyles"),this._extendArrayFromBase("seriesHoverStyles");var e=this.options,t=this._getDefFill();n.each(e.seriesStyles,function(e,n){n.fill||(n.fill=t[e])})},t.prototype._extendArrayFromBase=function(e){var r=n.extend(!0,{},t.prototype.options[e],this.options[e]),i=[];n.each(r,function(e,t){i.push(t)}),this.options[e]=i},t.prototype._getDefFill=function(){var e=["#00cc00","#0099cc","#0055cc","#2200cc","#8800cc","#d9007e","#ff0000","#ff6600","#ff9900","#ffcc00","#ffff00","#ace600"];return e},t.prototype._getCulture=function(e){return Globalize.findClosestCulture(e||this.options.culture)},t.prototype._handleDisabledOption=function(e,t){var n=this;e?(n.disabledDiv||(n.disabledDiv=n._createDisabledDiv(t)),n.disabledDiv.appendTo("body")):n.disabledDiv&&(n.disabledDiv.remove(),n.disabledDiv=null)},t.prototype._createDisabledDiv=function(e){var t=this,r=t.options,i=e||t.element,s=i.offset(),o=r.width||i.outerWidth(),u=r.height||i.outerHeight(),a;return a=n("<div></div>").css({"z-index":"99999",position:"absolute",width:o,height:u,left:s.left,top:s.top}),Raphael.vml&&a.addClass(r.wijCSS.stateDisabled).css("background-color","#fff"),a},t.prototype._bindData=function(){var e=this,t=e.options,r=t.dataSource,i=t.seriesList,s=t.data,o;n.each(i,function(t,n){var i=n.data,u,a,f,l=n.dataSource||r;l&&i&&(u=i.x,a=i.y,f=i.y1,u&&u.bind?i.x=e._getBindData(l,u.bind):s&&s.x&&s.x.bind&&(o===undefined&&(o=e._getBindData(l,s.x.bind)),i.x=o),a&&a.bind&&(i.y=e._getBindData(l,a.bind)),f&&f.bind&&(i.y1=e._getBindData(l,f.bind)))})},t.prototype._getBindData=function(e,t){if(n.isArray(e)){var r=[];return n.each(e,function(e,n){n&&n[t]!==undefined&&r.push(n[t])}),r}return null},t.prototype._hanldSharedXData=function(){var e=this,t=e.options,r=t.seriesList,i=t.data;i&&n.each(r,function(e,t){var r=t.data;if(r.x===undefined||r.x===null&&n.isArray(i.x))r.x=i.x})},t.prototype._init=function(){var e=this,t=e.options;e.rendered||(e.seriesList=n.arrayClone(t.seriesList)),e._bindData(),e._hanldSharedXData(),n.each(t.seriesList,function(e,r){var i=r.data,s;if(typeof i=="undefined"||i===null)s=n.inArray(r,t.seriesList),t.seriesList.splice(s,1)}),e.rendered||e._paint()},t.prototype.destroy=function(){var t=this,r=t.options;t._unbindLiveEvents(),t._clearChartElement(),t.chartElement.removeClass("ui-widget"),n("."+r.wijCSS.canvasObject,t.chartElement[0]).off(t.widgetName).off("."+t.widgetName),t.element!==t.chartElement&&t.chartElement.remove(),t.element.empty(),t.styles&&(t.styles=null),t.disabledDiv&&(t.disabledDiv.remove(),t.disabledDiv=null),e.prototype.destroy.call(this)},t.prototype.getCanvas=function(){return this.canvas},t.prototype.addSeriesPoint=function(e,t,n){var r=this.options.seriesList,i=null,s=null;if(e>=r.length)return;i=r[e],s=i.data||[],s.x.push(t.x),s.y.push(t.y),n&&(s.x.shift(),s.y.shift()),this._setOption("seriesList",r)},t.prototype.beginUpdate=function(){var e=this;e.updating++},t.prototype.endUpdate=function(){var e=this;e.updating--,e.redraw()},t.prototype.redraw=function(e){var t=this,n=t.options,r=0,i=0;if(t.updating>0)return;if(e&&t.rendered)return;r=n.width||t.element.width(),i=n.height||t.element.height();if(r<1||i<1)return;t.canvas.setSize(r,i),t._paint()},t.prototype._parseTable=function(){if(!this.element.is("table"))return;var e=this,t=e.element,r=e.options,i=n("caption",t),s=n("thead th",t),o=[],u=n("tbody tr",t);i.length&&(r.header=n.extend({visible:!0,text:n.trim(n(i[0]).text())},r.header),i.length>1&&(r.footer=n.extend({visibel:!0,text:n.trim(n(i[1]).text())},r.footer))),r.legend=n.extend({visible:!0},r.legend),e._getSeriesFromTR(s,u,o),e.options.seriesList=o},t.prototype._getSeriesFromTR=function(e,t,r){var i=[],s=null,o=null;e.length&&e.each(function(){s=n.trim(n(this).text()),i.push(s)}),t.length&&t.each(function(){var e=n("th",n(this)),t=n.trim(e.text()),s=[],u=n("td",n(this));u.length&&u.each(function(e,t){var r=n(this);s.push(parseFloat(n.trim(r.text())))}),o={label:t,legendEntry:!0,data:{x:i,y:s}},r.push(o)})},t.prototype._destroyRaphaelArray=function(e){if(!e)return;var t=e.length,r=0,i,s;for(;t&&r<t;r++)i=e[r],i&&i[0]&&(s=n(i.node),s.unbind().removeData(),i.wijRemove(),s.remove(),s=null),e[r]=null},t.prototype._clearChartElement=function(){var e=this,t=e.chartElement.data("fields");e._destroyRaphaelArray(e.headerEles),e._destroyRaphaelArray(e.footerEles),e._destroyRaphaelArray(e.legendEles),e._destroyRaphaelArray(e.legends),e._destroyRaphaelArray(e.legendIcons),e._destroyRaphaelArray(e.legendDots),e._destroyRaphaelArray(e.axisEles),e._destroyRaphaelArray(e.chartLabelEles),e.tooltip&&(e.tooltip.destroy(),e.tooltip=null),e.dataPoints=null,e.pointXs=null,t&&t.trackers&&(e._destroyRaphaelArray(t.trackers),t.trackers=null),e.headerEles=[],e.footerEles=[],e.legendEles=[],e.legends=[],e.legendIcons=[],e.legendDots=[],e.axisEles=[],e.chartLabelEles=[],t&&t.chartElements&&(n.each(t.chartElements,function(t,n){e._destroyRaphaelArray(n)}),t.chartElements=null),t&&t.seriesEles&&(t.seriesEles=null),e.seriesEles&&(e.seriesEles=[]),e.canvas.clear(),e.innerState=null,e.axisInfo=null,e.seriesGroup=null,e.lastAxisOffset=null,e.innerState={}},t.prototype._text=function(e,t,n){var r=this.canvas.text(e,t,n);return this.options.disableDefaultTextStyle&&(r.node.style.cssText=""),r},t.prototype._paint=function(){var e=this,t=e.options,n=e.element,r=n.css("display")==="none"||n.css("visibility")==="hidden",i={},s=null;r&&(i=n.css("left"),s=n.css("position"),n.css("left","-10000px"),n.css("position","absolute"),n.show());if(n.is(":hidden")){r&&(n.css("left",i),n.css("position",s),n.hide());return}e._clearChartElement();if(e._trigger("beforePaint")===!1)return;e._preHandleSeriesData(),e.canvasBounds={startX:0,endX:t.width||n.width(),startY:0,endY:t.height||n.height()},e._paintHeader(),e._paintFooter(),e._paintLegend(),e._paintChartArea(),t.indicator&&t.indicator.visible&&this.pointXs&&(this.pointXs=this.pointXs.sort(function(e,t){return e-t})),e._paintTooltip(),e._trigger("painted"),e.rendered=!0,e.styles&&(t.seriesStyles=e.styles.style,t.seriesHoverStyles=e.styles.hoverStyles),r&&(n.css("left",i),n.css("position",s),n.hide())},t.prototype._paintIndicater=function(){},t.prototype._calculatePosition=function(e,t,n){var r={x:0,y:0},i=5,s=5,o=this.canvasBounds;switch(e){case"north":r.x=(o.endX-o.startX)/2,r.y=o.startY+n/2+s,o.startY=o.startY+s*2+n;break;case"south":r.x=(o.endX-o.startX)/2,r.y=o.endY-n/2-s,o.endY=o.endY-s*2-n;break;case"east":r.x=o.endX-t/2-i,r.y=(o.endY-o.startY)/2,o.endX=o.endX-i*2-t;break;case"west":r.x=o.startX+t/2+i,r.y=(o.endY-o.startY)/2,o.startX=o.startX+i*2+t}return r},t.prototype._paintHeader=function(){var e=2,t=this,r=t.options,i=r.header,s=null,o=null,u=null,a=null,f=null,l=null,c=0,h=null;i.text&&i.text.length>0&&i.visible&&(s=i.compass,o=t._text(0,0,i.text),n.wijraphael.addClass(n(o.node),r.wijCSS.headerText),c=t._getRotationByCompass(s),u=n.extend(!0,{},r.textStyle,i.textStyle),o.attr(u),o.transform("...R"+c),a=o.wijGetBBox(),f=t._calculatePosition(s,a.width,a.height),o.transform(Raphael.format("...T{0},{1}",f.x,f.y)),l=o.wijGetBBox(),h=t.canvas.rect(l.x-e,l.y-e,l.width+2*e,l.height+2*e),n.wijraphael.addClass(n(h.node),r.wijCSS.headerContainer),h.attr(i.style),h.toBack(),t.headerEles.push(o),t.headerEles.push(h))},t.prototype._paintFooter=function(){var e=2,t=this,r=t.options,i=r.footer,s=null,o=null,u=null,a=null,f=null,l=null,c=0,h=null;i.text&&i.text.length>0&&i.visible&&(s=i.compass,o=t._text(0,0,i.text),n.wijraphael.addClass(n(o.node),r.wijCSS.footerText),c=t._getRotationByCompass(s),u=n.extend(!0,{},r.textStyle,i.textStyle),o.attr(u),o.transform("...R"+c),a=o.wijGetBBox(),f=t._calculatePosition(s,a.width,a.height),o.transform(Raphael.format("...T{0},{1}",f.x,f.y)),l=o.wijGetBBox(),h=t.canvas.rect(l.x-e,l.y-e,l.width+2*e,l.height+2*e),n.wijraphael.addClass(n(h.node),r.wijCSS.footerContainer),h.attr(i.style),h.toBack(),t.footerEles.push(o),t.footerEles.push(h))},t.prototype._getRotationByCompass=function(e){var t=0;return e==="east"?t=90:e==="west"&&(t=-90),t},t.prototype._paintLegendIcon=function(e,t,r,i,s,o,u,a,f,l){var c=this,h=c.canvas.rect(e,t,r,i);return n(h.node).data("legendIndex",o).data("index",u),c.legendIcons.push(h),s&&h.attr(s),n.wijraphael.addClass(n(h.node),a),h},t.prototype._paintLegend=function(){if(!this.options.legend.visible)return;var e=this,t=e.options,r=n.extend(!0,{size:{width:22,height:10}},t.legend),i=2,s=t.seriesStyles,o=[].concat(t.seriesList),u=r.compass,a=r.orientation,f,l,c,h,p=e.canvasBounds,d=p.endX-p.startX,v=p.endY-p.startY,m=r.size.width,g=r.size.height,y,b=0,w=0,E=0,S=0,x=0,T=0,N=1,C=0,k=0,L=0,A=0,O=0,M,_,D,P,H=[],B=0,j=0,F=0,I=[];r.text&&r.text.length&&(f=e._text(0,0,r.text),n.wijraphael.addClass(n(f.node),t.wijCSS.legendTitle),l=n.extend(!0,{},t.textStyle,r.textStyle,r.titleStyle),f.attr(l),e.legendEles.push(f)),r.reversed&&(o=o.reverse()),F=o.length,e.widgetName==="wijcompositechart"&&(F=0,n.each(o,function(e,t){t.type==="pie"?F+=t.data.length:F++})),n.each(o,function(i,o){function u(i){var o=r.reversed?F-1-B:B,u=s[o],a=n.extend(!0,{fill:"none",opacity:1,stroke:"black"},u),f,l,c,h=!1,p=i.type,d;i.legendEntry&&i.display!=="exclude"&&(l=n.extend(!0,{},t.textStyle,r.textStyle),r.textWidth?f=e.canvas.wrapText(0,0,i.label,r.textWidth,"far",l):(f=e._text(0,0,i.label),f.attr(l)),n.wijraphael.addClass(n(f.node),t.wijCSS.legendText+" "+t.wijCSS.legend),e.legends.push(f),c=n.extend(a,{"stroke-width":1}),H.push(c),I.push(i),e.widgetName==="wijcompositechart"?h=p==="line"||p==="spline"||p==="bezier"||p==="area":h=e.widgetName==="wijlinechart",r.textWidth?n.each(f,function(e,r){i.visible===!1&&!h&&(n(r.node).data("hidden",!0).data("textOpacity",r.attr("opacity")||1),r.attr("opacity",.3)),n.wijraphael.addClass(n(r.node),t.wijCSS.legendText+" "+t.wijCSS.legend),n(r.node).data("legendIndex",j).data("index",B)}):(i.visible===!1&&!h&&(n(f.node).data("hidden",!0).data("textOpacity",f.attr("opacity")||1),f.attr("opacity",.3)),n.wijraphael.addClass(n(f.node),t.wijCSS.legendText+" "+t.wijCSS.legend),n(f.node).data("legendIndex",j).data("index",B)),j++),B++}o=n.extend(!0,{legendEntry:!0,display:"show"},o);if(o.type==="pie"&&o.legendEntry)n.each(o.data,function(e,t){t=n.extend({legendEntry:o.legendEntry},t),u(t)});else if(e._isPieChart())u(o);else if(e._isStockChart()&&e._validateSeriesData(o))u(o);else{if(o.data.x===undefined&&o.data.xy===undefined||o.data.xy===undefined&&o.data.y===undefined)return!0;u(o)}}),c=e.legends.length,h=r.textMargin,f&&(y=f.wijGetBBox(),b=y.height,w=y.width),n.each(e.legends,function(e,t){var n=t.wijGetBBox();n.width>E&&(E=n.width),n.height>S&&(S=n.height)});if(u==="east"||u==="west")a==="horizontal"?(x=c*(E+m+i)+c*(h.left+h.right),x>d/2?(N=Math.floor(d/2/E),N<1&&(N=1)):N=c):a==="vertical"&&(T=S*c+b+c*(h.top+h.bottom),T>v?N=Math.ceil(T/v):N=1);else if(u==="south"||u==="north")a==="horizontal"?(x=(E+m+i)*c+c*(h.left+h.right),x>d?(N=Math.floor(c/x*d),N<1&&(N=1)):N=c):a==="vertical"&&(T=S*c+b+c*(h.top+h.bottom),T>v/2?(C=Math.floor(v-b)/2/S,N=Math.ceil(c/C)):N=1);N===0&&(N=1),k=N*(E+m+i)+N*(h.left+h.right),L=S*Math.ceil(c/N)+b+Math.ceil(c/N)*(h.top+h.bottom),k=k>w?k:w,M=e._calculatePosition(u,k,L),_=M.x-k/2,D=M.y-L/2,P=e.canvas.rect(_-i,D-i,k+2*i,L+2*i),n.wijraphael.addClass(n(P.node),t.wijCSS.legendContainer),P.attr(r.style),P.toBack(),e.legendEles.push(P),f&&f.transform(Raphael.format("...T{0},{1}",_+k/2,D+b/2)),A=b,n.each(e.legends,function(s,o){d=H[s];var u=o.wijGetBBox(),a,f=d["stroke-width"]||0,l=_+O*(m+f*2+E+i)+(O+1)*h.left+O*h.right,c=D+A+u.height/2+h.top+S/2-u.height/2,p=c-g/2-f,d,v,y=o;r.textWidth&&(y=o[0]),a=e._paintLegendIcon(l,p,m,g,d,n(y.node).data("legendIndex"),n(y.node).data("index"),t.wijCSS.legendIcon+" "+t.wijCSS.legend,I[n(y.node).data("legendIndex")],y),n(y.node).data("hidden")===!0&&(n(y.node).data("iconOpacity",a.attr("opacity")||1),a.attr("opacity",.3)),r.textStyle["text-anchor"]==="start"&&(l-=u.width/2),r.textWidth?o.transform(Raphael.format("...T{0},{1}",l+m+i,c-u.height/2)):o.transform(Raphael.format("...T{0},{1}",l+m+i+u.width/2,c)),Raphael.vml&&(v=e.canvas.rect(l+m+i,c-u.height/2,u.width,u.height).attr({stroke:"none",fill:"#000000",opacity:.01}),n.wijraphael.addClass(n(v.node),t.wijCSS.legendTextCover+" "+t.wijCSS.legend),n(v.node).data("legendIndex",n(y.node).data("legendIndex")),n(v.node).data("index",n(y.node).data("index")),e.legendEles.push(v)),o.toFront(),O++,O===N&&(O=0,A+=S+h.top+h.bottom)})},t.prototype._getLegendStyle=function(e){return e},t.prototype._hasAxes=function(){return this.widgetName==="wijpiechart"?!1:!0},t.prototype._applyAxisText=function(e,t){var r=this,i=e.text,s=null,o=null,u=null,a=0,f=0,l=t.bounds||r.canvasBounds;if(i!==null&&i!==undefined&&i.length>0){o=r._text(-100,-100,i),u=n.extend(!0,{},r.options.textStyle,e.textStyle),o.attr(u),s=o.wijGetBBox(),u["margin-left"]&&(f+=parseFloat(u["margin-left"])),u["margin-top"]&&(a+=parseFloat(u["margin-top"])),u["margin-right"]&&(f+=parseFloat(u["margin-right"])),u["margin-bottom"]&&(a+=parseFloat(u["margin-bottom"]));switch(e.compass){case"north":l.startY+=s.height+a;break;case"south":l.endY-=s.height+a;break;case"east":l.endX-=s.height+f;break;case"west":l.startX+=s.height+f}o.wijRemove(),o=null}return s},t.prototype._isSeriesDataEmpty=function(){var e=this,t=e.options.seriesList;return!t||t.length===0?!0:(n.each(t,function(e,t){if(!t.data||(!t.data.x||!t.data.y)&&!t.data.xy)return!0}),!1)},t.prototype._setTooltipContent=function(e){var t=this,r,i,s,o=t.tooltip,u,a={},f=t.options.hint,l=n.isFunction;o&&(r=[],n.each(e,function(e,t){var i=t.valX,s=t.valY;i&&s?r.push(n.extend({},t,{x:i,y:s})):r.push(t)}),u=o.getOptions(),i=f.title,s=f.content,l(i)&&(a.title=function(){return i.call(r)}),l(s)&&(a.content=function(){return s.call(r)}),o.setOptions(a))},t.prototype._setTooltip=function(){var e=this,t=e.options,n=e.tooltip,r;n&&(r={closeBehavior:"none",style:{stroke:t.indicator.style.stroke},animated:!1,showDelay:0,hideDelay:0,windowCollisionDetection:"fit",beforeShowing:function(t,n){if(this.target&&e.indicatorLine)return!1}},t.horizontal&&(r.compass="east"),n.setOptions(r))},t.prototype._resetTooltip=function(){var e=this,t=e.options,r=t.hint,i=r.title,s=r.content,o=e.tooltip,u=n.isFunction,a=n.extend(!0,{},this.options.hint);o&&(a.animated=r.animated,a.showDelay=r.showDelay,a.hideDelay=r.hideDelay,a.title=r.title,a.content=r.content,a.closeBehavior=r.closeBehavior||"auto",a.windowCollisionDetection="fit",u(i)&&(a.title=function(){return e._getTooltipText(i,this.target)}),u(s)&&(a.content=function(){return e._getTooltipText(s,this.target)}),a.beforeShowing=function(){e._onBeforeTooltipShowing(this)},o.setOptions(a))},t.prototype._fotmatTooltip=function(e){var t=this;return t._isDate(e)?Globalize.format(e,"f",t._getCulture()):isNaN(e)?e:Globalize.format(parseFloat(e),"n",t._getCulture())},t.prototype._paintTooltip=function(){var e=this,t=e.options,r=t.hint,i=!t.disabled&&r.enable,o=r,u,a,f=n.isFunction;i&&!e.tooltip&&(o=n.extend(!0,{},r,{}),u=r.title,a=r.content,a||(a=r.content=function(){var t;if(n.isArray(this)){var r="";return n.each(this,function(n,i){t=i.label,i.lineSeries&&i.lineSeries.label&&(t=i.lineSeries.label),r+=t+":"+e._fotmatTooltip(i.y)+"\n"}),r}return t=this.label,this.lineSeries&&this.lineSeries.label&&(t=this.lineSeries.label),t+":"+e._fotmatTooltip(this.y)}),f(u)&&(o.title=function(){return e._getTooltipText(u,this.target)}),f(a)&&(o.content=function(){return e._getTooltipText(a,this.target)}),o.beforeShowing=function(){e._onBeforeTooltipShowing(this)},e.tooltip=new s(e.canvas,null,o))},t.prototype._getTooltipText=function(e,t){var r=n(t.node).data("wijchartDataObj"),i={data:r,label:r.label,x:r.x,y:r.y,target:t,fmt:e};return n.proxy(e,i)()},t.prototype._onBeforeTooltipShowing=function(e){var t=e.target,n=this.options.hint.style;t&&(e.options.style.stroke=n.stroke||t.attrs.stroke||t.attrs.fill)},t.prototype._paintChartArea=function(){var e=this,t=e.options,r=t.axis,i=2,s=null,o=null,u={},a=5,f=0,l=0,c=n.isArray(r.y),h=0,p,d,v;e._applyMargins(),e.isMultiYAxis=c;if(e._isSeriesDataEmpty())return;c&&n.each(r.y,function(e,t){r.y[e]=n.extend(!0,{alignment:"center",style:{stroke:"#999999","stroke-width":.5},visible:!1,textVisible:!0,text:"",textStyle:{fill:"#888","font-size":15,"font-weight":"bold"},labels:{style:{fill:"#333","font-size":11},textAlign:"center",width:null},compass:"west",autoMin:!0,autoMax:!0,min:null,max:null,origin:null,autoMajor:!0,autoMinor:!0,unitMajor:null,unitMinor:null,gridMajor:{visible:!0,style:{stroke:"#999999","stroke-width":"0.5","stroke-dasharray":"none"}},gridMinor:{visible:!1,style:{stroke:"#CACACA","stroke-dasharray":"- "}},tickMajor:{position:"none",style:{fill:"black"},factor:1},tickMinor:{position:"none",style:{fill:"black"},factor:1},annoMethod:"values",annoFormatString:"",valueLabels:[]},t)});if(e._hasAxes()){if(e.innerState.axisInfo)e.axisInfo=e.innerState.axisInfo,e.canvasBounds=e.innerState.canvasBounds;else{s=e._applyAxisText(r.x,{}),e.axisInfo={x:{id:"x",tprec:0,isTime:!1,offset:0,vOffset:0,max:0,min:0,majorTickRect:null,minorTickRect:null,annoFormatString:null,textBounds:s,axisTextOffset:i,autoMax:!0,autoMin:!0,autoMajor:!0,autoMinor:!0,annoMethod:r.x.annoMethod,valueLabels:r.x.valueLabels||[]},y:{}},e.axisCompass[r.x.compass]=!0,c?n.each(r.y,function(t,n){o=e._applyAxisText(n,{}),e.axisInfo.y[t.toString()]={id:"y"+t,tprec:0,isTime:!1,offset:0,vOffset:0,max:0,min:0,majorTickRect:null,minorTickRect:null,annoFormatString:null,textBounds:o,axisTextOffset:i,autoMax:!0,autoMin:!0,autoMajor:!0,autoMinor:!0,annoMethod:n.annoMethod,valueLabels:n.valueLabels||[]},e.axisCompass[n.compass]||(e.axisCompass[n.compass]=!0)}):(o=e._applyAxisText(r.y,{}),e.axisInfo.y[0]={id:"y",tprec:0,isTime:!1,offset:0,vOffset:0,max:0,min:0,majorTickRect:null,minorTickRect:null,annoFormatString:null,textBounds:o,axisTextOffset:i,autoMax:!0,autoMin:!0,autoMajor:!0,autoMinor:!0,annoMethod:r.y.annoMethod,valueLabels:r.y.valueLabels||[]},e.axisCompass[r.y.compass]||(e.axisCompass[r.y.compass]=!0)),e._getSeriesGroup(c),u=e._getDataExtreme(c),e.extremeValue=u,r.x.autoMin&&e.axisInfo.x.autoMin?r.x.min=u.txn:r.x.min&&e._isDate(r.x.min)&&(r.x.min=n.toOADate(r.x.min)),r.x.autoMax&&e.axisInfo.x.autoMax?r.x.max=u.txx:r.x.max&&e._isDate(r.x.max)&&(r.x.max=n.toOADate(r.x.max)),n.each(u.y,function(e,t){h++});for(p=0;p<(r.y.length||1);p++){d=r.y[p]||r.y,v=p.toString(),d.autoMin&&e.axisInfo.y[v].autoMin&&u.y[v]?d.min=u.y[v].tyn:d.min&&e._isDate(d.min)&&(d.min=n.toOADate(d.min)),d.autoMax&&e.axisInfo.y[v].autoMax&&u.y[v]?d.max=u.y[v].tyx||0:d.max&&e._isDate(d.max)&&(d.max=n.toOADate(d.max));do{l=e._autoPosition(e.axisInfo,r,"y",v),f=e._autoPosition(e.axisInfo,r,"x",v);if(l===e.axisInfo.y[v].offset&&f===e.axisInfo.x.offset){a=0;break}!isNaN(f)&&!isNaN(l)&&(l!==e.axisInfo.y[v].offset&&l!==0&&(e.axisInfo.y[v].offset=l,e.axisInfo.y[v].vOffset=f),f!==e.axisInfo.x.offset&&f!==0&&(e.axisInfo.x.offset=f,e.axisInfo.x.vOffset=l)),a--}while(a>0)}e._adjustPlotArea(r.x,e.axisInfo.x),e._adjustPlotArea(r.y,e.axisInfo.y,!0),e.innerState.axisInfo=e.axisInfo,e.innerState.canvasBounds=e.canvasBounds}e._paintAxes(),e._paintPlotArea()}else e._paintPlotArea()},t.prototype._getSeriesGroup=function(e){var t=this,r=t.options,i={};n.each(r.seriesList,function(t,n){n.yAxis&&e?i[n.yAxis.toString()]?i[n.yAxis.toString()].push(n):i[n.yAxis.toString()]=[n]:i[0]?i[0].push(n):i[0]=[n]}),t.seriesGroup=i},t.prototype._adjustPlotArea=function(e,t,r){var i=this.canvasBounds,s,o={east:Number.MIN_VALUE,west:Number.MIN_VALUE,south:Number.MIN_VALUE,north:Number.MIN_VALUE};if(r)n.each(t,function(e,t){s=e}),n.each(t,function(t,n){var r=e[t]||e,i=r.compass;r.max=n.max,r.min=n.min;switch(i){case"north":o.north=Math.max(n.offset,o.north);break;case"south":o.south=Math.max(n.offset,o.south);break;case"east":o.east=Math.max(n.offset,o.east);break;case"west":o.west=Math.max(n.offset,o.west)}}),o.north!==Number.MIN_VALUE&&(i.startY+=o.north),o.south!==Number.MIN_VALUE&&(i.endY-=o.south),o.east!==Number.MIN_VALUE&&(i.endX-=o.east),o.west!==Number.MIN_VALUE&&(i.startX+=o.west);else{e.max=t.max,e.min=t.min;switch(e.compass){case"north":i.startY+=t.offset;break;case"south":i.endY-=t.offset;break;case"east":i.endX-=t.offset;break;case"west":i.startX+=t.offset}}},t.prototype._autoPosition=function(e,t,n,r){return this._autoPositionCartesianAxis(e,t,n,r)},t.prototype._autoPositionCartesianAxis=function(e,t,r,i){var s=this,o=null,u,a,f,l,c,h,p,d,v=s.lastAxisOffset||{},m,g;r==="y"?(u=e.y[i],a=t.y[i]||t.y,l=t.x,f=e.x):(u=e.x,a=t.x,f=e.y[i],l=t.y[i]||t.y),c=a.compass,h=l.origin,p=f.max,d=f.min,h!==null&&s._isDate(h)&&(h=n.toOADate(h)),s._calculateParameters(u,a),o=s._getMaxExtents(u,a);switch(c){case"north":case"south":m=o.height,u.maxExtent=m;break;case"east":case"west":m=o.width,u.maxExtent=m}return r==="y"&&v[c]&&(n.each(v[c],function(e,t){e!==i&&(g=t)}),g&&!u.isPartAxis&&(u.preStartOffset=g,m+=g)),r==="y"&&(v[c]===undefined&&(v[c]={}),v[c][i]=m+s._getAxisLabelBox(a).width,s.lastAxisOffset=v),m},t.prototype._getAxisLabelBox=function(e){var t=this,r=t.options,i=e.text,s=0,o=0,u=0,a=0,f,l,c=t._isVertical(e.compass),h=n.extend(!0,{},r.textStyle,e.textStyle);return h["margin-top"]&&(s=parseFloat(h["margin-top"])),h["margin-left"]&&(u=parseFloat(h["margin-left"])),h["margin-right"]&&(o=parseFloat(h["margin-right"])),h["margin-bottom"]&&(a=parseFloat(h["margin-bottom"])),f=t._text(0,0,i),f.attr(h),c&&f.transform("...R-90"),l=f.wijGetBBox(),f.wijRemove(),f=null,{width:l.width+u+o,height:l.height+a+s}},t.prototype._getMaxExtents=function(e,t,r){var i=this,s=i.options,o=null,u={width:0,height:0},a=e.min,f=e.max,l=e.isTime,c=t.annoFormatString,h=s.is100Percent,p=0,d=t.compass,v=t.labels,m,g=!1,y=e.bounds||i.canvasBounds,b,w;e.majorTickRect=i._getTickRect(e,t,!0,!0,r),e.minorTickRect=i._getTickRect(e,t,!1,!0,r),o=i._getMajorTickValues(e,t);if(!t.textVisible)return u;if(!c||c.length===0)c=e.annoFormatString;return m=n.extend(!0,{},s.textStyle,t.textStyle,v.style),w=m.transform,g=w&&/r/i.test(w),m=n.extend(!0,m,e.textStyle),b=y.endX-y.startX-e.vOffset-e.axisTextOffset,o&&o.length&&(b/=o.length-1,n.each(o,function(t,r){var s,o,y;if(r<a||r>f)return!0;if(e.annoMethod==="valueLabels"){if(r<0)return!0;if(p>=e.valueLabels.length)return!1;r=e.valueLabels[p],r.text?r=r.text:typeof r.value!="undefined"&&(r=r.value,c&&c.length&&(r=Globalize.format(r,c,i._getCulture())))}else e.annoMethod==="values"&&(c&&c.length?(l&&(r=n.fromOADate(r)),r=Globalize.format(r,c,i._getCulture())):h&&e.id==="y"&&(r=Globalize.format(r,"p0",i._getCulture())));v.width?s=i.canvas.wrapText(-100,-100,r,v.width,v.textAlign,m):s=i._text(-100,-100,r).attr(m),o=s.wijGetBBox(),!i._isVertical(d)&&!g&&e.annoMethod==="valueLabels"&&o.width>b&&(s.attr({transform:"r-45"}),o=s.wijGetBBox(),t===0&&(m.transform="r-45",e.textStyle={transform:"r-45"},y=s.clone(),y.attr({transform:"r0"}),o=y.wijGetBBox(),Math.sqrt(2)*o.height>b&&(s.attr({transform:"r-90"}),m.transform="r-90",e.textStyle={transform:"r-90"}),y.wijRemove(),y=null,o=s.wijGetBBox())),s.wijRemove(),s=null,o.width>u.width&&(u.width=o.width),o.height>u.height&&(u.height=o.height),p++})),u.width<v.width&&(u.width=v.width),e.labelWidth=u.width,u},t.prototype._getMajorTickValues=function(e,t){var r=[],i=e.valueLabels;return i&&i.length>0&&n.each(i,function(e,t){if(typeof t.text!="undefined"||typeof t.value!="undefined")return!1;typeof t=="string"?i[e]={text:t,gridLine:!1}:i[e]={value:t,gridLine:!1}}),e.annoMethod==="valueLabels"&&i&&i.length>0&&typeof i[0].value!="undefined"?(r=this._getSortedDataValues(e,t),r):(r=this._getTickValues(e.max,e.min,t.unitMajor,e.tprec,!e.isTime,t.autoMajor),r)},t.prototype._getSortedDataValues=function(e,t){var r=this,i=[],s=e.valueLabels;return n.each(s,function(e,t){var s=t.value;r._isDate(s)?i.push(n.toOADate(s)):typeof s=="number"?i.push(s):i.push(e)}),i},t.prototype._getMinorTickValues=function(e,t){var n=[];return n=this._getTickValues(e.max,e.min,t.unitMinor,e.tprec,!e.isTime,t.autoMinor),n},t.prototype._getTickValues=function(e,t,r,s,o,u){var a=this,f=[],l=t,c=0,h=0,p=0,d=0,v=0,m=0;try{if(r===0)f=[e,t];else{u?(s+1<0?s=-1:s+1>15&&(s=14),m=n.round(i.signedCeiling(t/r)*r,s+1),m<e&&(t=m),p=parseInt(n.round(e/r,5).toString(),10),d=parseInt(n.round(t/r,5).toString(),10),v=parseInt((p-d+1).toString(),10),v>1&&(h=d*r,h<t&&(v--,t+=r),h=t+(v-1)*r,h>e&&v--),v<1&&(v=2,t=l,r=e-t)):(v=parseInt(((e-t)/r+1).toString(),10),v>1&&(h=t+(v-1)*r,h>e&&v--),v<1&&(v=2,r=e-t));for(c=0;c<v;c++)o?u?f[c]=n.round(t+c*r,s+1):f[c]=t+c*r:f[c]=t+c*r}}catch(g){}return f},t.prototype._getTickRect=function(e,t,n,r,i){var s=t.compass,o=0,u=null,a=3,f=2,l=2,c=t.tickMajor.factor,h=t.tickMinor.factor,p={x:0,y:0,width:0,height:0};n?(u=t.tickMajor.position,c=c>0?c:1,o=a*c):(u=t.tickMinor.position,h=h>0?h:1,o=f*h);if(u==="none"||u==="inside"&&r)o=0;return s==="east"||s==="west"?(p={x:0,y:-1,width:o*l,height:l},s==="east"&&(u==="outside"||u==="cross"&&r)||s==="west"&&u==="inside"?p.width+=2:r||(u==="cross"&&(p.width<<=1),p.width+=2)):(p={x:-1,y:0,width:l,height:o*l},s==="south"&&(u==="outside"||u==="corss"&&r)||s==="north"&&u==="inside"?p.height+=2:r||(u==="cross"&&(p.height<<=1),p.height+=2)),p},t.prototype._applyMargins=function(){var e=this,t=e.options,n=e.canvasBounds;n.startX+=t.marginLeft,n.endX-=t.marginRight,n.startY+=t.marginTop,n.endY-=t.marginBottom},t.prototype._paintAxes=function(){var e=this,t=e.options.axis,r=e.axisInfo,i=t.x,s=t.y,o=r.x,u=r.y,a;a=e._paintAxis(i,o),n.each(u,function(t,n){var r=s[t]||s;r.origin!==null&&e._translateAxisIfNeeded(a,i.compass,r.origin,r.compass,n.max,n.min)}),n.each(u,function(t,n){var r=s[t]||s;a=e._paintAxis(r,n),i.origin!==null&&e._translateAxisIfNeeded(a,r.compass,i.origin,i.compass,o.max,o.min)})},t.prototype._translateAxisIfNeeded=function(e,t,r,i,s,o){var u=this,a=i==="west"||i==="east",f=u.canvasBounds,l=r,c;u._isDate(l)&&(l=n.toOADate(l)),a?(t==="south"?c=(o-l)/(s-o)*(f.endY-f.startY):c=(s-l)/(s-o)*(f.endY-f.startY),n.each(e,function(e,t){t.transform(Raphael.format("...T{0},{1}",0,c))})):(t==="west"?c=(l-o)/(s-o)*(f.endX-f.startX):c=(l-s)/(s-o)*(f.endX-f.startX),n.each(e,function(e,t){t.transform(Raphael.format("...T{0},{1}",c,0))}))},t.prototype._paintAxis=function(e,t){var r=this,i=r.options,s=t.bounds||r.canvasBounds,o={x:0,y:0},u={x:0,y:0},a=e.compass,f=2,l=!0,c=null,h=[],p=[],d=[],v=t.max,m=t.min,g=e.unitMajor,y=e.unitMinor,b=e.tickMajor.position,w=e.tickMinor.position,E=t.maxExtent,S=e.tickMajor.style,x=e.tickMinor.style,T=t.majorTickRect,N=t.minorTickRect,C=t.axisTextOffset,k=e.gridMajor,L=e.gridMinor,A=e.labels,O=0,M=[],_=0,D=e.annoFormatString,P=null,H=[];T=r._getTickRect(t,e,!0,!1),N=r._getTickRect(t,e,!1,!1);if(!D||D.length===0)D=t.annoFormatString;h=r._getMajorTickValues(t,e),p=r._getMinorTickValues(t,e),d=r._resetMinorTickValues(p,h);switch(a){case"south":o.x=s.startX,o.y=s.endY,u.x=s.endX,u.y=s.endY,l=!1;break;case"north":o.x=s.startX,o.y=s.startY-f,u.x=s.endX,u.y=s.startY-f,l=!1;break;case"east":o.x=s.endX-f,t.preStartOffset&&(o.x+=t.preStartOffset),o.y=s.endY,u.x=s.endX-f,u.y=s.startY;break;case"west":o.x=s.startX,t.preStartOffset&&(o.x-=t.preStartOffset),o.y=s.endY,u.x=s.startX,u.y=s.startY}return e.visible&&(c=r.canvas.line(o.x,o.y,u.x,u.y).attr(e.style),n.wijraphael.addClass(n(c.node),i.wijCSS.axis),r.axisEles.push(c),H.push(c)),n.each(h,function(s,f){var l=f,c=t.isTime,h=i.is100Percent,p,d,y=!1,w={};if(f<m||f>v)return _++,!0;if(t.annoMethod==="valueLabels"){if(_>=t.valueLabels.length)return!1;l=t.valueLabels[_],y=l.gridLine,w=l.gridLineStyle,l.text?l=l.text:typeof l.value!="undefined"&&(l=l.value,D&&D.length&&(l=Globalize.format(l,D,r._getCulture())))}else t.annoMethod==="values"&&(D&&D.length?(c&&(l=n.fromOADate(f)),l=Globalize.format(l,D,r._getCulture())):h&&t.id==="y"&&(l=Globalize.format(f,"p0",r._getCulture())));P=n.extend(!0,{},i.textStyle,e.textStyle,A.style,t.textStyle),t.id==="x"&&(l=r._getTickText(l)),p=r._paintMajorMinor(e.origin,v,m,f,b,g,T,a,o,u,E,C,S,l,k,e.textVisible,P,A.textAlign,A.width?t.labelWidth:null,y,w),p&&(p.elements&&(H=H.concat(p.elements)),d=p.textInfo),d&&(M.push(d),O<d.len&&(O=d.len)),_++}),A.width||n.each(M,function(e,t){var n=t.text,r=(t.len-O)/2;r=A.textAlign==="near"?r*-1:r,l?n.transform(Raphael.format("...T{0},{1}",r,0)):n.transform(Raphael.format("...T{0},{1}",0,r))}),n.each(d,function(n,i){var s;i>m&&i<v&&(s=r._paintMajorMinor(e.origin,v,m,i,w,y,N,a,o,u,E,C,x,null,L,e.textVisible,P,A.textAlign,A.width?t.labelWidth:null),s&&s.elements&&(H=H.concat(s.elements)))}),e.text&&e.text.length>0&&H.push(r._paintAxisText(e,t)),t.isPartAxis&&!t.isLastAxis&&H.push(r.canvas.path(["M",o.x.toString(),o.y.toString()+(t.vOffset/2).toString,"H",(o.x+t.maxExtent*2).toString()].join())),H},t.prototype._paintAxisText=function(e,t){if(!e.text||e.text.length===0)return;var r=this,i=r.options,s=e.text,o=e.compass,u=e.alignment,a=t.bounds||r.canvasBounds,f=a.startX,l=a.startY,c=a.endX,h=a.endY,p=f,d=l,v=t.textBounds,m=r._isVertical(o),g=t.axisTextOffset,y=t.majorTickRect,b=e.tickMajor.position,w=m?y.width:y.height,E=null,S=null,x=0,T=0,N=0,C=0;E=n.extend(!0,{},r.options.textStyle,e.textStyle),E["margin-top"]&&(x=parseFloat(E["margin-top"])),E["margin-left"]&&(T=parseFloat(E["margin-left"])),E["margin-right"]&&(N=parseFloat(E["margin-right"])),E["margin-bottom"]&&(C=parseFloat(E["margin-bottom"])),b==="cross"?w/=2:b==="inside"&&(w=0);if(m){switch(u){case"near":d=h-v.width/2;break;case"center":d=(l+h)/2;break;case"far":d=l+v.width/2}o==="west"?p=f-(t.offset+g+w+v.height/2+N):p=c+t.offset+g+w+v.height/2+T}else{switch(u){case"near":p=f+v.width/2;break;case"center":p=(f+c)/2;break;case"far":p=c-v.width/2}o==="north"?d=l-(t.offset+g+w+v.height/2+C):d=h+t.offset+g+w+v.height/2+x}return S=r._text(p,d,s),n.wijraphael.addClass(n(S.node),i.wijCSS.axisText),r.axisEles.push(S),S.attr(E),m&&S.transform("...R-90"),S},t.prototype._resetMinorTickValues=function(e,t){var n=0,r=0,i=null,s=null;for(n=e.length-1;n>=0;n--){i=e[n];for(r=t.length-1;r>=0;r--)s=t[r],i===s&&e.splice(n,1)}return e},t.prototype._getTickText=function(e){return e},t.prototype._paintMajorMinor=function(e,t,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E){var S=this,x=f.x,T=f.y,N=S.options,C=-1,k=-1,L=!0,A=S.canvasBounds,O=null,M=null,_=[],D=[],P=null,H={"stroke-width":2},B={text:null,len:0},j=null,F={},I=[],q=S.axisCompass;switch(a){case"south":s==="inside"?T-=u.height:s==="cross"&&(T-=u.height/2),b?k=T+h+u.height:k=T+h+u.height+c/2,L=!1;break;case"west":s==="outside"?x-=u.width:s==="cross"&&(x-=u.width/2),b?C=x-(h+c):C=x-(h+c/2);break;case"north":s==="outside"?T-=u.height:s==="cross"&&(T-=u.height/2),b?k=T-(h+c):k=T-(h+c/2),L=!1;break;case"east":s==="inside"?x-=u.width:s==="cross"&&(x-=u.width/2),b?C=x+h+u.width:C=x+h+u.width+c/2}return L?(T+=(i-r)/(t-r)*(l.y-f.y),D=["M",A.startX,T,"H",A.endX],v.visible&&((T!==A.startY||!q.north)&&(T!==A.endY||!q.south)||e!==i)&&(P=S.canvas.path(D.join(" ")),n.wijraphael.addClass(n(P.node),N.wijCSS.axisGridLine),P.attr(v.style),S.axisEles.push(P)),w&&((T!==A.startY||!q.north)&&(T!==A.endY||!q.south)||e!==i)&&(P=S.canvas.path(D.join(" ")),n.wijraphael.addClass(n(P.node),N.wijCSS.axisGridLine),P.attr(n.extend(!0,v.style,E)),S.axisEles.push(P)),k=T,s!=="none"&&(_=["M",x,T,"h",u.width],p["stroke-width"]=u.height)):(x+=(i-r)/(t-r)*(l.x-f.x),D=["M",x,A.startY,"V",A.endY],v.visible&&((x!==A.startX||!q.west)&&(x!==A.endX||!q.east)||e!==i)&&(P=S.canvas.path(D.join(" ")),n.wijraphael.addClass(n(P.node),N.wijCSS.axisGridLine),P.attr(v.style),S.axisEles.push(P)),w&&((x!==A.startX||!q.west)&&(x!==A.endX||!q.east)||e!==i)&&(P=S.canvas.path(D.join(" ")),n.wijraphael.addClass(n(P.node),N.wijCSS.axisGridLine),P.attr(n.extend(!0,{},v.style,E)),S.axisEles.push(P)),b?C=x-b/2:C=x,s!=="none"&&(_=["M",x,T,"v",u.height],p["stroke-width"]=u.width)),s!=="none"&&(M=S.canvas.path(_.join(" ")),n.wijraphael.addClass(n(M.node),N.wijCSS.axisTick),H=n.extend(H,p),M.attr(H),S.axisEles.push(M),I.push(M)),d!==null&&m&&(b?(B=S.canvas.wrapText(C,k,d.toString(),b,y,g),n.wijraphael.addClass(n(B.node),N.wijCSS.axisLabel)):(B=S._text(C,k,d.toString()),n.wijraphael.addClass(n(B.node),N.wijCSS.axisLabel),B.attr(g)),S.axisEles.push(B),I.push(B),m||B.hide(),y!=="center"&&(j=B.getBBox(),O={text:B,len:L?j.width:j.height})),F={textInfo:O,elements:I},F},t.prototype._paintPlotArea=function(){},t.prototype._paintChartLabels=function(){var e=this,t=e.options.chartLabels;t&&t.length&&n.each(t,function(t,r){var i;r=n.extend(!0,{compass:"east",attachMethod:"coordinate",attachMethodData:{seriesIndex:-1,pointIndex:-1,x:-1,y:-1},offset:0,visible:!1,text:"",connected:!1},r);if(r.visible){i=e._getChartLabelPointPosition(r);if(typeof i.x!="number"||typeof i.y!="number")return!1;e._setChartLabel(r,i)}})},t.prototype._getChartLabelPointPosition=function(e){},t.prototype._setChartLabel=function(e,t,r,i){var s=this,o=e.compass,u=s.options,a=n.extend(!0,{},u.textStyle,u.chartLabelStyle),f=s._text(0,0,e.text).attr(a),l=e.offset,c=0,h=0,p=null,d=null;n.wijraphael.addClass(n(f.node),u.wijCSS.labelText),s.chartLabelEles.push(f),p=s._getCompassTextPosition(o,f.wijGetBBox(),l,t,r),l&&e.connected&&(d=s.canvas.path("M"+t.x+" "+t.y+"L"+p.endPoint.x+" "+p.endPoint.y),n.wijraphael.addClass(n(d.node),u.wijCSS.labelConnect),d.attr(i),s.chartLabelEles.push(d)),c=p.endPoint.x+p.offsetX,h=p.endPoint.y+p.offsetY,f.transform(Raphael.format("...T{0},{1}",c,h)).toFront()},t.prototype._getCompassTextPosition=function(e,t,r,i,s){var o=0,u=0,a={x:0,y:0};switch(e.toLowerCase()){case"east":s=0;break;case"west":s=180;break;case"north":s=90;break;case"south":s=270;break;case"northeast":s=45;break;case"northwest":s=135;break;case"southeast":s=315;break;case"southwest":s=225}return s>=0&&s<22.5||s>337.5&&s<360?o=t.width/2:s>=22.5&&s<67.5?(o=t.width/2,u=-1*t.height/2):s>=67.5&&s<112.5?u=-1*t.height/2:s>=112.5&&s<157.5?(o=-1*t.width/2,u=-1*t.height/2):s>=157.5&&s<202.5?o=-1*t.width/2:s>=202.5&&s<247.5?(o=-1*t.width/2,u=t.height/2):s>=247.5&&s<292.5?u=t.height/2:(o=t.width/2,u=t.height/2),a=n.wijraphael.getPositionByAngle(i.x,i.y,r,s),{endPoint:a,offsetX:o,offsetY:u}},t.prototype._mouseDown=function(e,t){this._trigger("mouseDown",e,t)},t.prototype._mouseUp=function(e,t){this._trigger("mouseUp",e,t)},t.prototype._mouseOver=function(e,t){this._trigger("mouseOver",e,t)},t.prototype._mouseOut=function(e,t){this._trigger("mouseOut",e,t)},t.prototype._mouseMove=function(e,t){this._trigger("mouseMove",e,t)},t.prototype._click=function(e,t){this._trigger("click",e,t)},t.prototype._mouseMoveInsidePlotArea=function(e,t){var r=this,i=r.options,s=i.indicator,o=r.canvas,u,a,f,l=0,c=[],h=i.horizontal;s&&s.visible&&this.isPlotAreaMouseDown&&(h?u=this._calculatePositionByX(t.top):u=this._calculatePositionByX(t.left),u&&this.indicatorLine&&u.x!==this.lastIndicatorPosition&&(n.each(u.data,function(e,t){t.visible&&c.push(t)}),c.length>0&&(a=r.canvasBounds,h?this.indicatorLine.transform("T0 "+u.x):this.indicatorLine.transform("T"+u.x+" 0"),this._setTooltipContent(c),h?this.tooltip.showAt({x:a.endX,y:u.x}):this.tooltip.showAt({x:u.x,y:a.startY}),this.lastIndicatorPosition=u.x,r._indicatorLineShowing(c),this.lastIndicatorObjects=c)))},t.prototype._calculatePositionByX=function(e){var t=this,n=t.pointXs,r,i=t.dataPoints;return n&&n.length>0&&(r=this._calculatePositionByXInternal(e,n)),i?{x:r,data:i[r.toString()]}:null},t.prototype._calculatePositionByXInternal=function(e,t){var n=t.length,r,i;return n===1?t[0]:n===2?Math.abs(e-t[0])>Math.abs(e-t[1])?t[1]:t[0]:(r=parseInt((n/2).toString()),e>t[r]?i=t.slice(r):i=t.slice(0,r+1),this._calculatePositionByXInternal(e,i))},t.prototype._mouseMoveOutsidePlotArea=function(e,t){this.indicatorLine&&(this.indicatorLine.wijRemove(),this.indicatorLine=null,this.tooltip&&this.tooltip.hide(),this._resetTooltip())},t.prototype._mouseDownInsidePlotArea=function(e,t){this.isPlotAreaMouseDown=!0;var r=this,i=r.options,s=i.indicator,o=r.canvas,u,a,f,l=[],c=i.horizontal;s&&s.visible&&this.isPlotAreaMouseDown&&(r._setTooltip(),c?u=this._calculatePositionByX(t.top):u=this._calculatePositionByX(t.left),u&&(n.each(u.data,function(e,t){t.visible&&l.push(t)}),l.length>0&&(a=r.canvasBounds,c?f=["M",a.startX,0,"H",a.endX]:f=["M",0,a.startY,"V",a.endY],this.indicatorLine&&this.indicatorLine.wijRemove(),this.indicatorLine=o.path(f),this.indicatorLine.attr(s.style),c?this.indicatorLine.transform("T0 "+u.x):this.indicatorLine.transform("T"+u.x+" 0"),this._setTooltipContent(l),c?this.tooltip.showAt({x:a.endX,y:u.x}):this.tooltip.showAt({x:u.x,y:a.startY}),this.lastIndicatorPosition=u.x,r._indicatorLineShowing(l),this.lastIndicatorObjects=l)),e.preventDefault())},t.prototype._indicatorLineShowing=function(e){this.lastIndicatorObjects&&this._removeIndicatorStyles(this.lastIndicatorObjects)},t.prototype._removeIndicatorStyles=function(e){},t.prototype._mouseUpInsidePlotArea=function(e,t){this.isPlotAreaMouseDown=!1,this.indicatorLine&&(this.indicatorLine.wijRemove(),this.indicatorLine=null,this.tooltip&&this.tooltip.hide(),this._resetTooltip()),this.lastIndicatorObjects&&(this._removeIndicatorStyles(this.lastIndicatorObjects),this.lastIndicatorObjects=null)},t.prototype._bindLiveEvents=function(){this._bindLegendEvents(),this._bindCanvasEvents()},t.prototype._bindCanvasEvents=function(){var e=this,t=e.chartElement,r="",i="."+this.widgetName;window.navigator.msPointerEnabled&&t.css("-ms-touch-action","none"),n.support.isTouchEnabled&&n.support.isTouchEnabled()&&(r="wij"),t.bind(r+"mousemove"+i,function(n){var r=t.offset(),i=e.canvasBounds,s={left:n.pageX-r.left,top:n.pageY-r.top},o=e.options.disabled;if(o)return;s.left>=i.startX&&s.left<=i.endX&&s.top>=i.startY&&s.top<=i.endY?e._mouseMoveInsidePlotArea(n,s):e._mouseMoveOutsidePlotArea(n,s)}),e.options.indicator&&e.options.indicator.visible&&t.bind(r+"mousedown"+i,function(n){var r=t.offset(),i=e.canvasBounds,s={left:n.pageX-r.left,top:n.pageY-r.top},o=e.options.disabled;if(o)return;s.left>=i.startX&&s.left<=i.endX&&s.top>=i.startY&&s.top<=i.endY&&e._mouseDownInsidePlotArea(n,s)}).bind(r+"mouseup"+i,function(n){var r=t.offset(),i=e.canvasBounds,s={left:n.pageX-r.left,top:n.pageY-r.top},o=e.options.disabled;if(o)return;s.left>=i.startX&&s.left<=i.endX&&s.top>=i.startY&&s.top<=i.endY&&e._mouseUpInsidePlotArea(n,s)})},t.prototype._unbindCanvasEvents=function(){window.navigator.msPointerEnabled&&this.element.css("-ms-touch-action",""),this.element.unbind("."+this.widgetName)},t.prototype._bindLegendEvents=function(){var e=this,t=e.chartElement;t.delegate("."+e.options.wijCSS.legend,"click.wijchartcore",function(t){if(e.options.disabled)return;var r=n(t.target);r[0].tagName&&r[0].tagName==="tspan"&&(r=r.parent()),e._legendClick(r)})},t.prototype._legendClick=function(e){if(typeof e.data("index")=="undefined")return;var t=this,r=t.options.legend,i=e.data("index"),s=e.data("legendIndex"),o=t.chartElement.data("fields"),u=t.seriesEles,a,f=t.legendIcons[s],l=t.legends[s],c=r.textWidth?n(l[0].node):n(l.node),h=i,p;o&&o.seriesEles&&(u=o.seriesEles),t.legendDots&&t.legendDots.length>i&&(p=t.legendDots[i]),r.reversed&&(h=t.legends.length-1-i),a=u[h],a&&(c.data("hidden")?(t._showSerieEles(a),l.attr("opacity",c.data("textOpacity")),f.attr("opacity",c.data("iconOpacity")),p&&p.attr("opacity",c.data("dotOpacity")),c.data("hidden",!1)):(t._hideSerieEles(a),c.data("textOpacity")||(r.textWidth?c.data("textOpacity",l[0].attr("opacity")||1):c.data("textOpacity",l.attr("opacity")||1)),c.data("iconOpacity")||c.data("iconOpacity",f.attr("opacity")||1),p&&!c.data("dotOpacity")&&c.data("dotOpacity",f.attr("opacity")||1),l.attr("opacity","0.3"),f.attr("opacity","0.3"),p&&p.attr("opacity","0.3"),c.data("hidden",!0)))},t.prototype._showSerieEles=function(e){},t.prototype._hideSerieEles=function(e){},t.prototype._unbindLiveEvents=function(){var e=this,t=e.options,n=this.chartElement,r=e.widgetName;n.undelegate("."+t.wijCSS.legend,".wijchartcore").undelegate("."+t.wijCSS.legend,"wijchartcore"),this._unbindCanvasEvents()},t.prototype._isBarChart=function(){return!1},t.prototype._isPieChart=function(){},t.prototype._isStockChart=function(){},t.prototype._validateSeriesData=function(e){return!1},t.prototype._calculateParameters=function(e,t){var n=this,r=t.max,s=t.min,o=t.autoMax&&e.autoMax,u=t.autoMin&&e.autoMin,a=t.autoMajor&&e.autoMajor,f=t.autoMinor&&e.autoMinor,l=null,c=null,h=e.annoMethod==="valueLabels",p=0,d=0,v=0,m=0,g=0,y=e.isTime,b=n.options.adjustMinValue;o&&r!==Number.MIN_VALUE&&e.id!=="x"&&n._isBarChart()&&r<0&&.5*(r-s)>-r&&(r=0),u&&s!==Number.MAX_VALUE&&e.id!=="x"&&n._isBarChart()&&s>0&&.5*(r-s)>s&&(s=0),r===s&&(s!==0&&(s-=1),r+=1),m=r-s;if(y){l=t.annoFormatString;if(!l||l.length===0)l=i.getTimeDefaultFormat(r,s),e.annoFormatString=l;g=i.niceTimeUnit(0,l)}c=i.nicePrecision(m),e.tprec=c,o&&(y?(d=i.roundTime(r,g,!0),d<r?r=d+g:r=d):(d=i.precCeil(-c,r),typeof d=="number"&&(r=d))),u&&(y?(v=i.roundTime(s,g,!1),v>s?s=v-g:s=v):(v=i.precFloor(-c,s),typeof v=="number"&&(s=v))),e.max=r,e.min=s,e.annoFormatString=l,e.tinc=g;if(a||f)m=r-s,n._calculateMajorMinor(t,e),p=t.unitMajor,o&&p!==0&&!y&&!h&&(m=r-parseInt((r/p).toString(),10)*p,m!==0&&(r+=p-m,r=i.precCeil(-c,r))),u&&p!==0&&!y&&!h&&(m=s-parseInt((s/p).toString(),10)*p,m!==0&&(m<0&&(m+=p),s-=Math.abs(m),s=i.precFloor(-c,s))),u&&p!==0&&!h&&(typeof b=="undefined"||b===!1)&&u&&s===t.min&&s-p>=0&&e.id==="y"&&(s-=p);e.max=r,e.min=s},t.prototype._supportStacked=function(){return!1},t.prototype._getDataExtreme=function(e){var t={txx:0,txn:0,tyx:0,tyn:0},n;return n=this._getDataExtremes(t,e),n?(n.txn>n.txx&&(n.txn=0,n.txx=1),n):(t.txn>t.txx&&(t.txn=0,t.txx=1),t)},t.prototype._getDataExtremes=function(e,t){var i=this,s=i.options,o=s.seriesList,u=s.stacked&&i._supportStacked(),a=s.is100Percent,f=s.axis,l=i.axisInfo,c=[],h=[],p=[],d,v={y:{}},m=f.x.valueLabels,g=l.x.annoMethod,y=l.y.annoMethod;return!o||o.length===0?e:(n.each(o,function(e,t){var r=t.data,i=[],s=[],o,u=0;if(r.xy&&n.isArray(r.xy)){o=r.xy.length;while(u<o)i.push(r.xy[u]),s.push(r.xy[u+1]),u+=2;r.x=i,r.y=s}}),i.seriesGroup&&n.each(i.seriesGroup,function(t,s){var o=[],m=parseInt(t,10);n.each(s,function(t,r){if(r.type==="pie")return!0;r=n.extend(!0,{display:"show"},r);var s=r.data,a=0,f=0,l=[].concat(s.xy),p=l.length,d,v;if(r.display==="exclude")return!0;c=[].concat(s.x),o=[].concat(s.y);if(s.xy&&p){c=[],o=[];while(f<p)c[a]=l[f],o[a]=l[f+1],f+=2,a++,s.x=c,s.y=o}else s.x||(c=[],n.each(o,function(e){c.push(e)}),s.x=c);u&&t>0&&n.each(o,function(e){o[e]+=h[e]}),h=o,d=i._getMinMaxValue(c),v=i._getMinMaxValue(o),t===0?(e.txx=d.max,e.txn=d.min,e.tyx=v.max,e.tyn=v.min):(e.txx<d.max&&(e.txx=d.max),e.txn>d.min&&(e.txn=d.min),e.tyx<v.max&&(e.tyx=v.max),e.tyn>v.min&&(e.tyn=v.min)),t++}),a&&(e.tyx=1,e.tyn=0),v.y[t]={tyx:e.tyx,tyn:e.tyn},v.txx=e.txx,v.txn=e.txn,e.tyx=0,e.tyn=0;if(o.length){d=r.getFirstValidListValue(o);if(i._isDate(d))l.y[t].isTime=!0;else{if(typeof d=="undefined")return!0;typeof d!="number"&&(n.each(o,function(e,t){var n=f.y.annoFormatString,r=t;n&&n.length>0?r=Globalize.format(r,n,i._getCulture()):r=r.toString(),p.push({text:r,value:t,gridLine:!1})}),l.y[t].annoMethod="valueLabels",!f.y[m].valueLabels&&f.y[m].valueLabels.length===0?l.y[t].valueLabels=p:l.y[t].valueLabels=f.y[m].valueLabels,f.x.max=o.length-1,f.x.min=0,f.y[m].unitMajor=1,f.x.unitMinor=.5,l.y[t].autoMax=!1,l.y[t].autoMin=!1,l.y[t].autoMajor=!1,l.y[t].autoMinor=!1)}}}),c.length&&(d=r.getFirstValidListValue(c),g==="valueLabels"&&m&&m.length>0&&(l.x.valueLabels=m),i._isDate(d)?l.x.isTime=!0:typeof d!="number"&&(n.each(c,function(e,t){var r={},s,o;if(g==="valueLabels"&&m&&m.length&&e<m.length){s=m[e],o=typeof s;if(o==="string")s={text:s};else if(o==="number"||i._isDate(s))s={value:s}}r=n.extend({text:t,value:e,gridLine:!1},s),p.push(r)}),f.x.max=c.length-1,f.x.min=0,f.x.unitMajor=1,f.x.unitMinor=.5,l.x.annoMethod="valueLabels",l.x.valueLabels=p,l.x.autoMax=!1,l.x.autoMin=!1,l.x.autoMajor=!1,l.x.autoMinor=!1)),v)},t.prototype._isVertical=function(e){return e==="west"||e==="east"},t.prototype._isDate=function(e){return e?typeof e=="object"&&e.constructor===Date:!1},t.prototype._getMinMaxValue=function(e){var t=this,i={min:0,max:0},s=0,o;if(!e.length)return i;o=r.getFirstValidListValue(e);if(typeof o!="number"){if(!t._isDate(o))return i.min=0,i.max=e.length-1,i;i.min=o,i.max=o}else i.min=o,i.max=o;for(s=0;s<e.length;s++){if(e[s]===null||typeof e[s]=="undefined")continue;if(typeof e[s]=="number"&&isNaN(e[s]))continue;e[s]<i.min?i.min=e[s]:e[s]>i.max&&(i.max=e[s])}return t._isDate(i.min)&&(i.min=n.toOADate(i.min),i.max=n.toOADate(i.max)),i},t.prototype._calculateMajorMinor=function(e,t){var r=this,s=r.options,o=t.bounds||r.canvasBounds,u=e.autoMajor,a=e.autoMinor,f=t.max,l=t.min,c=t.isTime,h=t.tinc,p=t.annoFormatString,d=null,v=null,m=null,g=null,y=null,b=null,w=null,E=null,S=null,x=f-l,T=0,N=0,C=0,k=0;if(u){S=n.extend(!0,{},s.textStyle,e.textStyle,e.labels.style);if(c)d=Globalize.format(n.fromOADate(f),p,r._getCulture()),v=Globalize.format(n.fromOADate(l),p,r._getCulture()),y=r._text(-1e3,-1e3,d).attr(S),b=r._text(-1e3,-1e3,v).attr(S),m=y.wijGetBBox(),g=b.wijGetBBox(),y.wijRemove(),y=null,b.wijRemove(),b=null;else{w=i.nicePrecision(x),E=w+1;if(E<0||E>15)E=0;y=r._text(-1e3,-1e3,n.round(f,E).toString()).attr(S),b=r._text(-1e3,-1e3,n.round(l,E).toString()).attr(S),m=y.wijGetBBox(),g=b.wijGetBBox(),y.wijRemove(),y=null,b.wijRemove(),b=null}m.width<g.width&&(m.width=g.width),m.height<g.height&&(m.height=g.height),r._isVertical(e.compass)?(N=o.endY-o.startY-t.vOffset-t.axisTextOffset,k=N/m.height,Number.POSITIVE_INFINITY===k?C=0:C=parseInt(k.toString(),10)):(T=o.endX-o.startX-t.vOffset-t.axisTextOffset,k=T/m.width,Number.POSITIVE_INFINITY===k?C=0:C=parseInt(k.toString(),10)),k=x,C>0&&(x/=C,c?x<h?k=h:k=i.niceTimeUnit(x,t.annoFormatString):(t.tprec=i.nicePrecision(x),k=i.niceNumber(2*x,-w,!0),k<x&&(k=i.niceNumber(x,-w+1,!1)),k<x&&(k=i.niceTickNumber(x)))),e.unitMajor=k}a&&e.unitMajor&&!isNaN(e.unitMajor)&&(e.unitMinor=e.unitMajor/2)},t}(e.wijmoWidget);t.wijchartcore=u;var a=function(){function e(){this.width=null,this.height=null,this.wijCSS={headerText:"wijchart-header-text",headerContainer:"wijchart-header-container",footerText:"wijchart-footer-text",footerContainer:"wijchart-footer-container",legendTitle:"wijchart-legend-title",legendText:"wijchart-legend-text",legend:"wijchart-legend",legendDot:"chart-legend-dot",legendIcon:"wijchart-legend-icon",legendContainer:"wijchart-legend-container",legendTextCover:"wijchart-legend-textCover",axis:"wijchart-axis",axisText:"wijchart-axis-text",axisGridLine:"wijchart-axis-gridline",axisTick:"wijchart-axis-tick",axisLabel:"wijchart-axis-label",labelText:"wijchart-label-text",labelConnect:"wijchart-label-connect",canvasObject:"wijchart-canvas-object"},this.culture="",this.seriesList=[],this.seriesStyles=[{stroke:"#00cc00",opacity:.9,"stroke-width":1},{stroke:"#0099cc",opacity:.9,"stroke-width":1},{stroke:"#0055cc",opacity:.9,"stroke-width":1},{stroke:"#2200cc",opacity:.9,"stroke-width":1},{stroke:"#8800cc",opacity:.9,"stroke-width":1},{stroke:"#d9007e",opacity:.9,"stroke-width":1},{stroke:"#ff0000",opacity:.9,"stroke-width":1},{stroke:"#ff6600",opacity:.9,"stroke-width":1},{stroke:"#ff9900",opacity:.9,"stroke-width":1},{stroke:"#ffcc00",opacity:.9,"stroke-width":1},{stroke:"#ffff00",opacity:.9,"stroke-width":1},{stroke:"#ace600",opacity:.9,"stroke-width":1}],this.seriesHoverStyles=[{opacity:1,"stroke-width":1.5},{opacity:1,"stroke-width":1.5},{opacity:1,"stroke-width":1.5},{opacity:1,"stroke-width":1.5},{opacity:1,"stroke-width":1.5},{opacity:1,"stroke-width":1.5},{opacity:1,"stroke-width":1.5},{opacity:1,"stroke-width":1.5},{opacity:1,"stroke-width":1.5},{opacity:1,"stroke-width":1.5},{opacity:1,"stroke-width":1.5},{opacity:1,"stroke-width":1.5}],this.marginTop=25,this.marginRight=25,this.marginBottom=25,this.marginLeft=25,this.textStyle={fill:"#888","font-size":10,stroke:"none"},this.header={text:"",style:{fill:"none",stroke:"none"},textStyle:{"font-size":18,fill:"#666",stroke:"none"},compass:"north",visible:!0},this.footer={text:"",style:{fill:"#fff",stroke:"none"},textStyle:{fill:"#000",stroke:"none"},compass:"south",visible:!1},this.legend={text:"",textMargin:{left:2,top:2,right:2,bottom:2},style:{fill:"none",stroke:"none"},textWidth:null,textStyle:{fill:"#333",stroke:"none"},titleStyle:{"font-weight":"bold",fill:"#000",stroke:"none"},compass:"east",orientation:"vertical",visible:!0},this.axis={x:{alignment:"center",style:{stroke:"#999999","stroke-width":.5},visible:!0,textVisible:!0,text:"",textStyle:{fill:"#888","font-size":15,"font-weight":"bold"},labels:{style:{fill:"#333","font-size":11},textAlign:"near",width:null},compass:"south",autoMin:!0,autoMax:!0,min:null,max:null,origin:null,autoMajor:!0,autoMinor:!0,unitMajor:null,unitMinor:null,gridMajor:{visible:!1,style:{stroke:"#CACACA","stroke-dasharray":"- "}},gridMinor:{visible:!1,style:{stroke:"#CACACA","stroke-dasharray":"- "}},tickMajor:{position:"none",style:{fill:"black"},factor:1},tickMinor:{position:"none",style:{fill:"black"},factor:1},annoMethod:"values",annoFormatString:"",valueLabels:[]},y:{alignment:"center",style:{stroke:"#999999","stroke-width":.5},visible:!1,textVisible:!0,text:"",textStyle:{fill:"#888","font-size":15,"font-weight":"bold"},labels:{style:{fill:"#333","font-size":11},textAlign:"center",width:null},compass:"west",autoMin:!0,autoMax:!0,min:null,max:null,origin:null,autoMajor:!0,autoMinor:!0,unitMajor:null,unitMinor:null,gridMajor:{visible:!0,style:{stroke:"#999999","stroke-width":.5,"stroke-dasharray":"none"}},gridMinor:{visible:!1,style:{stroke:"#CACACA","stroke-dasharray":"- "}},tickMajor:{position:"none",style:{fill:"black"},factor:1},tickMinor:{position:"none",style:{fill:"black"},factor:1},annoMethod:"values",annoFormatString:"",valueLabels:[]}},this.hint={enable:!0,content:null,contentStyle:{fill:"#d1d1d1","font-size":16},title:null,titleStyle:{fill:"#d1d1d1","font-size":16},style:{fill:"#000000","stroke-width":2},animated:"fade",showAnimated:"fade",hideAnimated:"fade",duration:120,showDuration:120,hideDuration:120,easing:"",showEasing:"",hideEasing:"",showDelay:0,hideDelay:150,compass:"north",offsetX:0,offsetY:0,showCallout:!0,calloutFilled:!1,calloutFilledStyle:{fill:"#000"}},this.indicator={visible:!1,style:{stroke:"#000000"}},this.showChartLabels=!0,this.chartLabelStyle={},this.chartLabelFormatString="",this.disableDefaultTextStyle=!1,this.shadow=!0,this.dataSource=null,this.data=null,this.beforeSeriesChange=null,this.seriesChanged=null,this.beforePaint=null,this.painted=null}return e}();u.prototype.options=n.extend(!0,{},e.wijmoWidget.prototype.options,new a)})(e.chart||(e.chart={}));var t=e.chart})(wijmo||(wijmo={}));;
var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(e){var t=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype._create=function(){var t=this,n=t.options,r=t._getDefFill(),i;n.horizontal&&(i=n.axis.y.compass||"south",n.axis.y.compass=n.axis.x.compass||"west",n.axis.x.compass=i),$.extend(!0,{compass:"east"},n.hint),t._handleChartStyles(),r=null,e.prototype._create.call(this),t.chartElement.addClass(n.wijCSS.barChart)},t.prototype._setOption=function(t,n){t==="horizontal"&&$.extend(!0,this.options.axis,{x:{compass:n?"west":"south"},y:{compass:n?"south":"west"}}),e.prototype._setOption.call(this,t,n)},t.prototype.destroy=function(){var t=this,n=t.options,r=t.chartElement,i=r.data("fields"),s=i&&i.bars;r.removeClass(n.wijCSS.barChart),e.prototype.destroy.call(this),s&&s.length&&$.each(s,function(e,t){t=null}),r.data("fields",null)},t.prototype._clearChartElement=function(){var t=this,n=t.options,r=t.chartElement.data("fields");e.prototype._clearChartElement.call(this),t.element.removeData("plotInfos"),n.seriesTransition.enabled||r&&r.aniBarsAttr&&(r.aniBarsAttr=null)},t.prototype._isBarChart=function(){return!0},t.prototype.getBar=function(e){var t=this.chartElement,n=t.data("fields");return n.chartElements.bars[e]},t.prototype._paintTooltip=function(){var t=this,n=t.chartElement,r=n.data("fields");e.prototype._paintTooltip.call(this),t.tooltip&&r&&r.trackers&&r.trackers.length&&(t.tooltip.setTargets(r.trackers),t.tooltip.setOptions({relatedElement:r.trackers[0]}))},t.prototype._getTooltipText=function(e,t){var n=$(t.node),r,i;return n.data("owner")&&(n=n.data("owner")),r=n.data("wijchartDataObj"),i={data:r,value:r.value,label:r.label,total:r.total,target:t,fmt:e,x:r.x,y:r.y},$.proxy(e,i)()},t.prototype._preHandleSeriesData=function(){e.prototype._preHandleSeriesData.call(this);var t=this,n=t.options,r=n.seriesList;$.each(r,function(e,n){var r=n.data;r.y&&$.each(r.y,function(e,n){try{t._isDate(n)||(r.y[e]=parseFloat(n))}catch(i){r.y[e]=1}})})},t.prototype._paintPlotArea=function(){var e=this,t=e.options;this.barchartRender=new i(this.chartElement,{canvas:e.canvas,bounds:e.canvasBounds,tooltip:e.tooltip,widgetName:e.widgetName,horizontal:t.horizontal,stacked:t.stacked,axis:t.axis,seriesList:t.seriesList,seriesStyles:t.seriesStyles,seriesHoverStyles:t.seriesHoverStyles,seriesTransition:t.seriesTransition,showChartLabels:t.showChartLabels,textStyle:t.textStyle,chartLabelStyle:t.chartLabelStyle,chartLabelFormatString:t.chartLabelFormatString,shadow:t.shadow,disabled:t.disabled,clusterOverlap:t.clusterOverlap,clusterWidth:t.clusterWidth,clusterSpacing:t.clusterSpacing,is100Percent:t.is100Percent,clusterRadius:t.clusterRadius,animation:t.animation,culture:e._getCulture(),isYTime:e.axisInfo.y[0].isTime,isXTime:e.axisInfo.x.isTime,mouseDown:$.proxy(e._mouseDown,e),mouseUp:$.proxy(e._mouseUp,e),mouseOver:$.proxy(e._mouseOver,e),mouseOut:$.proxy(e._mouseOut,e),mouseMove:$.proxy(e._mouseMove,e),click:$.proxy(e._click,e),wijCSS:t.wijCSS,widget:this}),this.barchartRender.render()},t.prototype._showSerieEles=function(e){var t=this.options.stacked,n=-1;$.each(e,function(e,t){t&&t.bar&&(t.bar.show(),t.bar.shadow&&t.bar.shadow.show(),t.bar.tracker&&t.bar.tracker.show(),$(t.bar.node).data("wijchartDataObj")&&($(t.bar.node).data("wijchartDataObj").visible=!0)),t&&t.dcl&&t.dcl.show(),t&&t.animatedBar&&!t.animatedBar.removed&&t.animatedBar.show(),t.sIndex&&(n=t.sIndex)}),t&&this.stackedSeriesObjs&&this._handleStackedVisible(e.length)},t.prototype._hideSerieEles=function(e){var t=this.options.stacked,n=-1,r=e.length;$.each(e,function(e,t){t&&t.bar&&(t.bar.hide(),t.bar.shadow&&t.bar.shadow.hide(),t.bar.tracker&&t.bar.tracker.hide(),$(t.bar.node).data("wijchartDataObj")&&($(t.bar.node).data("wijchartDataObj").visible=!1)),t&&t.dcl&&t.dcl.hide(),t&&t.animatedBar&&!t.animatedBar.removed&&t.animatedBar.hide(),t.sIndex&&(n=t.sIndex)}),t&&this.stackedSeriesObjs&&this._handleStackedVisible(e.length)},t.prototype._handleStackedVisible=function(e){function n(e){return $(e.bar.node).data("wijchartDataObj").visible!==!1}function r(e,t,n){e&&(e.bar&&(e.bar.attr("x",t),e.bar.attr("width",n)),e.bar.shadow&&(e.bar.shadow.attr("x",t),e.bar.shadow.attr("width",n)),e.bar.tracker&&(e.bar.tracker.attr("x",t),e.bar.tracker.attr("width",n)))}function i(e,t,n){e&&(e.bar&&(e.bar.attr("y",t),e.bar.attr("height",n)),e.bar.shadow&&(e.bar.shadow.attr("y",t),e.bar.shadow.attr("height",n)),e.bar.tracker&&(e.bar.tracker.attr("y",t),e.bar.tracker.attr("height",n)))}function s(e){if(e){var t=e.rect.x,n=e.rect.width;e.bar&&(e.bar.attr("x",t),e.bar.attr("width",n)),e.bar.shadow&&(e.bar.shadow.attr("x",t),e.bar.shadow.attr("width",n)),e.bar.tracker&&(e.bar.tracker.attr("x",t),e.bar.tracker.attr("width",n))}}function o(e){if(e){var t=e.rect.y,n=e.rect.height;e.bar&&(e.bar.attr("y",t),e.bar.attr("height",n)),e.bar.shadow&&(e.bar.shadow.attr("y",t),e.bar.shadow.attr("height",n)),e.bar.tracker&&(e.bar.tracker.attr("y",t),e.bar.tracker.attr("height",n))}}var t=this;if(this.stackedSeriesObjs){$.each(this.stackedSeriesObjs,function(e,n){t.options.horizontal?s(n):o(n)});var u=[],a=this.element.data("fields").seriesEles.length;for(var f=0;f<a;f++)u.push(n(this.stackedSeriesObjs[f+"0"]));var l=[],c=-1,h=-1,p=-1;for(var f=u.length-1;f>=0;f--)u[f]&&(p-f>1&&l.push({start:p,end:f+1}),p=f);p>0&&l.push({start:p,end:0}),$.each(l,function(n,s){var o=s.start,u=s.end,a,f,l,c,h,p;for(var n=0;n<e;n++)a=t.stackedSeriesObjs[o+""+n],f=t.stackedSeriesObjs[u+""+n],t.options.horizontal?(l=f.rect.x,h=a.rect.width+a.rect.x-f.rect.x,r(a,l,h)):(l=a.rect.y,h=f.rect.height+f.rect.y-a.rect.y,i(a,l,h))})}},t.prototype._indicatorLineShowing=function(t){e.prototype._indicatorLineShowing.call(this,t),$.each(t,function(e,t){t.bar&&t.bar.attr(t.hoverStyle)})},t.prototype._removeIndicatorStyles=function(e){$.each(e,function(e,t){t.bar&&t.bar.attr(t.style)})},t.prototype._supportStacked=function(){return!0},t.prototype._calculateParameters=function(t,n){e.prototype._calculateParameters.call(this,t,n);if(t.id==="x"){var r=n.unitMinor,i=this._getBarAdjustment(t);i===0?i=r:r<i&&r!==0&&(i=Math.floor(i/r)*r),t.min-=i,t.max+=i,this._calculateMajorMinor(n,t)}},t.prototype._getBarAdjustment=function(e){var t=0,n=this.options,r=e.max,i=e.min,s=n.seriesList,o=0,u=0;for(o=0;o<s.length&&s[o].data.x;o++)u=s[o].data.x.length,t<u&&(t=u);return t>1?(r-i)/t*n.clusterWidth*.0125:t===1?(i===0&&r===1&&(i=-1,e.min=i),(r-i)*.0125):0},t}(e.wijchartcore);e.wijbarchart=t;var n=function(){function e(){this.initSelector=":jqmData(role='wijbarchart')",this.wijCSS={barChart:"wijmo-wijbarchart",barLabel:"wijbarchart-label",barElement:"wijbarchart",barTracker:"bartracker"},this.horizontal=!0,this.stacked=!1,this.is100Percent=!1,this.clusterOverlap=0,this.clusterWidth=85,this.clusterRadius=0,this.clusterSpacing=0,this.animation={enabled:!0,duration:400,easing:">"},this.seriesTransition={enabled:!0,duration:400,easing:">"},this.mouseDown=null,this.mouseUp=null,this.mouseOver=null,this.mouseOut=null,this.mouseMove=null,this.click=null}return e}();t.prototype.options=$.extend(!0,{},e.wijchartcore.prototype.options,new n),t.prototype.widgetEventPrefix="wijbarchart",$.wijmo.registerWidget("wijbarchart",t.prototype);var r=function(){function e(e){this.x=e,this.paSpec=[]}return e.prototype.stackValues=function(){var e=this,t=e.paSpec.length,n;t>1&&(n=e.paSpec[0],$.each(e.paSpec,function(e,t){if(e===0)return!0;t.y+=n.y,n=t}))},e}(),i=function(){function t(e,t){this.options=t,this.element=e,this._init()}return t.prototype._init=function(){var t=this.options,n=t.horizontal,r=t.axis.x,i=t.bounds;this.startLocation={x:i.startX,y:i.startY},this.width=i.endX-this.startLocation.x,this.height=i.endY-this.startLocation.y,this.nSeries=t.seriesList.length,this.seriesList=$.arrayClone(t.seriesList),this.seriesStyles=[].concat(t.seriesStyles.slice(0,this.nSeries)),this.seriesHoverStyles=[].concat(t.seriesHoverStyles.slice(0,this.nSeries)),this.xscale=e.ChartUtil.getScaling(n,r.max,r.min,n?this.height:this.width),this.xlate=e.ChartUtil.getTranslation(n,this.startLocation,r.max,r.min,this.xscale),this.fields=this.element.data("fields")||{},this.chartElements=this.fields.chartElements||{},this.aniBarsAttr=this.fields.aniBarsAttr,this.canvas=t.canvas},t.prototype._paintShadow=function(t,n,r){this.options.shadow&&e.ChartUtil.paintShadow(t,n,r)},t.prototype.getMinDX=function(e){var t=Number.MAX_VALUE,n=e.length,r,i;for(r=1;r<n;r++)i=e[r].x-e[r-1].x,i<t&&i>0&&(t=i);return t===Number.MAX_VALUE?2:t},t.prototype.stackValues=function(e){return $.each(e,function(e,t){t.stackValues()}),e},t.prototype.barPointList=function(t){function s(e,t){var s=i(t),o=t.length,u=null,a=0,f=0,l=0,c=!0,h=0,p=!1;s&&(a=s.length),n&&(l=n.length);if(s===undefined)return;$.each(s,function(t,i){c?(c=!1,h=i.x):(h===i.x?p=!0:p=!1,h=i.x);while(f<l&&n[f].x<i.x)f++;f<l?n[f].x!==i.x?(u=new r(i.x),n.splice(f,0,u),l=n.length):u=n[f]:(u=new r(i.x),n.push(u),l=n.length),u.paSpec.push({y:i.y,sIdx:e,pIdx:t,dupl:p})})}var n=[],i=e.ChartUtil.getXSortedPoints;return $.each(t,function(e,t){s(e,t)}),n},t.prototype.adjustToLimits=function(e,t,n){return e<t?t:e>n?n:e},t.prototype.transformPoints=function(e,t,n,r,i,s){return $.each(s,function(s,o){var u=o.x,a=o.y,f=0;o.x=t*u+r,o.y=n*a+i,e&&(f=o.x,o.x=o.y,o.y=f)}),s},t.prototype.paintDefaultChartLabel=function(e,t,n,r){var i=this.options,s=i.horizontal,o=i.canvas,u=i.wijCSS,a=i.culture,f=$.extend(!0,{},i.textStyle,i.chartLabelStyle),l=s?{x:e.x+e.width,y:e.y+e.height/2}:{x:e.x+e.width/2,y:e.y},c=i.chartLabelFormatString,h,p,d=this.options.widget,v=t;return r&&(f=$.extend(!0,f,r)),n&&(v=$.fromOADate(t)),c&&c.length?v=Globalize.format(v,i.chartLabelFormatString,a):n||(v=$.round(v,2)),p=d._text.call(d,l.x,l.y,v).attr(f),$.wijraphael.addClass($(p.node),u.barLabel),h=p.getBBox(),s?p.attr({x:l.x+h.width/2}):p.attr({y:l.y-h.height/2}),p},t.prototype.paintBar=function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){var v=this.options,m=v.stacked,g=v.horizontal,y=v.is100Percent,b=r.min,w=r.max,E=i.min,S=i.max,x=r.scale,T=r.late,N=i.scale,C=i.late,k,L,A,O,M=null,_,D=s,P=s["stroke-width"],H=s.stroke,B,j,F,I,q=-1;d.origin!==null&&(q=N*d.origin+C);if(m)if(y){c>0&&(e.height=t/c);if(l||l===0)e.y=l/c,e.height-=e.y}else{e.height=t;if(l||l===0)e.height-=l,e.y=l}else if(l||l===0)e.x+=e.width*(1-f),e.height=t;L=[{x:e.x,y:e.y},{x:e.x+e.width,y:e.y+e.height}],A=(b<=L[0].x&&L[0].x<=w||b<=L[1].x&&L[1].x<=w)&&(E<=L[0].y&&L[0].y<=S||E<=L[1].y&&L[1].y<=S),L[0].x=this.adjustToLimits(L[0].x,b,w),L[0].y=this.adjustToLimits(L[0].y,E,S),L[1].x=this.adjustToLimits(L[1].x,b,w),L[1].y=this.adjustToLimits(L[1].y,E,S),L=this.transformPoints(g,x,N,T,C,L),L[0].x>L[1].x&&(k=L[0].x,L[0].x=L[1].x,L[1].x=k),L[0].y>L[1].y&&(k=L[0].y,L[0].y=L[1].y,L[1].y=k),O={x:L[0].x,y:L[0].y,width:L[1].x-L[0].x,height:L[1].y-L[0].y},A&&!m&&(O.width===0&&(O.width=1),O.height===0&&(O.height=1,O.y-=1)),v.showChartLabels&&(M=this.paintDefaultChartLabel(O,t,h,p)),_=s.r?s.r:v.clusterRadius,_&&(D=$.extend(!0,{},s,{r:0})),H!=="none"&&P&&(P=parseInt(P,10));if(!P||isNaN(P))P=0;return j=O.width,F=O.height,P>1&&(P--,j=O.width-P,F=O.height-P/2,O.x+=P/2),j<0&&(j=0),F<0&&(F=0),o?(q===-1&&(g?q=a.x+P/2:q=a.y+n-P/2),_?(g?(t>d.origin?B=this.canvas.roundRect(O.x,O.y,j,F,0,0,_,_).hide():B=this.canvas.roundRect(O.x,O.y,j,F,_,_,0,0).hide(),I=this.canvas.rect(q,O.y,O.width,O.height)):(t>d.origin?B=this.canvas.roundRect(O.x,O.y,j,F,_,0,0,_).hide():B=this.canvas.roundRect(O.x,O.y,j,F,0,_,_,0).hide(),I=this.canvas.rect(O.x,q,O.width,O.height)),this._paintShadow(I,u),I.wijAttr(D),I.bar=B):(g?B=this.canvas.rect(q,O.y,O.width,F):B=this.canvas.rect(O.x,q,j,O.height),I=B),M&&(M.attr({opacity:0}),I.chartLabel=M),I.left=O.x,I.top=O.y,I.width=j,I.height=F,I.r=_):_?g?t>d.origin?B=this.canvas.roundRect(O.x,O.y,j,F,0,0,_,_):B=this.canvas.roundRect(O.x,O.y,j,F,_,_,0,0):t>d.origin?B=this.canvas.roundRect(O.x,O.y,j,F,_,0,0,_):B=this.canvas.roundRect(O.x,O.y,j,F,0,_,_,0):B=this.canvas.rect(O.x,O.y,j,F),this._paintShadow(B,u),o&&_&&B.shadow&&B.shadow.hide(),B.wijAttr(s),{rect:O,dcl:M,animatedBar:I,bar:B}},t.prototype.paintClusters=function(t,n,r,i,s,o,u,a,f,l){var c=this,h=c.options,p=h.clusterOverlap/100,d=h.clusterWidth/100,v=1,m=h.clusterSpacing+v,g=t.length,y=h.canvas,b=h.stacked,w=h.horizontal,E=h.axis.y,S=h.widget,x=h.wijCSS,T=h.animation&&h.animation.enabled,N,C,k,L=[],A=[],O=[],M=[],_=[],D=[],P=y.set(),H,B=0;return f||l?($.each(t,function(e,t){var n=$.extend(!0,{},t);n.data&&n.data.y&&n.data.y.length&&f&&$.each(n.data.y,function(e,t){n.data.y[e]=$.toOADate(t)}),n.data&&n.data.x&&n.data.x.length&&l&&$.each(n.data.x,function(e,t){n.data.x[e]=$.toOADate(t)}),_.push(n)}),N=c.barPointList(_)):N=c.barPointList(t),b&&(N=c.stackValues(N)),C=c.getMinDX(N)*d,$.each(n,function(e,t){t["stroke-width"]&&!isNaN(t["stroke-width"])&&(B!==0?B=Math.min(parseFloat(t["stroke-width"]),B):B=parseFloat(t["stroke-width"]))}),g>1&&!b&&(p-=N.length*(g-1)*(m+B*2)/(w?u:o),C/=g*(1-p)+p),$.each(N,function(l,d){var m=d.paSpec,g=m.length,y,N,_,B;b?y=C:y=C*(g*(1-p)+p),N={x:d.x-y/2,y:0,width:C,height:m[0].y},$.each(m,function(l,d){if(N.height===undefined)return!0;var g=d.sIdx,y=d.pIdx,b=n[g],C=t[g],j,F=C.yAxis||0,I=E[F]||E,q=s[F]||s;M[g]||(M[g]=[]),D[g]||(D[g]=[]),c.yscale=e.ChartUtil.getScaling(!w,I.max,I.min,w?o:u),c.ylate=e.ChartUtil.getTranslation(!w,a,I.max,I.min,c.yscale),q.late=c.ylate,q.scale=c.yscale,B=c.paintBar(N,d.y,u,i,q,b,T,v,a,p,l>0?m[l-1].y:null,m[m.length-1].y,f,C.textStyle,I),_=B.bar,j=_.clone().attr({opacity:.01,fill:"white","stroke-width":0,"fill-opacity":.01}),C.visible===!1&&(_.hide(),B.dcl&&B.dcl.hide(),j.hide(),_.shadow&&_.shadow.hide()),$.wijraphael.addClass($(_.node),x.canvasObject+" "+x.barElement),H=$.extend(!1,{index:y,bar:_,type:"bar",style:b,hoverStyle:r[g],x:C.data.x[y],y:C.data.y[y],visible:!0},C),$(_.node).data("wijchartDataObj",H),S.dataPoints=S.dataPoints||{},S.pointXs=S.pointXs||[],h.horizontal?k=$.round(B.rect.y+B.rect.height/2,2):k=$.round(B.rect.x+B.rect.width/2,2),S.dataPoints[k.toString()]||(S.dataPoints[k.toString()]=[],S.pointXs.push(k)),S.dataPoints[k.toString()].push(H),$(j.node).data("owner",$(_.node)),$.wijraphael.addClass($(j.node),x.barElement+" "+x.barTracker),B.bar.tracker=j,P.push(j),A.push(_),B.animatedBar&&O.push(B.animatedBar),B.dcl&&L.push(B.dcl),M[g][y]=B.rect,D[g][y]=B,_=null,j=null})}),$.each(L,function(e,t){t.toFront()}),P.toFront(),{bars:A,animatedBars:O,rects:M,chartLabels:L,seriesEles:D,trackers:P}},t.prototype.processStackedElement=function(e){var t={};$.each(e,function(e,n){$.each(n,function(n,r){r.sIndex=e,r.stackIndex=n,t[e+""+n]=r})}),this.options.widget.stackedSeriesObjs=t},t.prototype.playAnimation=function(t){var n=this,r=n.options,i=r.animation,s=i&&i.enabled,o=r.horizontal,u=r.seriesTransition,a,f,l=[],c,h=r.chartLabelStyle;s&&(a=i.duration||2e3,f=i.easing||"linear",$.each(t,function(t,r){var i;o?(r.wijAttr({width:0}),i={width:r.width,x:r.left}):(r.wijAttr({height:0}),i={height:r.height,y:r.top}),n.aniBarsAttr&&u.enabled&&n.aniBarsAttr.length>t&&(c=e.ChartUtil.getDiffAttrs(n.aniBarsAttr[t],r.attr()),o?(c.x=n.aniBarsAttr[t].x,c.width=n.aniBarsAttr[t].width):(c.y=n.aniBarsAttr[t].y,c.height=n.aniBarsAttr[t].height),c.path&&delete c.path,r.attr(c),a=u.duration,f=u.easing),l.push($.extend(!0,{},r.attr(),i)),r.tracker&&r.tracker.hide(),r.stop().wijAnimate(i,a,f,function(){var e=this,t=e.r,n=e;e.chartLabel&&(h&&h.opacity?e.chartLabel.wijAnimate({opacity:h.opacity},250):e.chartLabel.wijAnimate({opacity:1},250)),e.tracker&&(e.tracker.show(),e.tracker.attr({width:e.width,height:e.height,x:e.attr("x"),y:e.attr("y")})),t&&(n=e.bar,n.show(),n.shadow&&n.shadow.show(),e.shadow&&(e.shadow.wijRemove(),e.shadow=null),e.wijRemove(),e=null)})}),n.aniBarsAttr=l)},t.prototype.bindLiveEvents=function(){var e=this.options,t=e.wijCSS,n=e.widgetName,r=e.disabled,i=e.mouseDown,s=e.mouseUp,o=e.mouseOver,u=e.mouseOut,a=e.mouseMove,f=e.click,l=this.element,c=$.isFunction;$("."+t.barElement,l[0]).on("mousedown."+n,function(e){if(r)return;if(c(i)){var t=$(e.target),n;t.data("owner")&&(t=t.data("owner")),n=t.data("wijchartDataObj"),i.call(l,e,n),n=null}}).on("mouseup."+n,function(e){if(r)return;if(c(s)){var t=$(e.target),n;t.data("owner")&&(t=t.data("owner")),n=t.data("wijchartDataObj"),s.call(l,e,n),n=null}}).on("mouseover."+n,function(e){if(r)return;if(c(o)){var t=$(e.target),n,i;t.data("owner")&&(t=t.data("owner")),n=t.data("wijchartDataObj"),i=n.bar,n.hoverStyle?(n.initTransform=i.matrix.toTransformString(),i.wijAttr(n.hoverStyle)):i&&i.wijAttr({opacity:"0.8"}),o.call(l,e,n),n=null}}).on("mouseout."+n,function(e){if(r)return;var t=$(e.target),n,i;t.data("owner")&&(t=t.data("owner")),n=t.data("wijchartDataObj"),i=n.bar,n.hoverStyle?(i.transform(""),i.shadow&&i.shadow.transform(""),i.wijAttr(n.style)):i&&i.wijAttr({opacity:"1"}),c(u)&&u.call(l,e,n),n=null}).on("mousemove."+n,function(e){if(r)return;var t=$(e.target),n,i;t.data("owner")&&(t=t.data("owner")),n=t.data("wijchartDataObj"),i=n.bar,c(a)&&a.call(l,e,n),n=null}).on("click."+n,function(e){if(r)return;if(c(f)){var t=$(e.target),n;t.data("owner")&&(t=t.data("owner")),n=t.data("wijchartDataObj"),f.call(l,e,n)}})},t.prototype.unbindLiveEvents=function(){var e=this.options,t=e.widgetName,n=e.wijCSS,r=this.element;$("."+n.barElement,r[0]).off(t).off("."+t)},t.prototype.render=function(){var e=this.options,t=e.horizontal,n=e.stacked,r=this.seriesList,i=this.seriesStyles,s=this.seriesHoverStyles,o=e.axis.x,u=e.axis.y,a=e.isYTime,f=e.isXTime,l;this.unbindLiveEvents(),t&&!n&&(r.reverse(),i.reverse(),s.reverse());if(this.nSeries===0)return;l=this.paintClusters(r,i,s,{min:o.min,max:o.max,late:this.xlate,scale:this.xscale},u,this.width,this.height,this.startLocation,a,f),this.element.data("plotInfos",{xscale:this.xscale,xlate:this.xlate,yscale:this.yscale,ylate:this.ylate,rects:l.rects}),this.playAnimation(l.animatedBars),this.chartElements.bars=l.bars,this.chartElements.animatedBars=l.animatedBars,this.chartElements.chartLabels=l.chartLabels,this.fields.seriesEles=l.seriesEles,this.fields.trackers=l.trackers,this.fields.chartElements||(this.fields.chartElements={}),t&&!n&&this.fields.seriesEles.reverse(),n&&this.processStackedElement(this.fields.seriesEles),$.extend(!0,this.fields.chartElements,this.chartElements),this.fields.aniBarsAttr=this.aniBarsAttr,this.element.data("fields",this.fields),this.bindLiveEvents()},t}();e.BarChartRender=i})(e.chart||(e.chart={}));var t=e.chart})(wijmo||(wijmo={}));;
var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(e){var t=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype._create=function(){var t=this.options;this._handleChartStyles(),e.prototype._create.call(this),this.chartElement.addClass(t.wijCSS.lineChart),t.type==="area"&&this.chartElement.addClass(t.wijCSS.areaChart)},t.prototype.destroy=function(){var t=this.options;this.chartElement.removeClass(t.wijCSS.lineChart),t.type==="area"&&this.chartElement.removeClass(t.wijCSS.areaChart),e.prototype.destroy.call(this),this.aniPathsAttr&&this.aniPathsAttr.length&&($.each(this.aniPathsAttr,function(e,t){t=null}),this.aniPathsAttr=null)},t.prototype.getLinePath=function(e){var t=this.chartElement.data("fields"),n,r;if(t&&t.chartElements){n=t.chartElements;if(n.paths&&n.paths.length)return n.paths[e]}return r},t.prototype.getLineMarkers=function(e){var t=this.options,n=this.chartElement.data("fields"),r,i;if(t.seriesList&&t.seriesList[e].markers&&t.seriesList[e].markers.visible&&n&&n.chartElements){r=n.chartElements;if(r.markersSet&&r.markersSet.length)return r.markersSet[e]}return i},t.prototype._showSerieEles=function(e){var t=this.options,n;e.markers&&$.each(e.markers,function(e,t){var n=$(t.node).data("wijchartDataObj");if(n&&n.lineSeries&&n.lineSeries.markers&&!n.lineSeries.markers.visible)return!0;t.show()}),e.dcl&&$.each(e.dcl,function(e,n){t.showChartLabels&&n.show()}),e.path&&(n=$(e.path.node).data("wijchartDataObj"),n.visible&&(e.path.show(),e.path.shadow&&e.path.shadow.show(),e.path.area&&e.path.area.show(),e.path.tracker&&e.path.tracker.show()),$(e.path.node).data("wijchartDataObj")&&$(e.path.node).data("wijchartDataObj").virtualMarkers&&$.each($(e.path.node).data("wijchartDataObj").virtualMarkers,function(e,t){t.visible=!0}))},t.prototype._hideSerieEles=function(e){e.markers&&$.each(e.markers,function(e,t){t.hide()}),e.dcl&&$.each(e.dcl,function(e,t){t.hide()}),e.path&&(e.path.hide(),e.path.shadow&&e.path.shadow.hide(),e.path.area&&e.path.area.hide(),e.path.tracker&&e.path.tracker.hide(),$(e.path.node).data("wijchartDataObj")&&$(e.path.node).data("wijchartDataObj").virtualMarkers&&$.each($(e.path.node).data("wijchartDataObj").virtualMarkers,function(e,t){t.visible=!1}))},t.prototype._supportStacked=function(){return!0},t.prototype._indicatorLineShowing=function(t){e.prototype._indicatorLineShowing.call(this,t),$.each(t,function(e,t){t.marker&&t.marker.attr(t.markerHoverStyle)})},t.prototype._removeIndicatorStyles=function(e){$.each(e,function(e,t){t.marker&&(t.marker.attr(t.markerStyle),t.marker.transform("s1"))})},t.prototype._mouseDownInsidePlotArea=function(t,n){e.prototype._mouseDownInsidePlotArea.call(this,t,n),this._clearHoverState(!0)},t.prototype._mouseDown=function(t,n){e.prototype._mouseDown.call(this,t,n)},t.prototype._mouseUp=function(t,n){e.prototype._mouseUp.call(this,t,n)},t.prototype._mouseOver=function(t,n){if(!n||n.type!=="line"&&n.type!=="marker")return;if(this.indicatorLine)return;e.prototype._mouseOver.call(this,t,n),n.type==="marker"&&(n=n.lineSeries);if(n.path.removed)return;if(this.hoverLine!==n||this.hoverLine===null)this.isNewLine=!0,this.hoverLine&&(this.hoverLine.path.removed||(this.options.type==="line"&&this.hoverLine.lineStyle.fill&&delete this.hoverLine.lineStyle.fill,this.hoverLine.path.wijAttr(this.hoverLine.lineStyle),this.hoverPoint&&!this.hoverPoint.isSymbol&&(this.hoverPoint.marker.wijAttr(this.hoverPoint.markerStyle),this.hoverPoint.marker.transform("s1")))),n.lineHoverStyle&&n.path.wijAttr(n.lineHoverStyle),this.hoverLine=n,this.hoverPoint=null,this.hoverVirtualPoint=null},t.prototype._mouseOut=function(t,n){e.prototype._mouseOut.call(this,t,n)},t.prototype._mouseMove=function(t,n){e.prototype._mouseMove.call(this,t,n)},t.prototype._click=function(t,n){e.prototype._click.call(this,t,n)},t.prototype._mouseMoveInsidePlotArea=function(t,n){var r=this,i=this.tooltip,s=this.options.hint,o,u,a=0,f,l,c,h,p=null,d=null,v=null,m=s.title,g=s.content,y=$.isFunction(m),b=$.isFunction(g),w=0;i&&(v=i.getOptions());if(this.hoverLine&&!this.indicatorLine){this.isNewLine&&(s.enable&&i&&i.hide(),this.isNewLine=!1),o=this.hoverLine.lineMarkers,u=this.hoverLine.virtualMarkers,a=-1,f={x:0,y:0};if(o&&o.length){$.each(o,function(e,t){if(t.removed)return!0;var r=t.wijGetBBox(),i=r.x+r.width/2,s=Math.abs(i-n.left);if(e===0||s<w)w=s,a=e,f={x:i,y:r.y+r.height/2}});if(this.hoverPoint&&this.hoverPoint.index===a)return;if(a>-1){if(o[a].removed)return;l=$(o[a].node).data("wijchartDataObj"),l&&(this.hoverPoint&&!this.hoverPoint.isSymbol&&(this.hoverPoint.removed||(this.hoverPoint.marker.wijAttr(this.hoverPoint.markerStyle),this.hoverPoint.marker.transform("s1"))),l.isSymbol||l.marker.removed||l.marker.wijAttr(l.markerHoverStyle)),this.hoverPoint=l,this.hoverVirtualPoint=u[a]}}else{$.each(u,function(e,t){var r=Math.abs(t.x-n.left);if(e===0||r<w)w=r,a=e,f={x:t.x,y:t.y}});if(this.hoverVirtualPoint&&this.hoverVirtualPoint.index===a)return;a>-1&&(this.hoverPoint=null,this.hoverVirtualPoint=u[a])}if(i){d=this.hoverVirtualPoint,c=d.valX,h=d.valY;if(y||b)y&&(v.title=function(){var e={pointIndex:a,lineIndex:r.hoverLine.index,x:c,y:h,label:r.hoverLine.label,data:d,fmt:m},t=$.proxy(e.fmt,e),n=t();return n}),b&&(v.content=function(){var e={pointIndex:a,lineIndex:r.hoverLine.index,x:c,y:h,label:r.hoverLine.label,data:d,fmt:g},t=$.proxy(e.fmt,e),n=t();return n});p=$.extend({stroke:this.hoverLine.path.attr("stroke")},s.style),v.style.stroke=p.stroke,i.showAt(f)}}e.prototype._mouseMoveInsidePlotArea.call(this,t,n)},t.prototype._mouseMoveOutsidePlotArea=function(t,n){this._clearHoverState(!1),e.prototype._mouseMoveOutsidePlotArea.call(this,t,n)},t.prototype._clearHoverState=function(e){var t=this.tooltip,n=this.options.hint;n.enable&&t&&!e&&t.hide(),this.hoverLine&&(this.hoverLine.path.removed||(this.options.type==="line"&&this.hoverLine.lineStyle.fill&&delete this.hoverLine.lineStyle.fill,this.hoverLine.path.wijAttr(this.hoverLine.lineStyle),this.hoverPoint&&!this.hoverPoint.isSymbol&&(this.hoverPoint.marker.wijAttr(this.hoverPoint.markerStyle),this.hoverPoint.marker.transform("s1")))),this.hoverLine=null,this.hoverPoint=null,this.hoverVirtualPoint=null},t.prototype._paintLegendIcon=function(e,t,n,r,i,s,o,u,a,f){var l=this,c=this.options,h=l.canvas.path(Raphael.format("M{0},{1}L{2},{3}",e,t+r/2,e+n,t+r/2)),p;$(h.node).data("legendIndex",s).data("index",o),l.legendIcons.push(h),i&&h.attr($.extend(!0,{},i,{"stroke-width":c.legend.size.height})),$.wijraphael.addClass($(h.node),u);var d=a.markerStyle;d=$.extend({fill:i.stroke,stroke:i.stroke,opacity:1},d),i["stroke-dasharray"]&&h.attr({"stroke-width":1,"stroke-dasharray":i["stroke-dasharray"]});if(a.markers&&a.markers.visible){var v=a.markers.type;v||(v="circle"),p=this.canvas.paintMarker(v,e+n/2,t+r/2,3),$.wijraphael.addClass($(p.node),Raphael.format("{0} {1} {2}",c.wijCSS.legend,c.wijCSS.legendDot,c.wijCSS.canvasObject)),p.attr(d),$(p.node).data("index",o).data("legendIndex",s),this.legendDots.push(p)}return h},t.prototype._paintLegend=function(){var t=this.options,n=0,r=0,i=0,s=null,o=t.seriesList,u=t.seriesStyles,a=null,f=null,l=null,c=0,h=0,p=null,d=null,v=null;$.extend(!0,t,{legend:{size:{width:30,height:3}}}),e.prototype._paintLegend.call(this)},t.prototype._paintPlotArea=function(){var e=this.options,t;this.aniPathsAttr||(this.aniPathsAttr=[]),this.linechartRender=new r(this.chartElement,{bounds:this.canvasBounds,widgetName:this.widgetName,canvas:this.canvas,tooltip:this.tooltip,wijCSS:e.wijCSS,stacked:e.stacked,hole:e.hole,type:e.type,axis:e.axis,animation:e.animation,seriesTransition:e.seriesTransition,seriesList:e.seriesList,seriesStyles:e.seriesStyles,seriesHoverStyles:e.seriesHoverStyles,showChartLabels:e.showChartLabels,chartLabelStyle:e.chartLabelStyle,chartLabelFormatString:e.chartLabelFormatString,isXTime:this.axisInfo.x.isTime,isYTime:this.axisInfo.y.isTime||this.axisInfo.y[0].isTime,disabled:e.disabled,culture:this._getCulture(),hint:e.hint,aniPathsAttr:this.aniPathsAttr,chartLabelEles:this.chartLabelEles,mouseDown:$.proxy(this._mouseDown,this),mouseUp:$.proxy(this._mouseUp,this),mouseOver:$.proxy(this._mouseOver,this),mouseOut:$.proxy(this._mouseOut,this),mouseMove:$.proxy(this._mouseMove,this),click:$.proxy(this._click,this),widget:this,extremeValue:{txx:this.extremeValue.txx,txn:this.extremeValue.txn,tyx:this.extremeValue.y[0].tyx,tyn:this.extremeValue.y[0].tyn}}),this.linechartRender.render()},t}(e.wijchartcore);e.wijlinechart=t;var n=function(){function e(){this.initSelector=":jqmData(role='wijlinechart')",this.wijCSS={lineChart:"wijmo-wijlinechart",areaChart:"wijmo-wijareachart",lineLabel:"wijlinechart-label",lineElement:"wijlinechart",areaElement:"wijlinechart-area",lineTracker:"linetracker",canvasMarker:"wijchart-canvas-marker"},this.stacked=!1,this.hole=null,this.type="line",this.animation={enabled:!0,direction:"horizontal",duration:2e3,easing:"easeInCubic"},this.seriesTransition={enabled:!0,duration:2e3,easing:"easeInCubic"},this.mouseDown=null,this.mouseUp=null,this.mouseOver=null,this.mouseOut=null,this.mouseMove=null,this.click=null}return e}();t.prototype.options=$.extend(!0,{},e.wijchartcore.prototype.options,new n),$.wijmo.registerWidget("wijlinechart",t.prototype);var r=function(){function t(e,t){this.options=t,this.element=e}return t.prototype.render=function(){var e=this.element,t=this.options,n=t.wijCSS,r=t.bounds,i=t.widgetName,s=t.canvas,o=t.animation,u=t.seriesTransition,a=t.hint,f=t.tooltip,l=t.mouseDown,c=t.mouseUp,h=t.mouseOver,p=t.mouseOut,d=t.mouseMove,v=t.click,m=[],g=[],y=[],b=[],w=[],E=t.disabled,S=s.set(),x=t.aniPathsAttr,T=[],N,C=e.data("fields")||{},k=[],L=t.culture,A=t.widget,O=t.extremeValue,M={enable:!1,left:-10,top:-10,right:10,bottom:10};this.widget=A,this.renderLineChart(t,T,x,b,w,m,S,g,y,k,L),!t.axis.x.autoMax&&t.axis.x.max<O.txx&&(M.enable=!0,M.right=0),!t.axis.x.autoMin&&t.axis.x.min>O.txn&&(M.enable=!0,M.left=0),!t.axis.y.autoMax&&t.axis.y.max<O.tyx&&(M.enable=!0,M.top=0),!t.axis.y.autoMin&&t.axis.y.min>O.tyn&&(M.enable=!0,M.bottom=0),o.enabled||u.enabled?this.playAnimation(o,u,S,r,b,x,M):M.enable&&this.setClipRect(M,S,r),x.length=0,$.each(T,function(e,t){x.push(t)}),this.unbindLiveEvents(e,i,n),this.bindLiveEvents(e,s,r,i,l,c,h,p,d,v,E,a,y,f,n),N={paths:b,shadowPaths:w,markersSet:m,animationSet:S,symbols:g},C.chartElements||(C.chartElements={}),C.seriesEles=k,$.extend(!0,C.chartElements,N),e.data("fields",C)},t.prototype.setClipRect=function(e,t,n){var r=n.endX-n.startX-e.left+e.right,i=n.endY-n.startY-e.top+e.bottom;t.wijAttr("clip-rect",Raphael.format("{0} {1} {2} {3}",n.startX+e.left,n.startY+e.top,r,i))},t.prototype.playAnimation=function(e,t,n,r,i,s,o){var u=this,a=e.duration,f=e.easing;e.direction==="horizontal"?(s&&s.length&&t.enabled&&(a=t.duration,f=t.easing),this.playHAnimation(a,f,n,r,i,o)):(o.enable&&this.setClipRect(o,n,r),$.each(i,function(e,n){if(typeof n=="undefined"||n===null)return!0;s&&s.length>e&&t.enabled?(a=t.duration,f=t.easing,u.playVAnimation(n,s,e,a,f)):n.straight&&u.playVStraightAnimation(n,a,f)}))},t.prototype.playVAnimation=function(t,n,r,i,s){var o,u;t.shadow&&t.shadow.hide(),t.tracker&&t.tracker.hide(),o=n[r],o&&o.path&&(u=e.ChartUtil.getDiffAttrs(o.path,t.attr())),$.isEmptyObject(u)||(t.attr(o.path),t.wijAnimate(u,i,s,function(){t.shadow&&t.visible!==!1&&t.shadow.show(),t.tracker&&t.tracker.show()})),$.each(t.markers,function(t,n){var r=e.ChartUtil.getDiffAttrs(o.markers[t],n.attr());$.isEmptyObject(r)||(n.attr(o.markers[t]),n.wijAnimate(r,i,s))}),t.labels&&$.each(t.labels,function(t,n){var r=e.ChartUtil.getDiffAttrs(o.labels[t],n.attr()),u=o.labels[t];u&&u.text&&delete u.text,$.isEmptyObject(r)||(n.attr(u),n.wijAnimate(r,i,s))}),t.area&&(u=e.ChartUtil.getDiffAttrs(o.area,t.area.attr()),$.isEmptyObject(u)||(t.area.attr(o.area),t.area.wijAnimate(u,i,s)))},t.prototype.playVStraightAnimation=function(e,t,n){var r,i,s;e.shadow&&e.shadow.hide(),e.tracker&&e.tracker.hide(),r=e.straight,i=e.attr().path,e.attr({path:r}),e.wijAnimate({path:i},t,n,function(){e.shadow&&e.visible!==!1&&e.shadow.show(),e.tracker&&e.tracker.show()}),$.each(e.markers,function(e,r){if(r.straight){var i=r.attr().cy;r.attr({cy:r.straight}),r.wijAnimate({cy:i},t,n)}}),e.area&&(s=e.area,r=s.straight,i=s.attr().path,s.attr({path:r}),s.wijAnimate({path:i},t,n))},t.prototype.playHAnimation=function(e,t,n,r,i,s){$.each(i,function(e,t){t.tracker&&t.tracker.hide()});var o=s.enable,u=r.endX-r.startX-s.left+s.right,a=r.endY-r.startY-s.top+s.bottom;n.wijAttr("clip-rect",Raphael.format("{0} {1} 0 {2}",r.startX+s.left,r.startY+s.top,a)),n.wijAnimate({"clip-rect":Raphael.format("{0} {1} {2} {3}",r.startX+s.left,r.startY+s.top,u,a)},e,t,function(){this.tracker&&this.tracker.show();if(Raphael.vml&&!o){var e=null,t=null,n=this.node;n&&n.clipRect&&(e=this.attrs,delete e["clip-rect"],n.clipRect=null,t=$(n).parent(),t.before(n),t.remove(),this.attr(e),e.src&&e.src.length&&this.attr({src:e.src}))}})},t.prototype.renderLineChart=function(t,n,r,i,s,o,u,a,f,l,c){var h=this,p=t.wijCSS,d=t.bounds,v=t.canvas,m=t.stacked,g=t.hole,y=t.type,b=t.axis,w=t.animation,E=t.seriesTransition,S=!1,x=t.seriesList,T=t.seriesStyles,N=t.seriesHoverStyles,C=t.showChartLabels,k=t.chartLabelStyle,L=t.chartLabelFormatString,A=t.isXTime,O=t.isYTime,M=t.chartLabelEles,_,D,P,H,B,j,F=[],I=[],q,R,U,z,W;$.each(x,function(t,X){var V=[],J=[],K=[],Q,G,Y,Z,et,tt,nt=[];if(X.display==="exclude")return!0;tt=T[t],X=$.extend(!0,{display:"show",fitType:"line",markers:{visible:!1,type:"circle"},visible:!0},X),Q=X.data,G=$.extend({stroke:"black",opacity:1,fill:"none","stroke-linejoin":"round","stroke-linecap":"round"},tt),Z=X.markerStyle,Z=$.extend({fill:G.stroke,stroke:G.stroke,opacity:1,width:3},Z),Y=N[t],et=$.extend(!0,{},Y,{transform:"s1.5","stroke-width":1},x.markerHoverStyle),B=[].concat(Q.x),j=[].concat(Q.y),U=v.set(),R=[],H=X.fitType,z=!1,X.markers.symbol&&X.markers.symbol.length&&(z=!0),_=v.set();if(!r||r.length<=t||w.enabled&&!E.enabled)S=!0;S&&j.length>0&&(D=e.ChartUtil.getFirstValidListValue(j),O&&(D=$.toOADate(D)),P=e.ChartUtil.getLastValidListValue(j),O&&(P=$.toOADate(P))),W=h.processYValues(j,X.display,g,m,F),$.each(j,function(e,t){q=B[e],A&&(q=$.toOADate(q)),t=j[e];if(W[e].isHole){if(X.display==="excludeHole")return!0;if(!W[e].isValue)return!0}O&&(t=$.toOADate(t));if(q===undefined)return!1;R=h.renderPoint(d,v,K,R,U,V,u,_,J,M,L,S,D,P,q,t,Q.y[e],b,H,A,O,e,Z,et,X,z,C,a,B,j,W,X.display,m,nt,c,p)}),h.renderPath(v,d,X,i,s,f,Y,Z,et,U,o,u,R,n,K,G,k,V,J,_,t,y,I,m,nt,p),l.push({markers:U,path:i[i.length-1],shadowPath:s[s.length-1],dcl:_})}),$.each($.merge([],i).reverse(),function(e,t){t.toFront(),t.area&&t.area.toFront()}),$.each(i,function(e,t){t.tracker&&t.tracker.toFront()}),$.each(i,function(e,t){t.markers&&t.markers.toFront()})},t.prototype.renderPath=function(t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C){var k,L,A,O,M,_,D,P,H,B,j,F,I,q,R;k=t.path(p.join(" ")),k.straight=v.join(" "),e.ChartUtil.paintShadow(k,1,"#cccccc"),E===0&&(x.length=0,p.length>1?(_=p[1],D=p[p.length-2]):(_=n.startX,D=n.endX),$.merge(x,["L",_,n.endY,"L",D,n.endY])),P=t.path(p.join(" ")),k.tracker=P,m["stroke-width"]?H=10+parseFloat(m["stroke-width"]):H=10,P.attr({"stroke-width":H,stroke:"#C0C0C0",opacity:.01}),$.wijraphael.addClass($(P.node),Raphael.format("{0} {1} {2}",C.canvasObject,C.lineElement,C.lineTracker)),$(P.node).data("owner",$(k.node)),S==="area"?(m.fill&&m.fill!=="none"?(L=m.fill,delete m.fill):L=m.stroke,A=.5,O=1,m["fill-opacity"]&&m["fill-opacity"]!=="none"&&(A=m["fill-opacity"]),m.opacity&&m.opacity!=="none"&&(O=m.opacity),k.wijAttr(m),p.length>1?_=p[1]:_=n.startX,T?(p.push("V"),p.push(n.endY),p.push("H"),p.push(_),p.push("Z")):(I=Raphael.parsePathString(k.attr("path")),I&&I.length>0&&(p=[],$.each(I,function(e,t){$.each(t,function(e,t){p.push(t)}),t[0]==="M"&&(_=t[1]),e<I.length-1&&I[e+1][0]==="M"&&(p.push("V"),p.push(n.endY),p.push("H"),p.push(_),p.push("Z")),e===I.length-1&&(p.push("V"),p.push(n.endY),p.push("H"),p.push(_),p.push("Z"))}))),M=t.path(p.join(" ")),$.wijraphael.addClass($(M.node),C.areaElement),M.wijAttr({fill:L,opacity:O,"fill-opacity":A,stroke:"none"}),v.push("V"),v.push(n.endY),v.push("H"),v.push(_),v.push("Z"),M.straight=v.join(" "),k.area=M,h.push(M),d.push({path:$.extend(!0,{},k.attr()),area:$.extend(!0,{},M.attr()),markers:y,labels:b})):(R=$.extend(!0,{},m),R.fill&&delete R.fill,k.wijAttr(R),d.push({path:$.extend(!0,{},k.attr()),markers:y,labels:b})),k.markers=l,i.push(k),k.shadow&&(s[E]=k.shadow),h.push(k),o[E]={lineStyle:m,lineHoverStyle:u,markerStyle:a,markerHoverStyle:f},(!r.markers.visible||r.display==="hide")&&l.hide();if(!r.visible||r.display==="hide")k.hide(),k.shadow&&k.shadow.hide(),k.area&&k.area.hide(),k.visible=!1;r.markers.style&&l.attr(r.markers.style),l.toFront(),w.length&&(B=$.extend(!0,{},g),r.textStyle&&(B=$.extend(!0,B,r.textStyle)),w.attr(B),w.toFront(),k.labels=w),c[E]=l,r.index=E,r.type="line",r.path=k,r.lineMarkers=l,r.lineStyle=m,r.lineHoverStyle=u,r.virtualMarkers=N,$.wijraphael.addClass($(k.node),Raphael.format("{0} {1}",C.canvasObject,C.lineElement)),$(k.node).data("wijchartDataObj",r)},t.prototype.renderPoint=function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b,w,E,S,x,T,N,C,k,L,A,O,M,_,D,P,H){var B=e.endX-e.startX,j=e.endY-e.startY,F=g.x.min,I=g.y.min,q=g.x.max,R=g.y.max,U=B/(q-F),z=j/(R-I),W,X,V,J=0,K,Q,G,Y,Z=T.markers.visible,et=this.widget,tt;return isNaN(d)||typeof d=="string"?V=E:V=d,J=e.startX+(V-F)*U,K=e.endY-(v-I)*z,O[E].x=J,O[E].y=K,c&&(Q=h+(p-h)/(q-F)*(V-F),Q=e.endY-(Q-I)*z,n.push(O[E].idx?"L":"M"),n.push(J),n.push(Q)),O[E].isHole?r:(r=this.getPathArrByFitType(r,y,E,A.length,e,L,A,J,K,b,w,d,v,U,z,F,I,O,M,_),C&&(Y=this.renderChartLabel(t,w,v,l,J,K,P,H),f.push(Y),u.push(Y),a.push($.extend(!0,{},Y.attr()))),Z&&(W=this.renderMarker(t,k,N,T.markers,E,J,K,S,H),X=W.dot,c&&(X.straight=Q)),G={},G.valX=L[E],G.valY=m,G.index=E,G.type="marker",G.lineSeries=T,G.x=J,G.y=K,G.markerStyle=S,G.markerHoverStyle=x,G.visible=!0,Z&&(G.marker=X,G.isSymbol=W.isSymbol,$(X.node).data("wijchartDataObj",G),i.push(X),s.push($.extend(!0,{},X.attr())),o.push(X)),et.dataPoints=et.dataPoints||{},et.pointXs=et.pointXs||[],tt=$.round(J,2),et.dataPoints[tt.toString()]||(et.dataPoints[tt.toString()]=[],et.pointXs.push(tt)),et.dataPoints[tt.toString()].push(G),D.push(G),r)},t.prototype.processYValues=function(t,n,r,i,s){var o=[],u=0,a=0;return $.each(t,function(f,l){u||(a=f);var c={isHole:!1,isValue:!0,idx:u,firstYIdx:a,x:0,y:0};u++,e.ChartUtil.isHolefunction(l,r)&&(i?t[f]=0:(c.isHole=!0,n==="excludeHole"?(u--,c.idx=0):(u=0,c.idx=0),!e.ChartUtil.isHolefunction(r,undefined)&&l===r?c.isValue=!0:c.isValue=!1)),o.push(c),i&&f<s.length&&(t[f]+=s[f])}),s.length=0,$.merge(s,t),o},t.prototype.renderMarker=function(e,t,n,r,i,s,o,u,a){var f,l=null,c=!1,h,p;return n&&(f=r.symbol,$.each(f,function(n,r){if(r.index===i)return l=e.image(r.url,s-r.width/2,o-r.height/2,r.width,r.height),t.push(l),c=!0,!1})),l===null&&(h=r.type,p=u.width,l=e.paintMarker(h,s,o,p),r.visible&&l.attr(u)),$.wijraphael.addClass($(l.node),Raphael.format("{0} {1} {2}",a.canvasObject,a.lineElement,a.canvasMarker)),{dot:l,isSymbol:c}},t.prototype.renderChartLabel=function(e,t,n,r,i,s,o,u){var a,f,l,c=this.options.widget;return a=t?$.fromOADate(n):n,r&&r.length&&(a=Globalize.format(a,r,o)),f=c._text.call(c,i,s,a),$.wijraphael.addClass($(f.node),u.lineLabel),l=f.wijGetBBox(),f.transform(Raphael.format("...T{0},{1}",0,-l.height)),f},t.prototype.getAnchors=function(e,t,n,r,i,s){var o=(n-e)/2,u=(i-n)/2,a=Math.atan((n-e)/Math.abs(r-t)),f=Math.atan((i-n)/Math.abs(r-s)),l=0,c=0,h=0,p=0,d=0;return a=t<r?Math.PI-a:a,f=s<r?Math.PI-f:f,l=Math.PI/2-(a+f)%(Math.PI*2)/2,c=o*Math.sin(l+a),h=o*Math.cos(l+a),p=u*Math.sin(l+f),d=u*Math.cos(l+f),{x1:n-c,y1:r+h,x2:n+p,y2:r+d}},t.prototype.getPathArrByFitType=function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b){var w=null,E=0,S=0,x=0,T=0,N=null,C=null,k=g[n],L=!1,A=k.idx,O,M=n-1,_=n+1;if(y==="excludeHole"&&!b){if(n>0&&n<r-1){_=-1,M=-1;for(O=n+1;O<r;O++){L=!0;if(g[O].isHole)continue;_=O,L=!1;break}for(O=n-1;O>=0;O--){if(g[O].isHole)continue;M=O;break}M>-1&&(x=g[M].x,E=g[M].y)}}else n<r-1&&(L=g[_].isHole),n>0&&n<r-1&&(x=g[M].x,E=g[M].y);return b&&(t="line"),t==="line"?e=e.concat([A?"L":"M",u,a]):t==="spline"?A?A&&n<r-1&&!L?(w=o[_],l&&(w=$.toOADate(w)),S=i.endY-(w-m)*d,isNaN(c)||typeof c=="string"?T=i.startX+(_-v)*p:(N=s[_],f&&(N=$.toOADate(N)),T=i.startX+(N-v)*p),C=this.getAnchors(x,E,u,a,T,S),e=e.concat([C.x1,C.y1,u,a,C.x2,C.y2])):e=e.concat([u,a,u,a]):n===r-1?e=e.concat(["M",u,a]):L?e=e.concat(["M",u,a]):e=e.concat(["M",u,a,"C",u,a]):t==="bezier"&&(A?n<r-1&&g[n+1].isHole&&A%2===1||n===r-1&&A%2===1?e=e.concat(["Q",u,a,u,a]):A%2===0?e=e.concat([u,a]):e=e.concat(["Q",u,a]):e=e.concat(["M",u,a])),e},t.prototype.bindLiveEvents=function(e,t,n,r,i,s,o,u,a,f,l,c,h,p,d){var v="",m={element:e,mousedown:function(t){if(l)return;var n=$(t.target),r,s=null;n.data("owner")&&(n=n.data("owner")),r=n.data("wijchartDataObj"),n.hasClass(d.canvasMarker)?(s=r.lineSeries,s.markers.visible?i.call(e,t,r):i.call(e,t,s)):i.call(e,t,r)},mouseup:function(t){if(l)return;var n=$(t.target),r,i=null;n.data("owner")&&(n=n.data("owner")),r=n.data("wijchartDataObj"),n.hasClass(d.canvasMarker)?(i=r.lineSeries,i.markers.visible?s.call(e,t,r):s.call(e,t,i)):s.call(e,t,r)},mouseover:function(t){if(l)return;var n=$(t.target),r,i=null;n.data("owner")&&(n=n.data("owner")),r=n.data("wijchartDataObj"),n.hasClass(d.canvasMarker)?(i=r.lineSeries,i.markers.visible?o.call(e,t,r):o.call(e,t,i)):o.call(e,t,r)},mouseout:function(t){if(l)return;var n=$(t.target),r,i=null;n.data("owner")&&(n=n.data("owner")),r=n.data("wijchartDataObj"),n.hasClass(d.canvasMarker)?(i=r.lineSeries,i.markers.visible?u.call(e,t,r):u.call(e,t,i)):u.call(e,t,r)},mousemove:function(t){if(l)return;var n=$(t.target),r,i=null;n.data("owner")&&(n=n.data("owner")),r=n.data("wijchartDataObj"),n.hasClass(d.canvasMarker)?(i=r.lineSeries,i.markers.visible?a.call(e,t,r):a.call(e,t,i)):a.call(e,t,r)},click:function(t){if(l)return;var n=$(t.target),r,i=null;n.data("owner")&&(n=n.data("owner")),r=n.data("wijchartDataObj"),n.hasClass(d.canvasMarker)?(i=r.lineSeries,i.markers.visible?f.call(e,t,r):f.call(e,t,i)):f.call(e,t,r)}};$.support.isTouchEnabled&&$.support.isTouchEnabled()&&(v="wij"),e.on(v+"mousedown."+r,"."+d.lineElement,$.proxy(m.mousedown,m)).on(v+"mouseup."+r,"."+d.lineElement,$.proxy(m.mouseup,m)).on(v+"mouseover."+r,"."+d.lineElement,$.proxy(m.mouseover,m)).on(v+"mouseout."+r,"."+d.lineElement,$.proxy(m.mouseout,m)).on(v+"mousemove."+r,"."+d.lineElement,$.proxy(m.mousemove,m)).on(v+"click."+r,"."+d.lineElement,$.proxy(m.click,m))},t.prototype.unbindLiveEvents=function(e,t,n){e.off("."+t,"."+n.lineElement)},t}();e.LineChartRender=r})(e.chart||(e.chart={}));var t=e.chart})(wijmo||(wijmo={}));;
var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(e){var t=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype._create=function(){this._handleChartStyles(),e.prototype._create.call(this),this.chartElement.addClass(this.options.wijCSS.pieChart)},t.prototype.destroy=function(){var t=this.options.wijCSS,n=this.chartElement,r=n.data("fields"),i=r&&r.sectors,s=r&&r.labels;n.removeClass(t.pieChart),e.prototype.destroy.call(this),i&&i.length&&$.each(i,function(e,t){t=null}),s&&s.length&&$.each(s,function(e,t){t=null}),n.data("fields",null)},t.prototype._isPieChart=function(){return!0},t.prototype.getSector=function(e){var t=this.chartElement.data("fields");return t&&t.chartElements?t.chartElements.sectors[e]:null},t.prototype._bindData=function(){var e=this.options,t=e.dataSource,n=e.data,r=[],i,s,o;t&&n&&(i=n.label,s=n.value,o=n.offset,i&&i.bind&&(i=this._getBindData(t,i.bind)),s&&s.bind&&(s=this._getBindData(t,s.bind)),o&&o.bind&&(o=this._getBindData(t,o.bind)),i&&$.isArray(i)&&i.length&&s&&$.isArray(s)&&s.length&&($.each(s,function(e,t){var n,u=0;e>=0&&e<i.length&&(n=i[e]),o&&$.isArray(s)&&o.length&&e>=0&&e<o.length&&(u=typeof o[e]=="undefined"?0:o[e]),r.push({data:t,label:n,offset:u,legendEntry:!0})}),e.seriesList=r))},t.prototype._hanldSharedXData=function(){},t.prototype._getSeriesFromTR=function(e,t,n){var r=null,i=null,s=null,o=null,u=null;t.length&&t.each(function(){i=$("th",$(this)),r=$.trim(i.text()),s=$("td",$(this)),s.length&&(o=parseFloat($.trim($(s[0]).text()))),u={label:r,legendEntry:!0,data:o},n.push(u)})},t.prototype._showSerieEles=function(e){var t=this.options.showChartLabels;e.sector&&(e.sector.show(),e.sector.shadow&&e.sector.shadow.show(),e.sector.tracker&&e.sector.tracker.show()),e.label&&t&&(e.label.show(),e.label.connector&&e.label.connector.show(),$(e.label.node).data("legendHide",!1))},t.prototype._hideSerieEles=function(e){e.sector&&(e.sector.hide(),e.sector.shadow&&e.sector.shadow.hide(),e.sector.tracker&&e.sector.tracker.hide()),e.label&&(e.label.hide(),e.label.connector&&e.label.connector.hide(),$(e.label.node).data("legendHide",!0))},t.prototype._hasAxes=function(){return!1},t.prototype._mouseMoveInsidePlotArea=function(t,n){e.prototype._mouseMoveInsidePlotArea.call(this,t,n);if(this.isTapAndHold){var r=this.previousAngle,i=0,s="",o=this.chartElement,u=this.tapTarget?this.tapTarget.data("wijchartDataObj"):{},a=u.pieID||"",f=o.data("fields").chartElements["sectors"+a],l=this.canvasBounds,c=(l.startX+l.endX)/2,h=(l.startY+l.endY)/2,p=Raphael.angle(n.left,n.top,c,h);r&&(i=Math.round(p-r),Math.abs(p-r)>180&&(p>r?i-=360:i+=360),i&&(s=Raphael.format("...r{0},{1},{2}",i,c,h),$.each(f,function(e,t){t.transform(s)}),this.tooltip&&this._setTouchTooltip(null))),this.previousAngle=p}},t.prototype._mouseMoveOutsidePlotArea=function(t,n){e.prototype._mouseMoveOutsidePlotArea.call(this,t,n),this.isTapAndHold&&this._rotateToSectorCenter(null)},t.prototype._rotateToSectorCenter=function(e){var t=this,n=this.options.animation,r=this.chartElement,i=this.tapTarget?this.tapTarget.data("wijchartDataObj"):{},s=i.pieID||"",o=r.data("fields").chartElements["sectors"+s],u=r.data("fields").chartElements["labels"+s],a=this.canvasBounds,f=(a.startX+a.endX)/2,l=(a.startY+a.endY)/2,c,h,p,d=this;this._hideSectorElements(o,u),this.tooltip&&(h=this._getTouchttSector(e)),this.touchttSector&&this.touchttSector===h&&Math.abs(this.targetCenterAngle)>=.01?(this.targetCenterAngle>180?p=this.targetCenterAngle-360:this.targetCenterAngle<-180?p=this.targetCenterAngle+360:p=this.targetCenterAngle,c=Raphael.animation({transform:Raphael.format("...r{0},{1},{2}",p,f,l)},n.duration,n.easing,function(){d._rotateCallback(this,u)}),$.each(o,function(e,t){t.animate(c)})):$.each(o,function(e,n){t._rotateCallback(n,u)}),this.previousAngle=null,this.isTapAndHold=!1,this.tapTarget=null},t.prototype._rotateCallback=function(e,t){var n=this.canvasBounds,r=(n.startX+n.endX)/2,i=(n.startY+n.endY)/2,s=e.index,o=0,u=e.attr("transform"),a;$.each(u,function(e,t){if(t[0]!=="r")return!0;t.length>=4&&(o+=t[1])}),r>0&&(o%=360,e.attr("transform",Raphael.format("r{0},{1},{2}",o,r,i))),e.tracker&&(e.tracker.attr("transform",Raphael.format("r{0},{1},{2}",o,r,i)),e.tracker.show()),e.shadow&&(e.shadow.attr("transform",Raphael.format("r{0},{1},{2}",o,r,i)),e.shadow.show());if(t&&t.length&&t.length>s){a=t[s],a.attr("transform",Raphael.format("r{0},{1},{2}r{3}",o,r,i,0-o));if($(a.node).data("legendHide"))return;a.show()}},t.prototype._getTouchttSector=function(e){var t=this,n=this.chartElement,r=this.tapTarget?this.tapTarget.data("wijchartDataObj"):{},i=r.pieID||"",s=n.data("fields").chartElements["sectors"+i],o=this.tooltip.getOptions(),u=o.compass,a=90,f;switch(u){case"east":a=0;break;case"south":a=270;break;case"west":a=180;break;case"north":default:a=90}return $.each(s,function(n,r){var i=r.attr("transform"),s=0,o=r.angles;$.each(i,function(e,t){if(t[0]!=="r")return!0;t.length>=4&&(s+=t[1])}),s%=360,s<0&&(s=360+s),s=(a+s)%360;if(e){if(r===e)return t.targetCenterAngle=(o.start+o.end)/2-s,f=e,!1}else if(o.start<=s&&o.end>=s)return t.targetCenterAngle=(o.start+o.end)/2-s,f=r,!1}),f},t.prototype._setTouchTooltip=function(e){var t=this.tooltip.getOptions(),n=t.compass,r=this._getTouchttSector(e),i=this.options.hint,s=i.title,o=i.content,u=$.isFunction(s),a=$.isFunction(o),f,l;if(!r||this.touchttSector&&this.touchttSector===r)return;f=$(r.node).data("wijchartDataObj"),l={data:f,value:f.value,label:f.label,total:f.total,y:f.value};if(u||a)u&&(t.title=function(){l.fmt=s;var e=$.proxy(l.fmt,l),t=e();return t}),a&&(t.content=function(){l.fmt=o;var e=$.proxy(l.fmt,l),t=e();return t});this._showTouchTooltip(n),this.touchttSector=r},t.prototype._showTouchTooltip=function(e){var t=this.chartElement,n=this.canvasBounds,r={x:0,y:0};switch(e){case"east":r={x:t.width(),y:(n.startY+n.endY)/2};break;case"south":r={x:(n.startX+n.endX)/2,y:t.height()};break;case"west":r={x:0,y:(n.startY+n.endY)/2};break;case"north":default:r={x:(n.startX+n.endX)/2,y:0}}this.tooltip.showAt(r)},t.prototype._isTouchEnabled=function(){return $.support.isTouchEnabled&&$.support.isTouchEnabled()&&this.options.enableTouchBehavior},t.prototype._mouseDown=function(t,n){var r=$(t.target),i=this.chartElement,s,o,u;e.prototype._mouseDown.call(this,t,n),this._isTouchEnabled()&&(this.isTapAndHold=!0,r.data("owner")&&(r=r.data("owner")),this.tapTarget=r,s=n.pieID||"",o=i.data("fields").chartElements["sectors"+s],u=i.data("fields").chartElements["labels"+s],this._hideSectorElements(o,u))},t.prototype._hideSectorElements=function(e,t){$.each(e,function(e,n){n.stop(),n.tracker&&n.tracker.hide(),n.shadow&&n.shadow.hide();if(t&&t.length){var r=t[e];r.hide()}})},t.prototype._mouseUp=function(t,n){e.prototype._mouseUp.call(this,t,n),this._isTouchEnabled()&&this.isTapAndHold&&this._rotateToSectorCenter(null)},t.prototype._mouseOver=function(t,n){e.prototype._mouseOver.call(this,t,n)},t.prototype._mouseOut=function(t,n){e.prototype._mouseOut.call(this,t,n)},t.prototype._mouseMove=function(t,n){e.prototype._mouseMove.call(this,t,n)},t.prototype._click=function(t,n){var r=this.chartElement,i,s,o;e.prototype._click.call(this,t,n),this._isTouchEnabled()&&this.tooltip&&(i=n.pieID||"",s=r.data("fields").chartElements["sectors"+i],s.length&&s.length>n.index&&(o=s[n.index],this._setTouchTooltip(o),this._rotateToSectorCenter(o)))},t.prototype._paintTooltip=function(){var t=this.options.wijCSS,n=this.chartElement,r=n.data("fields");e.prototype._paintTooltip.call(this),this.tooltip&&r&&(this._isTouchEnabled()?(this.tooltip.setOptions({closeBehavior:"none",mouseTrailing:!1,animated:null,showAnimated:null,windowCollisionDetection:"fit"}),this._setTouchTooltip(null),this._rotateToSectorCenter(null)):r.trackers&&r.trackers.length&&(this.tooltip.setSelector($("."+t.canvasObject,n[0])),this.tooltip.setOptions({relatedElement:r.trackers[0]})))},t.prototype._paintPlotArea=function(){var e=this.options,t=this.canvasBounds,n=t.endX-t.startX,i=t.endY-t.startY,s=e.radius;s?(n<2*s&&(s=n/2),i<2*s&&(s=i/2)):s=Math.min(n,i)/2,t.startX+=n/2-s,t.endX=t.startX+2*s,t.startY+=i/2-s,t.endY=t.startY+2*s,this.chartElement.data("fields")&&(this.chartElement.data("fields").seriesEles=null),this.piechartRender=new r(this.chartElement,{canvas:this.canvas,tooltip:this.tooltip,bounds:t,wijCSS:e.wijCSS,radius:s,startAngle:e.startAngle,widgetName:this.widgetName,innerRadius:e.innerRadius,seriesList:e.seriesList,seriesStyles:e.seriesStyles,seriesHoverStyles:e.seriesHoverStyles,seriesTransition:e.seriesTransition,showChartLabels:e.showChartLabels,disabled:e.disabled,textStyle:e.textStyle,chartLabelStyle:e.chartLabelStyle,chartLabelFormatString:e.chartLabelFormatString,chartLabelFormatter:e.chartLabelFormatter,labels:e.labels,shadow:e.shadow,animation:e.animation,culture:this._getCulture(),mouseDown:$.proxy(this._mouseDown,this),mouseUp:$.proxy(this._mouseUp,this),mouseOver:$.proxy(this._mouseOver,this),mouseOut:$.proxy(this._mouseOut,this),mouseMove:$.proxy(this._mouseMove,this),click:$.proxy(this._click,this),widget:this,enableTouchBehavior:e.enableTouchBehavior}),this.piechartRender.render()},t.prototype._getTooltipText=function(e,t){var n=$(t.node),r,i;return n.data("owner")&&(n=n.data("owner")),r=n.data("wijchartDataObj"),i={data:r,value:r.value,label:r.label,total:r.total,target:t,y:r.value,fmt:e},$.proxy(e,i)()},t}(e.wijchartcore);e.wijpiechart=t;var n=function(){function e(){this.initSelector=":jqmData(role='wijpiechart')",this.wijCSS={pieChart:"wijmo-wijpiechart",pieLabel:"wijpiechart-label",pieElement:"wijpiechart",pieTracker:"pietracker"},this.startAngle=0,this.radius=null,this.innerRadius=0,this.chartLabelFormatter=null,this.labels={style:{},formatString:"",formatter:null,connectorStyle:{},position:"inside",offset:10},this.animation={enabled:!0,duration:400,easing:"easeInCubic",offset:10},this.seriesTransition={enabled:!0,duration:1e3,easing:"bounce"},this.seriesList=[],this.enableTouchBehavior=!0,this.mouseDown=null,this.mouseUp=null,this.mouseOver=null,this.mouseOut=null,this.mouseMove=null,this.click=null}return e}();t.prototype.options=$.extend(!0,{},e.wijchartcore.prototype.options,new n),$.wijmo.registerWidget("wijpiechart",t.prototype);var r=function(){function t(e,t){this.options=t,this.element=e}return t.prototype.render=function(){var t=this.element,n=this.options,r=function(t,r,i){n.shadow&&e.ChartUtil.paintShadow(t,r,i)},i=e.ChartUtil.getDiffAttrs,s=n.canvas,o=$.wijraphael.getPositionByAngle,u=n.seriesList,a=n.seriesStyles,f=n.seriesHoverStyles,l=a.length,c=n.textStyle,h=n.labels||{style:{},formatString:"",formatter:null,connectorStyle:{},position:"inside",offset:10},p=$.extend(!0,{},c,n.chartLabelStyle,h.style),d=h.formatString||n.chartLabelFormatString,v=h.formatter||n.chartLabelFormatter,m=n.culture,g=n.bounds,y=g.startX,b=g.startY,w=n.radius,E=n.showChartLabels,S=n.animation,x=n.seriesTransition,T=n.innerRadius,N=t.data("fields")||{},C=N.chartElements||{},k=N.aniSectorAttrs,L=N.aniLabelAttrs,A=0,O=n.startAngle||0,M=n.wijCSS,_,D,P,H=[],B=[],j=[],F=[],I=[],q=[],R=s.set(),U=this.options.widget;s.customAttributes.segment=function(t,n,r,i,s,o){var u=null,a=.01;return i-r>360-a?i-=a:i-r<a&&(i+=a),o?u=e.ChartUtil.donut(t,n,s,o,r,i):u=e.ChartUtil.sector(t,n,s,r,i),{path:u}},$.each(u,function(e,t){t&&typeof t.data=="number"&&(A+=t.data)}),$.each(u,function(e,t){var n=$.extend({opacity:1,stroke:"gray","stroke-width":1},a[e%l]),u=360*t.data/A,c=y+w,g=b+w,S,N,C,z,W,X,V,J,K,Q=h.position,G=h.connectorStyle,Y=h.offset,Z,et,tt,nt=!1;_=t.pieID,t=$.extend(!0,{offset:0},t),t.offset&&(S=o(c,g,t.offset,O+u/2),c=S.x,g=S.y),D=[c,g,O,O+u,w,T],k&&x.enabled?(n.segment=D,e<k.length?P=k[e]:(P=$.extend(!0,{},n),P.segment=[c,g,0,360,w,T]),N=s.path().attr(P),n=i(P,n),N.removed||N.wijAnimate(n,x.duration,x.easing,function(){r(N,1,"#cccccc"),V&&!V.removed&&!N.removed&&V.attr({path:N.attr("path")}),delete n.segment})):(N=s.path().attr({segment:D}),r(N,1,"#ccccc"),N.wijAttr(n)),N.angles={start:O,end:O+u},N.index=e,N.getOffset=function(e){var t=o(c,g,e,(N.angles.start+N.angles.end)/2);return{x:t.x-c,y:t.y-g}},N.center={x:c,y:g},N.radius=w,T&&(N.innerRadius=T),V=N.clone(),Raphael.vml?V.attr({opacity:.01,fill:"white","stroke-width":0,"fill-opacity":.01}):V.attr({opacity:.01,fill:"white","fill-opacity":.01}),$.wijraphael.addClass($(V.node),Raphael.format("{0} {1} {2} wijchart-tracker"+e,M.canvasObject,M.pieElement,M.pieTracker)),$(V.node).data("owner",$(N.node)),N.tracker=V,R.push(V),$.wijraphael.addClass($(N.node),Raphael.format("{0} {1} wijmo-wijpiechart-series-"+e,M.canvasObject,M.pieElement)),$(N.node).data("wijchartDataObj",t),E&&(Q==="outside"?(X=o(c,g,w,O+u/2),z=o(c,g,w+Y,O+u/2)):z=o(c,g,t.offset+w*2/3,O+u/2),W=$.extend(!0,{},W,p),t.textStyle&&(W=$.extend(!0,W,t.textStyle)),J=t.label,d&&d.length>0&&(J=Globalize.format(J,d,m)),v&&$.isFunction(v)&&(K={index:e,value:t.data,y:t.data,total:A,chartLabel:J,chartLabelFormatter:v},J=$.proxy(v,K)()),L&&x.enabled?e<L.length?(nt=!0,P=L[e],P.text=J,C=U._text.call(U,0,0,"").attr(P),W=i(P,W),W.x=z.x,W.y=z.y,C.wijAnimate(W,x.duration,x.easing,function(){tt&&tt.show()})):C=U._text.call(U,z.x,z.y,J).attr(W):C=U._text.call(U,z.x,z.y,J).attr(W),Q==="outside"&&(Z=(O+u/2)%360,et=C.wijGetBBox(),Z>=90&&Z<=270?C.transform(Raphael.format("T{0},{1}",-et.width/2,0)):C.transform(Raphael.format("T{0},{1}",et.width/2,0)),tt=s.path(Raphael.format("M{0} {1}L{2} {3}",X.x,X.y,z.x,z.y)).attr(G),nt&&tt.hide(),C.connector=tt),$.wijraphael.addClass($(C.node),Raphael.format("{0} {1} {2}",M.canvasObject,M.pieElement,M.pieLabel)),$(C.node).data("wijchartDataObj",t),I.push(C),F.push(C),B[e]=C.attr()),q.push({label:F[e],sector:N}),t.visible===!1&&(N.hide(),F[e]&&F[e].hide(),tt&&tt.hide(),N.shadow&&N.shadow.hide(),V.hide()),H[e]=N.attr(),j.push(N),I.push(N),t.style=n,t.hoverStyle=f[e],t.index=e,t.value=t.data,t.y=t.data,t.total=A,t.type="pie",O+=u}),F&&F.length&&$.each(F,function(e,t){t.toFront()}),C.sectors=j,_&&(C["sectors"+_]=j,C["labels"+_]=F),C.labels=F,N.chartElements||(N.chartElements={}),R.toFront(),$.extend(!0,N.chartElements,C),N.aniSectorAttrs=H,N.aniLabelAttrs=B,N.seriesEles=q,N.trackers=R,t.data("fields",N),this.unbindLiveEvents(),this.bindLiveEvents()},t.prototype._isTouchEnabled=function(){return $.support.isTouchEnabled&&$.support.isTouchEnabled()&&this.options.enableTouchBehavior===!0},t.prototype.bindLiveEvents=function(){var e=this,t=this.options,n=this.element,r=t.tooltip,i={x:0,y:0},s="",o=$.isFunction,u=t.disabled,a=t.animation;this._isTouchEnabled()&&(s="wij"),r&&r.setTargets(this.tooltipTars),n.on(s+"mousedown."+t.widgetName,"."+t.wijCSS.pieElement,function(e){if(u)return;var r=t.mouseDown,i=$(e.target),s;i.data("owner")&&(i=i.data("owner")),s=i.data("wijchartDataObj");if(!s)return;o(r)&&r.call(n,e,s)}).on(s+"mouseup."+t.widgetName,"."+t.wijCSS.pieElement,function(e){if(u)return;var r=t.mouseUp,i=$(e.target),s;i.data("owner")&&(i=i.data("owner")),s=i.data("wijchartDataObj");if(!s)return;o(r)&&r.call(n,e,s)}).on(s+"mouseover."+t.widgetName,"."+t.wijCSS.pieElement,function(r){if(u)return;var s=t.mouseOver,f=$(r.target),l=a&&a.enabled,c,h,p,d,v,m,g;f.data("owner")&&(f=f.data("owner")),c=f.data("wijchartDataObj");if(!c)return;h=c.pieID||"",p=c.index,d=n.data("fields").chartElements["sectors"+h][p],v=d.showAnimationTimer,m=d.hideAnimationTimer,g=d.explodeAnimationShowing,o(s)&&s.call(n,r,c);if(e._isTouchEnabled())return;if(d.removed)return;d.wijAttr(c.hoverStyle);if(l){m&&(window.clearTimeout(m),m=null,d.hideAnimationTimer=m),v&&(window.clearTimeout(v),v=null,d.showAnimationTimer=null);if(g)return;v=window.setTimeout(function(){var e=a.duration,t=a.easing;if(d.removed)return;i=d.getOffset(a.offset||10),d.offset=i,d.shadow&&!d.shadow.removed&&d.shadow.hide(),d.wijAnimate({transform:Raphael.format("t{0},{1}",i.x,i.y)},e,t),d.tracker&&!d.tracker.removed&&d.tracker.wijAnimate({transform:Raphael.format("t{0},{1}",i.x,i.y)},e,t),g=!0,d.explodeAnimationShowing=g},150),d.showAnimationTimer=v}}).on(s+"mouseout."+t.widgetName,"."+t.wijCSS.pieElement,function(r){if(u)return;var s=t.mouseOut,f=$(r.target),l=a&&a.enabled,c,h,p,d,v,m,g;f.data("owner")&&(f=f.data("owner")),c=f.data("wijchartDataObj");if(!c)return;h=c.pieID||"",p=c.index,d=n.data("fields").chartElements["sectors"+h][p],v=d.showAnimationTimer,m=d.hideAnimationTimer,g=d.explodeAnimationShowing,o(s)&&s.call(n,r,c);if(e._isTouchEnabled())return;if(d.removed)return;c.style.segment&&delete c.style.segment,d.wijAttr(c.style);if(l){m&&(window.clearTimeout(m),m=null,d.hideAnimationTimer=m),v&&(window.clearTimeout(v),v=null,d.showAnimationTimer=v);if(!g)return;m=window.setTimeout(function(){var e=a.duration,t=a.easing;i=d.offset,d.shadow&&!d.shadow.removed&&d.shadow.show(),d.removed||d.wijAnimate({transform:"t0,0"},e,t),d.tracker&&!d.tracker.removed&&d.tracker.wijAnimate({transform:"t0,0"},e,t),d.shadow&&!d.shadow.removed&&d.shadow.wijAnimate({transform:"t0,0"},e,t),i={x:0,y:0},g=!1,d.explodeAnimationShowing=g},150),d.hideAnimationTimer=m}}).on(s+"mousemove."+t.widgetName,"."+t.wijCSS.pieElement,function(e){if(u)return;var r=t.mouseMove,i=$(e.target),s;i.data("owner")&&(i=i.data("owner")),s=i.data("wijchartDataObj");if(!s)return;o(r)&&r.call(n,e,s)}).on(s+"click."+t.widgetName,"."+t.wijCSS.pieElement,function(e){if(u)return;var r=t.click,i=$(e.target),s;i.data("owner")&&(i=i.data("owner")),s=i.data("wijchartDataObj");if(!s)return;o(r)&&r.call(n,e,s)})},t.prototype.unbindLiveEvents=function(){var e=this.element,t=this.options;e.off("."+t.widgetName,"."+t.wijCSS.pieElement)},t}();e.PieChartRender=r})(e.chart||(e.chart={}));var t=e.chart})(wijmo||(wijmo={}));;
var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(t){"use strict";var n=jQuery,r="wijtree",i=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype._create=function(){window.wijmoApplyWijTouchUtilEvents&&(n=window.wijmoApplyWijTouchUtilEvents(n)),this._useDOMInit=!0,this._initState(),this._createTree(),this._attachEvent(),this._attachNodeEvent()},t.prototype._setOption=function(e,t){var r=this,i=!1,s=r.options,o,u;switch(e){case"allowDrag":r._setAllowDrag(t);break;case"allowDrop":r._setAllowDrop(t);break;case"showCheckBoxes":r._setCheckBoxes(t);break;case"showExpandCollapse":r.options.showExpandCollapse!==t&&(i=!0);break;case"disabled":o=r.element.find(":wijmo-wijtreecheck"),o.length&&o.wijtreecheck("option","disabled",t),r._setAllowDrag(!t);break;default:}n.Widget.prototype._setOption.apply(r,arguments),e==="nodes"&&(t&&t.length&&(r._useDOMInit=!1),r._createChildNodes()),i===!0&&r._setHitArea(t)},t.prototype._initState=function(){var e=this,t=e.options;e._selectedNodes=[],e._checkedNodes=[],t.nodes||(t.nodes=[]),t.nodes&&t.nodes.length&&(e._useDOMInit=!1),e._enabled=!0,e._insertPosition="unKnown",e.nodeWidgetName="wijtreenode"},t.prototype._createTree=function(){var e=this,t=e.options,r=[],i=["wijmo-wijtree",t.wijCSS.widget,t.wijCSS.content,t.wijCSS.helperClearFix,t.wijCSS.cornerAll].join(" ");e.element.is("ul")?(e.$nodes=e.element,e.element.wrap("<div></div>"),e.widgetDom=e.element.parent()):e.element.is("div")&&(e.widgetDom=e.element,e.$nodes=e.widgetDom.children("ul:eq(0)")),e.$nodes.length&&(e.widgetDom.addClass(i).attr({role:"tree","aria-multiselectable":!0}),e.$nodes.addClass("wijmo-wijtree-list "+t.wijCSS.helperReset),t.showExpandCollapse===!1&&e.$nodes.addClass("wijmo-wijtree-allexpanded"),e._createChildNodes(),e.widgetDom.append(n("<div>").css("clear","both"))),t.disabled&&e.disable()},t.prototype._createChildNodes=function(){var e=this,t={nIndex:undefined},r=[],i=e.$nodes,s=e.options.nodes,o=i.children("li");!e._useDOMInit||s.length?(i.empty(),n.each(s,function(n,s){var o=e._generateMarkup(s);i.append(o),t.nIndex=n,e._createNodeWidget(o,t),r.push(e._getNodeWidget(o))})):o.each(function(i,o){var u=n(o),a;e._createNodeWidget(u,t),a=e._getNodeWidget(u),r.push(a),s.push(a.options)}),e._hasChildren=r.length>0,e._setField("nodes",r),e.nodes=r},t.prototype._generateMarkup=function(e){var t,r,i=e.navigateUrl||"";if(!n.isPlainObject(e))return;return t=n("<li></li>"),r=n("<a>").attr("src",typeof i=="string"&&i?i:"#"),r.appendTo(t),typeof e.text=="string"&&e.text&&n("<span>").html(e.text).appendTo(r),t},t.prototype._createNodeWidget=function(e,t){var r=this,i=r.nodeWidgetName;return n.fn[i]&&(e.data("owner",this),!!t&&n.isPlainObject(t)?(n.extend(t,{treeClass:this.widgetFullName}),e[i](t)):e[i]({treeClass:this.widgetFullName})),e},t.prototype._attachEvent=function(){var e=this;e.element.bind(n.browser.msie?"focusin.":"focus."+e.widgetName,n.proxy(e._onFocus,e)).bind("mouseover."+this.widgetName,n.proxy(e._onMouseOver,e)),e.options.allowDrop&&e._attachDroppable()},t.prototype._attachDroppable=function(){var e=this,t=e.options,r={accept:"li",scope:"tree",drop:undefined},i=function(n){t.showCheckBoxes&&t.allowTriState&&!n.element.is(":"+e.widgetFullName)&&n._getField("nodes").length>0&&n._getField("nodes")[0]._setParentCheckState()},s=t.droppable;n.extend(r,s),r.drop=function(r,o){var u=o.draggable,a=e._getNodeWidget(u),f,l,c,h,p,d,v,m=-1;if(e._trigger("nodeBeforeDropped",r,o)===!1||!a||t.disabled){e._isDragging=!1;return}f=a._dropTarget,l=a._insertPosition;if(f&&l!=="unKnown"){c=u.data("owner"),c&&(v=u.index());if(l==="end")m=f._getField("nodes").length,h=f;else if(l==="before"||l==="after")h=f._getField("owner"),p=h._getField("nodes"),d=n.inArray(f,p),d!==-1&&(m=l==="before"?d:d+1);s&&n.isFunction(s.drop)?(o.oldParent=c.element,o.newParent=h.element,o.oldIndex=v,o.newIndex=m,s.drop.call(e.element,r,o)):(c&&c.remove(u),m!==-1&&((l==="before"||l==="after")&&d!=n.inArray(f,p)&&m--,e.$nodes.children("li").length?h.add(u,m):e.add(u,m))),n("a:eq(0)",u).blur(),a._tree._isDragging=!1,a.options.selected&&a._setSelected(!1),i(c),i(h),n.extend(o,{sourceParent:c?c.element:null,sIndex:v,targetParent:h.element,tIndex:m,widget:a}),e._trigger("nodeDropped",r,o)}},n.fn.droppable&&e.widgetDom.droppable(r)},t.prototype._attachNodeEvent=function(){this.element.bind("click."+this.widgetName,n.proxy(this._onClick,this)).bind("mouseout."+this.widgetName,n.proxy(this._onMouseOut,this)).bind("keydown."+this.widgetName,n.proxy(this._onKeyDown,this))},t.prototype._onClick=function(e){this._callEvent(e,"_onClick"),n.browser.webkit&&this.widgetDom.focus()},t.prototype._onFocus=function(e){this._callEvent(e,"_onFocus")},t.prototype._onKeyDown=function(e){this._callEvent(e,"_onKeyDown")},t.prototype._onMouseOut=function(e){this._callEvent(e,"_onMouseOut")},t.prototype._onMouseOver=function(e){this._callEvent(e,"_onMouseOver")},t.prototype._callEvent=function(e,t){var n=e.target,r;if(n){r=this._getNodeWidgetByDom(n);if(r===null)return;r[t](e)}},t.prototype._nodeSelector=function(){return":wijmo-wijtreenode"},t.prototype.getSelectedNodes=function(){return this._selectedNodes},t.prototype.getCheckedNodes=function(){var e=this,t=[],r=e.nodeWidgetName;return n(e._nodeSelector(),e.element).each(function(e,i){n(i)[r]("option","checked")&&n(i)[r]("option","checkState")!=="indeterminate"&&t.push(n(i))}),t},t.prototype.destroy=function(){var e=this,t=e.$nodes,r=e.options,i=["wijmo-wijtree",r.wijCSS.widget,r.wijCSS.content,r.wijCSS.helperClearFix,r.wijCSS.cornerAll].join(" ");e.widgetDom.removeClass(i).removeAttr("role").removeAttr("aria-multiselectable"),e.widgetDom.data("uiDroppable")&&e.widgetDom.droppable("destroy"),e.widgetDom.children("div[style]:last").remove(),t.removeData("nodes").removeClass("wijmo-wijtree-list "+r.wijCSS.helperReset),t.children("li").each(function(t,r){var i=e._getNodeWidget(n(r));i&&i.destroy()}),n.wijmo.wijtree.prototype.options.nodes=null,n.Widget.prototype.destroy.apply(this)},t.prototype.add=function(e,t){var r=null,i={},s,o,u=this,a,f,l="<li><a href='{0}'>{1}</a></li>",c;typeof e=="string"?(s=n(l.replace(/\{0\}/,"#").replace(/\{1\}/,e)),u._createNodeWidget(s,i),r=s.data(s.data("widgetName"))):e.jquery?(e.data("widgetName")||u._createNodeWidget(e,i),r=e.data(e.data("widgetName"))):e.nodeType?(s=n(e),u._createNodeWidget(s,i),r=s.data(s.data("widgetName"))):n.isPlainObject(e)&&(s=n(l.replace(/\{0\}/,e.url?e.url:"#").replace(/\{1\}/,e.text)),u._createNodeWidget(s,e),r=s.data(s.data("widgetName")));if(r===null)return;o=u._getField("nodes"),(!t||t>o.length)&&t!==0&&(t=o.length),c=r._getField("nodes"),r._tree=u;for(a=0;a<c.length;a++)c[a]._tree=u;r._setField("owner",this),f=o.length,f>0&&f!==t?r.element.get(0)!==o[t].element.get(0)&&r.element.insertBefore(o[t].element):u.$nodes.append(r.element),u._changeCollection(t,r),r._initNodeClass()},t.prototype.remove=function(e){var t=-1,n,r;e&&e.jquery?t=e.index():typeof e=="number"&&(t=e),r=this._getField("nodes");if(t<0||t>=r.length)return;n=r[t],n.element.detach(),this._changeCollection(t)},t.prototype._changeCollection=function(e,t){var n=this._getField("nodes"),r=this.options.nodes;t?(n.splice(e,0,t),r.splice(e,0,t.options)):(n.splice(e,1),r.splice(e,1))},t.prototype.getNodes=function(){return this.nodes},t.prototype.findNodeByText=function(e){var t=n(".wijmo-wijtree-node a>span",this.$nodes).filter(function(){return n(this).text()===e});return t.length?this._getNodeWidgetByDom(t.get(0)):null},t.prototype._setAllowDrag=function(e){var t=this,r,i=t._nodeSelector(),s="wijmoWijtreenode";if(!n.fn.draggable)return;e?(r=t.element.find(i),r.each(function(){var e=n(this).data(s);(!n(this).data("uiDraggable")&&!e.$navigateUrl.data("events")||!e.$navigateUrl.data("events").mousedown)&&e.$navigateUrl.one("mousedown",e,e._onMouseDown)})):(r=t.element.find(i+":ui-draggable"),r.draggable("destroy"))},t.prototype._setAllowDrop=function(e){if(!n.fn.droppable)return;e?this.widgetDom.data("uiDroppable")||this._attachDroppable():this.widgetDom.droppable&&this.widgetDom.droppable("destroy")},t.prototype._setCheckBoxes=function(e){var t=this;t.$nodes.children("li").each(function(r,i){var s=t._getNodeWidget(n(i));s!==null&&s._setCheckBoxes(e)})},t.prototype._setHitArea=function(e){var t=this;t.$nodes[e?"addClass":"removeClass"]("wijmo-wijtree-allexpanded"),t.$nodes.children("li").each(function(r,i){var s=t._getNodeWidget(n(i));s!==null&&s._setHitArea(e)})},t.prototype._getNodeWidget=function(e){if(e.is(this._nodeSelector())){var t=e.data(e.data("widgetName"));return t}return null},t.prototype._getNodeWidgetByDom=function(e){var t=this._getNodeByDom(e);return this._getNodeWidget(t)},t.prototype._getNodeByDom=function(e){return n(e).closest(this._nodeSelector())},t.prototype._refreshNodesClass=function(){var e=this._getField("nodes"),t;for(t=0;t<e.length;t++)e[t]._initNodeClass()},t.prototype._getField=function(e){return this.element.data(e)},t.prototype._setField=function(e,t){return this.element.data(e,t)},t}(e.wijmoWidget);t.wijtree=i;var s=function(t){function r(){t.apply(this,arguments)}return __extends(r,t),r.prototype._setOption=function(e,t){var r=this,i,s;switch(e){case"accessKey":r.$navigateUrl!==null&&r.$navigateUrl.attr("accesskey",t);break;case"checked":r._checkState=t?"checked":"unChecked",r._setChecked(t);break;case"collapsedIconClass":case"expandedIconClass":case"itemIconClass":r.options[e]=t,r._initNodeImg();break;case"expanded":r._setExpanded(t);break;case"selected":r._setSelected(t);break;case"text":r._setText(t);break;case"toolTip":r._setToolTip(t);break;case"navigateUrl":r._setNavigateUrlHref(t);break;case"disabled":if(r._isClosestDisabled()&&t===!0)return;i=r.element.find(":wijmo-wijtreecheck"),i.length&&i.wijtreecheck("option","disabled",t);break;default:}e==="nodes"?(r.options.nodes.length=0,n.each(t,function(e,t){r.options.nodes.push(t)}),r.options.nodes.concat(),r._hasChildren=r._getChildren(),r._createChildNodes(r.element),r._initNodeClass()):n.Widget.prototype._setOption.apply(r,arguments)},r.prototype._initState=function(){this._tree=null,this._dropTarget=null,this._checkState="unChecked",this._value=this._text=this._navigateUrl="",this._insertPosition="unKnown",this._hasNodes=!1},r.prototype._create=function(){var e=this,t=e.options;e._initState(),e._createTreeNode(),e._initNode(),e.element.data("widgetName","wijmoWijtreenode"),t.selected&&e._tree._selectedNodes.push(e),t.checked&&(e._checkState="checked",e.$checkBox&&(t.checkState==="indeterminate"?e.$checkBox.wijtreecheck("option","checkState","triState"):e.$checkBox.wijtreecheck("option","checkState","check")))},r.prototype._createTreeNode=function(){var e=this.element,t,r,i=this,s,o=i.options,u=[];this.$navigateUrl=e.children("a"),i._tree===null&&(i._tree=i._getTree()),isNaN(o.nIndex)?o.nodes||(o.nodes=[]):(s=i._getOwner().options,r=s.nodes[o.nIndex],r&&!r.nodes&&(r.nodes=[]),n.extend(o,r),s.nodes[o.nIndex]=o),i.$nodeBody=null,i.$checkBox=null,i.$hitArea=null,i.$nodes=null,i.$nodeImage=n("<span>"),i.$nodeBody=n("<div>").attr({role:"treeitem","aria-expanded":!1,"aria-checked":!1,"aria-selected":!1}),i._tree.options.showCheckBoxes===!0&&(i.$checkBox=n("<div>")),i.$navigateUrl.length===0&&(i.$navigateUrl=e.children("div"),i.$navigateUrl.addClass("wijmo-wijtree-template"),i._isTemplate=!0),i.$navigateUrl.length===0&&(i.$navigateUrl=n("<a>"),i.$navigateUrl.attr("href","#")),i._isTemplate||(i.$text=i.$navigateUrl.find("span:eq(0)"),i.$text.length===0&&(i.$navigateUrl.wrapInner("<span></span>"),i.$text=i.$navigateUrl.find("span:eq(0)"))),i._hasChildren=i._getChildren(),i.$inner=n("<span></span>").addClass(o.wijCSS.helperClearFix+" wijmo-wijtree-inner "+o.wijCSS.cornerAll),i._createChildNodes(e),i.$inner.append(i.$nodeImage),i.$checkBox!==null&&(i.$inner.append(i.$checkBox),i.$checkBox.wijtreecheck()),i.$inner.append(i.$navigateUrl),i.$nodeBody.append(i.$inner),e.prepend(i.$nodeBody)},r.prototype._createChildNodes=function(e){var t=this,r=[],i=t.options;t._hasChildren?(e.addClass("wijmo-wijtree-parent"),t.$nodeBody.addClass("wijmo-wijtree-node wijmo-wijtree-header "+i.wijCSS.stateDefault),t.$hitArea=n("<span>"),t.$inner.prepend(t.$hitArea),t.$nodes=e.find("ul:eq(0)"),r=t._createChildNode(),t.$nodes.addClass("wijmo-wijtree-list "+i.wijCSS.helperReset+" wijmo-wijtree-child")):(e.addClass("wijmo-wijtree-item"),t.$nodeBody.addClass("wijmo-wijtree-node "+i.wijCSS.stateDefault)),e.css("list-style-type","none"),t._setField("nodes",r)},r.prototype._createChildNode=function(){var e=this,t=e.options,r=[],i={nIndex:undefined,treeClass:undefined,cfli:undefined,nodes:undefined};return t.nodes&&t.nodes.length?(e.$nodes&&e.$nodes.length?e.$nodes.empty():e.$nodes=n("<ul>").appendTo(e.element),n.each(t.nodes,function(n,s){var o=e._generateMarkup(s),u;e.$nodes.append(o),o.data("owner",e),i.nIndex=n,i.treeClass=t.treeClass,o.wijtreenode(i),u=e._getNodeWidget(o),u._index=n,r.push(u)})):(t.nodes||(t.nodes=[]),e.$nodes.children("li").each(function(s,o){var u=n(o),a;u.data("owner",e),i.cfli=!0,i.nIndex=s,i.treeClass=t.treeClass,i.nodes=[],u.wijtreenode(i),a=e._getNodeWidget(u),a._index=s,r.push(a)})),r},r.prototype._generateMarkup=function(e){var t,r,i=e.navigateUrl||"";if(!n.isPlainObject(e))return;return t=n("<li></li>"),r=n("<a>").attr("src",typeof i=="string"&&i?i:"#"),r.appendTo(t),typeof e.text=="string"&&e.text&&n("<span>").html(e.text).appendTo(r),t},r.prototype._initNode=function(){var e=this,t=e.options;e._initialized||(e._initialized=!0,e._initNavigateUrl(),!e._isTemplate&&e.$text&&(e._text=e.$text.html(),t.text=e.$text.html()),e._hasChildren=e._getChildren(),e._initNodesUL(),e._initNodeClass(),e._initNodeImg(),e._initCheckBox(),e.$navigateUrl.one("mousedown",e,e._onMouseDown))},r.prototype._initNodeClass=function(){var e=this,t=e.options,r,i="wijmo-wijtree-item",s=t.wijCSS.icon+" "+(t.expanded?t.wijCSS.iconArrowRightDown:t.wijCSS.iconArrowRight);e._tree.options.showExpandCollapse&&(e._hasChildren||!!t.hasChildren?(e.$hitArea!==null?e.$hitArea.removeClass([t.wijCSS.icon,t.wijCSS.iconArrowRightDown,t.wijCSS.iconArrowRight].join(" ")).addClass(s):(e.$hitArea=n("<span>").addClass(s).prependTo(e.$inner),e.element.removeClass(i).addClass("wijmo-wijtree-parent")),e._hasChildren&&(r=t.expanded?"":"none",e.$nodes.css({display:r}))):e.$hitArea&&(e.$hitArea.remove(),e.$hitArea=null,e.element.removeClass("wijmo-wijtree-parent").addClass(i))),!e._hasChildren&&e.$nodes&&e.$nodes.css({display:"none"}),t.selected&&e.$inner&&e.$inner.addClass(t.wijCSS.stateActive)},r.prototype._initCheckBox=function(){var e=this,t=e.options;if(e.$checkBox&&t.checkState)switch(t.checkState){case"checked":e.$checkBox.wijtreecheck("option","checkState","check");break;case"indeterminate":e.$checkBox.wijtreecheck("option","checkState","triState");break;case"unChecked":e.$checkBox.wijtreecheck("option","checkState","unCheck");break;default:e.$checkBox.wijtreecheck("option","checkState","unCheck")}},r.prototype._initNodesUL=function(){var e=this;e._tree.options.showExpandCollapse&&e._hasChildren&&e.$nodes[e._expanded?"show":"hide"]()},r.prototype._initNavigateUrl=function(){var e=this,t=e.$navigateUrl.attr("href");e.$navigateUrl.bind("blur."+e.widgetName,e,e._onBlur),this._isTemplate||(e._navigateUrl=t?t:"",e._setNavigateUrlHref(t))},r.prototype._applyIconClass=function(e,t){e.attr("expandediconclass")&&(t.expandedIconClass=e.attr("expandediconclass"),e.removeAttr("expandediconclass")),e.attr("collapsediconclass")&&(t.collapsedIconClass=e.attr("collapsediconclass"),e.removeAttr("collapsediconclass")),e.attr("itemiconclass")&&(t.itemIconClass=e.attr("itemiconclass"),e.removeAttr("itemiconclass"))},r.prototype._initNodeImg=function(){var e=this,t=e.options,r=e.element;if(e.$nodeImage===null||!e.$nodeImage.length)e.$nodeImage=n("<span>");e._applyIconClass(r,t),t.collapsedIconClass!==""&&t.expandedIconClass!==""?(e.$nodeImage.removeClass().addClass(t.wijCSS.icon).addClass(t.expanded?t.expandedIconClass:t.collapsedIconClass),e._tree.options.showExpandCollapse||e.$nodeImage.addClass(t.expandedIconClass),e.$nodeImage.insertBefore(e.$checkBox)):t.itemIconClass!==""&&(e.$nodeImage.removeClass().addClass(t.wijCSS.icon),e.$nodeImage.addClass(t.itemIconClass),e.$nodeImage.insertBefore(e.$checkBox))},r.prototype._setNavigateUrlHref=function(e){if(this.$navigateUrl){if(e===""||typeof e=="undefined")e="#";this.$navigateUrl.attr("href",e)}},r.prototype._editNode=function(){this._tree._editMode=!0,this.$navigateUrl.hide(),this.$editArea||(this.$editArea=n('<input type="text">').wijtextbox()),this.$editArea.val(this.$text.html()),this.$editArea.insertBefore(this.$navigateUrl),this.$editArea.bind("blur",this,this._editionComplete),this.$editArea.focus()},r.prototype._editionComplete=function(e){var t=e.data,n;t._tree._editMode=!1,t.$editArea&&(n=t.$editArea.val(),t.$editArea.remove()),t.$navigateUrl.show(),t.$editArea=null,t._changeText(n)},r.prototype._changeText=function(e){var t=this,n=t.options;t.$text!==null&&e!==""&&(t.$text.text(e),n.text=e,t._tree._trigger("nodeTextChanged",null,t))},r.prototype._expandCollapseItem=function(){var e=this,t=e.options;!e._tree.options.disabled&&!e._isClosestDisabled()&&(e._hasChildren||t.hasChildren)&&e._setExpanded(!t.expanded)},r.prototype._expandNode=function(e){var t=this,n=t._tree.options,r=e?"nodeExpanding":"nodeCollapsing";if(t._tree._trigger(r,null,{node:this,params:this.options.params})===!1)return;t.$nodeBody.attr("aria-expanded",e),t._expanded=e,t.options.expanded=e,!n.disabled&&!t._isClosestDisabled()&&(e?n.expandDelay>0?(typeof t._expandTimer!="undefined"&&(t._expandTimer=window.clearTimeout(t._expandTimer)),t._expandTimer=window.setTimeout(function(){t._expandNodeVisually()},n.expandDelay)):t._expandNodeVisually():n.collapseDelay>0?(t._collapseTimer=window.clearTimeout(t._collapseTimer),t._collapseTimer=window.setTimeout(function(){t._collapseNodeVisually()},n.collapseDelay)):t._collapseNodeVisually())},r.prototype._expandNodeVisually=function(){var e=this,t,r=e.options;e._tree.options.autoCollapse&&(t=e.element.siblings(":"+this.widgetFullName),n.each(t,function(n){var r=e._getNodeWidget(t[n]);r.options.expanded&&r._setExpanded(!1)})),r.collapsedIconClass!==""&&r.expandedIconClass!==""&&e.$nodeImage.removeClass(r.collapsedIconClass).addClass(r.expandedIconClass),e._internalSetNodeClass(!0),e._show()},r.prototype._collapseNodeVisually=function(){var e=this;e.options.collapsedIconClass!==""&&e.options.expandedIconClass!==""&&e.$nodeImage.removeClass(e.options.expandedIconClass).addClass(e.options.collapsedIconClass),e._internalSetNodeClass(!1),e._hide()},r.prototype._internalSetNodeClass=function(e){var t=this.options.wijCSS,n=[t.icon,t.iconArrowRightDown,t.iconArrowRight].join(" ");this.$hitArea&&this.$hitArea.removeClass(n).addClass(t.icon+" "+(e?t.iconArrowRightDown:t.iconArrowRight))},r.prototype._show=function(){this._animation(!0)},r.prototype._hide=function(){this._animation(!1)},r.prototype._animation=function(e){var t=this,r=t.$nodes,i=e?"expandAnimation":"collapseAnimation",s=e?"nodeExpanded":"nodeCollapsed",o,u=t._tree.options[i];r&&(u?(o=u.animated||u.effect,n.effects&&!!o?r[e?"show":"hide"](o,{easing:u.easing},u.duration,function(){t._tree._trigger(s,null,t)}):r[e?"show":"hide"](u.duration,function(){t._tree._trigger(s,null,t)})):(r[e?"show":"hide"](),t._tree._trigger(s,null,t)))},r.prototype._getBounds=function(e){var t=e.height(),n=e.width(),r=e.offset().top,i=e.offset().left;return{h:t,w:n,t:r,l:i}},r.prototype._isMouseInsideRect=function(e,t){return e.x<t.l||e.x>=t.l+t.w?!1:e.y<=t.t+1||e.y>=t.t+t.h?!1:!0},r.prototype._getNodeByMouseOn=function(e){return n("li").each(function(){var t=this._getBounds(n(this));if(n.ui.isOver(e.y,e.x,t.t,t.l,t.h,t.w))return n(this)}),null},r.prototype._drowTemplate=function(e,t,n){var r="unKnown",i=n.is(".wijmo-wijtree-node")?n:n.children(".wijmo-wijtree-node"),s=this._getBounds(i);return t.width(i.width()),e.y>s.t&&e.y<s.t+s.h/2?(t.offset({left:s.l,top:s.t}),r="before"):e.y>s.t+s.h/2&&e.y<s.t+s.h&&(t.offset({left:s.l,top:s.t+s.h}),r="after"),r},r.prototype._beginDrag=function(e){var t=this,r=t.element,i,s=t._tree.options,o=s.draggable,u={cursor:"point",cursorAt:{top:15,left:-25},helper:function(){return n("<div>"+t.$navigateUrl.html()+"</div>").addClass(s.wijCSS.header+" "+s.wijCSS.cornerAll)},distance:n.browser.msie?1:10,handle:t.$navigateUrl,scope:"tree",stop:undefined,start:undefined,drag:undefined},a=n("<div>").addClass("wijmo-wijtree-insertion "+s.wijCSS.stateDefault);typeof s.dropVisual=="string"?(i=n(s.dropVisual),a=i.length?i:a):n.isFunction(s.dropVisual)&&(i=n(s.dropVisual.call()),a=i.length?i:a),a.hide(),n.extend(u,o),u.start=function(e,i){t._tree._isDragging=!0,t._tree.widgetDom.prepend(a),t._tree._trigger("nodeDragStarted",e,t),o&&n.isFunction(o.start)?o.start.call(t.element,e,i):r.hide()},u.drag=function(e,r){var i=e.srcElement||e.originalEvent.target,s=n(i),u,f={x:e.pageX,y:e.pageY};a&&a.hide(),s&&(u=t._getNodeWidget(s),u&&!u._tree.options.disabled?(s.closest(".wijmo-wijtree-inner",t.element).length?t._insertPosition="end":(a.show(),t._insertPosition=t._drowTemplate(f,a,u.element)),u!=t&&(t._dropTarget=u)):s.is(":"+t.options.treeClass)&&(t._dropTarget=s.data(t.options.treeClass),t._insertPosition="end")),t._tree._trigger("nodeDragging",e,t),o&&n.isFunction(o.drag)&&o.drag.call(t.element,e,r)},u.stop=function(e,i){a.remove(),t._dropTarget=null,t._insertPosition="unKnown",t._tree._isDragging=!1,o&&n.isFunction(o.stop)?o.stop.call(t.element,e,i):(r.show(),t._resetDrag())},n.fn.draggable&&(r.draggable(u).trigger(e),n.browser.mozilla&&t._setFocused(!0))},r.prototype._resetDrag=function(){var e=this,t,n;!e._tree.options.allowDrag&&e.element.data("uiDraggable")&&e.element.draggable("destroy"),t=e._getField("nodes");for(n=0;n<t.length;n++)t[n]._resetDrag()},r.prototype._checkClick=function(){var e=this,t=e.options;!e._tree.options.disabled&&!e._isClosestDisabled()&&(t.checked&&e._checkState==="indeterminate"?(e._checkState="checked",e._checkItem()):(e._checkState=t.checked?"unChecked":"checked",e._setChecked(!t.checked)),e._tree._trigger("nodeCheckChanged",null,e))},r.prototype._checkItem=function(){var e=this,t=!1,n=e._tree;if(n===null||!n.options.showCheckBoxes)return;n.options.autoCheckNodes&&e._checkState!=="indeterminate"&&(t=!0,e._changeCheckState(e.options.checked)),n.options.allowTriState&&e._setParentCheckState(),e[e.options.checked?"_checkNode":"_unCheckNode"](t)},r.prototype._checkNode=function(e){var t=this,n=t.options,r=this._getField("nodes"),i;t._checkState==="checked"?(t.$checkBox.wijtreecheck("option","checkState","check"),n.checkState="checked"):t._checkState==="indeterminate"&&(t.$checkBox.wijtreecheck("option","checkState","triState"),n.checkState="indeterminate");if(e)for(i=0;i<r.length;i++)r[i]._checkNode(!0)},r.prototype._unCheckNode=function(e){var t=this._getField("nodes"),n=this.options,r;this.$checkBox.wijtreecheck("option","checkState","unCheck"),n.checkState="unChecked";if(e)for(r=0;r<t.length;r++)t[r]._unCheckNode(!0)},r.prototype._changeCheckState=function(e){var t=this._getField("nodes");n.each(t,function(t,n){n.options.checked=e,n.$nodeBody.attr("aria-checked",e),n._checkState=e?"checked":"unChecked",n._changeCheckState(e)})},r.prototype._setParentCheckState=function(){var e=this._getOwner(),t,n=!0,r=!1,i=!1,s,o=this;if(e.element.is(":"+o.options.treeClass))return;t=e._getField("nodes");for(s=0;s<t.length;s++){t[s]._checkState==="indeterminate"&&(i=!0),t[s].options.checked?r=!0:n=!1;if(!n&&r)break}i?(e._checkState="indeterminate",e._setChecked(!0)):r?(n?(e._checkState="checked",e._checkNode(!1)):e._checkState="indeterminate",e._setChecked(!0)):(e._checkState="unChecked",e._setChecked(!1),e._unCheckNode(!1)),e._setParentCheckState()},r.prototype._onKeyDown=function(e){var t=n(e.target),r=this;t.closest(".wijmo-wijtree-inner",r.element).length>0&&r._keyAction(e)},r.prototype._onClick=function(e){var t=n(e.target),r=this;t.closest(".wijmo-checkbox",r.element).length>0?(r._checkClick(),e.preventDefault(),e.stopPropagation()):r.$hitArea&&r.$hitArea[0]===t[0]?(r._expandCollapseItem(),e.preventDefault(),e.stopPropagation()):t.closest(".wijmo-wijtree-inner",r.element).length>0&&r._click(e)},r.prototype._onMouseDown=function(e){var t=n(e.target),r=e.data;!r._tree.options.disabled&&r._tree.options.allowDrag&&t.closest(".wijmo-wijtree-node",r.element).length>0&&r._beginDrag(e)},r.prototype._onMouseOver=function(e){var t=n(e.target),r=this,i=n(e.relatedTarget);t.closest(".wijmo-wijtree-inner",r.element).length>0&&(this._tree._overNode!==r||i.is(":"+this.widgetFullName))&&(r._mouseOver(e),this._tree._overNode=r),r._mouseOverHitArea(e)},r.prototype._onMouseOut=function(e){var t=n(e.target),r=this,i=n(e.relatedTarget),s=this._getNodeWidget(i);t.closest(".wijmo-wijtree-inner",r.element).length>0&&(this._tree._overNode!==s||i.is(":"+this.widgetFullName)||i.is(".wijmo-wijtree-list")||i.is(".ui-effects-wrapper"))&&(r._mouseOut(e),s||(this._tree._overNode=null)),r._mouseOutHitArea(e)},r.prototype._onFocus=function(e){var t=n(e.target),r=this,i=r.options.wijCSS;t.closest(".wijmo-wijtree-inner",r.element).length>0&&!r._tree.options.disabled&&!r._isClosestDisabled()&&!t.hasClass(i.iconArrowRightDown)&&!t.hasClass(i.iconArrowRight)&&!t.closest(".wijmo-checkbox",r.element).length&&(r._tree._focusNode&&r._tree._focusNode.$navigateUrl.blur(),r._focused=!0,r._tree._focusNode=this,r.$inner.addClass(i.stateFocus),r._tree._trigger("nodeFocus",e,r))},r.prototype._onBlur=function(e){var t=n(e.target),r=e.data,i=r.options.wijCSS;!r._tree.options.disabled&&!r._isClosestDisabled()&&(r._focused=!1,t.closest(".wijmo-wijtree-inner",r.element).length>0&&r.$inner.removeClass(i.stateFocus),r._tree._trigger("nodeBlur",e,r))},r.prototype._click=function(e){var t=this,r=t.options,i=t._tree,s=t.$navigateUrl.attr("href");if(!i.options.disabled&&!t._isClosestDisabled()){if(!/^[#,\s]*$/.test(s)){if(!n.browser.msie||!/^7\.[\d]*/.test(n.browser.version))return;if(s.indexOf(window.location.href)<0)return}t._isClick=!0,i._ctrlKey=e.ctrlKey,r.selected&&i._ctrlKey?t._setSelected(!1):r.selected&&!t._tree._editMode&&i.options.allowEdit&&!t._isTemplate?t._editNode():t._setSelected(!r.selected),t._isTemplate||(e.preventDefault(),e.stopPropagation())}else t._setNavigateUrlHref("")},r.prototype._selectNode=function(e,t){var r=this,i=r.options,s,o;!r._tree.options.disabled&&!r._isClosestDisabled()&&!r._tree._isDragging&&(s=r._tree._ctrlKey,s?(o=n.inArray(r,r._tree._selectedNodes),o!==-1&&!e&&(r._tree._selectedNodes.splice(o,1),r.$inner.removeClass(i.wijCSS.stateActive))):(n.each(r._tree._selectedNodes,function(e,t){t.$inner.removeClass(i.wijCSS.stateActive),t.options.selected=!1,t.$nodeBody.attr("aria-selected",!1)}),r._tree._selectedNodes=[]),e?(o=n.inArray(r,r._tree._selectedNodes),o===-1&&this._tree._selectedNodes.push(r),r.$inner.addClass(i.wijCSS.stateActive)):r.$inner.removeClass(i.wijCSS.stateActive),r._isClick&&r._tree._trigger("nodeClick",t,r),r._isClick=!1,r._tree._ctrlKey=!1,r._tree._trigger("selectedNodeChanged",t,r))},r.prototype._keyAction=function(t){var n=t.target,r=this,i=!1,s=e.getKeyCodeEnum();if(r._tree.options.disabled||r._isClosestDisabled())return;if(n){if(r._tree._editMode&&t.keyCode!==s.ENTER)return;switch(t.keyCode){case s.UP:r._moveUp();break;case s.DOWN:r._moveDown();break;case s.RIGHT:r._tree.options.showExpandCollapse&&r._moveRight();break;case s.LEFT:r._tree.options.showExpandCollapse&&r._moveLeft();break;case 83:!r._tree._editMode&&r._tree.options.allowSorting&&r.sortNodes();break;case 113:r._tree.options.allowEdit&&r._editNode();break;case 109:r._tree.options.showExpandCollapse&&this._expanded&&r._setExpanded(!1);break;case 107:r._tree.options.showExpandCollapse&&!this._expanded&&r._setExpanded(!0);break;case s.ENTER:r._tree._editMode&&(t.data=r,r._editionComplete(t),r._setFocused(!0),i=!0,t.preventDefault());break;case s.SPACE:r._tree.options.showCheckBoxes&&(r._checkState=r.options.checked?"unChecked":"checked",r._setChecked(!r.options.checked))}r._customKeyDown(t.keyCode,i),!r._isTemplate&&t.keyCode!==s.ENTER&&(t.preventDefault(),t.stopPropagation())}},r.prototype._customKeyDown=function(e,t){},r.prototype._prevNode=function(e){var t=e.element;if(t.prev().length>0)return t.prev().data(t.data("widgetName"))},r.prototype._nextNode=function(e){var t=e.element;if(t.next().length>0)return t.next().data(t.data("widgetName"))},r.prototype._getNextExpandedNode=function(e){var t=e,n=e._getField("nodes"),r;return e._expanded&&n.length>0&&(r=n[n.length-1],r!==null&&(t=this._getNextExpandedNode(r))),t},r.prototype._getNextNode=function(e){var t=null,n=this;return e.element.is(":"+n.options.treeClass)?null:(t=n._nextNode(e),t?t:n._getNextNode(e._getOwner()))},r.prototype._moveUp=function(){var e=this._getCurrentLevel(),t=this._prevNode(this);t?this._getNextExpandedNode(t)._setFocused(!0):e>0&&this._getOwner()._setFocused(!0)},r.prototype._moveDown=function(){var e=this._getField("nodes"),t,n,r;this._expanded&&e.length>0?e[0]._setFocused(!0):(t=this._nextNode(this),t?t._setFocused(!0):(n=this._getOwner(),r=this._getNextNode(n),r&&r._setFocused(!0)))},r.prototype._moveLeft=function(){var e=this._getOwner();this._expanded?this._setExpanded(!1):e!==null&&!e.element.is(":"+this.options.treeClass)&&e._setFocused(!0)},r.prototype._moveRight=function(){if(this._hasChildren)if(!this._expanded)this._setExpanded(!0);else{var e=this._getField("nodes")[0];e!==null&&e._setFocused(!0)}},r.prototype._mouseOver=function(e){var t=this,n=t._tree;!n.options.disabled&&!t._isClosestDisabled()&&!n._editMode&&(t._mouseOverNode(),n._isDragging||n._trigger("nodeMouseOver",e,t))},r.prototype._mouseOut=function(e){var t=this,n=t._tree;!n.options.disabled&&!t._isClosestDisabled()&&!n._editMode&&(t._mouseOutNode(),n._isDragging||n._trigger("nodeMouseOut",e,t))},r.prototype._mouseOverNode=function(){this.$inner!==null&&!this._isOverNode&&(this.$inner.addClass(this.options.wijCSS.stateHover),this._isOverNode=!0)},r.prototype._mouseOutNode=function(){this.$inner!==null&&this._isOverNode&&(this.$inner.removeClass(this.options.wijCSS.stateHover),this._isOverNode=!1)},r.prototype._mouseOverHitArea=function(e){var t,n,r=this,i=r._tree;!i.options.disabled&&!r._isClosestDisabled()&&i.options.expandCollapseHoverUsed&&r._hasChildren&&!r._isOverHitArea&&(t=r._getBounds(r.element),n={x:e.pageX,y:e.pageY},r._isMouseInsideRect(n,t)&&(r._isOverHitArea=!0,r._setExpanded(!0)))},r.prototype._mouseOutHitArea=function(e){var t={x:e.pageX,y:e.pageY},n,r=this,i=r._tree;!i.options.disabled&&!r._isClosestDisabled()&&i.options.expandCollapseHoverUsed&&(r._hasChildren&&!!r._isOverHitArea?(n=r._getBounds(r.element),r._isMouseInsideRect(t,n)||(r._isOverHitArea=!1,r._setExpanded(!1))):r._getOwner().element.is(":"+r.widgetFullName)&&(n=r._getBounds(r._getOwner().element),r._isMouseInsideRect(t,n)||(r._getOwner()._isOverHitArea=!1,r._getOwner()._setExpanded(!1))))},r.prototype.destroy=function(){var e=this,t,r=e.options;e.element.data("uiDraggable")&&e.element.draggable("destroy"),e.$hitArea&&e.$hitArea.remove(),e.$checkBox&&e.$checkBox.remove(),e.$nodeImage&&e.$nodeImage.remove(),e.$navigateUrl.unwrap().unwrap().removeClass(r.wijCSS.stateDefault+" "+r.wijCSS.stateActive).unbind("mousedown").unbind("blur"),t=this.element.find("ul:first").show(),t.removeClass(),t.children("li").each(function(){var t=e._getNodeWidget(n(this));t.destroy()}),e.element.removeData("nodes").removeData("owner").removeData("widgetName").removeClass(),n.Widget.prototype.destroy.apply(this)},r.prototype.add=function(e,t){var r=null,i,s,o=this,u,a,f="<li><a href='{0}'>{1}</a></li>",l;typeof e=="string"?(i=n(f.replace(/\{0\}/,"#").replace(/\{1\}/,e)),o._createNodeWidget(i),r=i.data(i.data("widgetName"))):e.jquery?(e.data("widgetName")||o._createNodeWidget(e),r=e.data(e.data("widgetName"))):e.nodeType?(i=n(e),o._createNodeWidget(i),r=i.data(i.data("widgetName"))):n.isPlainObject(e)&&(i=n(f.replace(/\{0\}/,e.url?e.url:"#").replace(/\{1\}/,e.text)),o._createNodeWidget(i,e),r=i.data(i.data("widgetName")));if(r===null)return;s=o._getField("nodes"),(!t||t>s.length)&&t!==0&&(t=s.length),n.mobile&&r.element.find("a").addClass("ui-link"),u=r._getField("nodes"),r._tree=o._tree;for(a=0;a<u.length;a++)u[a]._tree=o._tree;r._setField("owner",o),l=s.length,o.$nodes||(o.$nodes=n("<ul></ul>").addClass("wijmo-wijtree-list "+o.options.wijCSS.helperReset+" wijmo-wijtree-child"),o.element.append(o.$nodes)),l>0&&l!==t?r.element.get(0)!==s[t].element.get(0)&&r.element.insertBefore(s[t].element):o.$nodes.append(r.element),o._changeCollection(t,r),o._collectionChanged(),r._initNodeClass()},r.prototype.remove=function(e){var t=-1,n,r=this,i=this._getField("nodes");e.jquery?t=e.index():typeof e=="number"&&(t=e);if(t<0||t>=i.length)return;n=i[t],n.element.detach(),r._changeCollection(t),r._collectionChanged()},r.prototype.getNodes=function(){return this._getField("nodes")},r.prototype._changeCollection=function(e,t){var n=this._getField("nodes"),r=this.options.nodes;t?(n.splice(e,0,t),r.splice(e,0,t.options)):(n.splice(e,1),r.splice(e,1))},r.prototype.sortNodes=function(){var e=this._getField("nodes");this._sort(),n.each(e,function(e,t){t._index=e,t._insertBefore(e)}),this._refreshNodesClass()},r.prototype.check=function(e){this._setOption("checked",e)},r.prototype.select=function(e){this._setOption("selected",e)},r.prototype.getOwner=function(){var e=this._getOwner();return e&&e.element.is("li")?e:null},r.prototype.expand=function(){this._setOption("expanded",!0)},r.prototype.collapse=function(){this._setOption("expanded",!1)},r.prototype._insertBefore=function(e){var t=this.element.parent().children("li");this.element.index()!==e&&this.element.insertBefore(t.eq(e))},r.prototype._sort=function(){var e=this._getField("nodes");this._isSorted?this._isDecsSort?(e.sort(this._compare2NodeTextDesc),this._isDecsSort=!1):(e.sort(this._compare2NodeTextAcs),this._isDecsSort=!0):(e.sort(this._compare2NodeTextAcs),this._isSorted=!0,this._isDecsSort=!0)},r.prototype._compare2NodeTextAcs=function(e,t){if(e!==null&&t!==null)return e._text.localeCompare(t._text)},r.prototype._compare2NodeTextDesc=function(e,t){if(e!==null&&t!==null)return-1*e._text.localeCompare(t._text)},r.prototype._collectionChanged=function(){this._hasChildren=this._getChildren(),this._initNodeClass()},r.prototype._refreshNodesClass=function(){var e=this._getField("nodes"),t;for(t=0;t<e.length;t++)e[t]._initNodeClass()},r.prototype._setChecked=function(e){var t=this;if(t.options.checked===e&&t._checkState!=="indeterminate")return;t.options.checked=e,t.$nodeBody.attr("aria-checked",e),this._checkItem()},r.prototype._isClosestDisabled=function(){var e=this;return e.element.closest(".wijmo-wijtree-disabled,.wijmo-wijtreenode-disabled",e._tree.element).length?!0:!1},r.prototype._setExpanded=function(e){var t=this,n=t.options;if(t._expanded===e)return;(t._hasChildren||n.hasChildren)&&t._expandNode(e)},r.prototype._setFocused=function(e){e?(this.$navigateUrl.focus(),this._setFocusNode()):this.$navigateUrl.blur()},r.prototype._setFocusNode=function(){this._tree._focusNode&&n.browser.webkit&&this._tree._focusNode.$navigateUrl.blur(),this._focused=!0,this._tree._focusNode=this,this.$inner.addClass(this.options.wijCSS.stateFocus),this._tree._trigger("nodeFocus",null,this)},r.prototype._setToolTip=function(e){e.length?this.element.attr("title",e):this.element.removeAttr("title")},r.prototype._setText=function(e){this._text!==e&&e.length&&(this._text=e,this._changeText(e))},r.prototype._setSelected=function(e){var t=this,n=t.options;n.selected!==e&&(n.selected=e,t.$nodeBody.attr("aria-selected",e),t._selectNode(e),t._setFocused(e))},r.prototype._setCheckBoxes=function(e){var t=this;t.$checkBox?t.$checkBox[e?"show":"hide"]():e&&(t.$checkBox=n("<div>"),t.$checkBox.insertBefore(t.$navigateUrl),t.$checkBox.wijtreecheck()),t.$nodes&&t.$nodes.children("li").each(function(r,i){var s=t._getNodeWidget(n(i));s!==null&&s._setCheckBoxes(e)})},r.prototype._setHitArea=function(e){var t=this;t._hasChildren&&(e?(t._initNodeClass(),t.$hitArea&&t.$hitArea.show()):(t._expanded=!0,t.options.expanded=!0,t.$nodeBody.attr("aria-expanded",!0),t.$nodes&&t.$nodes.show(),t._initNodeClass(),t.$hitArea&&t.$hitArea.hide())),t.$nodes&&t.$nodes.children("li").each(function(r,i){var s=t._getNodeWidget(n(i));s!==null&&s._setHitArea(e)})},r.prototype._getOwner=function(){return this._getField("owner")},r.prototype._getTree=function(){var e=this._getOwner();return e?e.element.is(":"+this.options.treeClass)?e:e._getTree():null},r.prototype._getInitElement=function(){var e=n("<li>"),t=this,r=n("<ul>"),i=t._getField("nodes");return e.append(t.$navigateUrl.clone()),i.length&&(e.append(r),n.each(i,function(e,t){var n=t._getInitElement();r.append(n)})),e},r.prototype._getChildren=function(){return this.element.find(">ul:first>li").length>0&&this.element.children("ul:first")||!!this.options.nodes&&!!this.options.nodes.length},r.prototype._getNodeWidget=function(e){var t=this._getNodeByDom(e),n;return t.length>0?(n=t.data(t.data("widgetName")),n):null},r.prototype._createNodeWidget=function(e,t){return n.fn.wijtreenode&&(e.data("owner",this),!!t&&n.isPlainObject(t)?(n.extend(t,{treeClass:this.options.treeClass}),e.wijtreenode(t)):e.wijtreenode({treeClass:this.options.treeClass})),e},r.prototype._getNodeByDom=function(e){return n(e).closest(":"+this.widgetFullName)},r.prototype._getCurrentLevel=function(){return this.element.parentsUntil(":"+this.options.treeClass).length-1},r.prototype._getField=function(e){return this.element.data(e)},r.prototype._setField=function(e,t){return this.element.data(e,t)},r}(e.wijmoWidget);t.wijtreenode=s;var o="",u="",a=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype._initCSS=function(e){var t=e.wijCSS;o=t.icon+" "+t.iconCheck,u=t.icon+" "+t.iconStop},t.prototype._create=function(){var e=this,t=this.options,r=t.wijCSS;e._initCSS(t),e.element.is("div")&&(e.element.addClass("wijmo-checkbox "+r.widget).attr("role","checkbox"),e.$icon=n("<span>"),e.$icon.addClass("wijmo-checkbox-icon"),t.checkState==="check"?e.$icon.addClass(o):t.checkState==="triState"&&e.$icon.addClass(u),e.$body=n("<div></div>").addClass(["wijmo-checkbox-box",r.widget,r.cornerAll,r.stateDefault].join(" ")).css({position:"relative"}).append(e.$icon),e.element.append(e.$body),e.element.bind("mouseover.wijtreecheck",function(){e.options.disabled||e.$body.addClass(r.stateHover)}).bind("mouseout.wijtreecheck",function(){e.options.disabled||e.$body.removeClass(r.stateHover).not(r.stateFocus).addClass(r.stateDefault)}))},t.prototype._setOption=function(e,t){var r=this,i=r.options.wijCSS;e==="checkState"&&(t==="unCheck"?(r.$body.removeClass(i.stateActive),r.$icon.removeClass(o+" "+u+" "+i.stateActive)):t==="check"?(r.$body.addClass(i.stateActive),r.$icon.removeClass(u).addClass(o)):t==="triState"&&(r.$body.addClass(i.stateActive),r.$icon.removeClass(o).addClass(u))),n.Widget.prototype._setOption.apply(r,arguments)},t.prototype.destory=function(){this.element.children().remove(),this.element.removeClass("wijmo-checkbox "+this.options.wijCSS.widget),n.Widget.prototype.destroy.apply(this)},t}(e.wijmoWidget);t.wijtreecheck=a,a.prototype.options=n.extend(!0,{},e.wijmoWidget.prototype.options,{wijMobileCSS:{header:"ui-header ui-bar-a",content:"ui-body-c",stateHover:"ui-btn-down-b",stateActive:"ui-btn-down-b"},checkState:"unCheck"});var f=function(){function e(){this.wijMobileCSS={header:"ui-header ui-bar-a",content:"ui-body-c",stateDefault:"ui-btn-up-c",stateHover:"ui-btn-down-c",stateActive:"ui-btn-down-b"},this.treeClass="wijmo-wijtree",this.initSelector=":jqmData(role='wijtreenode')",this.accessKey="",this.checked=!1,this.collapsedIconClass="",this.expanded=!1,this.expandedIconClass="",this.itemIconClass="",this.navigateUrl="",this.selected=!1,this.text="",this.toolTip="",this.hasChildren=!1,this.params={},this.nodes=null}return e}(),l=function(){function e(){this.wijMobileCSS={header:"ui-header ui-bar-a",content:"ui-body-c",stateDefault:"ui-btn-up-c",stateHover:"ui-btn-down-b",stateActive:"ui-btn-down-c"},this.allowDrag=!1,this.allowDrop=!1,this.allowEdit=!1,this.allowSorting=!0,this.allowTriState=!0,this.autoCheckNodes=!0,this.autoCollapse=!1,this.disabled=!1,this.expandCollapseHoverUsed=!1,this.showCheckBoxes=!1,this.showExpandCollapse=!0,this.expandAnimation={effect:"blind",easing:"linear",duration:200},this.expandDelay=0,this.collapseAnimation={effect:"blind",easing:"linear",duration:200},this.collapseDelay=0,this.draggable=null,this.droppable=null,this.dropVisual=null,this.nodes=null,this.nodeBlur=null,this.nodeFocus=null,this.nodeClick=null,this.nodeCheckChanged=null,this.nodeCollapsed=null,this.nodeExpanded=null,this.nodeDragging=null,this.nodeDragStarted=null,this.nodeBeforeDropped=null,this.nodeDropped=null,this.nodeMouseOver=null,this.nodeMouseOut=null,this.nodeTextChanged=null,this.selectedNodeChanged=null,this.nodeExpanding=null,this.nodeCollapsing=null}return e}();s.prototype.options=n.extend(!0,{},e.wijmoWidget.prototype.options,new f),i.prototype.options=n.extend(!0,{},e.wijmoWidget.prototype.options,new l),n.wijmo.registerWidget("wijtree",i.prototype),n.wijmo.registerWidget("wijtreenode",s.prototype),n.wijmo.registerWidget("wijtreecheck",a.prototype)})(e.tree||(e.tree={}));var t=e.tree})(wijmo||(wijmo={}));;
var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(t){"use strict";var n=jQuery,r="wijupload",i="wijmo-wijupload",s="wijmo-wijupload-fileRow",o="."+s,u="wijmo-wijupload-filesList",a="wijmo-wijupload-commandRow",f="wijmo-wijupload-uploadAll",l="wijmo-wijupload-cancelAll",c="wijmo-wijupload-buttonContainer",h="wijmo-wijupload-upload",p="."+h,d="wijmo-wijupload-cancel",v="."+d,m="wijmo-wijupload-file",g="wijmo-wijupload-progress",y="wijmo-wijupload-loading",b="ui-widget-content",w="ui-corner-all",E="ui-state-highlight",S,x,T=function(e){return e.indexOf("\\")>-1&&(e=e.substring(e.lastIndexOf("\\")+1)),e},N=function(e){var t=e.files,r="";return t?(n.each(t,function(e,t){r+=T(t.name)+"; "}),r.length&&(r=r.substring(0,r.lastIndexOf(";")))):r=T(e.value),r},C=function(e){var t=e.files,r=0;return t&&t.length>0&&n.each(t,function(e,t){t.size&&(r+=t.size)}),r};S=function(e,t,r){var i,s=n("input",t),o=function(e){e&&(e.abort(),e=null)},u=function(e){e&&(e=null)},a=function(){var e=this,i=s.get(0).files,a=[],f=0,l=0,c=function(t,r){var o=new XMLHttpRequest;return o.open("POST",r,!0),o.setRequestHeader("Wijmo-RequestType","XMLHttpRequest"),o.setRequestHeader("Cache-Control","no-cache"),o.setRequestHeader("Wijmo-FileName",t),o.setRequestHeader("Content-Type","application/octet-stream"),o.upload.onprogress=function(t){if(t.lengthComputable){var r;n.isFunction(e.onProgress)&&(r={supportProgress:!0,loaded:l+t.loaded,total:C(s[0]),fileName:T(e.currentFile.name),fileNameList:N(s[0]).split("; ")},e.onProgress(r))}},o.onreadystatechange=function(t){if(this.readyState===4){var r=this.responseText,s;l+=i[f].size,f++,i.length>f?h(i[f]):n.isFunction(e.onComplete)&&(s={e:t,response:r,supportProgress:!0},e.onComplete(s))}},a.push(o),o},h=function(t){var n=T(t.name),i=c(n,r);e.handleRequest(i,t),e.currentFile=t,i.send(t)};e.fileRow=t,e.inputFile=s,e.upload=function(){h(i[f])},e.cancel=function(){n.each(a,function(e,t){o(t)}),n.isFunction(e.onCancel)&&e.onCancel()},e.destroy=function(){n.each(a,function(e,t){u(t)})},e.updateAction=function(e){r=e},e.handleRequest=null,e.onCancel=null,e.onComplete=null,e.onProgress=null};return i=new a,i},x=function(e,t,r){var i,s=n("input",t),o=s.attr("id"),u="wijUploadForm_"+e,a=n("#"+u),f="wijUploadIfm_"+o,l=!0,c=n('<iframe id="'+f+'" name="'+f+'">'),h=function(e,t){a.empty(),a.attr("target",e.attr("name")),t&&(t.parent().append(t.clone()),a.append(t)),a.submit()},p=function(e){e.attr("src","javascript".concat(":false;"))},d=function(e,t){t&&a&&(a.remove(),a=null),e&&(e.remove(),e=null)},v;return a.length===0&&(a=n('<form method="post" enctype="multipart/form-data"></form>'),a.attr("action",r).attr("id",u).attr("name",u).appendTo("body")),c.css("position","absolute").css("top","-1000px").css("left","-1000px"),c.appendTo("body"),v=function(){var e=this;e.fileRow=t,e.iframe=c,e.inputFile=s,e.upload=function(){var t;h(c,s),n.isFunction(e.onProgress)&&(t={supportProgress:!1,loaded:1,total:1},e.onProgress(t))},e.doPost=function(){h(c)},e.cancel=function(){p(c),n.isFunction(e.onCancel)&&e.onCancel()},e.updateAction=function(e){r=e,a.attr("action",e)},e.destroy=function(e){d(c,e)},e.onCancel=null,e.onComplete=null,e.onProgress=null,c.bind("load",function(t){if(!n.browser.safari&&l&&!e.autoSubmit){l=!1;return}if(c.attr("src")==="javascript".concat(":false;"))return;var r=t.target,i,s,o;try{s=r.contentDocument?r.contentDocument:window.frames[0].document,s.XMLDocument?i=s.XMLDocument:s.body?i=s.body.innerHTML:i=s,n.isFunction(e.onComplete)&&(o={e:t,response:i,supportProgress:!1},e.onComplete(o))}catch(u){i=""}finally{}})},i=new v,i};var k=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype._swfAppendAddtionalData=function(e){e.queueData={files:{},filesSelected:0,filesQueued:0,filesReplaced:0,filesCancelled:0,filesErrored:0,uploadsSuccessful:0,uploadsErrored:0,averageSpeed:0,queueLength:0,queueSize:0,uploadSize:0,queueBytesUploaded:0,uploadQueue:[],errorMsg:""},e.widget=this},t.prototype._swfGetHandlers=function(){var e=this,t=e.element;return{onSelect:function(t){var n=this,r={};if(e._trigger("change",null,t)===!1)return!1;e._createFileRow(t),this.queueData.queueSize+=t.size,this.queueData.files[t.id]=t},onSelectError:function(e,t){t==SWFUpload.QUEUE_ERROR.FILE_EXCEEDS_SIZE_LIMIT?alert("File size exceeds the limitation!"):t==SWFUpload.QUEUE_ERROR.QUEUE_LIMIT_EXCEEDED&&alert("Too many files!")},onDialogOpen:function(){this.queueData.filesReplaced=0,this.queueData.filesCancelled=0},onDialogClose:function(t,n,r){var i=this.settings;this.queueData.filesErrored=t-n,this.queueData.filesSelected=t,this.queueData.filesQueued=n-this.queueData.filesCancelled,this.queueData.queueLength=r,e.isStartUpload=!1,e.options.autoSubmit&&(e.uploadAll=!0,e._swfUploadFile()),i.onDialogClose&&i.onDialogClose.call(this,this.queueData)},onUploadStart:function(t){this.bytesLoaded=0,this.queueData.uploadQueue.length==0&&(this.queueData.uploadSize=t.size);if(!e.isStartUpload&&e.uploadAll){if(e._trigger("totalUpload",null,null)===!1)return this.cancelUpload(),!1;e.isStartUpload=!0}if(e._trigger("upload",null,t)===!1)return this.cancelUpload(t.id),!1},onUploadProgress:function(r,i,s){var o=n("#"+r.id,t),u,a,f=Math.round(i/s*100),l=n("."+g,o),c={sender:r.name,loaded:i,total:s},h=this.queueData;l.html(f+"%"),e._trigger("progress",null,c),u=h.queueBytesUploaded+i,a=h.queueSize,e._updateSwfProgress(u,a),e._trigger("totalProgress",null,{loaded:u,total:a})},onUploadError:function(e,r,i){var s=this.settings,o=n("#"+e.id,t),u=n("."+g,o),a="Error";switch(r){case SWFUpload.UPLOAD_ERROR.HTTP_ERROR:a="HTTP Error ("+i+")";break;case SWFUpload.UPLOAD_ERROR.MISSING_UPLOAD_URL:a="Missing Upload URL";break;case SWFUpload.UPLOAD_ERROR.IO_ERROR:a="IO Error";break;case SWFUpload.UPLOAD_ERROR.SECURITY_ERROR:a="Security Error";break;case SWFUpload.UPLOAD_ERROR.UPLOAD_LIMIT_EXCEEDED:alert("The upload limit has been reached ("+i+")."),a="Exceeds Upload Limit";break;case SWFUpload.UPLOAD_ERROR.UPLOAD_FAILED:a="Failed";break;case SWFUpload.UPLOAD_ERROR.SPECIFIED_FILE_ID_NOT_FOUND:break;case SWFUpload.UPLOAD_ERROR.FILE_VALIDATION_FAILED:a="Validation Error";break;case SWFUpload.UPLOAD_ERROR.FILE_CANCELLED:a="Cancelled",this.queueData.queueSize-=e.size,this.queueData.queueLength-=1;if(e.status==SWFUpload.FILE_STATUS.IN_PROGRESS||n.inArray(e.id,this.queueData.uploadQueue)>=0)this.queueData.uploadSize-=e.size;s.onCancel&&s.onCancel.call(this,e),delete this.queueData.files[e.id];break;case SWFUpload.UPLOAD_ERROR.UPLOAD_STOPPED:a="Stopped"}u.text(a);var f=this.getStats();this.queueData.uploadsErrored=f.upload_errors},onUploadSuccess:function(r,i,s){var o=this.getStats();this.queueData.uploadsSuccessful=o.successful_uploads,this.queueData.queueBytesUploaded+=r.size,this.queueData.response=s;var u=n("#"+r.id,t),a=this;a.queueData.queueLength-=1,u.fadeOut(1500,function(){u.remove(),e.options.showUploadedFiles&&e._createUploadedFiles(r.name),a.queueData.queueLength||e.commandRow.hide()}),e._trigger("complete",null,{response:s})},onUploadComplete:function(t,n,r){var i=this;!i.queueData.queueLength&&e.uploadAll&&(e._cleanSwfProgress(),e._trigger("totalComplete",null,i.queueData)),e.uploadAll&&e._swfUploadFile()}}},t.prototype._cleanSwfProgress=function(){},t.prototype._updateSwfProgress=function(e,t){},t.prototype._initSwfUploadOptions=function(e,t){var r=this,i=r.element,s,o=r._swfGetHandlers(),u=r.options,a=r.options.swfUploadOptions,f=i.attr("id"),l=f+"_SWFUpload";return n("<input type='file' id='"+l+"'>").appendTo(i),s=n.extend({id:l,swf:"SWFUpload.swf",auto:!1,buttonClass:"",buttonCursor:"hand",buttonImage:null,checkExisting:!1,debug:!1,fileObjName:"Filedata",fileSizeLimit:u.maximumFileSize?u.maximumFileSize:0,fileTypeDesc:"All Files",fileTypeExts:u.accept?u.accept:"*.*",height:t,itemTemplate:!1,method:"post",multi:u.multiple,formData:{},preventCaching:!0,progressData:"percentage",queueID:!1,queueSizeLimit:u.maximumFiles?u.maximumFiles:999,removeCompleted:!0,removeTimeout:3,requeueErrors:!1,successTimeout:30,uploadLimit:0,width:e,uploader:u.action,overrideEvents:[]},a),{assume_success_timeout:s.successTimeout,button_placeholder_id:s.id,button_width:s.width,button_height:s.height,button_text:null,button_text_style:null,button_text_top_padding:0,button_text_left_padding:0,button_action:u.multiple?SWFUpload.BUTTON_ACTION.SELECT_FILES:SWFUpload.BUTTON_ACTION.SELECT_FILE,button_disabled:!1,button_cursor:s.buttonCursor=="arrow"?SWFUpload.CURSOR.ARROW:SWFUpload.CURSOR.HAND,button_window_mode:SWFUpload.WINDOW_MODE.TRANSPARENT,debug:s.debug,requeue_on_error:s.requeueErrors,file_post_name:s.fileObjName,file_size_limit:s.fileSizeLimit,file_types:s.fileTypeExts,file_types_description:s.fileTypeDesc,file_queue_limit:s.queueSizeLimit,file_upload_limit:s.uploadLimit,flash_url:s.swf,prevent_swf_caching:s.preventCaching,post_params:s.formData,upload_url:s.uploader,use_query_string:s.method=="get",file_dialog_complete_handler:o.onDialogClose,file_dialog_start_handler:o.onDialogOpen,file_queued_handler:o.onSelect,file_queue_error_handler:o.onSelectError,swfupload_loaded_handler:s.onSWFReady,upload_complete_handler:o.onUploadComplete,upload_error_handler:o.onUploadError,upload_progress_handler:o.onUploadProgress,upload_start_handler:o.onUploadStart,upload_success_handler:o.onUploadSuccess}},t.prototype._createSWFUpload=function(){var e=this,t=e.element,r=e.addBtn,i,s=e.options.swfUploadOptions,o,u=r.width(),a=r.height(),f=swfobject.getFlashPlayerVersion(),l=f.major>=9;l?(i=e._initSwfUploadOptions(u,a),o=new SWFUpload(i),e.swfupload=o,n("#"+o.movieName).css({position:"absolute","z-index":100,top:0,left:0,width:u,height:a}),e._swfAppendAddtionalData(o)):(alert("Please install flash player."),s&&s.onFallback&&s.onFallback.call())},t.prototype._create=function(){var e=this,t=e.options,r=(new Date).getTime(),i=e.supportXhr();window.wijmoApplyWijTouchUtilEvents&&(n=window.wijmoApplyWijTouchUtilEvents(n)),e.filesLen=0,e.totalUploadFiles=0,e.useXhr=i,e.id=r,e._createContainers(),e._createUploadButton(),t.enableSWFUploadOnIE&&n.browser.msie||t.enableSWFUpload?e._createSWFUpload():e._createFileInput(),e._bindEvents(),t.disabled&&e.disable(),e.element.is(":hidden")&&e.element.wijAddVisibilityObserver&&e.element.wijAddVisibilityObserver(function(){e._applyInputPosition(),e.element.wijRemoveVisibilityObserver&&e.element.wijRemoveVisibilityObserver()},"wijupload")},t.prototype._setOption=function(e,t){var r=this;n.Widget.prototype._setOption.apply(this,arguments),e==="disabled"?r._handleDisabledOption(t,r.upload):e==="accept"&&r.input&&r.input.attr("accept",t)},t.prototype._handleDisabledOption=function(e,t){var n=this;e?(n.disabledDiv||(n.disabledDiv=n._createDisabledDiv(t)),n.disabledDiv.appendTo("body")):n.disabledDiv&&(n.disabledDiv.remove(),n.disabledDiv=null)},t.prototype._createDisabledDiv=function(e){var t=this,r,i=e?e:t.upload,s=i.offset(),o=i.outerWidth(),u=i.outerHeight();return r=n("<div></div>").addClass("ui-disabled").css({"z-index":"99999",position:"absolute",width:o,height:u,left:s.left,top:s.top}),n.browser.msie&&(r.css("background-color","white"),parseInt(n.browser.version)>=9&&r.css("opacity","0.1")),r},t.prototype.destroy=function(){var e=this;e.upload.removeClass(i),e.upload.undelegate(e.widgetName).undelegate("."+e.widgetName),e.input.remove(),e.addBtn.remove(),e.filesList.remove(),e.commandRow.remove(),e.isCreateByInput===!0&&e.element.css({display:""}).unwrap(),e.uploaders&&(n.each(e.uploaders,function(e,t){t.destroy&&t.destroy(!0),t=null}),e.uploaders=null),e.disabledDiv&&(e.disabledDiv.remove(),e.disabledDiv=null)},t.prototype.widget=function(){return this.upload},t.prototype.supportXhr=function(){var e=!1;return typeof (new XMLHttpRequest).upload=="undefined"?e=!1:e=!0,e},t.prototype._createContainers=function(){var e=this,t,r,s=e.element;if(s.is(":input")&&s.attr("type")==="file")e.isCreateByInput=!0,e.maxDisplay=s.attr("multiple")||e.options.multiple?0:1,e.upload=s.css({display:"none"}).wrap("<div>").parent();else{if(!e.element.is("div"))throw'The initial markup must be "DIV", "INPUT[type=file]"';e.maxDisplay=e.options.multiple?0:1,e.upload=s}e.upload.addClass(i),t=n("<ul>").addClass(u).appendTo(e.upload),r=n("<div>").addClass(a).appendTo(e.upload),e.filesList=t,r.hide(),e.commandRow=r,e._createCommandRow(r)},t.prototype._createCommandRow=function(e){var t=this,r=n("<a>").attr("href","#").text("uploadAll").addClass(f).button({icons:{primary:"ui-icon-circle-arrow-n"},label:t._getLocalization("uploadAll","Upload All")}),i=n("<a>").attr("href","#").text("cancelAll").addClass(l).button({icons:{primary:"ui-icon-cancel"},label:t._getLocalization("cancelAll","Cancel All")});e.append(r).append(i)},t.prototype._getLocalization=function(e,t){var n=this.options.localization;return n&&n[e]||t},t.prototype._createUploadButton=function(){var e=this,t=n("<a>").attr("href","#").button({label:e._getLocalization("uploadFiles","Upload files")});t.mousemove(function(n){var r=t.data("uiButton").options.disabled;if(e.input){var i=n.pageX,s=n.pageY;r||e.input.offset({left:i+10-e.input.width(),top:s+10-e.input.height()})}}),e.addBtn=t,e.upload.prepend(t)},t.prototype._applyInputPosition=function(){var e=this,t=e.addBtn,n=t.offset(),r=e.cuurentInput;r.offset({left:n.left+t.width()-r.width(),top:n.top}).height(t.height())},t.prototype._createFileInput=function(){var e=this,t=e.addBtn,r=t.offset(),i=e.element.attr("accept")||e.options.accept,s="wijUpload_"+e.id+"_input"+e.filesLen,o=n("<input>").attr("type","file").prependTo(e.upload),u=e.options.maximumFiles||e.maxDisplay;u!==1&&e.maxDisplay===0&&o.attr("multiple","multiple"),i&&o.attr("accept",i),e.cuurentInput=o,e.filesLen++,o.attr("id",s).attr("name",s).css("position","absolute").offset({left:r.left+t.width()-o.width(),top:r.top}).css("z-index","9999").css("opacity",0).height(t.height()).css("cursor","pointer"),e.input=o,o.bind("change",function(t){var r,i;if(e._trigger("change",t,n(this))===!1)return!1;e._createFileInput(),r=e._createFileRow(n(this)),e._setAddBtnState(),e.options.autoSubmit&&(i=n(p,r),i&&i.click()),o.unbind("change")}),e.uploadAll=!1},t.prototype._createUploadedFiles=function(e){},t.prototype._setAddBtnState=function(){var e=this,t=e.options.maximumFiles||e.maxDisplay,r=e.addBtn,i;if(!t)return;if(!r)return;e.maskDiv||(e.maskDiv=n("<div></div>").css("position","absolute").css("z-index","9999").width(r.outerWidth()).height(r.outerHeight()).appendTo(e.upload).offset(r.offset())),i=n("li",e.filesList),i.length>=t?(r.button({disabled:!0}),e.maskDiv.show(),e.input&&e.input.css("left","-1000px")):(r.button({disabled:!1}),e.maskDiv.hide())},t.prototype._createFileRow=function(e){var t=this,r=t.options,i=n("<li>"),u="",a,f,l,p=n("<span>").addClass(c),v=n("<a>").attr("href","#").text("upload").addClass(h).button({text:!1,icons:{primary:"ui-icon-circle-arrow-n"},label:t._getLocalization("upload","upload")}),y=n("<a>").attr("href","#").text("cancel").addClass(d).button({text:!1,icons:{primary:"ui-icon-cancel"},label:t._getLocalization("cancel","cancel")});return i.addClass(s).addClass(b).addClass(w),r.enableSWFUploadOnIE&&n.browser.msie||r.enableSWFUpload?(u=e.name,i.attr("id",e.id).data("file",e)):(i.append(e),e.hide(),u=N(e[0])),a=n("<span>"+u+"</span>").addClass(m).addClass(E).addClass(w),i.append(a),i.append(p),f=n("<span />").addClass(g),p.append(f),p.append(v).append(y),i.appendTo(t.filesList),l=n(o,t.upload),l.length&&(t.commandRow.show(),(!r.enableSWFUploadOnIE||!n.browser.msie)&&!r.enableSWFUpload&&t._createUploader(i),t._resetProgressAll()),i},t.prototype._createUploader=function(e){var t=this,r=n("input",e),i=t.options.action,s=t.options.handleRequest,o;t.useXhr?(o=S(t.id,e,i),o.handleRequest=function(e,r){n.isFunction(s)&&s.call(t,e,r)}):o=x(t.id,e,i),o.onCancel=function(){var e=this;t._trigger("cancel",null,e.inputFile),t.totalUploadFiles===0&&t.uploadAll&&t._trigger("totalComplete")},t._wijUpload()&&(o.onProgress=function(e){var r=n("."+g,this.fileRow),i={sender:e.fileName,loaded:e.loaded,total:e.total,fileNameList:undefined},s=this.inputFile.attr("id");e.supportProgress?(r.html(Math.round(1e3*e.loaded/e.total)/10+"%"),e.fileNameList&&(i.fileNameList=e.fileNameList),t._trigger("progress",null,i),t._progressTotal(s,e.loaded)):r.addClass(y)},o.onComplete=function(e){var r=this,i=r.inputFile.attr("id"),s=t.uploaders[i],o=C(r.inputFile[0]),u=n("."+g,r.fileRow);t._trigger("complete",e.e,r.inputFile),u.removeClass(y),u.html("100%"),t._removeFileRow(r.fileRow,s,!0),t._progressTotal(i,o),t.totalUploadFiles--,t.totalUploadFiles===0&&(t.uploadAll||t.options.autoSubmit)&&t._trigger("totalComplete",e.e,e)}),typeof t.uploaders=="undefined"&&(t.uploaders={}),t.uploaders[r.attr("id")]=o},t.prototype._progressTotal=function(e,t){var n=this,r=n.progressAll,i,s;if(!n.uploadAll)return;r&&r.loadedSize&&(r.loadedSize[e]=t,i=n._getLoadedSize(r.loadedSize),s=r.totalSize),n._trigger("totalProgress",null,{loaded:i,total:s})},t.prototype._getLoadedSize=function(e){var t=0;return n.each(e,function(e,n){t+=n}),t},t.prototype._getTotalSize=function(){var e=this,t=0;return e.uploaders&&n.each(e.uploaders,function(e,n){t+=C(n.inputFile[0])}),t},t.prototype._resetProgressAll=function(){this.progressAll={totalSize:0,loadedSize:{}}},t.prototype._wijUpload=function(){return!0},t.prototype._wijcancel=function(e){},t.prototype._upload=function(e,t){},t.prototype._swfUploadFile=function(e){this.swfupload.startUpload(e)},t.prototype._bindEvents=function(){var e=this,t=e.options,r=e.progressAll;e.upload.delegate(v,"click."+e.widgetName,function(i){var s=n(this),u=s.parents(o),a,f;if(t.enableSWFUploadOnIE&&n.browser.msie||t.enableSWFUpload){var l=u.data("file");e.swfupload.cancelUpload(l.id),u.fadeOut(1500,function(){u.remove(),e.swfupload.queueData.queueLength==0&&e.commandRow.hide()})}else a=n("input",u[0]),f=e.uploaders[a.attr("id")],e._wijcancel(a),e._wijUpload()&&f&&f.cancel(),r&&(r.totalSize-=C(a[0]),r.loadedSize[a.val()]&&delete r.loadedSize[a.val()]),e._removeFileRow(u,f,!1)}),e.upload.delegate(p,"click."+e.widgetName,function(r){var i=n(this),s=i.parents(o),u,a;if(t.enableSWFUploadOnIE&&n.browser.msie||t.enableSWFUpload){var f=s.data("file");e.uploadAll=!1,e._wijUpload()?e._swfUploadFile(f.id):e._upload(f.id,!0)}else{u=n("input",s[0]),a=e.uploaders[u.attr("id")];if(e._trigger("upload",r,u)===!1)return!1;if(e.options.autoSubmit){a.autoSubmit=!0;if(e._trigger("totalUpload",r,null)===!1)return!1}e.totalUploadFiles++,e._upload(s),a&&e._wijUpload()&&a.upload()}r.preventDefault()}),e.upload.delegate("."+f,"click."+e.widgetName,function(r){if(t.enableSWFUploadOnIE&&n.browser.msie||t.enableSWFUpload)e.uploadAll=!0,e._wijUpload()?e._swfUploadFile():e._upload(!0,!0);else{e.uploadAll=!0,e.progressAll||e._resetProgressAll();if(e._trigger("totalUpload",r,null)===!1)return!1;e.progressAll.totalSize=e._getTotalSize(),e._wijuploadAll(n(p,e.filesList[0])),e._wijUpload()&&n(p,e.filesList[0]).each(function(e,t){return n(t).click(),e})}}),e.upload.delegate("."+l,"click."+e.widgetName,function(r){t.enableSWFUploadOnIE&&n.browser.msie||t.enableSWFUpload?(n.each(e.swfupload.queueData.files,function(t,n){e.swfupload.cancelUpload(t)}),n(o,e.element).fadeOut(1500,function(){n(this).remove(),e.commandRow.hide()})):(e._resetProgressAll(),n(v,e.filesList[0]).each(function(e,t){n(t).click()}))})},t.prototype._wijuploadAll=function(e){},t.prototype._wijFileRowRemoved=function(e,t,n){this._setAddBtnState()},t.prototype._removeFileRow=function(e,t,r){var i=this,s,u;t&&(s=t.inputFile.attr("id")),e.fadeOut(1500,function(){e.remove(),i._wijFileRowRemoved(e,t.inputFile,r),i.uploaders[s]&&delete i.uploaders[s],u=n(o,i.upload),u.length?(i.commandRow.show(),t&&t.destroy&&t.destroy()):(i.commandRow.hide(),i.totalUploadFiles=0,i._resetProgressAll(),t&&t.destroy&&t.destroy(!0))})},t.prototype._getFileName=function(e){return T(e)},t.prototype._getFileNameByInput=function(e){return N(e)},t.prototype._getFileSize=function(e){return C(e)},t}(e.wijmoWidget);t.wijupload=k;var L=function(){function e(){this.action="",this.autoSubmit=!1,this.change=null,this.upload=null,this.totalUpload=null,this.progress=null,this.totalProgress=null,this.complete=null,this.totalComplete=null,this.maximumFiles=0,this.multiple=!0,this.accept="",this.enableSWFUploadOnIE=!1,this.enableSWFUpload=!1,this.swfUploadOptions={},this.localization={},this.handleRequest=null}return e}(),A="wijmo-wijupload",O=A+"-";k.prototype.options=n.extend(!0,{},e.wijmoWidget.prototype.options,new L),n.wijmo.registerWidget("wijupload",k.prototype)})(e.upload||(e.upload={}));var t=e.upload})(wijmo||(wijmo={}));;
var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(t){"use strict";var n=jQuery,r=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype._create=function(){var e=this;this.element.is(":hidden")&&this.element.wijAddVisibilityObserver&&this.element.wijAddVisibilityObserver(function(){e.element.wijRemoveVisibilityObserver&&e.element.wijRemoveVisibilityObserver(),e._pageLize(!0)},"wijwizard"),this._pageLize(!0)},t.prototype._init=function(){var e=this.options,t=e.disabled;e.disabledState?(this.disable(),e.disabled=t):e.autoPlay&&this.play()},t.prototype._setOption=function(t,n){e.prototype._setOption.call(this,t,n);switch(t){case"activeIndex":this.show(n);break;case"navButtons":case"backBtnText":case"nextBtnText":this._createButtons();break;case"autoPlay":n===!0?this.play():this.stop();default:this._pageLize(!1)}},t.prototype.destroy=function(){var e=this.options;return this.abort(),this.stop(),this._removeScroller(),this._removeButtons(),this.element.unbind(".wijwizard").removeClass(e.wijCSS.wijwizard).removeClass(e.wijCSS.widget).removeClass(e.wijCSS.helperClearFix).removeData("wijwizard"),this.list&&this.list.removeClass(e.wijCSS.widget).removeClass(e.wijCSS.helperReset).removeClass(e.wijCSS.wijwizardSteps).removeClass(e.wijCSS.helperClearFix).removeAttr("role"),this.lis&&(this.lis.removeClass(e.wijCSS.header).removeClass(e.wijCSS.cornerAll).removeClass(e.wijCSS.priorityPrimary).removeClass(e.wijCSS.prioritySecondary).removeAttr("role"),n.each(this.lis,function(){n.data(this,"destroy.wijwizard")?n(this).remove():n(this).removeAttr("aria-selected")})),n.each(this.panels,function(){var t=n(this).unbind(".wijwizard");n.each(["load","cache"],function(e,n){t.removeData(n+".wijwizard")}),n.data(this,"destroy.wijwizard")?t.remove():t.removeClass(e.wijCSS.stateDefault).removeClass(e.wijCSS.wijwizardActived).removeClass(e.wijCSS.stateActive).removeClass(e.wijCSS.stateHover).removeClass(e.wijCSS.stateFocus).removeClass(e.wijCSS.stateDisabled).removeClass(e.wijCSS.wijwizardPanel).removeClass(e.wijCSS.content).removeClass(e.wijCSS.wijwizardHide).css({position:"",left:"",top:""}).removeAttr("aria-hidden")}),this.container.replaceWith(this.container.contents()),e.cookie&&this._cookie(null,e.cookie),this},t.prototype._pageLize=function(e){var t=this.options,r=/^#.+/;this.list=this.element.children("ol,ul").eq(0),this.list&&this.list.length===0&&(this.list=this.element.find("."+t.wijCSS.wijwizardSteps).eq(0),this.list&&this.list.length===0&&(this.list=null)),this.list&&(this.lis=n("li",this.list)),e?(this.panels=n("> div",this.element),n.each(this.panels,function(e,t){var i=n(t).attr("src");i&&!r.test(i)&&n.data(t,"load.wijwizard",i.replace(/#.*$/,""))}),this.element.addClass(t.wijCSS.wijwizard).addClass(t.wijCSS.widget).addClass(t.wijCSS.helperClearFix),this.list&&(this.list.addClass(t.wijCSS.widget).addClass(t.wijCSS.helperReset).addClass(t.wijCSS.wijwizardSteps).addClass(t.wijCSS.helperClearFix).attr("role","tablist"),this.lis.addClass(t.wijCSS.header).addClass(t.wijCSS.cornerAll).attr("role","tab")),this.container=n("<div/>"),this.container.addClass(t.wijCSS.wijwizardContent).addClass(t.wijCSS.widget).addClass(t.wijCSS.content).addClass(t.wijCSS.cornerAll),this.container.append(this.panels),this.container.appendTo(this.element),this.panels.addClass(t.wijCSS.wijwizardPanel).addClass(t.wijCSS.content).attr("role","tabpanel"),t.activeIndex===undefined?(typeof t.activeIndex!="number"&&t.cookie&&(t.activeIndex=parseInt(this._cookie(undefined,undefined),10)),typeof t.activeIndex!="number"&&this.panels.filter("."+t.wijCSS.wijwizardActived).length&&(t.activeIndex=this.panels.index(this.panels.filter("."+t.wijCSS.wijwizardActived))),t.activeIndex=t.activeIndex||(this.panels.length?0:-1)):t.activeIndex===null&&(t.activeIndex=-1),t.activeIndex=t.activeIndex>=0&&this.panels[t.activeIndex]||t.activeIndex<0?t.activeIndex:0,this.panels.addClass(t.wijCSS.wijwizardHide).attr("aria-hidden",!0),t.activeIndex>=0&&this.panels.length&&(this.panels.eq(t.activeIndex).removeClass(t.wijCSS.wijwizardHide).addClass(t.wijCSS.wijwizardActived).attr("aria-hidden",!1),this.load(t.activeIndex)),this._createButtons()):(this.panels=n("> div",this.container),t.activeIndex=this.panels.index(this.panels.filter("."+t.wijCSS.wijwizardActived))),this._refreshStep(),this._initScroller(),t.cookie&&this._cookie(t.activeIndex,t.cookie),t.cache===!1&&this.panels.removeData("cache.wijwizard");if(t.showOption===undefined||t.showOption===null)t.showOption={};this._normalizeBlindOption(t.showOption);if(t.hideOption===undefined||t.hideOption===null)t.hideOption={};this._normalizeBlindOption(t.hideOption),this.panels.unbind(".wijwizard")},t.prototype._removeButtons=function(){this.buttons&&(this.buttons.remove(),this.buttons=undefined)},t.prototype._createButtons=function(){var e=this,t=this,r=this.options,i,s,o,u=r.backBtnText,a=r.nextBtnText;this._removeButtons();if(r.navButtons==="none")return;this.buttons||(i=r.navButtons,i==="auto"&&(i=this.list?"common":"edge"),this.buttons=n("<div/>"),this.buttons.addClass(r.wijCSS.wijwizardButtons),s=function(e,t){if(r.disabled)return;t.is(":not(."+r.wijCSS.stateDisabled+")")&&t.addClass(e)},o=function(e,t){if(r.disabled)return;t.removeClass(e)},i==="common"?(this.backBtn=n("<a href='#'><span class='"+r.wijCSS.buttonText+"'>"+u+"</span></a>").addClass(r.wijCSS.widget).addClass(r.wijCSS.stateDefault).addClass(r.wijCSS.cornerAll).addClass(r.wijCSS.button).addClass(r.wijCSS.buttonTextOnly).appendTo(this.buttons).bind({click:function(){return e.back(),!1},mouseover:function(){s(r.wijCSS.stateHover,n(this))},mouseout:function(){o(r.wijCSS.stateHover,n(this))},mousedown:function(){s(r.wijCSS.stateActive,n(this))},mouseup:function(){o(r.wijCSS.stateActive,n(this))}}).attr("role","button"),this.nextBtn=n("<a href='#'><span class='"+r.wijCSS.buttonText+"'>"+a+"</span></a>").addClass(r.wijCSS.widget).addClass(r.wijCSS.stateDefault).addClass(r.wijCSS.cornerAll).addClass(r.wijCSS.button).addClass(r.wijCSS.buttonTextOnly).appendTo(this.buttons).bind({click:function(){return t.next(),!1},mouseover:function(){s(r.wijCSS.stateHover,n(this))},mouseout:function(){o(r.wijCSS.stateHover,n(this))},mousedown:function(){s(r.wijCSS.stateActive,n(this))},mouseup:function(){o(r.wijCSS.stateActive,n(this))}}).attr("role","button")):(this.backBtn=n("<a href='#'/>").addClass(r.wijCSS.wijwizardPrev).addClass(r.wijCSS.stateDefault).addClass(r.wijCSS.cornerRight).append("<span class='"+r.wijCSS.icon+" "+r.wijCSS.iconArrowLeft+"'></span>").appendTo(this.buttons).bind({click:function(){return t.back(),!1},mouseover:function(){s(r.wijCSS.stateHover,n(this))},mouseout:function(){o(r.wijCSS.stateHover,n(this))},mousedown:function(){s(r.wijCSS.stateActive,n(this))},mouseup:function(){o(r.wijCSS.stateActive,n(this))}}).attr("role","button"),this.nextBtn=n("<a href='#'/>").addClass(r.wijCSS.wijwizardNext).addClass(r.wijCSS.stateDefault).addClass(r.wijCSS.cornerLeft).append("<span class='"+r.wijCSS.icon+" "+r.wijCSS.iconArrowRight+"'></span>").appendTo(this.buttons).bind({click:function(){return t.next(),!1},mouseover:function(){s(r.wijCSS.stateHover,n(this))},mouseout:function(){o(r.wijCSS.stateHover,n(this))},mousedown:function(){s(r.wijCSS.stateActive,n(this))},mouseup:function(){o(r.wijCSS.stateActive,n(this))}}).attr("role","button")),this.buttons.appendTo(this.element))},t.prototype._refreshStep=function(){var e=this.options;this.lis&&(this.lis.removeClass(e.wijCSS.priorityPrimary).addClass(e.wijCSS.prioritySecondary).attr("aria-selected",!1),e.activeIndex>=0&&e.activeIndex<=this.lis.length-1&&(this.lis&&this.lis.eq(e.activeIndex).removeClass(e.wijCSS.prioritySecondary).addClass(e.wijCSS.priorityPrimary).attr("aria-selected",!0),this.scrollWrap&&this.scrollWrap.wijsuperpanel("scrollChildIntoView",this.lis.eq(e.activeIndex)))),this.buttons&&!e.loop&&(this.backBtn[e.activeIndex<=0?"addClass":"removeClass"](e.wijCSS.stateDisabled).attr("aria-disabled",e.activeIndex===0),this.nextBtn[e.activeIndex>=this.panels.length-1?"addClass":"removeClass"](e.wijCSS.stateDisabled).attr("aria-disabled",e.activeIndex>=this.panels.length-1))},t.prototype._initScroller=function(){if(!this.lis)return;var e=0;n.each(this.lis,function(){e+=n(this).outerWidth(!0)}),this.element.innerWidth()<e?(this.scrollWrap===undefined&&(this.list.wrap("<div class='scrollWrap'></div>"),this.scrollWrap=this.list.parent(),n.effects&&n.effects.save?n.effects.save(this.list,["width","height","overflow"]):n.save&&n.save(this.list,["width","height","overflow"])),this.list.width(e+8),this.scrollWrap.height(this.list.outerHeight(!0)),this.scrollWrap.wijsuperpanel({allowResize:!1,hScroller:{scrollBarVisibility:"hidden"},vScroller:{scrollBarVisibility:"hidden"}})):this._removeScroller()},t.prototype._removeScroller=function(){this.scrollWrap&&(this.scrollWrap.wijsuperpanel("destroy").replaceWith(this.scrollWrap.contents()),this.scrollWrap=undefined,n.effects&&n.effects.restore?n.effects.restore(this.list,["width","height","overflow"]):n.restore&&n.restore(this.list,["width","height","overflow"]))},t.prototype._cookie=function(e,t){var r=this.cookie||(this.cookie=this.options.cookie.name);return n.cookie.apply(null,[r].concat(n.makeArray(arguments)))},t.prototype._normalizeBlindOption=function(e){e.blind===undefined&&(e.blind=!1),e.fade===undefined&&(e.fade=!1),e.duration===undefined&&(e.duration=200);if(typeof e.duration=="string")try{e.duration=parseInt(e.duration,10)}catch(t){e.duration=200}},t.prototype._ui=function(e){return{panel:e,index:this.panels.index(e)}},t.prototype._removeSpinner=function(){this.element.removeClass(this.options.wijCSS.tabsLoading);var e=this.element.data("spinner.wijwizard");e&&(this.element.removeData("spinner.wijwizard"),e.remove())},t.prototype._showPanel=function(e){var t=this,r=this.options,i=n(e),s;i.addClass(r.wijCSS.wijwizardActived),(r.showOption.blind||r.showOption.fade)&&r.showOption.duration>0?(s={duration:r.showOption.duration},r.showOption.blind&&(s.height="toggle"),r.showOption.fade&&(s.opacity="toggle"),i.hide().removeClass(r.wijCSS.wijwizardHide).animate(s,r.showOption.duration||"normal","linear",function(){t._resetStyle(i),i.wijTriggerVisibility&&i.wijTriggerVisibility(),t._trigger("show",null,t._ui(i[0])),t._removeSpinner(),i.attr("aria-hidden",!1),t._trigger("activeIndexChanged",null,t._ui(i[0]))})):(i.removeClass(r.wijCSS.wijwizardHide).attr("aria-hidden",!1),i.wijTriggerVisibility&&i.wijTriggerVisibility(),this._trigger("show",null,this._ui(i[0])),this._removeSpinner(),this._trigger("activeIndexChanged",null,this._ui(i[0])))},t.prototype._hidePanel=function(e){var t=this,r=this,i=this.options,s=n(e),o;s.removeClass(i.wijCSS.wijwizardActived),(i.hideOption.blind||i.hideOption.fade)&&i.hideOption.duration>0?(o={duration:i.hideOption.duration},i.hideOption.blind&&(o.height="toggle"),i.hideOption.fade&&(o.opacity="toggle"),s.animate(o,i.hideOption.duration||"normal","linear",function(){s.addClass(i.wijCSS.wijwizardHide).attr("aria-hidden",!0),t._resetStyle(s),t.element.dequeue("wijwizard")})):(s.addClass(i.wijCSS.wijwizardHide).attr("aria-hidden",!0),this.element.dequeue("wijwizard"))},t.prototype._resetStyle=function(e){e.css({display:""}),n.support.opacity||e[0].style.removeAttribute("filter")},t.prototype.add=function(e,t,r){e===undefined&&(e=this.panels.length),t===undefined&&(t="Step "+e);var i=this,s=this.options,o=n(s.panelTemplate||i._defaults.panelTemplate).data("destroy.wijwizard",!0),u;return o.addClass(s.wijCSS.wijwizardPanel).addClass(s.wijCSS.content).addClass(s.wijCSS.cornerAll).addClass(s.wijCSS.wijwizardHide).attr("aria-hidden",!0),e>=this.panels.length?this.panels.length>0?o.insertAfter(this.panels[this.panels.length-1]):o.appendTo(this.container):o.insertBefore(this.panels[e]),this.list&&this.lis&&(u=n((s.stepHeaderTemplate||i._defaults.stepHeaderTemplate).replace(/#\{title\}/g,t).replace(/#\{desc\}/g,r)),u.addClass(s.wijCSS.header).addClass(s.wijCSS.cornerAll).addClass(s.wijCSS.prioritySecondary).data("destroy.wijwizard",!0),e>=this.lis.length?u.appendTo(this.list):u.insertBefore(this.lis[e])),this._pageLize(!1),this.panels.length===1&&(s.activeIndex=0,u.addClass(s.wijCSS.priorityPrimary),o.removeClass(s.wijCSS.wijwizardHide).addClass(s.wijCSS.wijwizardActived).attr("aria-hidden",!1),this.element.queue("wijwizard",function(){i._trigger("show",null,i._ui(i.panels[0]))}),this._refreshStep(),this.load(0)),this._trigger("add",null,this._ui(this.panels[e])),this},t.prototype.remove=function(e){var t=this.options,n=this.panels.eq(e).remove();return this.lis.eq(e).remove(),e<t.activeIndex&&t.activeIndex--,this._pageLize(!1),n.hasClass(t.wijCSS.wijwizardActived)&&this.panels.length>=1&&this.show(e+(e<this.panels.length?0:-1)),this._trigger("remove",null,this._ui(n[0])),this},t.prototype.show=function(e){var t=this;if(e<0||e>=this.panels.length)return this;if(this.element.queue("wijwizard").length>0)return this;var r=this.options,i={nextIndex:0,nextPanel:null},s,o;n.extend(i,this._ui(this.panels[r.activeIndex])),i.nextIndex=e,i.nextPanel=this.panels[e];if(this._trigger("validating",null,i)===!1)return this;s=this.panels.filter(":not(."+r.wijCSS.wijwizardHide+")"),o=this.panels.eq(e),r.activeIndex=e,this.abort(),r.cookie&&this._cookie(r.activeIndex,r.cookie),this._refreshStep();if(!o.length)throw"jQuery UI wijwizard: Mismatching fragment identifier.";return s.length&&this.element.queue("wijwizard",function(){t._hidePanel(s)}),this.element.queue("wijwizard",function(){t._showPanel(o)}),this.load(e),this},t.prototype.next=function(){var e=this.options,t=e.activeIndex+1;return e.disabled?!1:(e.loop&&(t%=this.panels.length),t<this.panels.length?(this.show(t),!0):!1)},t.prototype.back=function(){var e=this.options,t=e.activeIndex-1;return e.disabled?!1:(e.loop&&(t=t<0?this.panels.length-1:t),t>=0?(this.show(t),!0):!1)},t.prototype.load=function(e){var t=this,r=t.options,i=t.panels.eq(e)[0],s=n.data(i,"load.wijwizard"),o;t.abort();if(!s||t.element.queue("wijwizard").length!==0&&n.data(i,"cache.wijwizard")){t.element.dequeue("wijwizard");return}return this.element.addClass(r.wijCSS.tabsLoading),r.spinner&&(o=this.element.data("spinner.wijwizard"),o||(o=n("<div/>"),o.addClass(r.wijCSS.wijwizardSpinner),o.html(r.spinner||t._defaults.spinner),o.appendTo(document.body),this.element.data("spinner.wijwizard",o),o.wijpopup({showEffect:"blind",hideEffect:"blind"})),o.wijpopup("show",{of:this.element,my:"center center",at:"center center"})),this.xhr=n.ajax(n.extend({},r.ajaxOptions,{url:s,dataType:"html",success:function(s,o){n(i).html(s),r.cache&&n.data(i,"cache.wijwizard",!0),t._trigger("load",null,t._ui(t.panels[e]));try{r.ajaxOptions&&r.ajaxOptions.success&&r.ajaxOptions.success(s,o)}catch(u){}},error:function(n,s,o){t._trigger("load",null,t._ui(t.panels[e]));try{r.ajaxOptions&&r.ajaxOptions.error&&r.ajaxOptions.error(n,s,e,i)}catch(u){}}})),t.element.dequeue("wijwizard"),t},t.prototype.abort=function(){return this.element.queue([]),this.panels.stop(!1,!0),this.element.queue("wijwizard",this.element.queue("wijwizard").splice(-2,2)),this.xhr&&(this.xhr.abort(),delete this.xhr),this._removeSpinner(),this},t.prototype.url=function(e,t){return this.panels.eq(e).removeData("cache.wijwizard").data("load.wijwizard",t),this},t.prototype.count=function(){return this.panels.length},t.prototype.stop=function(){var e=this.element.data("intId.wijwizard");e&&(window.clearInterval(e),this.element.removeData("intId.wijwizard"))},t.prototype.play=function(){var e=this,t=this.options,n,r=this.panels.length;this.element.data("intId.wijwizard")||(n=window.setInterval(function(){var n=t.activeIndex+1;if(n>=r){if(!t.loop){e.stop();return}n=0}e.show(n)},t.delay),this.element.data("intId.wijwizard",n))},t}(e.wijmoWidget);t.wijwizard=r,r.prototype._defaults={stepHeaderTemplate:"<li><h1>#{title}</h1>#{desc}</li>",panelTemplate:"<div></div>",spinner:"<em>Loading&#8230;</em>"};var i=function(){function e(){this.wijCSS={wijwizard:"wijmo-wijwizard",wijwizardButtons:"wijmo-wijwizard-buttons",wijwizardPrev:"wijmo-wijwizard-prev",wijwizardNext:"wijmo-wijwizard-next",wijwizardSteps:"wijmo-wijwizard-steps",wijwizardContent:"wijmo-wijwizard-content",wijwizardPanel:"wijmo-wijwizard-panel",wijwizardActived:"wijmo-wijwizard-actived",wijwizardHide:"wijmo-wijwizard-hide",wijwizardSpinner:"wijmo-wijwizard-spinner"},this.wijMobileCSS={header:"ui-header ui-bar-a",content:"ui-body-c",stateDefault:"ui-btn-up-a",stateHover:"ui-btn-down-a",stateActive:"ui-btn-down-a"},this.navButtons="auto",this.autoPlay=!1,this.delay=3e3,this.loop=!1,this.hideOption={fade:!0},this.showOption={fade:!0,duration:400},this.ajaxOptions=null,this.cache=!1,this.cookie=null,this.stepHeaderTemplate="",this.panelTemplate="",this.spinner="",this.backBtnText="back",this.nextBtnText="next",this.add=null,this.remove=null,this.activeIndexChanged=null,this.show=null,this.load=null,this.validating=null}return e}();r.prototype.options=n.extend(!0,{},e.wijmoWidget.prototype.options,new i),n.wijmo.registerWidget("wijwizard",r.prototype)})(e.wizard||(e.wizard={}));var t=e.wizard})(wijmo||(wijmo={}));;
var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(t){"use strict";var n=jQuery,r="wijribbon",i="wijmo-wijribbon",s=i+"-disabled",o=i+"-bigbutton",u=i+"-panel",a=i+"-groups",f=i+"-group",l=f+"-content",c=f+"-label",h=i+"-dropdown",p=i+"-dropdowngroup",d=i+"-abbrev",v=d+"group",m=i+"-text",g=i+"-icon",y=i+"-abbrevicon",b=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype._create=function(){var e=this;window.wijmoApplyWijTouchUtilEvents&&(n=window.wijmoApplyWijTouchUtilEvents(n)),e._ribbonify(),n(window).bind("resize.wijribbon",function(){e.updateRibbonSize()}),e.element.is(":hidden")&&e.element.wijAddVisibilityObserver&&e.element.wijAddVisibilityObserver(function(){e.updateRibbonSize(),e.options.disabled&&e._setDisabled(!0),e.element.wijRemoveVisibilityObserver&&e.element.wijRemoveVisibilityObserver()},"wijribbon"),e.options.disabled&&e._setDisabled(!0)},t.prototype._setOption=function(e,t){n.wijmo.widget.prototype._setOption.apply(this,arguments),e==="disabled"&&this._setDisabled(t),n(".wijmo-wijribbon-startmenulink",this.element).unbind("click.tabs")},t.prototype._setDisabled=function(e){var t=this,r=t.element,i=r.offset(),o=i.top,u=i.left,a=n("body"),f=this.options.wijCSS,l=t.disabledModal;r.data("wijmoWijtabs")&&r.wijtabs("option","disabled",e),r.closest(".wijmo-wijeditor").length!==0&&(o=0,u=0,a=r.parent()),e?(l||(l=n("<div></div>").addClass(f.stateDisabled+" "+s).css({top:o,left:u,"background-color":"lightgray",position:"absolute"}).appendTo(a).bind("click mousedown mouseup mouseover mouseout focus keydown keypress",function(e){return e.stopPropagation(),e.preventDefault(),!1}),t.disabledModal=l),t.disabledModal.width(r.width()).height(r.outerHeight()).show()):t.disabledModal&&t.disabledModal.hide()},t.prototype._ribbonify=function(){var e=this,t=this.options.wijCSS;e.buttons={},e.listUis={},e.accessbarBtns={},e._createAccessToolBar(),e._getButtonSets(),e._createButtons(),e._createGroup(),e._createSplit(),e._createDropdwon(),e._createInputDropdown(),e._createGallery(),e._hideShowedList(),e._createTab(),n("."+t.helperReset+":not(."+a+", ."+t.tabsNav+", .wijmo-wijmenu-list)",e.element).hover(function(){n(this).addClass(t.stateHover)},function(){n(this).removeClass(t.stateHover)}),n("."+t.button,e.element).bind("mouseenter",function(){n("."+t.buttonText,this).addClass(t.stateHover)}).bind("mouseleave",function(){n("."+t.buttonText,this).removeClass(t.stateHover)}),n("button."+t.button,e.element).bind("mousedown",function(){e._addActiveClassToButtonText(this)}).bind("mouseup",function(){e._addActiveClassToButtonText(this)}),n("label."+t.button,e.element).bind("click",function(){n("span",this)&&n("span",this).length===1&&e._addActiveClassToLabelButtonText(this)})},t.prototype._addActiveClassToButtonText=function(e){var t=this.options.wijCSS;e&&(n(e).hasClass(t.stateActive)?n("."+t.buttonText,e).addClass(t.stateActive):n("."+t.buttonText,e).removeClass(t.stateActive))},t.prototype._addActiveClassToLabelButtonText=function(e){var t=this,r,i,s;e&&(i=n(e).attr("for"),r=n("#"+i,t.element),r.is(":checkbox")?t._addActiveClassToButtonText(e):r.is(":radio")&&(s=t.element.find("[name='"+r.attr("name")+"']"),n.each(s,function(){t._updateGroupElementTextState(this)})))},t.prototype._updateGroupElementTextState=function(e){var t,r=this.options.wijCSS;if(!e)return;t=n("[for='"+n(e).attr("id")+"']",n(e).parent()),t&&(t.hasClass(r.stateActive)?t.children("."+r.buttonText).addClass(r.stateActive):t.children("."+r.buttonText).removeClass(r.stateActive))},t.prototype._getButtonSets=function(){var e=this,t;e.groups=[],e.splits=[],e.dropdowns=[],e.inputDropdowns=[],n("span>button, span>:checkbox, span>:radio, div>button, div>:checkbox, div>:radio, div>:text",e.element).each(function(r,i){return t=n(i).parent(),n(">ul",t).length===0&&!t.hasClass("wijmo-wijribbon-accesstoolbar")?e.groups.push(t):n(">button",t).length===2?e.splits.push(t):n(">button",t).length===1?e.dropdowns.push(t):n(">input[type='text']",t).length===1&&e.inputDropdowns.push(t),this}),e.groups=e._unique(e.groups),e.splits=e._unique(e.splits)},t.prototype._unique=function(e){var t=n.makeArray(n.map(e,function(e){return e.get(0)}));return n.map(n.unique(t),function(e){return n(e)})},t.prototype._createButtons=function(){var e=this,t=e.element;n(":checkbox",t).each(function(){return e._createButton(n(this),"checkbox"),n(this).bind("change",function(){e._addActiveClassToLabelButtonText(n(this).button("widget")[0])}),this}),n(":radio",t).each(function(){return e._createButton(n(this),"radio"),n(this).bind("change",function(){e._addActiveClassToLabelButtonText(n(this).button("widget")[0])}),this}),n("button",t).each(function(){return e._createButton(n(this),"button"),this})},t.prototype._createButton=function(e,t){var r=this,i=this.options.wijCSS,s=r._buildButtonOption(e,t),o=e.data("commandName"),u;e.button(s),s.text||(t==="button"?e.children("."+i.buttonText).text(o):(u=n("[for='"+e.attr("id")+"']",e.parent()),u&&u.children("."+i.buttonText).text(o))),e.parent().is(".wijmo-wijribbon-accesstoolbar")&&e.attr("canlocateonaccesstoolbar")==="true"&&e.button("widget").hide(),r._triggerEvent(e)},t.prototype._createGroup=function(){n.each(this.groups,function(e,t){t.buttonset()})},t.prototype._createSplit=function(){var e=this,t=this.options.wijCSS;n.each(e.splits,function(r,s){var o=s.children("ul"),u=s.children("button:eq(0)"),a=u.data("commandName"),f=s.children("button:eq(1)"),l;o.children("li").addClass(t.cornerAll),s.addClass(i+"-"+a),f.button({icons:{primary:t.iconArrowDown},text:!1}).data("list",o).unbind("click").bind("click",function(e){e.stopPropagation(),e.preventDefault()}).bind("mouseup",function(t){o=n(this).data("list"),o.is(":visible")?(e.showList.hide().css("z-index",""),e.showList=null):(o.show().position({my:"left top",at:"left bottom",of:s}).css("z-index",9999),e.showList=o),t.stopPropagation(),t.preventDefault()}),f.children("."+t.buttonText).text("foo"),s.after(o),o.css("position","absolute").addClass(t.helperReset+" "+t.helperClearFix+" "+t.cornerAll+" "+h).hide(),s.buttonset(),l={ui:u,defaultValue:u.button("option","label"),buttons:[],type:"split",trigger:f,list:o},n("button, :checkbox, :radio",o).bind("click",function(t){o.hide().css("z-index",""),e.showList=null,t.preventDefault()}),o.find(">li>button,>li>:radio,>li>:checkbox").each(function(t,r){var i=n(r).data("commandName");i!==""&&e.buttons[i]&&(e.buttons[i].parent=u,e.buttons[i].type="split"),l.buttons.push(n(r))}),a!==""&&(e.listUis[a]=l)})},t.prototype._createDropdwon=function(){var e=this,t=this.options.wijCSS,r,s;e.dropdownLabels={},n.each(e.dropdowns,function(r,s){var o=s.children("ul"),u=s.children("button:eq(0)"),a=u.data("commandName"),f;o.children("li").addClass(t.cornerAll),s.addClass(i+"-"+a),u.button({icons:{secondary:t.iconArrowDown}}).unbind("click").bind("click",function(e){e.stopPropagation(),e.preventDefault()}).bind("mouseup",function(t){e._showDropDownList(o,u),t.stopPropagation(),t.preventDefault()}).bind("keydown",function(t){if(!o.is(":visible"))return;e._dropdownListKeyHandler(t,o,u)}),f={ui:u,defaultValue:u.button("option","label"),buttons:[],type:"dropdown",list:o},n("button, :checkbox, :radio",o).bind("click",function(r){var i=n(this).data("commandName"),s,a=u.children("."+t.buttonText).width();e.dropdownLabels[i]||(e.dropdownLabels[i]=e._getDropdownLabelSubstr(n(this).button("option","label"),u.children("."+t.buttonText),a)),s=e.dropdownLabels[i],u.button("option","label",s),u.attr("title",n(this).button("option","label")),o.hide().css("z-index",""),e.showList=null,r.preventDefault()}),o.css("position","absolute").addClass(t.helperReset+" "+t.helperClearFix+" "+t.cornerAll+" "+h).hide(),s.buttonset(),e._collectDropDownButtons(o,u,f,a)})},t.prototype._createInputDropdown=function(){var e=this,t=this.options.wijCSS;e.dropdownLabels={},n.each(e.inputDropdowns,function(r,s){var o=s.children("ul"),u=s.children("input[type='text']:eq(0)"),a=e._createInputDropDownWrapper(u),f=u.prop("name"),l;s.prepend(a),o.children("li").addClass(t.cornerAll),s.addClass(i+"-"+f),u.removeProp("name").data("commandName",f).addClass(t.stateDefault+" "+t.content+" "+t.cornerLeft),a.find("a").bind("mouseup",function(t){e._showDropDownList(o,u),u.focus(),t.stopPropagation(),t.preventDefault()}).bind("keydown",function(t){e._dropdownListKeyHandler(t,o,a)}),e._bindInputEvent(u,o),l={ui:u,defaultValue:u.val(),buttons:[],type:"dropdown",list:o},n("button, :checkbox, :radio",o).bind("click",function(t){var r=n(this).data("commandName"),i;e.dropdownLabels[r]||(e.dropdownLabels[r]=n(this).button("option","label")),i=e.dropdownLabels[r],u.val(n(this).button("option","label")).attr("title",n(this).button("option","label")),o.hide().css("z-index",""),e.showList=null,t.preventDefault(),t.stopPropagation()}),o.css("position","absolute").addClass(t.helperReset+" "+t.helperClearFix+" "+t.cornerAll+" "+h).hide(),e._collectDropDownButtons(o,u,l,f)})},t.prototype._collectDropDownButtons=function(e,t,r,i){var s=this;e.find(">li>button,>li>:radio,>li>:checkbox").each(function(e,i){var o=n(i).data("commandName");o!==""&&s.buttons[o]&&(s.buttons[o].parent=t,s.buttons[o].type="dropdown"),r.buttons.push(n(i))}),i!==""&&(s.listUis[i]=r)},t.prototype._showDropDownList=function(e,t){var n=this;e.is(":visible")&&!e.find("li."+n.options.wijCSS.stateActive)?(n.showList.hide().css("z-index",""),n.showList=null):(n.showList&&(n.showList.hide(),n.showList=null),e.show().position({my:"left top",at:"left bottom",of:t}).css("z-index",9999),n.showList=e,n.isShow=!0)},t.prototype._bindInputEvent=function(e,t){var n=this,r,i;e.bind("change",function(t){var r={name:undefined,commandName:undefined};r.name=e.prop("name"),r.commandName=e.val(),n._trigger("click",t,r)}).bind("keydown",function(r){n._dropdownListKeyHandler(r,t,e)})},t.prototype._dropdownListKeyHandler=function(e,t,n){var r=this,i=e.keyCode,s=r._getKeyCodeEnum();switch(i){case s.UP:r._activeDropDownListElement(!1,t,n),e.preventDefault();break;case s.DOWN:r._activeDropDownListElement(!0,t,n),e.preventDefault();break;case s.ENTER:t.find("label."+r.options.wijCSS.stateActive).parent("li").find("input").trigger("click"),e.preventDefault()}},t.prototype._activeDropDownListElement=function(e,t,r){var i=this,s=t.find("li").length,o,u;if(!t.is(":visible")){i._showDropDownList(t,r);return}u=t.find("label."+i.options.wijCSS.stateActive).parent("li"),u&&u.length>0&&(o=t.find("li").index(u)),i._changeListItemActiveState(u,!1),o===undefined?o=0:e?(o++,o==s&&(o=undefined)):(o--,o==-1&&(o=s-1)),i._changeListItemActiveState(n(t.find("li")[o]),!0)},t.prototype._changeListItemActiveState=function(e,t){var r=this.options.wijCSS;if(!e)return;t?(n("label",e).addClass(r.stateActive),n("span",e).addClass(r.stateActive)):(n("label",e).removeClass(r.stateActive),n("span",e).removeClass(r.stateActive))},t.prototype._createGallery=function(){var e=this,t=e.options.wijCSS;n(".wijmo-wijribbon-gallery",e.element).each(function(r,i){n(i).children("div").each(function(r,i){n(i).bind("mouseenter",function(e){if(n(i).hasClass(t.stateDisabled))return;n(i).addClass(t.stateHover)}).bind("mouseleave",function(e){if(n(i).hasClass(t.stateDisabled))return;n(i).removeClass(t.stateHover)}).bind("click",function(r){if(n(i).hasClass(t.stateDisabled))return;n(i).parent("div.wijmo-wijribbon-gallery").children("div").removeClass(t.stateActive),n(i).addClass(t.stateActive);var s={name:undefined,commandName:undefined};s.name=n(i).parent("div.wijmo-wijribbon-gallery").attr("name"),s.commandName=n(i).attr("name"),e._trigger("click",r,s)}),e.buttons[n(i).attr("name")]={button:n(i),type:"galleryBtn"}})})},t.prototype._getKeyCodeEnum=function(){if(n.ui&&n.ui.keyCode)return n.ui.keyCode;if(n.mobile&&n.mobile.keyCode)return n.mobile.keyCode;throw"keyCode object is not found"},t.prototype._createInputDropDownWrapper=function(e){var t=this.options.wijCSS,r=n("<span class='wijmo-wijribbon-inputdropdownwrapper'></span>").append(e);return n("<a></a>").appendTo(r).button({icons:{primary:t.iconArrowDown},text:!1}).removeClass(t.cornerAll).addClass("wijmo-wijribbon-inputdropdownbtn "+t.cornerRight),r},t.prototype._createTab=function(){var e=this,t=this.options.wijCSS,r=e.element;return r.addClass(i),e.tabEle=r,n(">ul",r).length>0?(r.wijtabs({select:function(t,n){e._hideAllMenus()}}),e._createRibbonGroups(),n(".wijmo-wijribbon-startmenu")&&n(".wijmo-wijribbon-startmenu").length>0&&(r.wijtabs("option","selected",1),e._createStartMenu()),!0):(r.addClass(i+"-simple").addClass(t.stateDefault).addClass(t.helperClearFix),!1)},t.prototype._createAccessToolBar=function(){var e=this,t,r=n("<div class='wijmo-wijribbon-accesstoolbar'></div>"),i;if(n("*[canlocateonaccesstoolbar='true']",e.element).length===0&&n("*[locateonaccesstoolbar='true']",e.element).length===0)return;n("input[canlocateonaccesstoolbar='true'],input[locateonaccesstoolbar='true']",e.element).each(function(){t=n(this).attr("id")+"_accessbar";var r=n("label[for="+n(this).attr("id")+"]");e.accessbarBtns[r.attr("title")]={button:n(this).clone().attr("id",t),type:n(this).attr("type"),labelEle:r.clone().attr("for",t),selected:n(this).attr("locateonaccesstoolbar")==="true"?!0:!1}}),n("button[canlocateonaccesstoolbar='true'],button[locateonaccesstoolbar='true']",e.element).each(function(){t=n(this).attr("id")+"_accessbar",e.accessbarBtns[n(this).attr("title")]={button:n(this).clone(),type:"button",selected:n(this).attr("locateonaccesstoolbar")==="true"?!0:!1}}),n.each(e.accessbarBtns,function(e,t){r.append(t.button),t.labelEle&&r.append(t.labelEle)}),i=n('<button title="Customize Access Toolbar" class ="wijmo-wijribbon-accesstoolbarbtn '+e.options.wijCSS.iconArrowDown+'"'+' name="quicktoolbar"></button>'),r.append(i),e.accessbarBtns&&e.element.prepend(r),e._createCustomQuickToolbarMenu(i,r)},t.prototype._createCustomQuickToolbarMenu=function(e,t){var r=this,i,s,o=r.options.wijCSS,u=n('<ul class="wijmo-wijribbon-accesstoolbarmenu"></ul>');n.each(r.accessbarBtns,function(e,t){s=t.selected?" wijmo-wijribbon-accesstoolbarmenuitemchecked":" wijmo-wijribbon-accesstoolbarmenuitemunchecked",i=n('<li><a class="'+o.cornerAll+'" tabindex="-1">'+'<span class="'+o.icon+s+'"></span><span'+' class="wijmo-wijmenu-text">'+e+"</span></a></li>"),i.data("accessbarcommand",e),u.append(i)}),u.prepend("<li class='wijmo-wijribbon-accesstoolbarmenutitleitem'><a>Customize Access Toolbar</a></li>"),t.append(u),u.wijmenu({trigger:e,triggerEvent:"click",orientation:"vertical",select:function(e,t){var i=t.item,s=i.element.data("accessbarcommand"),a=n("span."+o.icon,i.element),f=r.accessbarBtns[s].button,l=f.button("widget");a.hasClass("wijmo-wijribbon-accesstoolbarmenuitemchecked")?(a.removeClass("wijmo-wijribbon-accesstoolbarmenuitemchecked").addClass("wijmo-wijribbon-accesstoolbarmenuitemunchecked"),l.hide().removeAttr("canlocateonaccesstoolbar").attr("locateonaccesstoolbar","true")):(a.addClass("wijmo-wijribbon-accesstoolbarmenuitemchecked").removeClass("wijmo-wijribbon-accesstoolbarmenuitemunchecked"),l.show().removeAttr("locateonaccesstoolbar").attr("canlocateonaccesstoolbar","true")),u.wijmenu("deactivate",null)}}),u.wijmenu("setItemDisabled",n(".wijmo-wijribbon-accesstoolbarmenutitleitem"),!0)},t.prototype.updateRibbonSize=function(){var e=this,t,r=this.options.wijCSS,s;e.tabEle.children("div").not(".wijmo-wijmenu").each(function(o,u){var a=n(u),f=a.is(":visible"),l=a.find(">ul>li:not(.wijmo-wijmenu-item)"),c=[],h=a.width();return f||(a.removeClass(r.wijtabsHide),h=a.width()),l.each(function(r,o){var u=n(o),a=u.find(">div:last"),f=e._getGroupLabelText(a);return t=u.children("."+p),s=u.children("."+v),t&&(u.addClass(i+"-"+f.toLowerCase()).prepend(t.children()),t.remove(),s&&s.remove()),c.push({width:u.outerWidth(!0),text:f}),this}),e._adjustRibbonGroupIfNeeded(l,c,h),f||a.addClass(r.wijtabsHide),this}),e.options.disabled&&e._setDisabled(!0)},t.prototype._createRibbonGroups=function(){var e=this,t=this.options.wijCSS;e.tabEle.children("div").each(function(r,s){var o=n(s),h=o.is(":visible"),p=o.find(">ul:not(.wijmo-wijribbon-accesstoolbarmenu)>li"),d=[],v;if(o.data("destroy.tabs")){o.remove();return}return h||o.removeClass(t.wijtabsHide),v=o.width(),o.addClass(u),o.hasClass(t.tabsPanel)||(o.addClass("wijmo-wijribbon-accesstoolbar"),e.tabEle.prepend(o)),o.find(">ul").addClass(t.helperReset+" "+t.helperClearFix+" "+t.content+" "+t.cornerAll+" "+a),p.each(function(r,s){var o=n(s),u=o.find(">div:last"),a=u.find("span"),h=t.stateDefault+" "+f,p=e._getGroupLabelText(u);return u&&(h+=" "+i+"-"+p.toLowerCase()),o.addClass(h),u.addClass(c).bind("click",function(){return!1}),o.wrapInner("<div class = '"+l+"'></div>"),o.children().bind("mouseover",function(){n(this).addClass(t.stateHover)}).bind("mouseout",function(){n(this).removeClass(t.stateHover)}),u.appendTo(o),d.push({width:o.outerWidth(!0),text:p}),this}),e._originalGroupInfo=d,e._adjustRibbonGroupIfNeeded(p,d,v),h||o.addClass(t.wijtabsHide),this})},t.prototype._createStartMenu=function(){var e=this,t=n(".wijmo-wijribbon-startmenulink",e.element),r=e.options.wijCSS;t.unbind("click"),t.parent("li").addClass("wijmo-wijribbon-startmenulinkcontainer").hover(function(){n(this).removeClass("wijmo-wijribbon-startmenulinkcontainer")},function(){n(this).addClass("wijmo-wijribbon-startmenulinkcontainer")}),n(".wijmo-wijribbon-startmenuindicator",e.element).addClass(r.icon+" "+r.iconArrowDown),n(".wijmo-wijribbon-startmenu",e.element).wijmenu({trigger:n(".wijmo-wijribbon-startmenulink",e.element).parent(),triggerEvent:"click",orientation:"vertical",select:function(t,n){var r={name:undefined,commandName:undefined};r.commandName=n.item._link.attr("name"),e._trigger("click",t,r)},hidden:function(e,t){t.activeItem&&t.activeItem._link.removeClass(r.stateFocus)}})},t.prototype._getGroupLabelText=function(e){var t,r;return e&&(t=e.find("span"),e.attr("displayname")?r=e.attr("displayname"):t&&t.length>0?r=n(t[0]).text():r=n.trim(e.text())),r},t.prototype._adjustRibbonGroupIfNeeded=function(e,t,r){var s=this,o=e.length-1,u=0,a=0,f=0,l,c,h;for(;o>=0;o--){f=0;for(u=0;u<o;u++)f+=t[u].width;f+a+t[o].width<=r?(l=n(e[o]).children("."+p),c=n(e[o]).children("."+v),l&&(n(e[o]).addClass(i+"-"+t[o].text.toLowerCase()).prepend(l.children()),l.remove(),c&&c.remove())):(h=t[o],a+=s._createDropDownRibbonGroup(h.text,e[o]))}},t.prototype._createDropDownRibbonGroup=function(e,t){var r=this,s=i+"-"+e.toLowerCase(),o=this.options.wijCSS,u=n(t).removeClass(s),a=r._getGroupLabelText(u.find(">div:last"))||e,l;return u.wrapInner("<div class='"+p+" "+f+"'></div>").children().hide().addClass(s).bind("mouseup."+r.widget,function(e){r.showDrpDwnGroup!==null&&(r.showDrpDwnGroup.hide().css("z-index",""),r.showDrpDwnGroup=null)}),l=n("<div class='"+v+"'>"+"<span class='"+d+a.toLowerCase()+" "+g+" "+y+"'></span>"+"<span class='"+m+"'>"+a+"</span>"+"<span class='"+o.icon+" "+o.iconArrowDown+" "+g+"'></span></div>").appendTo(u).unbind(r.widget).bind("mouseover."+r.widget,function(e){n(this).addClass(o.stateHover)}).bind("mouseout."+r.widget,function(e){n(this).removeClass(o.stateHover)}).bind("click."+r.widget,function(e){var t=n(this).siblings("."+p);t.is(":visible")?(t.hide().css("z-index",""),r.showDrpDwnGroup=null):(r.showDrpDwnGroup&&r.showDrpDwnGroup.hide().css("z-index",""),t.show().position({my:"left top",at:"left bottom",of:this}).css("z-index","10000"),r.showDrpDwnGroup=t,e.stopPropagation())}),u.outerWidth(!0)},t.prototype._hideShowedList=function(){var e=this;n(document).bind("mouseup",function(t){var r=t.target;e.showList&&(n(r).is(document)||!n.contains(e.showList.get(0),r))&&(e.showList.hide().css("z-index",""),e.showList=null),e.showDrpDwnGroup&&(n(r).is(document)||!n.contains(e.showDrpDwnGroup.get(0),r))&&(e.showDrpDwnGroup.hide().css("z-index",""),e.showDrpDwnGroup=null)})},t.prototype._buildButtonOption=function(e,t){var r=!0,i=this,s=e.attr("class"),u,a,f,l,c,h,p;if(s&&s!==""&&s!==o)a=s.split(" ")[0],e.removeClass(a),c=n.trim(e.text()),c===""&&(r=!1);else{if(t==="checkbox"||t==="radio"){if(n.trim(e.attr("id"))==="")return;h=n("[for='"+e.attr("id")+"']",e.parent());if(!h.is("label"))return;s=h.attr("class"),s&&s!==""&&s!==o?(a=s.split(" ")[0],h.removeClass(a),c=n.trim(h.text()),c===""&&(r=!1)):u=h.children("span,div")}else t==="button"&&(u=e.children("span,div"));u&&(u.length===1?u.eq(0).attr("class")!==""&&(f=u.eq(0),a=f.attr("class"),r=!1):u.length===2?u.eq(0).attr("class")&&(f=u.eq(0),a=f.attr("class"),f.is("span")?l="left":f.is("div")&&(l="top"),c=u.eq(1).text()):t==="button"&&n.trim(e.text())!==""&&(c=n.trim(e.text())))}return t==="button"?(e.empty(),p=n.trim(e.attr("name")),p!==""&&e.removeAttr("name")):(p=n.trim(h.attr("name")),p!==""&&h.removeAttr("name")),p!==""&&(e.data("commandName",p),i.buttons[p]||(i.buttons[p]={button:undefined,accessToolbarButton:undefined}),e.parent().is(".wijmo-wijribbon-accesstoolbar")?i.buttons[p].accessToolbarButton=e:i.buttons[p].button=e),{label:c,icons:{primary:a},position:l,text:r}},t.prototype._triggerEvent=function(e){var t=this,r,i,s=t.options.wijCSS;e.bind("click",function(o){if(t.options.disabled){o.preventDefault(),o.stopPropagation();return}t._hideAllMenus();var u=!0,a=e.data("commandName"),f=t.buttons[a],l={name:undefined,commandName:undefined};f&&f.parent&&(l.name=f.parent.data("commandName")),l.commandName=a,t._trigger("click",o,l),e.parent().is(".wijmo-wijribbon-accesstoolbar")?r=t.buttons[a].button:r=t.buttons[a].accessToolbarButton,r&&(i=r.button("widget"),r.is("button")||(i&&i.hasClass(s.stateActive)&&(u=!1),t._setBtnWidgetCheckedStyle(r,u))),e.is("button")&&(o.preventDefault(),o.stopPropagation()),n("."+s.buttonText,this).removeClass(s.stateHover)})},t.prototype._getDropdownLabelSubstr=function(e,t,r){var i=this,s=e.length,o=0,u=s,a=Math.floor((o+u)/2),f=n("<span></span>"),l=e.substr(0,a),c;f.appendTo(t.parent()),c=i._calculateWidth(l,f);while(c!==r&&u>o)l=e.substr(0,a+1),c=i._calculateWidth(l,f),c>r?u=a-1:c<r&&(o=a+1),a=Math.floor((o+u)/2);return f.remove(),l},t.prototype._calculateWidth=function(e,t){return t.text(e),t.width()},t.prototype.hideDropdown=function(e){var t=this,n=t.listUis[e];n&&n.list&&n.list.hide()},t.prototype._hideAllMenus=function(){var e=this;n(".wijmo-wijmenu",e.tabEle).hide()},t.prototype.setTabPageVisible=function(e,t){var r=this,i=n("a[href=#"+e+"]",r.element).parent("li"),s=i.parent("ul"),o;i&&i.length>0&&(t?(i.show(),o=n("li",s).index(i)):(i.hide(),o=n("li",s).index(n('li:visible:not(".wijmo-wijribbon-startmenulinkcontainer")',s)))),r.element.wijtabs("option","selected",o)},t.prototype.destroy=function(){this.disabledModal&&this.disabledModal.remove(),n(window).unbind("resize.wijribbon"),n.Widget.prototype.destroy.call(this)},t.prototype.getDropdownList=function(e){var t=this,r=t.listUis[e],i={};return r&&n.each(r.buttons,function(e,t){i[t.data("commandName")]=t.button("option","label")}),i},t.prototype.setButtonDisabled=function(e,t){var r=this.buttons[e],i=this.options.wijCSS,s=!1,o,u,a;r&&r.button&&r.type==="galleryBtn"&&r.button.addClass(i.stateDisabled);if(r&&r.button){o=r.button,u=r.accessToolbarButton,s=o.is("button");if(r.type==="galleryBtn"){t?o.addClass(i.stateDisabled):o.removeClass(i.stateDisabled);return}o.button("option","disabled",t),u&&u.button("option","disabled",t),s?e!=="save"&&(o.children("."+i.buttonText).text(e),u&&o.children("."+i.buttonText).text(e)):n("[for='"+o.attr("id")+"']",o.parent()).children("."+i.buttonText).text(e),a=this.listUis[e],a&&a.type==="split"&&(a.trigger.button("option","disabled",t),a.trigger.children("."+i.buttonText).text(e))}},t.prototype.setButtonsDisabled=function(e){var t=this;n.each(e,function(e,n){t.setButtonDisabled(e,n)})},t.prototype.setButtonsChecked=function(e){var t=this;n.each(e,function(e,r){n.isPlainObject(r)?t.setButtonChecked(e,r.checked,r.name):t.setButtonChecked(e,r,null)})},t.prototype._setBtnWidgetCheckedStyle=function(e,t){var n=this,e,r=n.options.wijCSS;e.is("button")?t?e.addClass(r.stateActive):e.removeClass(r.stateActive):e.is("input[type='text']")||(e.prop("checked",t),e.button("refresh")),n._addActiveClassToButtonText(e.button("widget"))},t.prototype.setButtonChecked=function(e,t,r){var i=this,s,o=i.buttons[e],u=this.options.wijCSS,a,f,l,c;if(o&&o.button){a=o.button,f=o.accessToolbarButton;if(a.is("button"))t?(a.addClass(u.stateActive),f&&f.addClass(u.stateActive)):(a.removeClass(u.stateActive),f&&f.removeClass(u.stateActive));else{if(o.type==="galleryBtn"){var h=a.parent("div");n("div",h).removeClass(u.stateActive),t?a.addClass(u.stateActive):a.removeClass(u.stateActive);return}a.is("input[type='text']")||(a.prop("checked",t),a.button("refresh"),f&&(f.prop("checked",t),f.button("refresh")))}o.parent?o.type==="dropdown"&&t&&(i.dropdownLabels[e]||(i.dropdownLabels[e]=i._getDropdownLabelSubstr(a.button("option","label"),o.parent.children("."+u.buttonText),o.parent.children("."+u.buttonText).width())),c=i.dropdownLabels[e],o.parent.is("input[type='text']")?(o.parent.val(c),o.parent.attr("title",c)):(o.parent.button("option","label",c),o.parent.attr("title",a.button("option","label"))),s=n(":radio",o.button.closest("ul")),s&&n.each(s,function(){i._updateGroupElementTextState(this)})):(i._addActiveClassToButtonText(a.button("widget")),f&&i._addActiveClassToButtonText(f.button("widget")))}else r&&(l=i.listUis[r],l&&(l.ui.is("input[type='text']")?l.ui.val(l.defaultValue):l.ui.button("option","label",l.defaultValue),l.buttons&&n.each(l.buttons,function(e,t){t.prop("checked",!1),t.button("refresh"),i._addActiveClassToButtonText(t.button("widget"))})))},t}(e.wijmoWidget);t.wijribbon=b;var w=function(){function e(){this.initSelector=":jqmData(role='wijribbon')",this.wijCSS={wijtabsHide:"wijmo-wijtabs-hide"},this.click=null}return e}();b.prototype.options=n.extend(!0,{},e.wijmoWidget.prototype.options,new w),n.wijmo.registerWidget("wijribbon",b.prototype)})(e.ribbon||(e.ribbon={}));var t=e.ribbon})(wijmo||(wijmo={}));;
var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(t){"use strict";var n=jQuery,r="wijeditor",i=alert,s=window,o=document,u=parseInt,a,f,l,c=[],h=null,p=!0,d=!0,v=0,m=[],g=null,y=null,b="setButtonDisabled",w="setButtonsDisabled",E="setButtonChecked",S="setButtonsChecked",x="form",T="imagebutton",N="textarea",C="button",k="textbox",L="list",A="passwordfield",O="dropdownlist",M="hiddenfield",_="radio",D="checkbox",P="insertcol",H="insertrow",B="insertcell",j="splitcell",F="mergecell",I="deletecol",q="deleterow",R="deletecell",U="justifyleft",z="justifycenter",W="justifyright",X="justifyfull",V="borders",$="insertorderedlist",J="insertunorderedlist",K="outdent",Q="indent",G="backcolor",Y="fontcolor",Z="bold",et="italic",tt="strikethrough",nt="underline",rt="subscript",it="superscript",st="template",ot="removeformat",ut="insertbreak",at="insertparagraph",ft="insertprintpagebreak",lt="inserthorizontalrule",ct="tablebutton",ht="inserttable",pt="edittable",dt="wysiwyg",vt="split",mt="code",gt="wordwrap",yt="fullscreen",bt="undo",wt="redo",Et="preview",St="cleanup",xt="cut",Tt="copy",Nt="paste",Ct="selectall",kt="media",Lt="specialchar",At="datetime",Ot="find",Mt="inspect",_t="save",Dt="spelling",Pt="imagebrowser",Ht="link",Bt="xx-small",jt="x-small",Ft="small",It="medium",qt="large",Rt="x-large",Ut="xx-large",zt="fontname",Wt="fontsize",Xt="blockquote",Vt="insertcode",$t="wijmo-wijribbon",Jt=$t+"-bigbutton",Kt=$t+"-dropdownbutton",Qt=$t+"-splitbutton",Gt=$t+"-list",Yt=$t+"-save",Zt=$t+"-save16",en=$t+"-undo",tn=$t+"-redo",nn=$t+"-preview",rn=$t+"-cleanup",sn=$t+"-cut",on=$t+"-copy",un=$t+"-paste",an=$t+"-selectall",fn=$t+"-bgcolor",ln=$t+"-color",cn=$t+"-bold",hn=$t+"-italic",pn=$t+"-underline",dn=$t+"-strike",vn=$t+"-sub",mn=$t+"-sup",gn=$t+"-template",yn=$t+"-removeformat",bn=$t+"-justifyleft",wn=$t+"-justifycenter",En=$t+"-justifyright",Sn=$t+"-justifyfull",xn=$t+"-borders",Tn=$t+"-orderlist",Nn=$t+"-unorderlist",Cn=$t+"-outdent",kn=$t+"-indent",Ln=$t+"-inspect",An=$t+"-find",On=$t+"-table",Mn=$t+"-inserttable",_n=$t+"-edittable",Dn=$t+"-insertcol",Pn=$t+"-insertrow",Hn=$t+"-insertcell",Bn=$t+"-splitcell",jn=$t+"-mergecell",Fn=$t+"-deletecol",In=$t+"-deleterow",qn=$t+"-deletecell",Rn=$t+"-insertbreak",Un=$t+"-insertparagraph",zn=$t+"-insertprintpagebreak",Wn=$t+"-inserthr",Xn=$t+"-form",Vn=$t+"-textarea",$n=$t+"-textbox",Jn=$t+"-password",Kn=$t+"-hiddenfield",Qn=$t+"-imagebutton",Gn=$t+"-button",Yn=$t+"-listbox",Zn=$t+"-dropdownlist",er=$t+"-radio",tr=$t+"-checkbox",nr=$t+"-link",rr=$t+"-link16",ir=$t+"-imagebrowser",sr=$t+"-media",or=$t+"-specialchar",ur=$t+"-datetime",ar=$t+"-blockquote",fr=$t+"-insertcode",lr=$t+"-modes",cr=$t+"-designview",hr=$t+"-sourceview",pr=$t+"-splitview",dr=$t+"-wordwrap",vr=$t+"-fullscreen",mr="wijmo-wijeditor",gr=mr+"-container",yr=mr+"-header",br=mr+"-content",wr=mr+"-footer",Er=mr+"-pathselector",Sr=mr+"-fullscreen",xr=mr+"-dialog",Tr=xr+"-hr",Nr=xr+"-buttons",Cr=xr+"-button",kr=xr+"-text",Lr=mr+"-imagedlg",Ar=Lr+"-content",Or=Lr+"-fields",Mr=Lr+"-imagefield",_r=Lr+"-imagelist",Dr=Lr+"-preview",Pr=Lr+"-imagesrc",Hr=Lr+"-imagealt",Br=Lr+"-imagewidth",jr=Lr+"-imageheight",Fr=Lr+"-css",Ir=Lr+"-hideimagelist",qr=mr+"-templatedlg",Rr=qr+"-toplabels",Ur=qr+"-topleftlabel",zr=qr+"-toprightlabel",Wr=qr+"-content",Xr=qr+"-templatelist",Vr=qr+"-preview",$r=qr+"-templateinfo",Jr=qr+"-nameinfo",Kr=qr+"-descriptioninfo",Qr=qr+"-fields",Gr=qr+"-name",Yr=qr+"-description",Zr=qr+"-buttons",ei=qr+"-delete",ti=qr+"-save",ni=mr+"-linkdlg",ri=ni+"-address",ii=ni+"-linktype",si=ni+"-anchor",oi=ni+"-text",ui=ni+"-target",ai=ni+"-css",fi=ni+"-src",li=ni+"-width",ci=ni+"-height",hi=ni+"-imagecontainer",pi=ni+"-linkicontype",di=mr+"-codedlg",vi=di+"-source",mi=di+"-sourcelabel",gi=mr+"-taginsdlg",yi=gi+"-caption",bi=gi+"-taglabel",wi=gi+"-tagtext",Ei=gi+"-filterempty",Si=gi+"-attribs",xi=gi+"-attriblist",Ti=gi+"-innerhtml",Ni=gi+"-css",Ci=mr+"-colordlg",ki=Ci+"-picker",Li=Ci+"-color",Ai=mr+"-tabledlg",Oi=Ai+"-rows",Mi=Ai+"-columns",_i=Ai+"-width",Di=Ai+"-height",Pi=Ai+"-border",Hi=Ai+"-cellpadding",Bi=Ai+"-cellspacing",ji=Ai+"-csstext",Fi=Ai+"-bgcolor",Ii=mr+"-previewdlg",qi=Ii+"-caption",Ri=Ii+"-navigator",Ui=Ii+"-prev",zi=Ii+"-next",Wi=Ii+"-printall",Xi=Ii+"-printone",Vi=Ii+"-ok",$i=Ii+"-printdocument",Ji=Ii+"-previewiframe",Ki=mr+"-cleanupdlg",Qi=Ki+"-caption",Gi=Ki+"-document",Yi=Ki+"-actions",Zi=mr+"-finddlg",es=Zi+"-find",ts=Zi+"-replace",ns=mr+"-mediadlg",rs=ns+"-type",is=ns+"-src",ss=ns+"-width",os=ns+"-height",us=mr+"-specialchardlg",as=us+"-chars",fs=us+"-preview",ls=us+"-content",cs=us+"-list",hs=us+"_label",ps=us+"-punctuation",ds=us+"-symbols",vs=us+"-diacritics",ms="wijmo-formatspan",gs="."+Nr+" input:first",ys="."+Nr+" input:last",bs="."+Nr+" input[value='OK']",ws="."+Nr+" input[engValue='Cancel']",Es=["Bold","Italic","UnderLine","StrikeThrough","SubScript","SuperScript","JustifyLeft","JustifyCenter","JustifyRight","JustifyFull","Border","NumberedList","BulletedList","Outdent","Indent"],Ss=["Bold","Italic","Link","BlockQuote","StrikeThrough","InsertDate","InsertImage","NumberedList","BulletedList","InsertCode"],xs=["Bold","Italic","StrikeThrough","UnderLine","ForeColor","FontSize","Link","InsertImage","NumberedList","BulletedList","BlockQuote"],Ts={Form:{name:"form",tip:"Form",css:Xn},Image:{name:"imagebutton",tip:"Image Button",css:Qn},TextArea:{name:"textarea",tip:"TextArea",css:Vn},Button:{name:"button",tip:"Button",css:Gn},TextBox:{name:"textbox",tip:"TextBox",css:$n},List:{name:"list",tip:"ListBox",css:Yn},PasswordField:{name:"passwordfield",tip:"Password Field",css:Jn},DropDownList:{name:"dropdownlist",tip:"DropDownList",css:Zn},HiddenField:{name:"hiddenfield",tip:"Hidden Field",css:Kn},Radio:{name:"radio",tip:"RadioButton",css:er},CheckBox:{name:"checkbox",tip:"CheckBox",css:tr},InsertColumn:{name:"insertcol",tip:"Insert Column",css:Dn},InsertRow:{name:"insertrow",tip:"Insert Row",css:Pn},InsertCell:{name:"insertcell",tip:"Insert Cell",css:Hn},SplitCell:{name:"splitcell",tip:"Split Cell",css:Bn},MergeCell:{name:"mergecell",tip:"Merge Cell",css:jn},DeleteColumn:{name:"deletecol",tip:"Delete Column",css:Fn},DeleteRow:{name:"deleterow",tip:"Delete Row",css:In},DeleteCell:{name:"deletecell",tip:"Delete Cell",css:qn},JustifyLeft:{name:"justifyleft",tip:"Justify Left",css:bn,grpname:"alignment"},JustifyCenter:{name:"justifycenter",tip:"Justify Center",css:wn,grpname:"alignment"},JustifyRight:{name:"justifyright",tip:"Justify Right",css:En,grpname:"alignment"},JustifyFull:{name:"justifyfull",tip:"Justify Full",css:Sn,grpname:"alignment"},Border:{name:"borders",tip:"Border",css:xn},NumberedList:{name:"insertorderedlist",tip:"Numbered List",css:Tn,grpname:"list"},BulletedList:{name:"insertunorderedlist",tip:"Bulleted List",css:Nn,grpname:"list"},Outdent:{name:"outdent",tip:"Outdent",css:Cn,grpname:"block"},Indent:{name:"indent",tip:"Indent",css:kn,grpname:"block"},BackColor:{name:"backcolor",tip:"Background Color",css:fn},ForeColor:{name:"fontcolor",tip:"Font Color",css:ln},Bold:{name:"bold",tip:"Bold",css:cn},Italic:{name:"italic",tip:"Italic",css:hn},StrikeThrough:{name:"strikethrough",tip:"Strikethrough",css:dn},UnderLine:{name:"underline",tip:"Underline",css:pn},SubScript:{name:"subscript",tip:"Subscript",css:vn},SuperScript:{name:"superscript",tip:"Superscript",css:mn},Template:{name:"template",tip:"Template",css:gn},RemoveFormat:{name:"removeformat",tip:"RemoveFormat",css:yn},InsertBreak:{name:"insertbreak",tip:"Insert Break",css:Rn},InsertParagraph:{name:"insertparagraph",tip:"Insert Paragraph",css:Un},InsertPrint:{name:"insertprintpagebreak",tip:"Insert Print Page Break",css:zn},InsertHR:{name:"inserthorizontalrule",tip:"Insert Horizontal Line",css:Wn},Table:{name:"tablebutton",tip:"Table",css:On},InsertTable:{name:"inserttable",tip:"Insert Table",css:Mn},EditTable:{name:"edittable",tip:"Edit Table",css:_n},Wysiwyg:{name:"wysiwyg",tip:"Design View",css:cr,grpname:"modes"},Split:{name:"split",tip:"Split View",css:pr,grpname:"modes"},Code:{name:"code",tip:"Source View",css:hr,grpname:"modes"},Wordwrap:{name:"wordwrap",tip:"Wordwrap",css:dr},FullScreen:{name:"fullscreen",tip:"Fullscreen",css:vr},Undo:{name:"undo",tip:"Undo",css:en},Redo:{name:"redo",tip:"Redo",css:tn},Preview:{name:"preview",tip:"Preview",css:nn},Cleanup:{name:"cleanup",tip:"Clean up",css:rn},Cut:{name:"cut",tip:"Cut",css:sn},Copy:{name:"copy",tip:"Copy",css:on},Paste:{name:"paste",tip:"Paste",css:un},SelectAll:{name:"selectall",tip:"Select All",css:an},Media:{name:"media",tip:"Media",css:sr},InsertSpecialChar:{name:"specialchar",tip:"Insert Special Character",css:or},InsertDate:{name:"datetime",tip:"Insert Date Time",css:ur},Find:{name:"find",tip:"Find And Replace",css:An,text:"Find"},Inspect:{name:"inspect",tip:"Tag Inspect",css:Ln,text:"Inspect"},Save:{name:"save",tip:"Save",css:Yt,text:"Save"},Spelling:{name:"spelling",tip:"Form",css:""},InsertImage:{name:"imagebrowser",tip:"Image Browser",css:ir},Link:{name:"link",tip:"Link",css:nr,text:"Link"},FontName:{name:"fontname",tip:"Font Name",css:Kt},FontSize:{name:"fontsize",tip:"Font Size",css:Kt},BlockQuote:{name:"blockquote",tip:"Block Quote",css:ar},InsertCode:{name:"insertcode",tip:"Insert Code",css:fr}},Ns=function(){var e=this,t=[];e.append=function(e){t.push(e)},e.toString=function(){return t.join("")},e.dispose=function(){t=null}},Cs=function(e){this.text=e,this.render=function(){return this.text}},ks=function(e,t,r){var i=this,s={br:!0,img:!0,hr:!0,input:!0};i.tagName=e||"div",i.attributes=r||{},i.innerText=t||"",i.children=[],n.isPlainObject(t)&&(i.innerText="",i.attributes=t),i._isShortTag=!1,s[i.tagName]===!0&&(i._isShortTag=!0),i.render=function(){var e=new Ns,t="";return e.append(i._renderBeginTag(i.tagName,i.attributes)),i.innerText!==""&&e.append(i.innerText),i.children.length>0&&n.each(i.children,function(t,n){e.append(n.render())}),e.append(i._renderEndTag(i.tagName)),t=e.toString(),e.dispose(),t},i.add=function(e){this.children.push(e)},i._renderBeginTag=function(e,t){var r=new Ns,i="";return r.append("<"),r.append(e),n.each(t,function(e,t){r.append(" "),r.append(e),r.append("="),r.append('"'),r.append(t?t.toString():""),r.append('"')}),this._isShortTag?r.append(" "):r.append(">"),i=r.toString(),r.dispose(),i},i._renderEndTag=function(e){var t=new Ns,n="";return this._isShortTag?t.append("/>"):(t.append("</"),t.append(e),t.append(">")),n=t.toString(),t.dispose(),n}},Ls=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.wijeditor=function(){this._curPageIdx=0,this.tRange=null,this.txtFoundInIE=!1,this.txtFoundInNoneIE=!1},t.prototype._create=function(){var e=this;window.wijmoApplyWijTouchUtilEvents&&(n=window.wijmoApplyWijTouchUtilEvents(n));if(e.element.is("input"))return;e.id_prefix="wijeditor-"+e.element.attr("id")+"-",e.$ribbon=undefined,e.$modes=undefined,e._editorify(),e._initElements(),s.setTimeout(function(){e.options.disabled&&e._handleDisabledOption(!0,e.editor)},40),e._continueSavingInputTextForUndo=!1,e.element.is(":hidden")&&e.editor.wijAddVisibilityObserver&&e.editor.wijAddVisibilityObserver(function(t){if(n.contains(e.editor[0],t.target))return;e.refresh(),e.editor.wijRemoveVisibilityObserver&&e.editor.wijRemoveVisibilityObserver()},"wijeditor")},t.prototype._contextMenuWidgetName=function(){return"wijmenu"},t.prototype._createBigButton=function(e,t,n,r){var i=this,s=i._createElement("button",{title:e,name:n,"class":Jt});return s.add(i._createDiv(t)),s.add(i._createSpan("",r)),s},t.prototype._createTextButton=function(e,t,n){return this._createElement("button",n,{title:e,name:t})},t.prototype._createButton=function(e,t,n,r){var i=this,s;return r?(s=i._createElement("button",{title:e,name:n}),s.add(i._createSpan(t)),s.add(i._createSpan("",r)),s):i._createElement("button",{title:e,name:n,"class":t})},t.prototype._createTextRadioButton=function(e,t,n,r,i){var s=this,o=[];return o.push(s._createElement("input",{id:t+n,type:"radio",name:r})),o.push(s._createElement("label",i,{"for":t+n,title:e,name:n})),o},t.prototype._createImageRadioButton=function(e,t,n,r,i){var s=this,o=[];return o.push(s._createElement("input",{id:t+r,type:"radio",name:i})),o.push(s._createElement("label",{"for":t+r,title:e,name:r,"class":n})),o},t.prototype._createImageCheckButton=function(e,t,n,r){var i=this,s=[];return s.push(i._createElement("input",{id:t+r,type:"checkbox"})),s.push(i._createElement("label",{"for":t+r,title:e,name:r,"class":n})),s},t.prototype._createRibbonList=function(){return this._createSpan(Gt)},t.prototype._createDropdownButton=function(e,t,r,i,s){var o=this,u=o._createElement("div",{title:e,"class":Kt}),a=o._createElement("ul");return u.add(o._createTextButton(e,t,r)),u.add(a),n.each(i,function(e,r){var i=o._createElement("li"),u=o._createTextRadioButton(r.tip,s,r.name,t,r.text);n.each(u,function(e,t){i.add(t)}),a.add(i)}),u},t.prototype._createSplitButton=function(e,t,r,i,s){var o=this,u=o._createElement("div",{title:e,"class":Qt}),a=o._createElement("ul");return u.add(o._createBigButton(e,t,r,i)),u.add(o._createElement("button",{"class":Jt})),u.add(a),n.each(s,function(e,t){var n=o._createElement("li");n.add(o._createButton(t.tip,t.css,t.name,t.text)),a.add(n)}),u},t.prototype._createButtonByCommand=function(e){var t=this,n,r=Ts[e],i;if(!r)return;i=r.name;switch(i){case Xt:case x:case T:case N:case C:case k:case L:case A:case O:case M:case _:case D:case P:case H:case B:case j:case F:case I:case q:case R:case ot:case ut:case at:case ft:case yt:case bt:case wt:case xt:case Tt:case Nt:case At:case gt:case G:case Y:case Et:case St:case kt:case Lt:case st:case Pt:case Vt:case lt:case Ct:n=t._createButton(r.tip,r.css,i);break;case Ot:case Mt:n=t._createButton(r.tip,r.css,i,r.text);break;case V:case rt:case it:case Z:case et:case nt:case tt:n=t._createImageCheckButton(r.tip,t.id_prefix,r.css,i);break;case dt:case vt:case mt:case U:case z:case W:case X:case K:case Q:case $:case J:n=t._createImageRadioButton(r.tip,t.id_prefix,r.css,i,r.grpname);break;case ct:n=t._createSplitButton("Table",On,ct,"Table",[{tip:"Insert Table",css:Mn,name:ht,text:"Insert"},{tip:"Edit Table",css:_n,name:pt,text:"Edit"}]);break;case _t:t.options.mode==="ribbon"?n=t._createBigButton(r.tip,r.css,i,r.text):n=t._createButton(r.tip,Zt,i);break;case Ht:t.options.mode==="ribbon"?n=t._createBigButton(r.tip,r.css,i,r.text):n=t._createButton(r.tip,rr,i);break;case zt:n=t._createDropdownButton("Font Name",zt,"Font Name",[{tip:"Arial",name:"fn1",text:"Arial"},{tip:"Courier New",name:"fn2",text:"Courier New"},{tip:"Garamond",name:"fn3",text:"Garamond"},{tip:"Tahoma",name:"fn4",text:"Tahoma"},{tip:"Times New Roman",name:"fn5",text:"Times New Roman"},{tip:"Verdana",name:"fn6",text:"Verdana"},{tip:"Wingdings",name:"fn7",text:"Wingdings"}],t.id_prefix);break;case Wt:n=t._createDropdownButton("Font Size",Wt,"Font Size",[{tip:"VerySmall",name:"xx-small",text:"VerySmall"},{tip:"Smaller",name:"x-small",text:"Smaller"},{tip:"Small",name:"small",text:"Small"},{tip:"Medium",name:"medium",text:"Medium"},{tip:"Large",name:"large",text:"Large"},{tip:"Larger",name:"x-large",text:"Larger"},{tip:"VeryLarge",name:"xx-large",text:"VeryLarge"}],t.id_prefix);break;case Dt:}return n},t.prototype._createActionGroup=function(){var e=this,t=e._createElement("li"),n=e._createRibbonList();return t.add(e._createButtonByCommand("Save")),t.add(n),n.add(e._createButtonByCommand("Undo")),n.add(e._createButtonByCommand("Redo")),n=e._createRibbonList(),t.add(n),n.add(e._createButtonByCommand("Preview")),n.add(e._createButtonByCommand("Cleanup")),n=e._createRibbonList(),t.add(n),n.add(e._createButtonByCommand("Cut")),n.add(e._createButtonByCommand("Copy")),n.add(e._createButtonByCommand("Paste")),n.add(e._createButtonByCommand("SelectAll")),t.add(e._createElement("div","Actions")),t},t.prototype._createFontGroup=function(){var e=this,t=e._createElement("li"),r=e._createRibbonList();return t.add(e._createButtonByCommand("FontName")),t.add(e._createButtonByCommand("FontSize")),t.add(r),r.add(e._createButtonByCommand("BackColor")),r.add(e._createButtonByCommand("ForeColor")),r=e._createRibbonList(),t.add(r),n.each(e._createButtonByCommand("Bold"),function(e,t){r.add(t)}),n.each(e._createButtonByCommand("Italic"),function(e,t){r.add(t)}),n.each(e._createButtonByCommand("UnderLine"),function(e,t){r.add(t)}),n.each(e._createButtonByCommand("StrikeThrough"),function(e,t){r.add(t)}),n.each(e._createButtonByCommand("SubScript"),function(e,t){r.add(t)}),n.each(e._createButtonByCommand("SuperScript"),function(e,t){r.add(t)}),r=e._createRibbonList(),t.add(r),r.add(e._createButtonByCommand("Template")),r=e._createRibbonList(),t.add(r),r.add(e._createButtonByCommand("RemoveFormat")),t.add(e._createElement("div","Font")),t},t.prototype._createParaGroup=function(){var e=this,t=e._createElement("li"),r=e._createRibbonList();return t.add(r),n.each(e._createButtonByCommand("JustifyLeft"),function(e,t){r.add(t)}),n.each(e._createButtonByCommand("JustifyCenter"),function(e,t){r.add(t)}),n.each(e._createButtonByCommand("JustifyRight"),function(e,t){r.add(t)}),n.each(e._createButtonByCommand("JustifyFull"),function(e,t){r.add(t)}),r=e._createRibbonList(),t.add(r),n.each(e._createButtonByCommand("Border"),function(e,t){r.add(t)}),r=e._createRibbonList(),t.add(r),n.each(e._createButtonByCommand("NumberedList"),function(e,t){r.add(t)}),n.each(e._createButtonByCommand("BulletedList"),function(e,t){r.add(t)}),r=e._createRibbonList(),t.add(r),n.each(e._createButtonByCommand("Outdent"),function(e,t){r.add(t)}),n.each(e._createButtonByCommand("Indent"),function(e,t){r.add(t)}),t.add(e._createElement("div","Paragraph")),t},t.prototype._createReviewGroup=function(){var e=this,t=e._createElement("li");return t.add(e._createButtonByCommand("Inspect")),t.add(e._createButtonByCommand("Find")),t.add(e._createElement("div","Review")),t},t.prototype._createTablesGroup=function(){var e=this,t=e._createElement("li"),n=e._createRibbonList();return t.add(e._createButtonByCommand("Table")),t.add(n),n.add(e._createButtonByCommand("InsertColumn")),n.add(e._createButtonByCommand("InsertRow")),n.add(e._createButtonByCommand("InsertCell")),n=e._createRibbonList(),t.add(n),n.add(e._createButtonByCommand("SplitCell")),n.add(e._createButtonByCommand("MergeCell")),n=e._createRibbonList(),t.add(n),n.add(e._createButtonByCommand("DeleteColumn")),n.add(e._createButtonByCommand("DeleteRow")),n.add(e._createButtonByCommand("DeleteCell")),t.add(e._createElement("div","Tables")),t},t.prototype._createBreaksGroup=function(){var e=this,t=e._createElement("li");return t.add(e._createButtonByCommand("InsertBreak")),t.add(e._createButtonByCommand("InsertParagraph")),t.add(e._createButtonByCommand("InsertPrint")),t.add(e._createButtonByCommand("InsertHR")),t.add(e._createElement("div","Breaks")),t},t.prototype._createFormsGroup=function(){var e=this,t=e._createElement("li"),n=e._createRibbonList();return t.add(n),n.add(e._createButtonByCommand("Form")),n=e._createRibbonList(),t.add(n),n.add(e._createButtonByCommand("TextArea")),n.add(e._createButtonByCommand("TextBox")),n.add(e._createButtonByCommand("PasswordField")),n.add(e._createButtonByCommand("HiddenField")),n=e._createRibbonList(),t.add(n),n.add(e._createButtonByCommand("Image")),n.add(e._createButtonByCommand("Button")),n=e._createRibbonList(),t.add(n),n.add(e._createButtonByCommand("List")),n.add(e._createButtonByCommand("DropDownList")),n.add(e._createButtonByCommand("Radio")),n.add(e._createButtonByCommand("CheckBox")),t.add(e._createElement("div","Forms")),t},t.prototype._createSpecialGroup=function(){var e=this,t=e._createElement("li");return t.add(e._createButtonByCommand("Link")),t.add(e._createButtonByCommand("InsertImage")),t.add(e._createButtonByCommand("Media")),t.add(e._createButtonByCommand("InsertSpecialChar")),t.add(e._createButtonByCommand("InsertDate")),t.add(e._createElement("div","Special")),t},t.prototype._getDefaultRibbonMarkup=function(){var e=this,t=e._createElement("div"),n=e._createElement("ul"),r=e._createElement("li"),i=e._createElement("li"),s=e._createElement("div",{id:e.id_prefix+"format"}),o=e._createElement("div",{id:e.id_prefix+"insert"}),u=e._createElement("ul"),a=e._createElement("ul");return t.add(n),t.add(s),t.add(o),n.add(r),n.add(i),r.add(e._createElement("a","Format",{href:"#"+e.id_prefix+"format"})),i.add(e._createElement("a","Insert",{href:"#"+e.id_prefix+"insert"})),s.add(u),u.add(e._createActionGroup()),u.add(e._createFontGroup()),u.add(e._createParaGroup()),u.add(e._createReviewGroup()),o.add(a),a.add(e._createTablesGroup()),a.add(e._createBreaksGroup()),a.add(e._createFormsGroup()),a.add(e._createSpecialGroup()),t.render()},t.prototype._getRibbonModesMarkup=function(){var e=this,t=e._createDiv(lr),r=e._createRibbonList(),i=e.element.find(".wijeditor-footer"),s,o,u,a,f;return i.length>0&&(s=n(i.find("."+cr)),s.length>0&&(Ts.Wysiwyg.tip=s.attr("title")||Ts.Wysiwyg.tip),o=n(i.find("."+pr)),o.length>0&&(Ts.Split.tip=o.attr("title")||Ts.Split.tip),u=n(i.find("."+hr)),u.length>0&&(Ts.Code.tip=u.attr("title")||Ts.Code.tip),a=n(i.find("."+dr)),s.length>0&&(Ts.Wordwrap.tip=a.attr("title")||Ts.Wordwrap.tip),f=n(i.find("."+vr)),s.length>0&&(Ts.FullScreen.tip=f.attr("title")||Ts.FullScreen.tip),i.remove()),t.add(r),n.each(e._createButtonByCommand("Wysiwyg"),function(e,t){r.add(t)}),n.each(e._createButtonByCommand("Code"),function(e,t){r.add(t)}),n.each(e._createButtonByCommand("Split"),function(e,t){r.add(t)}),t.add(e._createButtonByCommand("Wordwrap")),t.add(e._createButtonByCommand("FullScreen")),t.render()},t.prototype._getSimpleToolBar=function(e){var t=this,r,i=t._createDiv("");return n.each(e,function(e,s){r=t._createButtonByCommand(s),r&&(n.inArray(s,Es)!==-1?n.each(r,function(e,t){i.add(t)}):i.add(r))}),i.render()},t.prototype._editorify=function(){var e=this,t=e.element,r=t.width(),i=t.height(),s=e.options,o=s.mode,u,a,f,l,c,h,p;e._oriStyle=t.attr("style"),e._oriContent=t.html(),e._oriEleWidth=r,e._oriEleHeight=i,t.is("textarea")?(o==="ribbon"?e.$ribbon=n(e._getDefaultRibbonMarkup()):o==="bbcode"?e.$ribbon=n(e._getSimpleToolBar(xs)):s.simpleModeCommands&&s.simpleModeCommands.length!==0?(f=n.grep(s.simpleModeCommands,function(e,t){return e!=="Table"},undefined),e.$ribbon=n(e._getSimpleToolBar(f))):e.$ribbon=n(e._getSimpleToolBar(Ss)),s.text&&t.val(s.text),e.sourceView=t,e.editor=t.wrap("<div></div>").parent(),e.editor.width(r).height(i)):(e.editor=t,e.$ribbon=t.children(":eq(0)"),h=t.children(":eq(1)"),h.is("textarea")?(s.text&&h.val(s.text),e.sourceView=h):(s.text?p=s.text:p=h.html(),h.remove(),e.sourceView=n("<textarea></textarea>").val(p))),u=n("<div class='"+gr+"'></div>"),e.dialog=n("<div class ='"+mr+"'></div>"),e.subDialog=n("<div class ='"+mr+"'></div>"),e.editor.addClass(mr).addClass(e.options.wijCSS.widget).append(u).append(e.dialog).append(e.subDialog),e._createMenuMarkUp(e,s),e.$ribbon.wrap("<a href='javascript:void(null)'></a>").parent().appendTo("<div class='"+yr+" ui-widget-header ui-helper-clearfix ui-corner-top'></div>").parent().appendTo(u),a=n("<div class='"+br+"'></div>").appendTo(u),e.designView=n("<iframe frameborder='0'></iframe>"),e.designView.wrap("<div></div>").parent().appendTo(a),e.sourceView.wrap("<div></div>").parent().appendTo(a),l=[e.$ribbon],e.$modes=n(e._getRibbonModesMarkup()),s.showFooter&&(c=n("<div class='"+wr+" "+"ui-widget ui-widget-content ui-state-default'></div>"),u.append(c),c.append("<div class='"+Er+"'></div>"),e.$modes.appendTo(c),l.push(e.$modes)),n.each(l,function(t,n){n.wijribbon({click:function(t,n){e._ribbonCommand(n.commandName,n.name),e._trigger("commandButtonClick",t,n)}})})},t.prototype._createMenuMarkUp=function(e,t){t.customContextMenu&&!n.browser.webkit&&(e.contextMenu=n("<ul><li _c1buttoncmd='cut'><a>"+this.localizeString("contextMenuCut","Cut")+"</a></li>"+"<li _c1buttoncmd='copy'><a>"+this.localizeString("contextMenuCopy","Copy")+"</a></li>"+"<li _c1buttoncmd='paste'><a>"+this.localizeString("contextMenuPaste","Paste")+"</a></li></ul>"),n("<a href='#'></a>").append(e.contextMenu).appendTo(e.editor))},t.prototype._handleDisabledOption=function(e,t){var r=this;e?(r.disabledDiv||(r.disabledDiv=r._createDisabledDiv(t)),n("body").focus(),r.disabledDiv.appendTo(r.editor)):r.disabledDiv&&(r.disabledDiv.remove(),r.disabledDiv=null)},t.prototype._createDisabledDiv=function(e){var t=this,r=e?e:t.element,i=r.outerWidth(),s=r.outerHeight();return n("<div></div>").addClass("ui-state-disabled").css({"z-index":"99999",position:"relative","background-color":"lightgray",width:i,height:s,left:0,top:-s})},t.prototype._initElements=function(){var e=this,t=e.options,n=e.element.height()-e._getHeader().outerHeight(!0)-e._getFooter().outerHeight(!0),r={};e._getContent().height(n).wijsplitter({showExpander:!1,orientation:"horizontal",panel1:{scrollBars:"none",collapsed:!1},panel2:{scrollBars:"none",collapsed:!0}}),e.sourceView.css("width","").css("height",""),e._addHandlerToDesignView(),e._addDefaultFontStyleToDesignView(),e._createWijMenu(),(!t.showPathSelector||e.options.mode==="bbcode")&&e._getPathSelector().hide(),e._ribbonCommand(t.editorMode),t.fullScreenMode&&e._setFullScreen(t.fullScreenMode),r[wt]=!0,r[bt]=!0,e.$ribbon.wijribbon(w,r),e._handleWinDocumentKeyDown()},t.prototype._handleWinDocumentKeyDown=function(){var e=this;n(document).keydown(function(t){if(e.options.disabled)return;switch(t.keyCode){case 27:e._escActionAssociated()}})},t.prototype._setOption=function(e,t){var r=this,i=r.options,s=i.mode,o=r.$ribbon.parent(),u=i.customContextMenu;n.Widget.prototype._setOption.apply(r,arguments);if(e==="fullScreenMode")i.fullScreenMode=t,r._setFullScreen(t);else if(e==="showPathSelector")i.showPathSelector=t,t?r._getPathSelector().show():r._getPathSelector().hide();else if(e==="editorMode")i.editorMode=t,r._ribbonCommand(t);else if(e==="fullScreenContainerSelector")i.fullScreenContainerSelector=t,r.options.fullScreenMode&&r._setFullScreen(!0);else if(e==="disabled")r._handleDisabledOption(t,r.editor);else if(e==="showFooter")t?n("."+wr).is(":visible")||n("."+wr).show():n("."+wr).is(":visible")&&n("."+wr).hide();else if(e==="commandButtonClick")i.commandButtonClick=t;else if(e==="text")i.text=t,r.setText(t);else if(e==="customContextMenu"){if(u===t)return;t?(r.contextMenu||r._createMenuMarkUp(r,i),r._createWijMenu()):(r.contextMenu[r._contextMenuWidgetName()]("destroy").remove(),r.contextMenu=undefined)}else e==="mode"&&t!==s&&(r.$ribbon.wijribbon("destroy"),r.$ribbon.remove(),t==="ribbon"?r.$ribbon=n(r._getDefaultRibbonMarkup()):t==="bbcode"?r.$ribbon=n(r._getSimpleToolBar(xs)):r.$ribbon=n(r._getSimpleToolBar(Ss)),o.append(r.$ribbon),r.$ribbon.wijribbon({click:function(e,t){r._ribbonCommand(t.commandName,t.name),r._trigger("commandButtonClick",e,t)}}),r._ribbonCommand(i.editorMode))},t.prototype._getHeader=function(){return n("."+yr,this.editor)},t.prototype._getContent=function(){return n("."+br,this.editor)},t.prototype._getFooter=function(){return n("."+wr,this.editor)},t.prototype._getPathSelector=function(){return n("."+Er,this.editor)},t.prototype._getModes=function(){return n("."+lr,this.editor)},t.prototype._getDesignView=function(){return this.designView},t.prototype._getDesignViewWindow=function(){var e=this.designView;return e&&e.length>0?e[0].contentWindow:null},t.prototype._getDesignViewDocument=function(){var e=this._getDesignViewWindow();return e?e.document:null},t.prototype._getDesignViewText=function(){var e=this._getDesignViewDocument();return e&&e.body&&e.body.innerHTML?e.body.innerHTML:""},t.prototype._setDesignViewText=function(e){var t=this,n=this._getDesignViewDocument();this.options.mode==="bbcode"&&(e=t._convertBBCodeToHtml(e)),n&&n.body&&(n.body.innerHTML=e),t.options.text=e},t.prototype._getDialog=function(){return this.dialog},t.prototype._getSubDialog=function(){return this.subDialog},t.prototype._initContentDocument=function(){var e=this,t=e.sourceView.val(),r=e._getDesignViewDocument();e.options.mode==="bbcode"&&(t=e._convertBBCodeToHtml(n.trim(t))),r.open(),r.write('<html style="width:100%;height:100%;'+(e.options.enabled?"cursor:text;":"")+'"><head><title></title><style id="__wijStyle" '+' type="text/css" >table,td,tr{border: 1px #acacac dashed;}'+"</style></head><body>"+t+"</body></html>"),r.close(),d||n("#__wijStyle",r).prop("disabled",!d),e.element.attr("accesskey")&&(n(r.body).attr("accesskey",e.element.attr("accesskey")),e.element.removeAttr("accesskey")),m=[],m.push(t),v=0},t.prototype._addHandlerToDesignView=function(){var e=this,t=e._getDesignViewWindow(),n=t.document;e._initContentDocument(),e._loadDesignView()},t.prototype._loadDesignView=function(){var e=this,t=e._getDesignViewWindow(),r=t.document;n.browser.mozilla?setTimeout(e._setDesignModeForFF,1e3,e):e._setContentEditable(r,!0),n.browser.msie&&e._setContentSpellCheck(r,!1),e.sourceView.bind("blur."+e.widgetName,function(t){e._onSourceViewBlur()}),e.sourceView.bind("keyup."+e.widgetName,function(t){e._onSourceViewBlur()}),n.browser.mozilla?n(r).bind("blur."+e.widgetName,function(t){e._onDesignViewBlur(t)}):n(t).blur(function(t){e._onDesignViewBlur(t)}),n(r).bind("mouseup."+e.widgetName,function(t){e._onDesignViewMouseUp(t)}).bind("keydown."+e.widgetName,function(t){e._onDesignViewKeyDown(t)}).bind("keyup."+e.widgetName,function(t){e._onDesignViewKeyUp(t),e._onDesignViewBlur(t)})},t.prototype._addDefaultFontStyleToDesignView=function(){var e=this,t=e.options,r=e._getDesignViewDocument(),i=t.defaultFontName,s=t.defaultFontSize,o='<style type="text/css"> body {';if(!(i!==""&&i!==null||s!==""&&s!==null))return;i!==""&&i!==null&&(o+="font-family: "+i+";"),t.defaultFontSize!==""&&t.defaultFontSize!==null&&(o+=" font-size: "+s+";"),o+="}</style>",window.setTimeout(function(){n(o).appendTo(n("head",r))},200),e._setFontStyleButtonState(i,zt),e._setFontStyleButtonState(s,Wt)},t.prototype._setFontStyleButtonState=function(e,t){var r="";if(!e||e===null)return;n.each(this.$ribbon.wijribbon("getDropdownList",t),function(t,n){if(n.toUpperCase()===e.toUpperCase())return r=t,!1}),this.$ribbon.wijribbon(E,r,!0,t)},t.prototype._setDesignModeForFF=function(e){var t=e._getDesignViewDocument();t&&(t.designMode="on")},t.prototype.destroy=function(){var e=this;e.element.html(e._oriContent),e.element.removeAttr("tabindex"),e._oriStyle===undefined?e.element.removeAttr("style"):e.element.attr("style",e._oriStyle),e.element.insertBefore(e.editor),e.element.unbind("."+e.widgetName),e.editor.remove(),n.Widget.prototype.destroy.call(e)},t.prototype.showEditorDialog=function(e){switch(e){case ht:case st:case Pt:case Mt:case Ot:case Lt:case kt:case St:case Ht:case G:case Y:case Vt:this._ribbonCommand(e);break;default:i("Cannot find the dialog with command name '"+e+"'!")}},t.prototype.executeEditorAction=function(e,t){this._ribbonCommand(e,t)},t.prototype._isFontSizeCustomized=function(){if(h!==null)return h;var e=this.$ribbon.wijribbon("getDropdownList",Wt),t=[Bt,jt,Ft,It,qt,Rt,Ut];return h=!1,n.each(e,function(e,r){if(n.inArray(e,t)===-1)return h=!0,!1}),h},t.prototype._fontSizeCommand=function(e){var t=this,r=t._getDesignViewDocument(),i,s=4,o="font-size",a=[];t._getDesignViewWindow().getSelection&&(i=t._getDesignViewWindow().getSelection());switch(e){case Bt:s=1;break;case jt:s=2;break;case Ft:s=3;break;case It:s=4;break;case qt:s=5;break;case Rt:s=6;break;case Ut:s=7}t._isFontSizeCustomized()?n.browser.msie?t._formatFontSpan(r,o,e):(r.execCommand("FontSize",!1,s),n.each(n("font[size]",r),function(r,i){a.push(t._replaceFontWithSpan(n(i),"size",o,e))}),t._setSelection(a)):n.browser.msie&&u(n.browser.version)>=9?i&&i.rangeCount>0&&r.execCommand("FontSize",!1,s):r.execCommand("FontSize",!1,s),t.options.mode==="bbcode"&&!n.browser.msie&&t._convertFontStyleToStandTag(),t._addtoUndoBuffer()},t.prototype._fontNameCommand=function(e){var t=this,r=t._getDesignViewDocument(),i,s=t.$ribbon.wijribbon("getDropdownList",zt),o;t._getDesignViewWindow().getSelection&&(i=t._getDesignViewWindow().getSelection()),n.each(s,function(t,n){if(e===t)return o=n,!1}),n.browser.msie&&u(n.browser.version)>=9?i&&i.rangeCount>0&&r.execCommand("FontName",!1,o):r.execCommand("FontName",!1,o),t._isFontSizeCustomized()&&n.browser.msie&&t._formatFontSpan(r,"font-family",o),t._addtoUndoBuffer()},t.prototype._formatFontSpan=function(e,t,r){var i=this,s=r,o="fontFamily",u=[];t!=="font-family"&&(s="c1-temp",o="fontSize"),e.execCommand("FontName",!1,s),n.each(n("font[face='"+s+"']",e),function(e,s){var a=i._replaceFontWithSpan(n(s),"face",t,r),f,l;u.push(a),f=n("span."+ms,a);for(l=f.length-1;l>=0;l--)i._removeSpecifiedStyleSpan(n(f[l]),o,t);n.each(a,function(e,r){n.each(n(r).parents("span."+ms),function(e,s){var u=n(s);if(u.children().length>1)return!1;u.text()===n(r).text()&&i._removeSpecifiedStyleSpan(u,o,t)})})}),i._setSelection(u)},t.prototype._setSelection=function(e,t,r){var i=this._getDesignViewWindow(),s=i.document,o,u,a,f,l=0;try{n.browser.msie?(o=s.selection.createRange(),e?(n.each(e,function(e,t){l+=t.text().length}),o.moveToElementText(e[0][0]),o.collapse(!0),o.moveEnd("character",l)):(o.moveStart("textedit",-1),o.collapse(!0),o.moveStart("character",t),o.moveEnd("character",r)),o.select()):(f=i.getSelection(),o=s.createRange(),u=e[0][0],a=e[e.length-1][0],o.setStart(u,0),o.setEnd(a,a.childNodes.length),f.removeAllRanges(),f.addRange(o))}catch(c){}},t.prototype._replaceFontWithSpan=function(e,t,n,r){e.wrap("<span class = '"+ms+"' style='"+n+":"+r+"'></span>");var i=e.parent();return e.removeAttr(t),/<font\s*>/ig.test(i.html())&&(i.html(e.html()),e.remove()),i},t.prototype._removeSpecifiedStyleSpan=function(e,t,r){var i,s=!0;e[0].style[t]!==""&&e.css(r,""),i=e.attr("style"),i&&n.each(i.split(";"),function(e,t){var i=n.trim(t).toLowerCase();if(i!==""&&i.indexOf(r)!==-1)return s=!1,!1}),s&&e.replaceWith(e.html())},t.prototype._removeFormat=function(){var e=this,t=e._getDesignViewDocument(),r={};t.execCommand(ot,!1,null),e._isFontSizeCustomized()&&n.browser.msie&&e._removeFormatForIE(t),e._addtoUndoBuffer(),r[Z]=!1,r[et]=!1,r[tt]=!1,r[nt]=!1,r[rt]=!1,r[it]=!1,r[$]=!1,r[J]=!1,r[U]=!1,r[z]=!1,r[W]=!1,r[X]=!1,e.$ribbon.wijribbon(S,r)},t.prototype._removeFormatForIE=function(e){var t=e.selection.createRange(),r=t.htmlText,i=t.text,s=0,o=n(t.parentElement()),u=n(e.body),a="",f="",l="__c1temp",c="c1-temp",h="<span class='"+c+"'>"+l+"</span>",p,d,v,m,g,y;o.addClass("c1-app-parent"),t.pasteHTML(h),s=u.text().indexOf(l),p=n("span."+c,e),d=p,p.parentsUntil("body").each(function(e){if(n(this).is(".c1-app-parent"))return!1;d=n(this)}),p.html(r),v=n("span."+ms,p);for(g=v.length-1;g>=0;g--)m=n(v[g]),m.replaceWith(m.html());d.is("."+c)||d.after(p),n.each(d.parents("span."+ms),function(e,t){a+="</span>",f="<span class='"+ms+"' style = '"+n(t).attr("style")+"'>"+f}),r=p.html(),p.replaceWith(l),y=u.html().split(l),u.html(y[0]+a+r+f+y[1]),v=n("span."+ms,e);for(g=v.length-1;g>=0;g--)m=n(v[g]),m.text()===""&&m.replaceWith(m.html());n(".c1-app-parent",e).removeClass("c1-app-parent"),this._setSelection(null,s,i.length)},t.prototype._toggleFullScreen=function(){var e=this,t=e.options;t.fullScreenMode=!t.fullScreenMode,e._setFullScreen(t.fullScreenMode)},t.prototype._setFullScreen=function(e){var t=this,r=1,i=t._getHeader(),o=t._getFooter(),c=t._getContent(),h=t.options.fullScreenContainerSelector,p=n(h),d=t._getDesignViewText(),v,m,g;e?(p.length===0&&(p=n(s),h="body",t._oriDocOverFlow=n(document.documentElement).css("overflow"),n(document.documentElement).css({overflow:"hidden"}),n.browser.mozilla||window.scrollTo(0,0),n(s).bind("resize.wijeditor",function(){t._fullscreenOnWindowResize()})),v=p.width(),m=p.height()-2*r,a=t.editor.width(),f=t.editor.height(),l||(l=t.editor.parent()),t._replacedDiv||(t._replacedDiv=n("<div />")),t.editor.after(t._replacedDiv),n(h).append(t.editor),t.editor.css({width:v,height:m,position:""}).addClass(Sr),t.$ribbon.wijribbon("updateRibbonSize")):(t._replacedDiv.after(t.editor).remove(),t.editor.css({width:a,height:f,position:"static"}).removeClass(Sr),t.options.fullScreenContainerSelector||n(document.documentElement).css({overflow:t._oriDocOverFlow}),n(s).unbind("resize.wijeditor"),t.$ribbon.wijribbon("updateRibbonSize")),g=t.editor.height()-i.outerHeight(!0)-o.outerHeight(!0),c.height(g).wijsplitter("refresh"),t._addHandlerToDesignView(),t._addDefaultFontStyleToDesignView(),t._createWijMenu(),n.browser.msie&&window.setTimeout(function(){t.options.mode==="bbcode"&&(d=t._convertHtmlToBBCode(n.trim(d))),t._setDesignViewText(d),u(n.browser.version)>=9&&t.sourceView.val(d)},40)},t.prototype._createWijMenu=function(){var e=this,t=e._getDesignViewDocument();e.contextMenu&&e.contextMenu[e._contextMenuWidgetName()]({orientation:"vertical",trigger:e.designView,triggerEvent:"rtclick",showing:function(r,i){n.browser.msie&&(g=t.selection.createRange());var s=e.designView.offset(),o=n(n(e.designView)[0].contentWindow).scrollLeft(),u=n(n(e.designView)[0].contentWindow).scrollTop(),a=s.left+2-o,f=s.top-u;i.options.position={my:"left+"+a+" "+"top+"+f,at:"right top",of:r,collision:"none none"}},animation:{animated:"fade"},select:function(t,n){e._setIESelection(),e._contextMenuItemClick(t,n),e.contextMenu[e._contextMenuWidgetName()]("deactivate")}})},t.prototype._fullscreenOnWindowResize=function(){var e=this,t=e._getHeader(),r=e._getFooter(),i=e._getContent(),s,o=n(window).width(),u=n(window).height();e.editor.css({width:o,height:u}),s=e.editor.height()-t.height()-r.height(),i.height(s).wijsplitter("refresh")},t.prototype._saveText=function(e){},t.prototype._doSpellCheck=function(){},t.prototype._ribbonCommand=function(e,t){var r=this,i=r._getDesignViewDocument(),s=r._getContent(),o,u,a;if(t===zt){r._fontNameCommand(e),r._onDesignViewBlur(null);return}if(t===Wt){r._fontSizeCommand(e),r._onDesignViewBlur(null);return}r.editor.hasClass("ui-helper-hidden-accessible")||r._setIEFocus();switch(e){case Xt:n.browser.msie?(i.execCommand("FormatBlock",!1,"<ADDRESS>"),a=i.selection.createRange(),a=n(a.parentElement()).closest("address"),a.length&&(a.replaceWith("<blockquote>"+a.html()+"</blockquote>"),i.body.innerHTML=i.body.innerHTML.replace(/<BLOCKQUOTE>\s*?<BLOCKQUOTE>/gi,"<BLOCKQUOTE>"),i.body.innerHTML=i.body.innerHTML.replace(/<\/BLOCKQUOTE>\s*?<\/BLOCKQUOTE>/gi,"</BLOCKQUOTE>"),i.body.innerHTML=i.body.innerHTML.replace(/<BLOCKQUOTE>\s*?<\/BLOCKQUOTE>/gi,""))):i.execCommand("FormatBlock",!1,"<BLOCKQUOTE>"),r._addtoUndoBuffer(),r._setFocusNotIE();break;case x:o=r._generateUniqueName("form"),r.insertHTML('<form id="'+o+'" name="'+o+'" method="post">'+o+"</form>"),r._setFocusNotIE();break;case T:o=r._generateUniqueName("image"),r.insertHTML('<input id="'+o+'" name="'+o+'" type="image"'+' value="'+o+'"/>'),r._setFocusNotIE();break;case N:o=r._generateUniqueName("textarea"),r.insertHTML('<textarea id="'+o+'" name="'+o+'" rows="4" cols="48"></textarea>'),r._setFocusNotIE();break;case C:o=r._generateUniqueName("button"),r.insertHTML('<input id="'+o+'" name="'+o+'" type="button"'+' value="'+o+'"/>'),r._setFocusNotIE();break;case k:o=r._generateUniqueName("textbox"),r.insertHTML('<input id="'+o+'" name="'+o+'" type="text"'+' value="'+o+'"/>'),r._setFocusNotIE();break;case L:o=r._generateUniqueName("list"),r.insertHTML('<select id="'+o+'" name="'+o+'" style="width: 120px" size="8"></select>'),r._setFocusNotIE();break;case A:o=r._generateUniqueName("password"),r.insertHTML('<input id="'+o+'" name="'+o+'" type="password" value="'+o+'"/>'),r._setFocusNotIE();break;case O:o=r._generateUniqueName("dropdown"),r.insertHTML('<select id="'+o+'" name="'+o+'"></select>'),r._setFocusNotIE();break;case M:o=r._generateUniqueName("hidden"),r.insertHTML('<input id="'+o+'" name="'+o+'" type="hidden" value="'+o+'" />'),r._setFocusNotIE();break;case _:o=r._generateUniqueName("radiobox"),r.insertHTML('<input id="'+o+'" name="'+o+'" type="radio"'+' value="'+o+'">'+'<label for="'+o+'">'+o+"</label></input>"),r._setFocusNotIE();break;case D:o=r._generateUniqueName("checkbox"),r.insertHTML('<input id="'+o+'" name="'+o+'" type="checkbox"'+' value="'+o+'">'+'<label for="'+o+'">'+o+"</label></input>"),r._setFocusNotIE();break;case P:case H:case B:case j:case F:case I:case q:case R:r._tableAction(e);break;case V:r._toggleTableBorders();break;case rt:try{i.queryCommandState(it)&&(i.execCommand(it,!1,null),r.$ribbon.wijribbon(E,it,!1))}catch(f){}i.execCommand(rt,!1,null),r._addtoUndoBuffer(),r._setFocusNotIE();break;case it:try{i.queryCommandState(rt)&&(i.execCommand(rt,!1,null),r.$ribbon.wijribbon(E,rt,!1))}catch(l){}i.execCommand(it,!1,null),r._addtoUndoBuffer(),r._setFocusNotIE();break;case ot:r._removeFormat(),r._setFocusNotIE();break;case ut:r.insertHTML("<br/>"),r._setFocusNotIE();break;case at:u=r._getSelectedContent();if(!u||u==="")u="&nbsp;";r.insertHTML("<p>"+u+"</p>"),r._setFocusNotIE();break;case ft:r.insertHTML('<div title="Print Page Break" style="font-size:1px;page-break-before:always;vertical-align:middle;height:1px;background-color:#c0c0c0">&nbsp;</div>'),r._setFocusNotIE();break;case yt:r._toggleFullScreen();break;case bt:r._undoAction(),r._setFocusNotIE();break;case wt:r._redoAction(),r._setFocusNotIE();break;case xt:r._execCut(),r._setFocusNotIE();break;case Tt:r._execCopy();break;case Nt:r._execPaste();break;case At:r.insertDateAndTime(),r._setFocusNotIE();break;case dt:r.$modes.data("wijmoWijribbon")&&r.$modes.wijribbon(b,gt,!0).wijribbon(E,dt,!0),r.$ribbon.wijribbon("option","disabled",!1),s.wijsplitter("option","panel2",{collapsed:!0});break;case vt:r.$modes.data("wijmoWijribbon")&&r.$modes.wijribbon(b,gt,!0).wijribbon(E,vt,!0),r.$ribbon.wijribbon("option","disabled",!1),s.wijsplitter("option",{panel1:{collapsed:!1},panel2:{collapsed:!1}});break;case mt:r.$modes.data("wijmoWijribbon")&&r.$modes.wijribbon(b,gt,!1).wijribbon(E,mt,!0),r.$ribbon.wijribbon("option","disabled",!0),s.wijsplitter("option","panel1",{collapsed:!0}),n.browser.msie&&r.sourceView.focus();break;case gt:s.wijsplitter("option","panel1").collapsed&&r._toggleWordWrap();break;case G:r._saveSelectionForIE(),r._createDialog(this.localizeString("backColorDialogTitle","Set BackColor"),r._getDialogRes_BackColor(),r.initBackColorDialog);break;case Y:r._saveSelectionForIE(),r._createDialog(this.localizeString("foreColorDialogTitle","Set ForeColor"),r._getDialogRes_ForeColor(),r.initForeColorDialog);break;case ht:r._saveSelectionForIE(),r._createDialog(this.localizeString("insertTableDialogTitle","Insert Table"),r._getDialogRes_Table(),r.initInsertTableDialog);break;case pt:r._getEditableTable()&&r._createDialog(this.localizeString("editTableDialogTitle","Edit Table"),r._getDialogRes_Table(),r.initEditTableDialog);break;case Et:r._createDialog(this.localizeString("previewDialogPreview","Preview"),r._getDialogRes_Preview(),r.initPreviewDialog);break;case St:r._createDialog(this.localizeString("cleanUpDialogTitle","Clean up source HTML document"),r._getDialogRes_CleanUp(),r.initCleanUpDialog);break;case kt:r._saveSelectionForIE(),r._createDialog(this.localizeString("mediaDialogTitle","Insert media"),r._getDialogRes_Media(),r.initMediaDialog);break;case Lt:r._saveSelectionForIE(),r._createDialog(this.localizeString("specialCharacterDialogTitle","Insert special character"),r._getDialogRes_SpecialCharacter(),r.initSpecialCharacterDialog);break;case Ot:r._createDialog(this.localizeString("findAndReplaceTitle","Find and replace"),r._getDialogRes_FindAndReplace(),r.initFindDialog);break;case Mt:y=r._getSelectedElement(),r._createDialog(this.localizeString("tagInspectorDialogTitle","Tag Inspector"),r._getDialogRes_TagInspector(),r.initTagInspectorDialog);break;case st:r._saveSelectionForIE(),r._createDialog(this.localizeString("templateDialogApplyTemplate","Apply Template"),r._getDialogRes_Template(),r.initTemplateDialog);break;case Pt:r._saveSelectionForIE(),r._createDialog(this.localizeString("imageEditorDialogImageBrowser","Image Browser"),r._getDialogRes_ImageBrowser(),r.initImageBrowserDialog);break;case Ht:r._saveSelectionForIE(),r._createDialog(this.localizeString("hyperLinkDialogInserthyperLink","Insert hyperLink"),r._getDialogRes_Link(),r.initHyperLinkDialog);break;case Vt:r._saveSelectionForIE(),r._createDialog("Insert Code",r._getDialogRes_Code(),r.initInsertCodeDialog);break;case U:case z:case W:case X:case K:case Q:case Z:case et:case nt:case $:case J:case tt:case lt:case Ct:i.execCommand(e,!1,null),r.options.mode==="bbcode"&&!n.browser.msie&&r._convertStyleToStandTag(),r._addtoUndoBuffer(),r._setFocusNotIE();break;case _t:r._saveText();break;case Dt:r._doSpellCheck()}r._onDesignViewBlur(null)},t.prototype._saveSelectionForIE=function(){var e=this._getDesignViewWindow(),t;n.browser.msie&&(t=e.document.selection,g=t.createRange())},t.prototype._createDialog=function(e,t,r){var i=this,s,o=i.dialog;o.html("").undelegate(i.widgetName).undelegate("."+i.widgetName).append(t),i.subDialog&&i.subDialog.html("").undelegate(i.widgetName).undelegate("."+i.widgetName),s={width:"auto",height:"auto",modal:!0,title:e,position:"center",resizable:!1,captionButtons:{pin:{visible:!1},refresh:{visible:!1},toggle:{visible:!1},minimize:{visible:!1},maximize:{visible:!1}}},o.data("wijmoWijdialog")?(o.wijdialog("reset"),o.wijdialog("option",{width:"auto",height:"auto",title:e})):n.browser.msie&&u(n.browser.version)===6?window.setTimeout(function(){o.wijdialog(s)},0):o.wijdialog(s),i._adjustDialogLayoutForIE7(),r&&r.call(i),o.wijdialog("open")},t.prototype._adjustDialogLayoutForIE7=function(){var e=this.dialog;n.browser.msie&&/^7\.[0-9]+/.test(n.browser.version)&&e.wijdialog("option","width",e.parent().width())},t.prototype._contextMenuItemClick=function(e,t,n){var r=this,i=t.item.element.attr("_c1buttoncmd");switch(i){case xt:r._execCut();break;case Tt:r._execCopy();break;case Nt:r.focus(),r._execPaste()}},t.prototype._execCut=function(){var e=this,t=e._getDesignViewDocument();n.browser.safari?i(this.localizeString("errorMessageCutError","This function is not supported in current browser.  Plesse use (Ctrl + X).")):n.browser.msie?(t.execCommand("Cut",!1,null),e._addtoUndoBuffer()):(e._execCopy(),e._deleteSelectionContent(),e._addtoUndoBuffer())},t.prototype._execCopy=function(){var e=this,t=e._getDesignViewDocument();n.browser.safari?i(this.localizeString("errorMessageCopyError","This function is not supported in current browser. Plesse use (Ctrl + C).")):n.browser.msie?(t.execCommand("Copy",!1,null),e._addtoUndoBuffer()):e._copyToClipboard(e._getSelectedContent())},t.prototype._execPaste=function(){var e=this,t,r=e._getDesignViewDocument();if(n.browser.safari)i(this.localizeString("errorMessagePasteError","This function is not supported in current browser. Plesse use (Ctrl + V)."));else if(n.browser.msie)r.execCommand("Paste",!1,null),e._addtoUndoBuffer();else try{t=e._copyFromClipboard(),t&&t!==""&&e.insertHTML(t)}catch(s){}},t.prototype._getFontSizeCollection=function(){return{"10px":Bt,"13px":jt,"16px":Ft,"18px":It,"24px":qt,"32px":Rt,"48px":Ut,1:Bt,2:jt,3:Ft,4:It,5:qt,6:Rt,7:Ut}},t.prototype._updateButtonStates=function(e){var t=this,r=t._getDesignViewDocument(),i,s,o={},u=[Z,et,tt,nt,rt,it,$,J,U,z,W,X],a,f=e.target,l=n(f);n.each(u,function(e,t){o[t]=r.queryCommandState(t)}),t.$ribbon.wijribbon(S,o),i=t._queryCommandValue(zt)||"",n.each(t.$ribbon.wijribbon("getDropdownList",zt),function(e,t){if(t.toUpperCase()===i.toUpperCase())return s=e,!1}),t.$ribbon.wijribbon(E,s,!0,zt),t._isFontSizeCustomized()?(l.is("span")?s=f.style.fontSize:s="",s===""&&(a=l.parents("span."+ms),n.each(a,function(e,t){s=t.style.fontSize;if(s&&s!=="")return!1})),s===""&&(s=l.css("font-size"))):(i=t._queryCommandValue(Wt)||"",i===""&&(i=l.css("font-size")),n.each(t._getFontSizeCollection(),function(e,t){if(e.toString()===i.toString())return s=t,!1})),t.$ribbon.wijribbon(E,s,!0,Wt)},t.prototype._queryCommandValue=function(e){var t=this._getDesignViewDocument();try{if(!t.queryCommandEnabled(e))return null}catch(n){return null}try{return t.queryCommandValue(e)}catch(r){}return null},t.prototype._escActionAssociated=function(){var e=this,t=e._getDesignViewWindow();t.document.selection!==undefined&&t.document.selection.empty(),t.getSelection!==undefined&&t.getSelection().removeAllRanges(),e._hideAllDropdownsMenus()},t.prototype._hideAllDropdownsMenus=function(){var e=this;e.contextMenu&&e.contextMenu[e._contextMenuWidgetName()]("hideAllMenus"),e.$ribbon.wijribbon("hideDropdown",zt).wijribbon("hideDropdown",Wt).wijribbon("hideDropdown",ct)},t.prototype._onDesignViewKeyDown=function(e){var t=this,n;t._setSaveBtnEnabled();try{if(e.ctrlKey)n=String.fromCharCode(e.keyCode).toLowerCase();else switch(e.keyCode){case 27:t._escActionAssociated();break;case 13:case 46:t._addtoUndoBuffer(),t._continueSavingInputTextForUndo=!1;break;default:t._continueSavingInputTextForUndo=!0}}catch(r){}},t.prototype._onDesignViewKeyUp=function(e){var t=this,r;if(e.keyCode===37||e.keyCode===38||e.keyCode===39||e.keyCode===40||e.keyCode===33||e.keyCode===34||e.keyCode===35||e.keyCode===36)n.browser.msie&&n.browser.version==="6.0"?(t._keyTimeoutHandlerIE6&&(clearTimeout(t._keyTimeoutHandlerIE6),t._keyTimeoutHandlerIE6=null),t._keyTimeoutHandlerIE6=window.setTimeout(function(){t._updateButtonStates(e)},300)):t._updateButtonStates(e);if(e.ctrlKey){r=String.fromCharCode(e.keyCode).toLowerCase();switch(r){case"y":t._redoAction(),e.preventDefault(),e.stopPropagation();break;case"z":t._undoAction(),e.preventDefault(),e.stopPropagation();break;case"x":case"v":t._addtoUndoBuffer(),t._continueSavingInputTextForUndo=!1}}},t.prototype._onDesignViewMouseUp=function(e){var t=this,r;if(e.button===2)return;t._updateButtonStates(e),t._refreshPathSelector(),t._hideAllDropdownsMenus(),n(document).mouseup();if(n.browser.msie){r=n(e.target).closest("a");if(e.ctrlKey&&r.length>0)try{r.focus(),s.open(r[0].href,"_blank")}catch(i){}}},t.prototype._onDesignViewBlur=function(e){var t=this,r=t.options,i;i=t._getDesignViewText(),t._onTextChange(e),r.mode==="bbcode"&&(i=t._convertHtmlToBBCode(n.trim(i))),t.sourceView.val(i),r.text=i},t.prototype._onTextChange=function(e){var t=this;t._continueSavingInputTextForUndo&&(t._addtoUndoBuffer(),t._continueSavingInputTextForUndo=!1),t._trigger("textChanged",e,{text:t.options.text})},t.prototype._onSourceViewBlur=function(){var e=this,t;t=e.sourceView.val(),e._setDesignViewText(t),e.options.text=t},t.prototype._convertBBCodeToHtml=function(e){return e?(e=e.replace(/</g,"&lt;"),e=e.replace(/>/g,"&gt;"),e=e.replace(/(?:\r\n|\n|\r)/g,"<br>"),e=e.replace(/\[EMAIL\]([\s\S]*?)\[\/EMAIL\]/gim,'<a href="mailto:$1">$1</a>'),e=e.replace(/\[EMAIL\=([^\]]+)]([\s\S]*?)\[\/EMAIL\]/gim,'<a href="mailto:$1">$2</a>'),e=e.replace(/\[URL\]([\s\S]*?)\[\/URL\]/gim,'<a href="$1">$1</a>'),e=e.replace(/\[URL\=([^\]]+)]([\s\S]*?)\[\/URL\]/gim,'<a href="$1">$2</a>'),e=e.replace(/\[B\]/gim,"<b>"),e=e.replace(/\[\/B\]/gim,"</b>"),e=e.replace(/\[I\]/gim,"<i>"),e=e.replace(/\[\/I\]/gim,"</i>"),e=e.replace(/\[S\]/gim,"<strike>"),e=e.replace(/\[\/S\]/gim,"</strike>"),e=e.replace(/\[U\]/gim,"<u>"),e=e.replace(/\[\/U\]/gim,"</u>"),e=e.replace(/\[IMG height=(.*?) width=(.*?)](.+?)\[\/IMG\]/gim,'<img height="$1" width = "$2" src="$3"/>'),e=e.replace(/\[BLOCK\]/gim,"<blockquote>"),e=e.replace(/\[\/BLOCK\]/gim,"</blockquote>"),e=e.replace(/\[LIST\=1\]\[\*\]([\s\S]*?)\[\/LIST\]/gim,"<ol><li>$1</li></ol>"),e=e.replace(/\[LIST\]\[\*\]([\s\S]*?)\[\/LIST\]/gim,"<ul><li>$1</li></ul>"),e=e.replace(/\[\*\]/gim,"</li><li>"),e=e.replace(/\[size=([^\]]*?)\]/gi,'<font size="$1">'),e=e.replace(/\[\/size\]/gim,"</font>"),e=e.replace(/\[color=([^\]]*?)\]/gi,'<font color="$1">'),e=e.replace(/\[\/color\]/gim,"</font>"),e):""},t.prototype._replaceComplexHtml=function(e){var t,r,i,s,o=n("<div/>").html(e);t=n("img",o),n.each(t,function(){i="[IMG height="+n(this).height()+" width="+n(this).width()+"]"+n(this).attr("src").toString()+"[/IMG]",n(this).replaceWith(i)}),r=n("font",o);for(s=r.length-1;s>=0;s--)n(r[s]).attr("color")&&n(n(r[s])).attr("size")?i="[Color="+n(n(r[s])).attr("color")+"]"+"[Size="+n(n(r[s])).attr("size")+"]"+n(n(r[s])).html()+"[/Size][/Color]":n(n(r[s])).attr("color")&&!n(n(r[s])).attr("size")?i="[Color="+n(n(r[s])).attr("color")+"] "+n(n(r[s])).html()+"[/Color]":n(n(r[s])).attr("size")&&!n(n(r[s])).attr("color")&&(i="[Size="+n(n(r[s])).attr("size")+"]"+n(n(r[s])).html()+"[/Size]"),n(n(r[s])).replaceWith(i);return o.html()},t.prototype._convertHtmlToBBCode=function(e){var t=this;if(e==="")return;return e=t._replaceComplexHtml(e),e=e.replace(/<br(?=[ \/>]).*?>/gim,"\r\n"),e=e.replace(/<a .*?href=(["'])(.+?)\1.*?>(.+?)<\/a>/gi,"[URL=$2]$3[/URL]"),e=e.replace(/<a .*?href=(["'])mailto:(.+?)\1.*?>(.+?)<\/a>/gi,"[EMAIL=$2]$3[/EMAIL]"),e=e.replace(/<(?:b|strong)>/gim,"[B]"),e=e.replace(/<\/(?:b|strong)>/gim,"[/B]"),e=e.replace(/<(?:i|em)>/gim,"[I]"),e=e.replace(/<\/(?:i|em)>/gim,"[/I]"),e=e.replace(/<(?:strike|s)>/gim,"[S]"),e=e.replace(/<\/(?:strike|s)>/gim,"[/S]"),e=e.replace(/<u>/gim,"[U]"),e=e.replace(/<\/u>/gim,"[/U]"),e=e.replace(/<blockquote.*?\>/gim,"[BLOCK]"),e=e.replace(/\s{0,}<\/blockquote>/gim,"[/BLOCK]"),e=e.replace(/(?:\r\n|\r|\n){0,1}<(?:ol)>[\s]*/gim,"[LIST=1]"),e=e.replace(/<\/(?:ol)>/gim,"[/LIST]"),e=e.replace(/(?:\r\n|\r|\n){0,1}\<(?:ul)>[\s]*/gim,"[LIST]"),e=e.replace(/<\/(?:ul)>/gim,"[/LIST]"),e=e.replace(/\s{0,}<li\s{0,1}.*?>([\s\S]*?)\n{0,}\s{0,}<\/li>/gim,"[*]$1"),e=e.replace(/&nbsp;/gi," "),e=e.replace(/(<[^>]+>)/gm,""),e},t.prototype._convertFontStyleToStandTag=function(){var e=this,t=e._getDesignViewDocument(),r=n(t.body),i,s,o=n("[style*='color: ']",r);o.length!==0&&(i=o,s="<font color='"+e._getWebColorFromRgb(o.css("color"))+"'></font>"),i&&n.each(i,function(e){n(this).is("span")?n(this).replaceWith(n(s).html(n(this).html())):n(this).is("font")&&n(this).attr("size")&&n(this).removeAttr("style").html(n(s).html())})},t.prototype._convertStyleToStandTag=function(){var e=this,t=e._getDesignViewDocument(),r=n(t.body),i,s,o,u=n("[style*='font-weight: bold;']",r),a=n("[style*='font-style: italic;']",r),f=n("[style*='text-decoration: line-through;']",r),l=n("[style*='text-decoration: underline;']",r);u.length!==0?(i=u,s="<b></b>",o="font-weight"):a.length!==0?(i=a,s="<i></i>",o="font-style"):f.length!==0?(i=f,s="<strike></strikes>",o="text-decoration"):l.length!==0&&(i=l,s="<u></u>",o="text-decoration"),i&&n.each(i,function(e){n(this).is("span")&&this.style.fontSize===""?n(this).replaceWith(n(s).html(n(this).html())):n(this).removeAttr("style").html(n(s).html())})},t.prototype._getWebColorFromRgb=function(e){var t=this,n;return e.indexOf("rgb(")===0&&(n=e.substring(4,e.length-1).split(","),e=t._convertToWebColor(u(n[0]),u(n[1]),u(n[2]))),e},t.prototype._updateList=function(e,t){var r;n("option",t).remove();for(r in e)e[r]&&t.append("<option>"+r+"</option>")},t.prototype._triggerEvent=function(e,t){var n=this,r=n.options[e];return r&&typeof r=="function"?r.call(n,t):r},t.prototype._closeDialog=function(){this.dialog.wijdialog("close"),this.focus()},t.prototype._onTemplateList=function(e){return this._triggerEvent("templateList",e)},t.prototype.updateTemplateList=function(e,t){var r=this,i=t||n("select",r.dialog);r._updateList(e,i),r._templateList=e},t.prototype.initTemplateDialog=function(){var e=this,t=e.dialog,r=n("select",t),i=e._onTemplateList();t.delegate("select","change."+e.widgetName,function(){e.templateListOnChanged()}).delegate("."+ei,"click."+e.widgetName,function(){e.deleteTemplate()}).delegate("."+ti,"click."+e.widgetName,function(){e.saveTemplate()}).delegate(gs,"click."+e.widgetName,function(){e.applyTemplate()}).delegate(ys,"click."+e.widgetName,function(){e._closeDialog()});if(!i){i=e._templateList;if(!i)return}e.updateTemplateList(i,r)},t.prototype.templateListOnChanged=function(){var e=this,t=e.dialog,r=n("select",t).val(),i=n("iframe",t),s=e._templateList,o;if(!s)return;o=s[r],o.src&&i.attr("src",o.src+"?d="+(new Date).getMilliseconds().toString()),o.text&&i.length>0&&i[0].contentWindow.document.write(o.text),r&&(n("."+Jr,t).html(r),n("."+Gr,t).val(r)),o.desc&&(n("."+Kr,t).html(o.desc),n("."+Yr,t).val(o.desc))},t.prototype._onSaveTemplate=function(e){this._triggerEvent("saveTemplate",e)},t.prototype.saveTemplate=function(){var e=this,t=e.dialog,r=n("."+Gr,t).val(),s=n("."+Yr,t).val(),o=e._templateList,u=this._getDesignViewText();if(n.trim(r)===""){i(this.localizeString("errorMessageTemplateNameError","Please input a template name!"));return}o||(e._templateList=[],o=e._templateList),o[r]||n("select",t).append("<option>"+r+"</option>"),o[r]={desc:s,text:u},e._onSaveTemplate({name:r,desc:s,text:u})},t.prototype._onDeleteTemplate=function(e){this._triggerEvent("deleteTemplate",e)},t.prototype.deleteTemplate=function(){var e=this,t=e.dialog,r=n("select",t),s=r.val(),o=e._templateList;if(n.trim(s)===""){i(this.localizeString("errorMessageTemplateFileError","Please select a template file."));return}n("option:selected",r).remove(),n("iframe",t).attr("src","about:blank"),n("."+Jr,t).empty(),n("."+Gr,t).val(""),n("."+Kr,t).empty(),n("."+Yr,t).val(""),delete o[s],e._onDeleteTemplate(s)},t.prototype.applyTemplate=function(){var e=this,t=e.dialog,r=n("select",t),s=r.val(),o=n("iframe",t)[0],u=n("."+Gr,t).val(),a=o.contentWindow.document.body.innerHTML;if(n.trim(u)===""||n.trim(s)===""){i(this.localizeString("errorMessageValidTemplateFileError","Please select a valid template file."));return}e._setDesignViewText(a),e._addtoUndoBuffer(),e._setSaveBtnEnabled(),e._closeDialog()},t.prototype._onImageList=function(){var e=this,t=e.options.imageList;return t&&typeof t=="function"?t.call(e):t},t.prototype.updateImageList=function(e,t){var r=this,i=r.dialog,s=t||n("select",i),o=n("."+Mr,i);r._updateList(e,s),r._imgList=e;if(!e){o.addClass(Ir);return}o.removeClass(Ir)},t.prototype.initImageBrowserDialog=function(){var e=this,t=e.dialog,r=e._onImageList();n("img",t).hide(),t.delegate("select","change."+e.widgetName,function(){e.imageListOnChanged()}).delegate(gs,"click."+e.widgetName,function(t){e.submitInsertImageDialog(),e._onDesignViewBlur(t)}).delegate(ys,"click."+e.widgetName,function(){e._closeDialog()}),n("."+Pr+" input",t).bind("change."+e.widgetName,function(){e.imageUrlChanged(this)});if(!r){r=e._imgList;if(!r){n("."+Mr,t).addClass(Ir);return}}e.updateImageList(r,n("select",t))},t.prototype.imageUrlChanged=function(e){var t=this,r=t.dialog;n("img",this.dialog).attr("src",n(e).val()+"?"+(new Date).getTime()).show().bind("load",function(){n("."+Br+" input",r).val(n("img",r).width().toString()),n("."+jr+" input",r).val(n("img",r).height().toString())})},t.prototype.imageListOnChanged=function(){var e=this,t=e.dialog,r=n("select",t).val(),i=e._imgList,o;if(!i)return;o=i[r],n("img",t).prop("src",o).show(),n("."+Pr+" input",t).prop("value",o),s.setTimeout(function(){n("."+Br+" input",t).val(n("img",t).width().toString()),n("."+jr+" input",t).val(n("img",t).height().toString())},200)},t.prototype.submitInsertImageDialog=function(){var e=this,t,r=e.dialog,s=n("."+Pr+" input",r).val(),o=n("."+Hr+" input",r).val(),u=n("."+Br+" input",r).val(),a=n("."+jr+" input",r).val(),f=n("."+Fr+" input",r).val();if(n.trim(s)===""){i(this.localizeString("errorMessageSelectImageError","Please select a image."));return}if(!e._isNumeric(u)){i(this.localizeString("errorMessageImageWidthError","Please input a number for 'Image width' textbox."));return}if(!e._isNumeric(a)){i(this.localizeString("errorMessageImageHeightError","Please input a number for 'Image height' textbox."));return}e.focus(),n.browser.msie?(t='<img src="'+s+'" alt="'+o+'" style="width:'+u+"px;height:"+a+"px",e.options.mode!=="bbcode"&&f!==null&&f!==undefined&&f.length>0&&(t+=";"+f)):(t='<img src="'+s+'" alt="'+o+'" width="'+u+'" height="'+a,e.options.mode!=="bbcode"&&(t+='" style="'+f)),t+='"/>',e.insertHTML(t),e._closeDialog()},t.prototype.initHyperLinkDialog=function(){var e=this,t=e.dialog,r=e.getLinkHrefField(),i=n("."+hi,t),o,u,a,f=n("."+ri+" input",t);t.delegate(gs,"click."+e.widgetName,function(t){e.submitHyperLinkDialog(),e._onDesignViewBlur(t)}).delegate(ys,"click."+e.widgetName,function(){e._closeDialog()}).delegate("."+si,"change."+e.widgetName,function(){e.anchorListOnChanged(this)}).delegate("."+ii+">div","click."+e.widgetName,function(){e.radioListOnChanged()}).delegate("."+pi+">div","click."+e.widgetName,function(){e.linkIconTypeOnChanged()}).delegate("."+fi+" input","change."+e.widgetName,function(){e.tempImg=n('<img src="'+n("."+fi+" input",t).val()+'">').appendTo("body"),s.setTimeout(function(){n("."+li+" input",t).val(e.tempImg.width().toString()),n("."+ci+" input",t).val(e.tempImg.height().toString()),e.tempImg.remove(),e.tempImg=undefined},200)});try{f.val(r),u=e._getLinkInnerHTML()}catch(l){}a=n(u),u&&u.substring(0,3)==="<img"?o=!0:o=!1,o?(i.show(),n("."+oi+" input",t).hide(),n("."+fi+" input",t).val(a.attr("src")),n("."+li+" input",t).val(a.attr("width")),n("."+ci+" input",t).val(a.attr("heigth"))):(n("."+oi+" input",t).show(),i.hide(),n("."+oi+" input",t).val(u)),n("."+ai+" input",t).val(e._getLinkCssField()),n("."+ui+" select",t).val(e._getLinkTarget()),n("#radAnchor",t).attr("checked","checked"),n("#radLinkTypeIsText",t).attr("checked","checked"),r.length>6&&(r.substring(0,4)==="http"?n("#radUrl",t).attr("checked","checked"):r.substring(0,6)==="mailto"?n("#radMail",t).attr("checked","checked"):r.substring(0,1)==="#"?n("#radAnchor",t).attr("checked","checked"):n("#radFile",t).attr("checked","checked")),a=undefined},t.prototype._getLinkInnerHTML=function(){var e=this,t;e.focus(),t=e._getInspectElement();try{if(t&&t.tagName==="A")return t.innerHTML||""}catch(n){}return""},t.prototype.getLinkHrefField=function(){var e=this,t;e.focus(),t=e._getInspectElement();try{if(t&&t.tagName==="A")return e.fixAbsoluteUrlsIfNeeded(t.href||"")}catch(n){}return""},t.prototype._getLinkTarget=function(){var e=this,t;e.focus(),t=e._getInspectElement();try{if(t&&t.tagName==="A")return t.target||""}catch(n){}return""},t.prototype._getLinkCssField=function(){var e=this,t;e.focus(),t=e._getInspectElement();try{if(t&&t.tagName==="A")return t.style.cssText||""}catch(n){}return""},t.prototype.submitHyperLinkDialog=function(){var e=this,t=e.dialog,r=n("#radMail",t),s=n("."+ri+" input",t),o=n("."+oi+" input",t),u=n("."+ai+" input",t),a=n("."+ui+" select",t),f=s.val(),l=o.val(),c=a.val(),h=n("#radLinkTypeIsImage",t),p=h.prop("checked"),d=n("."+fi+" input",t).val(),v=n("."+li+" input",t).val(),m=n("."+ci+" input",t).val(),g=u.val();if(f===""){i(this.localizeString("errorMessageAddressError","Please input address!"));return}if(l===""&&!p){i(this.localizeString("errorMessageDisplayTextError","Please input display text!"));return}if(d===""&&p){i(this.localizeString("errorMessageHyperLinkImageUrlError","Please input image url!"));return}if(!e._isNumeric(v)&&p){i(this.localizeString("errorMessageHyperLinkImageWidthError","Please input correct image width!"));return}if(!e._isNumeric(m)&&p){i(this.localizeString("errorMessageHyperLinkImageHeightError","Please input correct image height!"));return}if(r.attr("checked")&&!e._isEmail(f)){i(this.localizeString("errorMessageHyperLinkEmail","Please input correct email!"));return}p&&(l='<img src="'+d+'" width="'+v+'" height="'+m,l+='"/>'),e._editLink(l,f,g,c),e._closeDialog()},t.prototype._editLink=function(e,t,n,r){var i=this,s,o="";i.focus(),s=i._getInspectElement();try{if(s&&s.tagName==="A"){s.innerHTML=e,s.href=t,s.target=r,n!==s.style.cssText&&(s.style.cssText=n),i._addtoUndoBuffer(),i._setSaveBtnEnabled();return}}catch(u){}o='<a href="'+t+'" target="'+r+'"',n!==""&&(o+=' style="'+n+'"'),o+=">"+e+"</a>",i._setIESelection(),i.insertHTML(o)},t.prototype.anchorListOnChanged=function(e){var t=this,r=t.dialog,i=n(e).val();i!==""&&(n("."+ri+" input",r).val(i),n("#radAnchor",r).attr("checked","checked"))},t.prototype.radioListOnChanged=function(){var e=this,t=e.dialog,r=n("."+si,t),i=n("."+ri+" input",t);i.val(""),n("#radUrl",t).is(":checked")?r.hide():n("#radAnchor",t).is(":checked")?r.show():n("#radMail",t).is(":checked")?(r.hide(),i.val("mailto:")):n("#radFile",t).is(":checked")&&r.hide()},t.prototype.linkIconTypeOnChanged=function(){var e=this,t=e.dialog,r=n("."+hi,t),i=n("."+oi,t);n("#radLinkTypeIsText",t).is(":checked")?(i.show(),r.hide()):n("#radLinkTypeIsImage",t).is(":checked")&&(i.hide(),r.show())},t.prototype._getDialogRes_Code=function(){var e=this,t=e._createDiv(ni);return t.add(e._createElement("div","Enter source code",{"class":mi})),t.add(e._createElement("textarea","",{"class":vi})),t.add(e._createSeparator()),t.add(e._createOKCancelButtons()),t.render()},t.prototype.initInsertCodeDialog=function(){var e=this,t=e.dialog;t.delegate(gs,"click."+e.widgetName,function(t){e.submitCodeDialog(),e._onDesignViewBlur(t)}).delegate(ys,"click."+e.widgetName,function(){e._closeDialog()})},t.prototype.submitCodeDialog=function(){var e=this,t=e.dialog,r=n("."+vi,t),i=r.val();if(i==="")return;i=i.replace(/</g,"&lt;"),i=i.replace(/>/g,"&gt;"),i="<pre>"+i+"</pre>",e._setIESelection(),e.insertHTML(i),e._closeDialog()},t.prototype.initTagInspectorDialog=function(){var e=this,t=e.dialog,r=n("."+Ti);t.delegate(gs,"click."+e.widgetName,function(t){e.submitTagInspectorDialog(),e._onDesignViewBlur(t)}).delegate(ys,"click."+e.widgetName,function(){e._closeDialog()}).delegate("#displayNoEmpty","click."+e.widgetName,function(){e.tagInspectorDialogSwitchAttList(this)}),e._laySelectedElementAttributes(n("."+xi,t),n("."+wi,t)),n("."+Ni+" input",t).val(e._getSelectedElementStyle()),e._selectedElementCanHaveChildren()?(r.show(),n("textarea",r).val(e._getSelectedElementInnerHTML())):r.hide()},t.prototype.submitTagInspectorDialog=function(){var e=this,t=e.dialog,r=e._getInspectElement(),i=n("."+xi,t),s=n("."+Ni+" input").val(),o=n("."+Ti+" textarea").val();try{n.each(n("input:checkbox",i),function(e,t){var i,s,o=n(t);o.is(":checked")&&(i=o.siblings("span").text(),i=i.substring(0,i.length-1),s=o.siblings("input:text").val(),n(r).attr(i,s))}),n.trim(s)!==""&&(r.style.cssText=s),e._selectedElementCanHaveChildren()&&n(r).html(o)}catch(u){}e._closeDialog(),e._addtoUndoBuffer(),e._setSaveBtnEnabled()},t.prototype.tagInspectorDialogSwitchAttList=function(e){var t=n("."+xi,this.dialog),r=!e.checked;n.each(n("input:text",t),function(e,t){n(t).val()===""&&n(t).parent("li")[r?"show":"hide"]()})},t.prototype._laySelectedElementAttributes=function(e,t){var r=this,i=r._getInspectElement(),s,o,u,a=this.localizeString("tagInspectorDialogSave","Save"),f="";if(!i)return;t.html(i.tagName),s=r._getDictionaryDeclare(),o=i.tagName.toLowerCase(),u=s[o];switch(o){case"ul":case"u":case"textarea":case"tbody":case"tr":case"th":case"td":case"table":case"select":case"strong":case"span":case"p":case"option":case"ol":case"li":case"label":case"input":case"img":case"i":case"hr":case"form":case"font":case"em":case"div":case"code":case"button":case"body":case"b":case"a":f+="<ul class='ui-helper-reset'>",n.each(u,function(e,t){var n=i.getAttribute(t)||"";f+="<li><span class='"+kr+"'>",f+=t+":</span>",f+="<input type='text' value='"+n+"'/>",f+="<input type='checkbox' id='save"+e+"'/>",f+="<label for='save"+e+"'>"+a+"</label></li>"})}e.html(f)},t.prototype._getSelectedElementStyle=function(){var e=this._getInspectElement();return e&&e.style?e.style.cssText||"":""},t.prototype._getSelectedElementInnerHTML=function(){var e=this._getInspectElement();return e?e.innerHTML:""},t.prototype._selectedElementCanHaveChildren=function(){return!n(this._getInspectElement()).is("input,hr,br,img")},t.prototype.initBackColorDialog=function(){this._initColorDialog("BackColor")},t.prototype.initForeColorDialog=function(){this._initColorDialog("ForeColor")},t.prototype._initColorDialog=function(e){var t=this,r=t.dialog,i=t._getDesignViewDocument(),s=i.queryCommandValue(e),o,a,f;r.delegate(gs,"click."+t.widgetName,function(n){t.submitColorDialog(e),t._onDesignViewBlur(n)}).delegate(ys,"click."+t.widgetName,function(){t._closeDialog()}),s&&(f=s.toString(),n.browser.mozilla&&f==="transparent"&&(f="#ffffff"),n.browser.msie&&(o=u(f),f="rgb("+(o&255)+", "+((o&65280)>>8)+", "+((o&16711680)>>16)+")"),f.indexOf("rgb(")===0?(a=f.substring(4,f.length-1).split(","),f=t._convertToWebColor(u(a[0]),u(a[1]),u(a[2]))):f.indexOf("rgba(")===0&&(a=f.substring(5,f.length-1).split(","),f=t._convertToWebColor(u(a[0]),u(a[1]),u(a[2]))),n("."+Li+" input",r).attr("value",f)),n("."+ki,r).wijeditorcolorcanvas("."+Li+" input",f)},t.prototype.submitColorDialog=function(e){var t=this,r=n("."+Li+" input",t.dialog);t.setColor(e,r.val()),t._closeDialog()},t.prototype.setColor=function(e,t){var r=this,i=r._getDesignViewDocument(),s=r._getDesignViewWindow(),o;r._setIESelection(),n.browser.mozilla&&e==="BackColor"?(o=s.getSelection(),r.insertHTML('<span style="background-color:'+t+';">'+o+"</span>")):(i.execCommand(e,!1,t),r.options.mode==="bbcode"&&!n.browser.msie&&r._convertFontStyleToStandTag()),r._addtoUndoBuffer(),r._setSaveBtnEnabled()},t.prototype.initInsertTableDialog=function(){var e=this,t=e.dialog;t.delegate(gs,"click."+e.widgetName,function(t){e.submitInsertTableDialog(),e._onDesignViewBlur(t)}).delegate(ws,"click."+e.widgetName,function(){e._closeDialog()}).delegate("."+Fi+" input:button","click."+e.widgetName,function(){e.showTableColorDialog(this)})},t.prototype.submitInsertTableDialog=function(){var e=this,t=e._getValuesFromTableDialog();if(!t)return;e._insertTable(t),e._closeDialog()},t.prototype._insertTable=function(e){var t=this,r="",i,s;if(!e)return!1;t.focus(),r+='<table width="'+e.width+'" height="'+e.height+'" cellspacing="'+e.cspacing+'" cellpadding="'+e.cpadding+'" border="'+e.border+'" bgcolor="'+e.bgcolor+'" style="'+e.css+'">';for(i=0;i<e.rows;i++){r+="<tr>";for(s=0;s<e.cols;s++)r+="<td>Cell "+(i+1)+"-"+(s+1)+"</td>";r+="</tr>"}r+="</table>";if(n.browser.mozilla||n.browser.msie&&u(n.browser.version)>=9)r+="<br />";t.insertHTML(r)},t.prototype.initEditTableDialog=function(){var e=this,t=e.dialog,r=e._getInspectElement(),i,s;t.delegate(gs,"click."+e.widgetName,function(t){e.submitEditTableDialog(),e._onDesignViewBlur(t)}).delegate(ws,"click."+e.widgetName,function(){e._closeDialog()}).delegate("."+Fi+" input:button","click."+e.widgetName,function(){e.showTableColorDialog(this)});if(!r)return;try{i=r.rows,i.length>0?s=i[0].cells.length:s=0,i=i.length}catch(o){}n("."+Oi+" input",t).val(i),n("."+Mi+" input",t).val(s),n("."+_i+" input",t).val(r.getAttribute("width")),n("."+Di+" input",t).val(r.getAttribute("height")),n("."+Pi+" input",t).val(r.getAttribute("border")),n("."+Hi+" input",t).val(r.getAttribute("cellPadding")),n("."+Bi+" input",t).val(r.getAttribute("cellSpacing")),n("."+Fi+" input",t).val(r.getAttribute("bgcolor")||"#ffffff"),n("."+ji+" input",t).val(r.style.cssText)},t.prototype.submitEditTableDialog=function(){var e=this,t=e._getInspectElement(),r=n(t),i=e._getValuesFromTableDialog(),s=i&&u(i.rows),o=i&&u(i.cols),a,f;if(!i)return;if(t){r.attr("width",i.width),r.attr("height",i.height),r.attr("bgcolor",i.bgcolor),r.attr("border",i.border),r.attr("cellSpacing",i.cspacing),r.attr("cellPadding",i.cpadding),t.style.cssText=i.css;if(!s||isNaN(s))return;if(!o||isNaN(o))return;while(t.rows.length>s)t.deleteRow(0);while(t.rows.length<s){a=t.insertRow(0);while(a.cells.length<o)f=a.insertCell(0),f.innerHTML="&nbsp;"}n.each(t.rows,function(e,t){while(t.cells.length>o)t.deleteCell(0);while(t.cells.length<o)f=t.insertCell(0),f.innerHTML="&nbsp;"})}e._closeDialog()},t.prototype._getValuesFromTableDialog=function(){var e=this,t=e.dialog,r=n("."+Oi+" input",t).val(),s=n("."+Mi+" input",t).val(),o=n("."+_i+" input",t).val(),a=n("."+Di+" input",t).val(),f=n("."+Pi+" input",t).val(),l=n("."+Hi+" input",t).val(),c=n("."+Bi+" input",t).val(),h=n("."+ji+" input",t).val(),p=n("."+Fi+" input",t).val();return e._isNumeric(r)?e._isNumeric(s)?e._isNumeric(o)?e._isNumeric(a)?e._isNumeric(f)?e._isNumeric(l)?e._isNumeric(c)?{rows:r,cols:s,width:u(o),height:u(a),border:f,cpadding:l,cspacing:c,css:h,bgcolor:p}:(i(this.localizeString("tableDialogCellSpacingError","Please input a number for 'Cell Spacing' textbox.")),!1):(i(this.localizeString("tableDialogCellPaddingError","Please input a number for 'Cell Padding' textbox.")),!1):(i(this.localizeString("tableDialogBorderError","Please input a number for 'Border thickness' textbox.")),!1):(i(this.localizeString("errorMessageTableHeightError","Please input a number for 'Table Height' textbox.")),!1):(i(this.localizeString("errorMessageTableWidthError","Please input a number for 'Table Width ' textbox.")),!1):(i(this.localizeString("errorMessageColumnsError","Please input a number for 'Columns' textbox.")),!1):(i(this.localizeString("errorMessageRowsError","Please input a number for 'Rows' textbox.")),!1)},t.prototype.showTableColorDialog=function(e){var t=this,r,i=t.subDialog,s=n(e).prev().val(),o=t._getDialogRes_Color();r={width:"auto",height:"auto",modal:!0,title:"Set Background Color",position:"center",resizable:!1,captionButtons:{pin:{visible:!1},refresh:{visible:!1},toggle:{visible:!1},minimize:{visible:!1},maximize:{visible:!1}}},i.empty().append(o),n.browser.msie&&u(n.browser.version)===6?window.setTimeout(function(){i.wijdialog(r)},0):i.wijdialog(r),i.delegate(bs,"click."+t.widgetName,function(){t.submitTableColorDialog()}).delegate(ws,"click."+t.widgetName,function(){t.closeSubDialog()}),s!==""&&n("."+Li+" input",i).val(s),n("."+ki,i).wijeditorcolorcanvas("."+Li+" input",s),i.wijdialog("open")},t.prototype.submitTableColorDialog=function(){var e=this,t=e.subDialog,r=e.dialog,i=n("."+Li+" input",t).val();n("."+Fi+" input:text",r).val(i),e.closeSubDialog()},t.prototype.closeSubDialog=function(){this.subDialog.wijdialog("close")},t.prototype._getEditableTable=function(){var e=this,t,r,s;r=e._getSelectedElement();if(!r)return i(this.localizeString("errorMessageSelectTableError","Please select a table!")),!1;s=n(r);if(s.is("td,tr,tbody,th"))r=s.parents("table:first")[0];else if(!s.is("table")){t=s.find("table:only-child");if(!n.browser.msie||!t.length)return i(this.localizeString("errorMessageSelectTableError","Please select a table!")),!1;r=t[0]}return y=r,!0},t.prototype.initPreviewDialog=function(){var e=this,t=e.dialog;e._setPreviewContent(0),t.delegate("#rad640_480","click."+e.widgetName,function(){e._setPreviewDialogSize(640,480)}).delegate("#rad800_600","click."+e.widgetName,function(){e._setPreviewDialogSize(800,600)}).delegate("#rad1024_768","click."+e.widgetName,function(){e._setPreviewDialogSize(1024,768)}).delegate("#chkSplit","click."+e.widgetName,function(){e._splitPreviewPages(this.checked)}).delegate("."+Wi,"click."+e.widgetName,function(){e._printPreviewPage(!0)}).delegate("."+Xi,"click."+e.widgetName,function(){e._printPreviewPage(!1)}).delegate("."+Vi,"click."+e.widgetName,function(){e._closeDialog()}).delegate("."+Ui,"click."+e.widgetName,function(){e._navigatePreviewPage(!1)}).delegate("."+zi,"click."+e.widgetName,function(){e._navigatePreviewPage(!0)})},t.prototype._setPreviewContent=function(e){var t=this,r=t.dialog,i=n("iframe",r),s=n("."+Ri+" span",r),o=i[0].contentWindow.document;o.open(),e===-1?(o.write(t._getPreviewAllPageContent()),s.html("1 / 1")):(o.write(t._getPreviewPageContent(e)),s.html(e+1+" / "+t._getPreviewPageCount())),o.close()},t.prototype._setPreviewDialogSize=function(e,t){var r=this,i=r.dialog,s=n("iframe",i),o=i.wijdialog("option","width"),u=i.wijdialog("option","height");o==="auto"?o=i.parent(".wijmo-wijdialog").width()-s.width():o-=s.width(),u==="auto"?u=i.parent(".wijmo-wijdialog").height()-s.height():u-=s.height(),s.css("width",e).css("height",t),i.wijdialog("option",{width:e+o,height:t+u})},t.prototype._getPreviewPageCount=function(){return this._getPreviewPages().length},t.prototype._getPreviewPageContent=function(e){var t=this._getPreviewPages();return t.length>e?t[e]:null},t.prototype._getPreviewAllPageContent=function(){return this._getDesignViewText()},t.prototype._getPreviewPages=function(){var e=this._getPreviewAllPageContent(),t=new RegExp("<(DIV|div)[^>]*(page-break-before|PAGE-BREAK-BEFORE)[ ]*:[ ]*always[^>]*>(.*?)<\\/(DIV|div)>","g"),n=e.replace(t,"!-~U^n#i@q,P|.a=g~e+br!");return n.split("!-~U^n#i@q,P|.a=g~e+br!")},t.prototype._splitPreviewPages=function(e){var t=this,r=t.dialog,i=n("."+$i,r),s=n("."+Ri,r);e?(t._setPreviewContent(0),s.show(),i.hide()):(t._setPreviewContent(-1),s.hide(),i.show()),t._curPageIdx=0},t.prototype._navigatePreviewPage=function(e){var t=this,r=n("#chkSplit",t.dialog),i=t._curPageIdx,s=t._getPreviewPageCount();r.is(":checked")&&(e?(i++,i<s?t._setPreviewContent(i):i=s-1):(i--,i>=0?t._setPreviewContent(i):i=0),t._curPageIdx=i)},t.prototype._printPreviewPage=function(e){var t=this,r=t.dialog,i=n("#chkSplit",r),s=n("iframe",r)[0].contentWindow;e&&(i.removeAttr("checked"),t._setPreviewContent(-1)),s.focus(),s.print()},t.prototype.initCleanUpDialog=function(){var e=this,t=e.dialog;n("textarea",t).val(e.sourceView.val()),t.delegate(gs,"click."+e.widgetName,function(t){e.submitCleanUpDialog(),e._onDesignViewBlur(t)}).delegate(ys,"click."+e.widgetName,function(){e._closeDialog()})},t.prototype.submitCleanUpDialog=function(){var e=this,t=e.dialog,r=e.sourceView,i=r.val(),s;n("#replaceSpans",t).is(":checked")&&(s=new RegExp("<\\/?SPAN[^>]*>","g"),i=i.replace(s,"")),n("#replaceClass",t).is(":checked")&&(s=new RegExp("<(\\w[^>]*) class=([^ |>]*)([^>]*)","g"),i=i.replace(s,"<$1$3")),n("#replaceStyle",t).is(":checked")&&(s=new RegExp('<(\\w[^>]*) style="([^"]*)"([^>]*)',"g"),i=i.replace(s,"<$1$3"),s=new RegExp("<(\\w[^>]*) lang=([^ |>]*)([^>]*)","g"),i=i.replace(s,"<$1$3"),s=new RegExp("<\\\\?\\?xml[^>]*>","g"),i=i.replace(s,""),s=new RegExp("<\\/?\\w+:[^>]*>","g"),i=i.replace(s,"")),n("#replaceNbsp",t).is(":checked")&&(s=new RegExp("&nbsp;","g"),i=i.replace(s," ")),n("#transformPtoDiv",t).is(":checked")&&(s=new RegExp("(<P)([^>]*>.*?)(<\\/P>)","g"),i=i.replace(s,"<div$2</div>")),r.val(i),e._setDesignViewText(i),e._addtoUndoBuffer(),e._closeDialog()},t.prototype.initFindDialog=function(){var e=this,t=e.dialog;e.tRange&&(e.tRange=null),t.delegate(gs,"click."+e.widgetName,function(){e.submitFindAction()}).delegate(ys,"click."+e.widgetName,function(t){e.submitReplaceAction(),e._onDesignViewBlur(t)})},t.prototype.submitFindAction=function(){var e=this,t=n("textarea:first",e.dialog).val();if(n.trim(t)==="")return;e._findAndReplaceString(t)},t.prototype.submitReplaceAction=function(){var e=this,t=e.dialog,r=n("textarea:first",t).val(),s=n("textarea:last",t).val();if(n.trim(r)==="")return;if(n.trim(s)===""){i(this.localizeString("errorMessageReplaceStringError","please input replace string!"));return}e._findAndReplaceString(r,s)},t.prototype._findAndReplaceString=function(e,t){var r=this,s=r._getDesignViewWindow(),o=0,u=!1,a=t&&t!==e;t||(t=e);if(n.browser.msie)r.tRange&&(r.txtFoundInIE&&a?(o=r.tRange.findText(e),o&&(r.tRange.pasteHTML(t),r.tRange.collapse(!1),u=!0,r.txtFoundInIE=!1)):(r.tRange.collapse(!1),o=r.tRange.findText(e),o&&r.tRange.select())),!u&&(!r.tRange||!o)&&(r.tRange=s.document.body.createTextRange(),o=r.tRange.findText(e),o&&(r.tRange.select(),a&&(r.tRange.pasteHTML(t),u=!0)));else{if(r.txtFoundInNoneIE&&a)r._replaceSelectionForNoneIE(t),u=!0,r.txtFoundInNoneIE=!1;else{o=s.find(e);if(!o){o=s.find(e,0,1);while(s.find(e,0,1))continue}}r.txtFoundInNoneIE=r.txtFoundInNoneIE||o,r.txtFoundInNoneIE&&a&&(r._replaceSelectionForNoneIE(t),u=!0,r.txtFoundInNoneIE=!1)}!o&&!u?(i('"'+e+'"'+this.localizeString("errorMessageFindTextError"," String Not Found!")),r.tRange=null,r.txtFoundInNoneIE=!1,r.txtFoundInIE=!1):r.txtFoundInIE=!0},t.prototype._replaceSelectionForNoneIE=function(e){var t=this._getDesignViewDocument();t.execCommand("inserttext",!1,e)},t.prototype.initMediaDialog=function(){var e=this,t=e.dialog;t.delegate(gs,"click."+e.widgetName,function(t){e.submitMediaDialog(),e._onDesignViewBlur(t)}).delegate(ys,"click."+e.widgetName,function(){e._closeDialog()})},t.prototype.submitMediaDialog=function(){var e=this,t=e.dialog,r=n("select",t).val(),s=n("."+is+" input",t).val(),o=n("."+ss+" input",t).val(),u=n("."+os+" input",t).val();if(s===""){i(this.localizeString("errorMessageUrlEmptyError","URL is empty!"));return}if(!e._isUrl(s)){i(this.localizeString("errorMessageUrlCorrectError","please input correct URL!"));return}if(!e._isNumeric(o)){i(this.localizeString("errorMessageMediaWidthError","please input width of the media!"));return}if(!e._isNumeric(u)){i(this.localizeString("errorMessageMediaHeightError","please input height of the media!"));return}e._insertMedia(r,s,o,u),e._closeDialog()},t.prototype._insertMedia=function(e,t,n,r){var i=this,s="";i._setIESelection();switch(e){case"video":s+='<embed src="'+t+'" width="'+n+'" '+'height="'+r+'" '+'type=audio/x-pn-realaudio-plugin console="Clip1" '+'controls="IMAGEWINDOW,ControlPanel,StatusBar" '+'autostart="true"></embed>';break;case"flash":s+='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab#version=6,0,29,0" width="'+n+'" height="'+r+'">',s+='<param name="movie" value="'+t+'">',s+='<param name="quality" value="high">',s+='<embed src="'+t+'" quality="high" '+'pluginspage="http://www.macromedia.com/go/getflashplayer" '+'type="application/x-shockwave-flash" '+'width="'+n+'" height="'+r+'"></embed>',s+="</object>";break;case"applet":s+='<applet code="'+t+'" width="'+n+'" '+'height="'+r+'"></applet>';break;case"other":s+='<embed src="'+t+'" width="'+n+'" '+'height="'+r+'"></embed>'}i.insertHTML(s)},t.prototype.initSpecialCharacterDialog=function(){var e=this,t=e.dialog,r=n("."+ls+" span",t);t.delegate("label","click."+e.widgetName,function(t){e.submitSpecialCharacterDialog(this),e._onDesignViewBlur(t)}).delegate(gs,"click."+e.widgetName,function(){e._closeDialog()}).delegate("label","mouseover."+e.widgetName,function(){r.html(n(this).html())}).delegate("label","mouseout."+e.widgetName,function(){r.empty()})},t.prototype.submitSpecialCharacterDialog=function(e){var t=this;t._setIESelection(),t.insertHTML(n(e).html()),t._closeDialog()},t.prototype._setSaveBtnEnabled=function(){this.$ribbon.wijribbon(b,_t,!1)},t.prototype._undoAction=function(){var e=this._getDesignViewDocument().body,t={};v--,v<=0&&(v=0),e.innerHTML=m[v],v?this.$ribbon.wijribbon(b,wt,!1):(t[bt]=!0,t[wt]=!1,this.$ribbon.wijribbon(w,t))},t.prototype._redoAction=function(){var e=this._getDesignViewDocument().body,t=m.length,n={};v++,v>=t-1&&(v=t-1),e.innerHTML=m[v],v===t-1?(n[bt]=!1,n[wt]=!0,this.$ribbon.wijribbon(w,n)):this.$ribbon.wijribbon(b,bt,!1)},t.prototype._addtoUndoBuffer=function(){var e=m.length-1-v,t;for(t=0;t<e;t++)m.pop();v++,m.push(this._getDesignViewText()),this.$ribbon.wijribbon(b,bt,!1)},t.prototype._deleteSelectionContent=function(){var e=this._getDesignViewWindow(),t,r,i,s="rangeCount";if(n.browser.msie)t=e.document.selection,t.type.toLowerCase()!=="none"&&t.clear();else{t=e.getSelection();for(r=0;r<t[s];r++)i=t.getRangeAt(r),i.deleteContents()}},t.prototype._refreshPathSelector=function(){var e=this,t=e._getParentElement(e._getDesignViewWindow()),r,i=e._getPathSelector(),s=n(t).parents(),o=s.length,u="wijmo-wijeditor-label ui-state-default ui-corner-all",a;if(!t)return;r=t.tagName?t.tagName.toLowerCase():"",i.empty();for(a=o-1;a>=0;a--)i.append("<label class='"+u+"'>&lt;"+s[a].tagName.toLowerCase()+"&gt;</label>");i.append("<label class='"+u+" wijmo-wijeditor-selectlabel ui-state-highlight ui-corner-all'>&lt;"+r+"&gt;</label>")},t.prototype._toggleTableBorders=function(){var e=this._getDesignViewDocument(),t=n("#__wijStyle",e);d=!d,n.browser.safari?d?t.html("table,td,tr{border: 1px #acacac dashed;}"):t.empty():t.prop("disabled",!d)},t.prototype._tableAction=function(e){var t=this,r=t._getParentElement(t._getDesignViewWindow()),s=n(r).closest("td"),o,u,a,f,l,c,h,p,d,v,m=0;t._setSaveBtnEnabled();if(s.length===0&&e!==F)return!1;e!==F&&(o=s.parent(),u=o.closest("table"),a=s[0],f=o[0],l=u[0],c=f.rowIndex,h=a.cellIndex);try{switch(e){case H:p=f.cells.length,v=l.insertRow(c);for(m=0;m<p;m++)t._insertCell(v,m);break;case q:l.deleteRow(c);break;case P:d=l.rows.length;for(m=0;m<d;m++)t._insertCell(l.rows[m],h);break;case I:t._removeColumn(l,h);break;case B:t._insertCell(f,h+1);break;case R:p=f.cells.length,p===1?l.deleteRow(c):f.deleteCell(h);break;case j:t._splitCell(l,f,c,h);break;case F:t._mergeCell(t._getSelectedCells(r))}this._addtoUndoBuffer()}catch(g){return i(g.message),!1}return!0},t.prototype._removeColumn=function(e,t){var n=e.rows.length,r=0,i,s,o,u,a;while(r<n)i=e.rows[r],s=i.cells,o=s.length,u=t>o-1?o-1:t,a=s[u].colSpan,a>1&&o>1&&(u+1<o?s[u+1].colSpan+=a-1:s[u-1].colSpan+=a+1),o===1?(e.deleteRow(r),n=e.rows.length):(i.deleteCell(u),r++)},t.prototype._splitCell=function(e,t,n,r){var i=e.rows.length,s=0,o=0,u,a,f,l,c;while(s<=r)t.cells[s].colSpan>1&&(o+=t.cells[s].colSpan-1),s++;this._insertCell(t,r+1);for(f=0;f<i;f++){u=e.rows[f];if(f!==n){l=r,s=0,a=0;while(s<=l)u.cells[s].colSpan>1&&(a+=u.cells[s].colSpan-1,l-=a),s++;c=r+o-a,c<0&&(c=0),u.cells[c].colSpan++}}},t.prototype._mergeCell=function(e){var t=e.length,n,r,i,s;if(t<2||e[0].parentNode!==e[t-1].parentNode)return!1;n=e[0].parentNode,r=e[0].cellIndex,i=r+t;for(s=r+1;s<i;s++)n.cells[r].innerHTML+=n.cells[r+1].innerHTML,n.cells[r].colSpan++,n.deleteCell(r+1)},t.prototype._getSelectedCells=function(e){var t=this._getDesignViewWindow(),r=t.document,i=[],s,o,u,a,f,l,c,h;if(n.browser.msie)s=r.selection.createRange(),o=n(e).closest("tr")[0],o&&n.each(o.cells,function(e,t){var n=r.selection.createRange(),o="compareEndPoints";n.moveToElementText(t),(s.inRange(n)||s[o]("StartToStart",n)>=0&&s[o]("StartToEnd",n)<=0||s[o]("EndToStart",n)>=0&&s[o]("EndToEnd",n)<=0)&&i.push(t)});else if(n.browser.mozilla){u=t.getSelection(),f=u.rangeCount;for(a=0;a<f;a++)s=u.getRangeAt(a),l=s.startContainer,c=l.nodeName.toLowerCase(),c==="td"||c==="th"?i.push(l):c==="tr"&&(h=s.startOffset,i.push(l.cells[h]))}else{u=t.getSelection(),o=n(e).closest("tr")[0];if(o){f=o.cells.length;for(a=0;a<f;a++)i.push(o.cells[a])}}return i},t.prototype.insertDateAndTime=function(){var e=new Date;this.options.culture&&this.options.culture!==""?this.insertHTML(Globalize.format(e,"dddd ",Globalize.findClosestCulture(this.options.culture))+Globalize.format(e,"F",Globalize.findClosestCulture(this.options.culture))):this.insertHTML(e.toDateString()+" "+e.toTimeString())},t.prototype._toggleWordWrap=function(){var e=this,t=e.sourceView,r="wrap",i;p=!p,i=p?"soft":"off",t.attr(r,i),t[0].focus(),n.browser.mozilla&&(t.hide(),s.setTimeout(function(){t.show()},40))},t.prototype.insertHTML=function(e){var t=this,r=t._getDesignViewDocument(),i;try{n.browser.msie?(i=r.selection.createRange(),i.pasteHTML(e),i.collapse(!1),i.select()):r.execCommand("insertHTML",!1,e)}catch(s){}t._addtoUndoBuffer(),t._setSaveBtnEnabled()},t.prototype._getSelectedContent=function(){var e=this._getDesignViewWindow(),t=e.document,n="",r="cloneContents",i,s,o;return t.selection?(i=t.selection.createRange(),i.htmlText):(i=e.getSelection().getRangeAt(0),i&&i[r]&&(s=i[r](),o=document.createElement("div"),o.appendChild(s),n=o.innerHTML,o=null),n||"")},t.prototype._setIESelection=function(){n.browser.msie&&g&&g.select()},t.prototype._setIEFocus=function(){var e=this._getDesignViewDocument();if(n.browser.msie)try{e.body.focus()}catch(t){}},t.prototype.focus=function(){var e=this._getDesignViewWindow(),t=e.document;n.browser.msie?g?g.select():t.body?t.body.focus():t.onreadystatechange=function(){t.readyState==="complete"&&t.body.focus()}:e.focus()},t.prototype._setFocusNotIE=function(){var e=this._getDesignViewWindow();n.browser.msie||e.focus()},t.prototype._getInspectElement=function(){return y||this._getSelectedElement()},t.prototype._getSelectedElement=function(){return this._getParentElement(this._getDesignViewWindow())},t.prototype._createElement=function(e,t,n){return new ks(e,t,n)},t.prototype._createDiv=function(e,t){return this._createElement("div",{"class":e})},t.prototype._createSpan=function(e,t){var n=this;return t?e.length===0?n._createElement("span",t):this._createElement("span",t,{"class":e}):n._createElement("span",{"class":e})},t.prototype._createTextBox=function(e,t){var n={"class":e,type:"text",value:undefined};return t&&(n.value=t),this._createElement("input",n)},t.prototype._createLabel=function(e,t){return t?new ks("label",e,{"for":t}):new ks("label",e)},t.prototype._createRadio=function(e,t,n){var r={name:t,id:e,value:n,type:"radio"};return this._createElement("input",r)},t.prototype._createCheckbox=function(e){var t={type:"checkbox",id:e};return this._createElement("input","",t)},t.prototype._createSelect=function(e,t){var r=this,i={"class":e},s=r._createElement("select",i);return e===""&&(s=r._createElement("select")),n.each(t,function(e,t){n.isPlainObject(t)&&t.selected?s.add(r._createElement("option",t.text,{selected:"selected"})):s.add(r._createElement("option",t))}),s},t.prototype._createInputButton=function(e,t){var n={"class":e,type:"button",value:undefined};return t&&(n.value=t),this._createElement("input",n)},t.prototype._createTextField=function(e,t,n,r){var i=this,s=i._createDiv(t),o={type:"text",value:""};return r&&(o.value=r),s.add(i._createSpan(kr,e)),s.add(i._createElement("input",o)),n&&s.add(new Cs(n)),s},t.prototype._createSeparator=function(){var e=this,t=e._createDiv(Tr);return t.add(e._createElement("hr")),t},t.prototype._createOKCancelButtons=function(){var e=this,t=e._createDiv(Nr);return t.add(e._createElement("input",{type:"button","class":Cr,value:this.localizeString("dialogOK","OK")})),t.add(e._createElement("input",{type:"button","class":Cr,engValue:"Cancel",value:this.localizeString("dialogCancel","Cancel")})),t},t.prototype._getDialogRes_Template=function(){var e=this,t=e._createDiv(qr),n=e._createDiv(Rr),r=e._createDiv(Wr),i=e._createDiv(Xr),s=e._createDiv(Vr),o=e._createDiv($r),u=e._createElement("div",this.localizeString("templateDialogName","Name :")),a=e._createElement("div",this.localizeString("templateDialogDescription","Description :")),f=e._createDiv(Qr),l=e._createDiv(Zr);return n.add(e._createElement("div",this.localizeString("templateDialogSelectTemplate","Select Template:"),{"class":Ur})),n.add(e._createElement("div",this.localizeString("templateDialogTemplatePreview","Template Preview:"),{"class":zr})),t.add(n),i.add(e._createElement("select",{size:8})),s.add(e._createElement("iframe",{frameborder:0})),r.add(i),r.add(s),t.add(r),u.add(e._createSpan(Jr)),a.add(e._createSpan(Kr)),o.add(u),o.add(a),t.add(o),f.add(e._createSpan(kr,this.localizeString("templateDialogName","Name :"))),f.add(e._createTextBox(Gr)),f.add(e._createSpan(kr,this.localizeString("templateDialogDescription","Description :"))),f.add(e._createTextBox(Yr)),t.add(f),l.add(e._createInputButton(Cr+" "+ei,this.localizeString("templateDialogDeleteSelected","Delete selected"))),l.add(e._createInputButton(Cr+" "+ti,this.localizeString("templateDialogSaveCurrentPage","Save current page as template"))),t.add(l),t.add(e._createSeparator()),t.add(e._createOKCancelButtons()),t.render()},t.prototype._getDialogRes_ImageBrowser=function(){var e=this,t=e._createDiv(Lr),n=e._createDiv(Ar),r=e._createDiv(Or),i=e._createDiv(Mr),s=e._createDiv(_r),o=e._createDiv(Dr);return r.add(e._createTextField(this.localizeString("imageEditorDialogImageSrc","Image Src:"),Pr)),r.add(e._createTextField(this.localizeString("imageEditorDialogImageAltText","Image alt text:"),Hr)),r.add(e._createTextField(this.localizeString("imageEditorDialogImageWidth","Image width:"),Br,this.localizeString("dialogPixel","px"))),r.add(e._createTextField(this.localizeString("imageEditorDialogImageHeight","Image height:"),jr,this.localizeString("dialogPixel","px"))),r.add(e._createTextField(this.localizeString("imageEditorDialogCssText","Css text:"),Fr)),n.add(r),i.add(s),s.add(e._createElement("select",{size:8})),i.add(o),o.add(e._createElement("img",{src:"",alt:""})),n.add(i),n.add(e._createSeparator()),n.add(e._createOKCancelButtons()),t.add(n),t.render()},t.prototype._getDialogRes_Link=function(){var e=this,t=e._createDiv(ni),r=e._createTextField(this.localizeString("hyperLinkDialogAddress","Address :"),ri),i=e._createDiv(ii+" ui-helper-clearfix"),s=e._createElement("div"),o=e._createDiv(hi),u=e._createDiv(pi),a=e._createElement("div"),f=[{id:"radUrl",value:"url",text:this.localizeString("hyperLinkDialogUrl","url")},{id:"radAnchor",value:"anchor",checked:!0,text:this.localizeString("hyperLinkDialogAnchor","anchor")},{id:"radMail",value:"email",text:this.localizeString("hyperLinkDialogEmail","email")}],l=[{id:"radLinkTypeIsText",value:"text",checked:!0,text:this.localizeString("hyperLinkDialogText","text")},{id:"radLinkTypeIsImage",value:"image",text:this.localizeString("hyperLinkDialogImage","image")}],c=[],h=e._createTextField(this.localizeString("hyperLinkDialogTextToDisplay","Text to display :"),oi),p=e._createSpan(kr,this.localizeString("hyperLinkDialogIconType","Icon Type :")),d=e._createDiv(ui),v=e._createSpan(kr,this.localizeString("hyperLinkDialogTarget","Target :")),m=[{text:"_blank",selected:!0},"_parent","_self","_top"],g=e._createSelect(ui,m),y=e._createTextField(this.localizeString("hyperLinkDialogCss","Css :"),ai),b;o.add(e._createTextField(this.localizeString("imageEditorDialogImageSrc","Image Src:"),fi)),o.add(e._createTextField(this.localizeString("imageEditorDialogImageWidth","Image width:"),li,this.localizeString("dialogPixel","px"))),o.add(e._createTextField(this.localizeString("imageEditorDialogImageHeight","Image height:"),ci,this.localizeString("dialogPixel","px"))),t.add(r),t.add(i),i.add(s),u.add(a),a.add(p),n.each(f,function(t,n){s.add(e._createRadio(n.id,"radioList",n.value)),s.add(e._createLabel(n.text,n.id))}),n.each(l,function(t,n){a.add(e._createRadio(n.id,"linkIconRadioList",n.value)),a.add(e._createLabel(n.text,n.id))});for(b=1;b<8;b++)c.push("#anchor"+b.toString());return i.add(e._createSelect(si,c)),t.add(e._createSeparator()),t.add(u),t.add(h),t.add(o),t.add(d),d.add(v),d.add(g),t.add(y),t.add(e._createSeparator()),t.add(e._createOKCancelButtons()),t.render()},t.prototype._getDialogRes_TagInspector=function(){var e=this,t=e._createDiv(gi),n=e._createDiv(yi),r=e._createDiv(Ei),i=e._createDiv(Si),s=e._createDiv(Ti);return t.add(n),n.add(e._createSpan(bi,this.localizeString("tagInspectorDialogSelectedTag","Selected tag :"))),n.add(e._createSpan(wi,"")),t.add(r),r.add(e._createCheckbox("displayNoEmpty")),r.add(e._createLabel(this.localizeString("tagInspectorDialogDisplayNotEmptyAttributes","Display not empty attributes only"),"displayNoEmpty")),t.add(i),i.add(e._createSpan(kr,this.localizeString("tagInspectorDialogAttributes","Attributes:"))),i.add(e._createDiv(xi)),t.add(s),s.add(e._createSpan(kr,this.localizeString("tagInspectorDialogInnerHTML","Inner HTML:"))),s.add(e._createElement("textarea")),t.add(e._createTextField(this.localizeString("tagInspectorDialogCSSText","Css Text:"),Ni)),t.add(e._createSeparator()),t.add(e._createOKCancelButtons()),t.render()},t.prototype._getDialogRes_Color=function(){return this._getDialogRes_CommonColor("#FFFFFF")},t.prototype._getDialogRes_ForeColor=function(){return this._getDialogRes_CommonColor("#000000")},t.prototype._getDialogRes_BackColor=function(){return this._getDialogRes_CommonColor("#FFFFFF")},t.prototype._getDialogRes_CommonColor=function(e){var t=this,n=t._createDiv(Ci),r=t._createDiv(Li);return n.add(t._createDiv(ki)),n.add(r),r.add(t._createSpan(kr,this.localizeString("backColorDialogSelectedColor","Selected Color:"))),r.add(t._createElement("input",{type:"text",value:e})),n.add(t._createSeparator()),n.add(t._createOKCancelButtons()),n.render()},t.prototype._getDialogRes_Table=function(){var e=this,t=e._createDiv(Ai),n=e._createDiv(Fi);return t.add(e._createTextField(this.localizeString("tableDialogRows","Rows :"),Oi,"",3)),t.add(e._createTextField(this.localizeString("tableDialogColumns","Columns :"),Mi,"",3)),t.add(e._createTextField(this.localizeString("tableDialogTableWidth","Table Width :"),_i,this.localizeString("tableDialogPixels","pixels"),200)),t.add(e._createTextField(this.localizeString("tableDialogTableHeight","Table Height :"),Di,this.localizeString("tableDialogPixels","pixels"),200)),t.add(e._createTextField(this.localizeString("tableDialogBorder","Border thickness:"),Pi)),t.add(e._createTextField(this.localizeString("tableDialogCellPadding","Cell Padding :"),Hi)),t.add(e._createTextField(this.localizeString("tableDialogCellSpacing","Cell Spacing :"),Bi)),t.add(e._createTextField(this.localizeString("tableDialogCssText","Css Text :"),ji)),t.add(n),n.add(e._createSpan(kr,this.localizeString("tableDialogBackgroundColor","Background Color:"))),n.add(e._createElement("input",{type:"text"})),n.add(e._createElement("input",{type:"button",value:"..."})),t.add(e._createSeparator()),t.add(e._createOKCancelButtons()),t.render()},t.prototype._getDialogRes_Preview=function(){var e=this,t=e._createDiv(Ii),n=e._createDiv(qi),r=e._createDiv(Nr),i=e._createDiv(Ri),s=e._createDiv(Ji);return t.add(n),n.add(e._createSpan(kr,this.localizeString("previewDialogPreviewSize","Preview Size:"))),n.add(e._createElement("input",{id:"rad640_480",name:"preview",type:"radio",checked:"checked"})),n.add(e._createLabel("640x480","rad640_480")),n.add(e._createElement("input",{id:"rad800_600",name:"preview",type:"radio"})),n.add(e._createLabel("800x600","rad800_600")),n.add(e._createElement("input",{id:"rad1024_768",name:"preview",type:"radio"})),n.add(e._createLabel("1024x768","rad1024_768")),n.add(e._createElement("input",{id:"chkSplit",type:"checkbox",checked:"checked"})),n.add(e._createLabel(this.localizeString("previewDialogSplit","Split pages"),"chkSplit")),t.add(e._createSeparator()),t.add(r),r.add(e._createInputButton(Cr+" "+Wi,this.localizeString("previewDialogPrintAll","Print All"))),r.add(e._createInputButton(Cr+" "+Xi,this.localizeString("previewDialogPrintPage","Print Page"))),r.add(e._createInputButton(Cr+" "+Vi,this.localizeString("dialogOK","OK"))),t.add(e._createSeparator()),t.add(i),i.add(e._createElement("a",this.localizeString("previewDialogPrevPage","Prev page"),{"class":Ui,href:"#"})),i.add(e._createElement("span","1 / 1")),i.add(e._createElement("a",this.localizeString("previewDialogNextPage","Next page"),{"class":zi,href:"#"})),t.add(e._createDiv($i)),t.add(s),s.add(e._createElement("iframe",{src:"about:blank"})),t.render()},t.prototype._getDialogRes_CleanUp=function(){var e=this,t=e._createDiv(Ki),r=e._createDiv(Qi),i=e._createDiv(Gi),s=e._createDiv(Yi),o=[{id:"replaceSpans",label:this.localizeString("cleanUpDialogStripSpanTag","Strip SPAN tag")},{id:"replaceClass",label:this.localizeString("cleanUpDialogStripClass","Strip CLASS tag")},{id:"replaceStyle",label:this.localizeString("cleanUpDialogStripStyle","Strip STYLE attribute")},{id:"replaceNbsp",label:this.localizeString("cleanUpDialogReplaceSymbol","Replace &amp;nbsp; symbol")},{id:"transformPtoDiv",label:this.localizeString("cleanUpDialogTransformParagraphToDIV","Transform Paragraph to DIV")}];return t.add(r),r.add(e._createSpan(kr,this.localizeString("cleanUpDialogDocumentSource","Document source :"))),t.add(i),i.add(e._createElement("textarea",{readonly:"readonly"})),t.add(s),n.each(o,function(t,n){s.add(e._createCheckbox(n.id)),s.add(e._createLabel(n.label,n.id))}),t.add(e._createSeparator()),t.add(e._createOKCancelButtons()),t.render()},t.prototype._getDialogRes_FindAndReplace=function(){var e=this,t=e._createDiv(Zi),n=e._createDiv(es),r=e._createDiv(ts),i=e._createDiv(Nr);return t.add(n),n.add(e._createSpan(kr,this.localizeString("findAndReplaceFind","Find:"))),n.add(e._createElement("textarea","text")),t.add(r),r.add(e._createSpan(kr,this.localizeString("findAndReplaceReplace","Replace:"))),r.add(e._createElement("textarea")),t.add(e._createSeparator()),t.add(i),i.add(e._createInputButton(Cr,this.localizeString("findAndReplaceFindButton","Find"))),i.add(e._createInputButton(Cr,this.localizeString("findAndReplaceReplaceButton","Replace"))),t.render()},t.prototype._getDialogRes_Media=function(){var e=this,t=e._createDiv(ns),n=e._createDiv(rs);return t.add(n),n.add(e._createSpan(kr,this.localizeString("mediaDialogMediaType","Media Type :"))),n.add(e._createSelect("",["flash","video","applet","other"])),t.add(e._createTextField(this.localizeString("mediaDialogMediaUrl","Media Url :"),is)),t.add(e._createTextField(this.localizeString("mediaDialogWidth","Width :"),ss,this.localizeString("dialogPixel","px"),200)),t.add(e._createTextField(this.localizeString("mediaDialogHeight","Height :"),os,this.localizeString("dialogPixel","px"),200)),t.add(e._createSeparator()),t.add(e._createOKCancelButtons()),t.render()},t.prototype._getDialogRes_SpecialCharacter=function(){var e=this,t=e._createDiv(us),r=e._createDiv(as),i=e._createDiv(fs),s=e._createDiv(ls),o=e._createDiv(cs),u=e._createDiv(hs,"Punctuation"),a=e._createDiv(ps),f=["&#8211;","&#8212;","&iexcl;","&iquest;","&quot;","&laquo;","&raquo;","&nbsp;"],l=e._createDiv(hs,"Symbols"),c=e._createDiv(ds),h=["&amp;","&cent;","&copy;","&divide;","&gt;","&lt;","&micro;","&#8226;","&para;","&plusmn;","&#8364;","&pound;","&reg;","&sect;","&yen;"],p=e._createDiv(hs,"Diacritics"),d=e._createDiv(vs),v=["&aacute;","&Aacute;","&agrave;","&Agrave;","&acirc;","&Acirc;","&aring;","&Aring;","&atilde;","&Atilde;","&auml;","&Auml;","&aelig;","&AElig;","&ccedil;","&Ccedil;","&eacute;","&Eacute;","&egrave;","&Egrave;","&ecirc;","&Ecirc;","&euml;","&Euml;","&iacute;","&Iacute;","&igrave;","&Igrave;","&icirc;","&Icirc;","&iuml;","&Iuml;","&ntilde;","&Ntilde;","&oacute;","&Oacute;","&ograve;","&Ograve;","&ocirc;","&Ocirc;","&oslash;","&Oslash;","&otilde;","&Otilde;","&ouml;","&Ouml;","&uacute;","&Uacute;","&ugrave;","&Ugrave;","&ucirc;","&Ucirc;","&uuml;","&Uuml;","&szlig;","&yuml;","&#8216;","&#8217;"],m=e._createDiv(Nr);return t.add(r),r.add(i),i.add(s),s.add(new ks("span")),r.add(o),o.add(u),u.add(a),n.each(f,function(t,n){a.add(e._createLabel(n))}),o.add(l),l.add(c),n.each(h,function(t,n){c.add(e._createLabel(n))}),o.add(p),p.add(d),n.each(v,function(t,n){d.add(e._createLabel(n))}),t.add(e._createSeparator()),m.add(e._createInputButton(Cr,"Cancel")),t.add(m),t.render()},t.prototype._copyFromClipboard=function(){var e,t,r,i;if(s.clipboardData)return s.clipboardData.getData("Text");if(n.browser.mozilla){try{netscape.security.PrivilegeManager.enablePrivilege&&netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect")}catch(o){}return e=Components.classes["@mozilla.org/widget/clipboard;1"].getService(Components.interfaces.nsIClipboard),e?(t=Components.classes["@mozilla.org/widget/transferable;1"].createInstance(Components.interfaces.nsITransferable),t?(t.addDataFlavor("text/unicode"),e.getData(t,e.kGlobalClipboard),t.getTransferData("text/unicode",r,i),r&&(r=r.value.QueryInterface(Components.interfaces.nsISupportsString)),r?r.data.substring(0,i.value/2):""):!1):!1}},t.prototype._copyToClipboard=function(e){var t,r,o,u={},a={};if(s.clipboardData&&e)s.clipboardData.setData("Text",e);else if(n.browser.mozilla)try{netscape.security.PrivilegeManager.enablePrivilege&&netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect"),t=Components.classes["@mozilla.org/widget/clipboard;1"].createInstance(Components.interfaces.nsIClipboard);if(!t)return;r=Components.classes["@mozilla.org/widget/transferable;1"].createInstance(Components.interfaces.nsITransferable);if(!r)return;r.addDataFlavor("text/unicode"),a={},u=Components.classes["@mozilla.org/supports-string;1"].createInstance(Components.interfaces.nsISupportsString),u.data=e,r.setTransferData("text/unicode",u,e.length*2),o=Components.interfaces.nsIClipboard;if(!t)return!1;t.setData(r,null,o.kGlobalClipboard)}catch(f){u="Copy text to Clipboard \n",u+="If you are using firefox please do the following :\n ",u+="1. Write in your url box : 'about:config'\n",u+="2. Change signed.applets.codebase_principal_support = true\n",i(this.localizeString("errorMessageCopyToClipboardError",u))}},t.prototype.fixAbsoluteUrlsIfNeeded=function(e){var t=this,n=o.URL,r=o.URL,i=o.URL,s=!1,u=r.length,a=e,f,l,c,h,p,d,v,m;for(v=u-1;v>0;v--){f=r.charAt(v),l=r.charAt(v-1);if(f==="/"||f==="\\"){if(f===l)break;i=r.substring(0,v)+f,s||(r=i,s=!0)}}return c=t._prepareLiteralRegexText(n+"?"),h=new RegExp(c,"g"),a=a.replace(h,"?"),p=t._prepareLiteralRegexText(r),h=new RegExp(p,"g"),a=a.replace(h,""),d=t._prepareLiteralRegexText(i),h=new RegExp(d,"g"),a=a.replace(h,"/"),m=a.indexOf("#"),m>-1&&(a=a.substr(m)),a},t.prototype._insertCell=function(e,t){var n=e.insertCell(t);return n.innerHTML="&nbsp;",n},t.prototype._getDictionaryDeclare=function(){var e={};return e.a=["accesskey","charset","class","coords","dir","href","hreflang","id","lang","name","rel","rev","shape","tabindex","target","title"],e.b=["class","dir","id","lang","title"],e.body=["alink","background","bgColor","bgproperties","bottommargin","class","dir","id","lang","leftmargin","link","marginheight","marginwidth","rightmargin","text","title","topmargin","vlink"],e.button=["accesskey","class","dir","disabled","id","lang","name","tabindex","title","type","value"],e.code=["class","dir","id","lang","title"],e.div=["align","class","dir","id","lang","title"],e.em=["class","dir","id","lang","title"],e.font=["class","color","dir","face","id","lang","pointsize","size","title"],e.form=["action","class","dir","enctype","id","lang","method","name","runat","target","title"],e.hr=["align","class","color","id","noshade","size","title","width"],e.i=["class","dir","id","lang","title"],e.img=["align","alt","border","class","controls","dir","dynsrc","height","hspace","id","ismap","lang","longdesc","loop","lowsrc","name","src","start","title","usemap","vspace","width"],e.input=["accept","accesskey","align","alt","border","checked","class","dir","disabled","height","hspace","id","lang","maxlength","name","readonly","size","src","tabindex","title","type","usemap","value","vspace","width"],e.label=["accesskey","class","dir","for","id","lang","title"],e.li=["class","dir","id","lang","title","type","value"],e.ol=["class","compact","dir","id","lang","start","title","type"],e.option=["class","dir","disabled","id","label","lang","selected","title","value"],e.p=["align","class","dir","id","lang","title"],e.span=["class","dir","id","lang","title"],e.strong=["class","dir","id","lang","title"],e.select=["accesskey","class","dir","disabled","id","lang","multiple","name","size","tabindex","title"],e.table=["align","background","bgColor","border","bordercolor","bordercolordark","bordercolorlight","cellpadding","cellspacing","class","cols","datapagesize","dir","frame","height","hspace","id","lang","rules","summary","title","vspace","width"],e.td=["abbr","align","axis","background","bgColor","bordercolor","bordercolordark","bordercolorlight","class","colspan","dir","headers","height","id","lang","nowrap","rowspan","scope","title","valign","width"],e.th=["abbr","align","axis","background","bgColor","bordercolor","bordercolordark","bordercolorlight","class","colspan","dir","headers","height","id","lang","nowrap","rowspan","scope","title","valign","width"],e.tr=["align","bgColor","bordercolor","bordercolordark","bordercolorlight","class","dir","height","id","lang","nowrap","title","valign"],e.tbody=["align","bgColor","class","dir","id","lang","title","valign"],e.textarea=["accesskey","class","cols","dir","disabled","id","label","lang","name","readonly","rows","tabindex","title","wrap"],e.u=["class","id","xml:lang"],e.ul=["class","compact","dir","id","lang","title","type"],e},t.prototype._getParentElement=function(e){var t=this,n=t._getRange(e),r,i,s,o,u;if(!n)return null;if(n.commonAncestorContainer)return r=e.getSelection(),i=n.startContainer||r.baseNode,s=n.endContainer||r.extentNode,o=n.startOffset,o===null&&(o=r.baseOffset),u=n.endOffset,u===null&&(u=r.extentOffset),i===s&&u-o===1?r.anchorNode.childNodes[r.anchorOffset]:n.commonAncestorContainer.tagName?n.commonAncestorContainer:e.document===n.commonAncestorContainer&&r.baseNode?r.baseNode.parentNode:n.commonAncestorContainer.parentNode;return n.length?n.item(0):n.parentElement?n.parentElement():null},t.prototype._getRange=function(e){var t,n;if(e.document.selection&&!s.opera)return e.document.selection.createRange();if(e.getSelection)return t=e.getSelection(),!t||t.rangeCount<1?null:(t.getRangeAt?n=t.getRangeAt(0):n=e.document.createRange(),n)},t.prototype._generateUniqueName=function(e){var t=c[e];return t||(t=0),c[e]=++t,e+t},t.prototype._setContentEditable=function(e,t){var r="designMode",i="contentEditable";try{e.body[i]&&(e.body[i]=t.toString()),e[r]&&(!t&&e[r]!=="off"?e[r]="off":t&&e[r]!=="on"&&(n.browser.msie&&u(n.browser.version)>=9||(e[r]="on"))),t&&!n.browser.msie&&e.execCommand("useCSS",!1,!0)}catch(s){}},t.prototype._setContentSpellCheck=function(e,t){var n="spellcheck";try{e.body[n]!==undefined&&(e.body[n]=t)}catch(r){}},t.prototype._formatString=function(e,t){var n=e.length,r;for(r=0;r<t-n;r++)e="0"+e;return e},t.prototype._convertToWebColor=function(e,t,n){var r=this,i,s,o,a;if(isNaN(e)||255-e<0)e=0;if(isNaN(t)||255-t<0)t=0;if(isNaN(n)||255-n<0)n=0;return i=r._formatString(u(e).toString(16),2),s=r._formatString(u(t).toString(16),2),o=r._formatString(u(n).toString(16),2),a="#"+i+s+o,a},t.prototype._prepareLiteralRegexText=function(e){var t=e;return t=t.replace("\\","\\\\"),t=t.replace(".","\\."),t=t.replace("?","\\?"),t},t.prototype._isNumeric=function(e){return(new RegExp("^\\d+$")).test(e)},t.prototype._isEmail=function(e){return(new RegExp("mailto:(\\S)+[@]{1}(\\S)+[.]{1}(\\w)+")).test(e)},t.prototype._isUrl=function(e){return(new RegExp("[a-zA-z]+://[^s]+")).test(e)},t.prototype.refresh=function(){var e=this,t=e._getDesignViewDocument(),r=e.element,i=e._getHeader(),s=e._getFooter(),o=e._oriEleWidth,u=e._oriEleHeight,a=e._getContent(),f;e.editor.width(o).height(u),this.$ribbon.wijribbon("updateRibbonSize"),f=e.editor.height()-i.outerHeight(!0)-s.outerHeight(!0),a.height(f).wijsplitter("refresh"),n.browser.mozilla?setTimeout(e._setDesignModeForFF,1e3,e):e._setContentEditable(t,!0)},t.prototype.getText=function(){var e=this;return e._getDesignViewText()},t.prototype.setText=function(e){var t=this;e&&(t._setDesignViewText(e),t.sourceView.val(e))},t.prototype.localizeString=function(e,t){var n=this.options;return n.localization&&n.localization[e]?n.localization[e]:t},t}(e.wijmoWidget);t.wijeditor=Ls;var As=function(){function e(){this.initSelector=":jqmData(role='wijeditor')",this.fullScreenContainerSelector="",this.editorMode="wysiwyg",this.fullScreenMode=!1,this.showPathSelector=!0,this.mode="ribbon",this.commandButtonClick=null,this.simpleModeCommands=null,this.showFooter=!0,this.customContextMenu=!0,this.text=null,this.textChanged=null,this.localization=null}return e}();Ls.prototype.options=n.extend(!0,{},e.wijmoWidget.prototype.options,new As),n.wijmo.registerWidget("wijeditor",Ls.prototype);var Os=mr+"-colorcanvas",Ms=mr+"-color",_s=mr+"-wheel",Ds=mr+"-overlay",Ps=mr+"-marker";n.fn.wijeditorcolorcanvas=function(e,t){var n=this.get(0);return n.wijeditorcolorcanvas||(n.wijeditorcolorcanvas=new Hs(n,e,t))};var Hs=function(){function e(e,t,r){var i=this,s="",a,f;f="progid:DXImageTransform.Microsoft.AlphaImageLoader(enabled=true, sizingMethod=crop, ",s+="<div class='"+Os+"'>",s+="<div class='"+Ms+"'></div>",s+="<div class='"+_s+"'></div>",s+="<div class='"+Ds+"'></div>",s+="<div class='h-marker "+Ps+"'></div>",s+="<div class='sl-marker "+Ps+"'></div></div>",n(e).html(s),a=n("."+Os,e),i.wheel=n("."+_s,e).get(0),i.radius=84,i.square=100,i.width=194,n.browser.msie&&parseInt(n.browser.version,10)<7&&n("*",a).each(function(){var e=this,t=e.currentStyle.backgroundImage;return t!=="none"&&(t=t.substring(5,t.length-2),n(e).css({backgroundImage:"none",filter:f+"src='"+t+"')"})),this}),i.linkTo=function(e){typeof i.callback=="object"&&n(i.callback).unbind("keyup",i.updateValue),i.color=null;if(typeof e=="function")i.callback=e;else if(typeof e=="object"||typeof e=="string")i.callback=n(e),i.callback.bind("keyup",i.updateValue),i.callback.get(0).value&&i.setColor(i.callback.get(0).value);return this},i.updateValue=function(e){var t=this;t.value&&t.value!==i.color&&i.setColor(t.value)},i.setColor=function(e){var t=i.unpack(e);return i.color!==e&&t&&(i.color=e,i.rgb=t,i.hsl=i.RGBToHSL(i.rgb),i.updateDisplay()),this},i.setHSL=function(e){return i.hsl=e,i.rgb=i.HSLToRGB(e),i.color=i.pack(i.rgb),i.updateDisplay(),this},i.widgetCoords=function(e){var t,r,s,o,u;return s=e.target||e.srcElement,o=i.wheel,u=i.absolutePosition(o),t=(e.pageX||0*(e.clientX+n("html").get(0).scrollLeft))-u.x,r=(e.pageY||0*(e.clientY+n("html").get(0).scrollTop))-u.y,{x:t-i.width/2,y:r-i.width/2}},i.mousedown=function(e){o.dragging||(n(o).bind("mousemove",i.mousemove).bind("mouseup",i.mouseup),o.dragging=!0);var t=i.widgetCoords(e);return i.circleDrag=Math.max(Math.abs(t.x),Math.abs(t.y))*2>i.square,i.mousemove(e),!1},i.mousemove=function(e){var t=i.widgetCoords(e),n,r,s;return i.circleDrag?(n=Math.atan2(t.x,-t.y)/6.28,n<0&&(n+=1),i.setHSL([n,i.hsl[1],i.hsl[2]])):(r=Math.max(0,Math.min(1,-(t.x/i.square)+.5)),s=Math.max(0,Math.min(1,-(t.y/i.square)+.5)),i.setHSL([i.hsl[0],r,s])),!1},i.mouseup=function(){n(o).unbind("mousemove",i.mousemove).unbind("mouseup",i.mouseup),o.dragging=!1},i.updateDisplay=function(){var e=i.hsl[0]*6.28,t;n(".h-marker",a).css({left:Math.round(Math.sin(e)*i.radius+i.width/2)+"px",top:Math.round(-Math.cos(e)*i.radius+i.width/2)+"px"}),n(".sl-marker",a).css({left:Math.round(i.square*(.5-i.hsl[1])+i.width/2)+"px",top:Math.round(i.square*(.5-i.hsl[2])+i.width/2)+"px"}),n("."+Ms,a).css("backgroundColor",i.pack(i.HSLToRGB([i.hsl[0],1,.5]))),typeof i.callback=="object"?(n(i.callback).css({backgroundColor:i.color,color:i.hsl[2]>.5?"#000":"#fff"}),n(i.callback).each(function(){return t=this,t.value&&t.value!==i.color&&(t.value=i.color),this})):typeof i.callback=="function"&&i.callback.call(i,i.color)},i.absolutePosition=function(e){var t={x:e.offsetLeft,y:e.offsetTop},n;return e.offsetParent&&(n=i.absolutePosition(e.offsetParent),t.x+=n.x,t.y+=n.y),t},i.pack=function(e){var t=Math.round(e[0]*255),n,r;return n=Math.round(e[1]*255),r=Math.round(e[2]*255),"#"+(t<16?"0":"")+t.toString(16)+(n<16?"0":"")+n.toString(16)+(r<16?"0":"")+r.toString(16)},i.unpack=function(e){if(e.length===7)return[u("0x"+e.substring(1,3))/255,u("0x"+e.substring(3,5))/255,u("0x"+e.substring(5,7))/255];if(e.length===4)return[u("0x"+e.substring(1,2))/15,u("0x"+e.substring(2,3))/15,u("0x"+e.substring(3,4))/15]},i.HSLToRGB=function(e){var t,n,r,i,s,o=this;return r=e[0],i=e[1],s=e[2],n=s<=.5?s*(i+1):s+i-s*i,t=s*2-n,[o.hueToRGB(t,n,r+.33333),o.hueToRGB(t,n,r),o.hueToRGB(t,n,r-.33333)]},i.hueToRGB=function(e,t,n){return n=n<0?n+1:n>1?n-1:n,n*6<1?e+(t-e)*n*6:n*2<1?t:n*3<2?e+(t-e)*(.66666-n)*6:e},i.RGBToHSL=function(e){var t,n,r,i,s,o,u,a,f;return u=e[0],a=e[1],f=e[2],t=Math.min(u,Math.min(a,f)),n=Math.max(u,Math.max(a,f)),r=n-t,o=(t+n)/2,s=0,o>0&&o<1&&(s=r/(o<.5?2*o:2-2*o)),i=0,r>0&&(n===u&&n!==a&&(i+=(a-f)/r),n===a&&n!==f&&(i+=2+(f-u)/r),n===f&&n!==u&&(i+=4+(u-a)/r),i/=6),[i,s,o]},n("*",a).mousedown(i.mousedown),i.setColor(r||"#000000"),t&&i.linkTo(t)}return e}();t._wijeditorcolorcanvas=Hs})(e.editor||(e.editor={}));var t=e.editor})(wijmo||(wijmo={}));;
var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(t){var n=this;"use strict";var r=jQuery,i=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype._setOption=function(t,n){var i=this.options,s=r("."+i.wijCSS.wijratingResetButton,this.ratingElement[0]),o=r("."+i.wijCSS.wijratingStarContainer,this.ratingElement[0]),u=r("."+i.wijCSS.wijratingNormalStar,this.ratingElement[0]);if(r.isPlainObject(i[t])){switch(t){case"resetButton":typeof n.disabled!="undefined"&&n.disabled!==i[t].disabled&&(n.disabled?(s.hide(),s.attr("aria-hidden",!0)):i.disabled||(s.show(),s.attr("aria-hidden",!1))),typeof n.hint!="undefined"&&n.hint!==i[t].hint&&(n.hint===null?s.attr("title",""):s.attr("title",n.hint)),n.position&&n.position.length&&n.position!==i[t].position&&(n.position==="rightOrBottom"?s.parent().append(s):s.parent().prepend(s)),typeof n.customizedClass!="undefined"&&n.customizedClass!==i[t].customizedClass&&(i[t].customizedClass.length&&s.removeClass(i[t].customizedClass),n.customizedClass.length&&s.addClass(n.customizedClass));break;case"hint":typeof n.disabled!="undefined"&&n.disabled!==i[t].disabled&&(n.disabled?u.removeAttr("title"):this._resetHint(i.hint.content)),typeof n.content!="undefined"&&n.content!==i[t].content&&(i[t].disabled||this._resetHint(n.content));break;case"icons":typeof n.iconsClass!="undefined"&&(i[t].iconsClass&&i[t].iconsClass.length&&this._removeCustomizedIconsClass(i[t].iconsClass),this._addCustomizedIconsClass(n.iconsClass,i.split)),typeof n.hoverIconsClass!="undefined"&&i[t].hoverIconsClass&&i[t].hoverIconsClass.length&&this._removeCustomizedIconsClass(i[t].hoverIconsClass),typeof n.ratedIconsClass!="undefined"&&(i[t].ratedIconsClass&&i[t].ratedIconsClass.length&&this._removeCustomizedIconsClass(i[t].ratedIconsClass),this._resetValue(i.value,i.ratingMode,n.ratedIconsClass));break;default:}r.extend(!0,i[t],n)}else{if(n===i[t])return;switch(t){case"disabled":n?(this._unbindLiveEvents(),s.hide(),s.attr("aria-hidden",!0)):(this._bindLiveEvents(),i.resetButton.disabled||(s.show(),s.attr("aria-hidden",!1)));break;case"count":this._createStars(i.split,n,o);break;case"split":this._createStars(n,i.count,o);break;case"totalValue":this._resetTotalValue(n);break;case"orientation":n==="vertical"?this.ratingElement.addClass(i.wijCSS.wijvRating):this.ratingElement.removeClass(i.wijCSS.wijvRating),i.split>1&&(i[t]=n,this._createStars(i.split,i.count,o));break;case"direction":i[t]=n,this._createStars(i.split,i.count,o);break;case"ratingMode":this._resetValue(i.value,n,i.icons.ratedIconsClass);break;case"value":if(i.min&&n<i.min)return;if(i.max&&n>i.max)return;this._resetValue(n,i.ratingMode,i.icons.ratedIconsClass);break;case"iconWidth":i[t]=n,this._createStars(i.split,i.count,o);break;case"iconHeight":i[t]=n,this._createStars(i.split,i.count,o);break;default:}e.prototype._setOption.call(this,t,n)}},t.prototype._create=function(){var t=this.options,n;if(this.element.is("select"))this._parseSelect(),this.element.hide(),n=r("<div></div>"),this.element.after(n);else{if(!this.element.is("div"))return;this.element.children("input[type='radio']").length>0?(this._parseRadio(),this.element.hide(),n=r("<div></div>"),this.element.after(n)):n=this.element}this.ratingElement=n,this._createRating(),t.disabled||this._bindLiveEvents(),e.prototype._create.call(this)},t.prototype.destroy=function(){var t=this.options;this._unbindLiveEvents(),this.element!==this.ratingElement?(this.ratingElement.remove(),this.element.show()):this.element.removeClass(t.wijCSS.widget).removeClass(t.wijCSS.wijrating).removeClass(t.wijCSS.wijvRating).empty(),e.prototype.destroy.call(this)},t.prototype._unbindLiveEvents=function(){var e=this.options;this.ratingElement.off(".wijrating","."+e.wijCSS.wijratingNormalStar).off(".wijrating","."+e.wijCSS.wijratingResetButton)},t.prototype._bindLiveEvents=function(){var e=this,t=e.options,n="."+t.wijCSS.wijratingNormalStar,i="."+t.wijCSS.wijratingResetButton,s,o={element:e.ratingElement,mouseover:function(i){var o=r(i.target),u=r(n,e.ratingElement[0]);o.is(n)&&(u.removeClass(t.wijCSS.wijratingHoverStar),o.addClass(t.wijCSS.wijratingHoverStar),t.ratingMode==="continuous"&&(t.direction==="reversed"?o.parent().nextAll().children().addClass(t.wijCSS.wijratingHoverStar):o.parent().prevAll().children().addClass(t.wijCSS.wijratingHoverStar)),e._addCustomizedHoverIconsClass(t.icons.hoverIconsClass,t.split,o),s={value:parseFloat(o.html()),target:o},e._trigger("hover",i,s))},mouseout:function(i){var s=r(i.target),o=r(n,e.ratingElement[0]);s.is(n)&&(o.removeClass(t.wijCSS.wijratingHoverStar),e._removeCustomizedIconsClass(t.icons.hoverIconsClass))},click:function(i){var o=r(i.target),u=parseFloat(o.html()),a=r(n,e.ratingElement[0]),f={duration:500,easing:null,delay:250,animated:null},l=r.wijmo.wijrating.animations,c;r.extend(!0,f,t.animation),c=f.animated;if(!o.is(n))return;if(t.max&&u>t.max)return;if(t.min&&u<t.min)return;s={oldValue:t.value,newValue:u,target:o};if(e._trigger("rating",i,s)===!1)return!1;t.value=u,e._resetValue(u,t.ratingMode,t.icons.ratedIconsClass),a.removeClass(t.wijCSS.wijratingHoverStar),e._removeCustomizedIconsClass(t.icons.hoverIconsClass),s={value:u,target:o},c?l&&l[c]?l[c](t,a,function(){e._trigger("rated",i,s)}):r.effects&&(r.effects[c]||r.effects.effect&&r.effects.effect[c])?e._playJqueryAnimation(f,a,function(){r.browser.msie&&parseInt(r.browser.version)<9&&a.css("filter",""),e._trigger("rated",i,s)}):e._trigger("rated",i,s):e._trigger("rated",i,s)}},u={element:e.ratingElement,mouseover:function(e){var n=r(e.target);n=n.closest("."+t.wijCSS.wijratingResetButton),n.addClass(t.wijCSS.wijratingHoverResetButton).addClass(t.wijCSS.stateHover),t.resetButton.customizedHoverClass&&t.resetButton.customizedHoverClass.length&&n.addClass(t.resetButton.customizedHoverClass)},mouseout:function(e){var n=r(e.target);n=n.closest("."+t.wijCSS.wijratingResetButton),n.removeClass(t.wijCSS.wijratingHoverResetButton).removeClass(t.wijCSS.stateHover),t.resetButton.customizedHoverClass&&t.resetButton.customizedHoverClass.length&&n.removeClass(t.resetButton.customizedHoverClass)},click:function(t){var n=r(t.target);e._setOption("value",0),s={target:n},e._trigger("reset",t,s)}};this.ratingElement.on("mouseover.wijrating",n,r.proxy(o.mouseover,o)).on("mouseout.wijrating",n,r.proxy(o.mouseout,o)).on("click.wijrating",n,r.proxy(o.click,o)).on("mouseover.wijrating",i,r.proxy(u.mouseover,u)).on("mouseout.wijrating",i,r.proxy(u.mouseout,u)).on("click.wijrating",i,r.proxy(u.click,u))},t.prototype._createRating=function(){var e=this.ratingElement,t=this.options,n,i,s;e.addClass(t.wijCSS.wijrating).addClass(t.wijCSS.widget),t.orientation==="vertical"&&e.addClass(t.wijCSS.wijvRating),n=r("<div></div>").addClass(t.wijCSS.wijratingResetButton).addClass(t.wijCSS.cornerAll).addClass(t.wijCSS.stateDefault),t.resetButton.customizedClass&&t.resetButton.customizedClass.length&&n.addClass(t.resetButton.customizedClass),n.appendTo(e),n.attr("role","button").attr("aria-label","reset").attr("aria-hidden",!1),t.resetButton.hint&&t.resetButton.hint.length&&n.attr("title",t.resetButton.hint);if(t.resetButton.disabled||t.disabled)n.hide(),n.attr("aria-hidden",!0);i=r("<span></span>"),i.addClass(t.wijCSS.icon).addClass(t.wijCSS.iconClose),n.append(i),s=r("<div></div>"),s.attr("role","radiogroup").addClass(t.wijCSS.wijratingStarContainer),t.resetButton.position==="leftOrTop"?s.appendTo(e):s.prependTo(e),this._createStars(t.split,t.count,s)},t.prototype._createStars=function(e,t,n){var i=this.options,s=i.hint,o,u,a,f=0,l=0,c=0,h=Math.ceil(i.iconWidth/e),p=Math.ceil(i.iconHeight/e),d=i.icons.ratedIconsClass,v,m,g=d&&d.length;n.empty();for(l;l<t*e;l++,c++)a=Math.round((l+1)*i.totalValue*100/t/e)/100,f=Math.round((l+2)*i.totalValue*100/t/e)/100,c===e&&(c=0),u=r("<div></div>"),u.attr("role","radio").attr("aria-checked",!1),i.orientation==="vertical"?u.width(i.iconWidth).height(p):u.width(h).height(i.iconHeight),u.addClass(i.wijCSS.wijratingStar),o=r("<div>"+a+"</div>"),o.addClass(i.wijCSS.wijratingNormalStar).width(i.iconWidth).height(i.iconHeight),u.attr("aria-label",a),c>0&&i.direction==="normal"?i.orientation==="vertical"?o.css({"margin-top":"-"+c*p+"px"}):o.css({"margin-left":"-"+c*h+"px"}):c<e-1&&i.direction==="reversed"&&(i.orientation==="vertical"?o.css({"margin-top":"-"+(e-1-c)*p+"px"}):o.css({"margin-left":"-"+(e-1-c)*h+"px"})),s.disabled||(s.content&&s.content.length?l<=s.content.length&&(o.attr("title",s.content[l]),u.attr("aria-label",s.content[l])):o.attr("title",a)),g&&(typeof d=="string"?m=d:r.isArray(d)&&(v=Math.floor(l/e),d.length>v&&(m=d[v]))),a===i.value||f>i.value&&a<i.value&&i.ratingMode==="single"?(o.addClass(i.wijCSS.wijratingRatedStar),g&&o.addClass(m),u.attr("aria-checked",!0)):a<i.value&&i.ratingMode==="continuous"&&(o.addClass(i.wijCSS.wijratingRatedStar),g&&o.addClass(m)),o.appendTo(u),i.direction==="reversed"?u.prependTo(n):u.appendTo(n);this._addCustomizedIconsClass(i.icons.iconsClass,e)},t.prototype._resetValue=function(e,t,n){var i=this.options,s=r("."+i.wijCSS.wijratingNormalStar,this.ratingElement[0]),o=t||i.ratingMode,u=n&&n.length,a=0,f;r.each(s,function(t,l){var c=r(l),h=parseFloat(c.html()),p;t<s.length-1?p=parseFloat(r(s[t+1]).html()):p=i.direction==="normal"?i.totalValue+1:-1,c.removeClass(i.wijCSS.wijratingRatedStar),c.parent().attr("aria-checked",!1),u&&(typeof n=="string"?(c.removeClass(n),f=n):r.isArray(n)&&(r.each(n,function(e,t){c.removeClass(t)}),i.direction==="reversed"?a=Math.floor((s.length-1-t)/i.split):a=Math.floor(t/i.split),n.length>a&&(f=n[a]))),h===e||p>e&&h<e&&o==="single"?(c.addClass(i.wijCSS.wijratingRatedStar),u&&c.addClass(f),c.parent().attr("aria-checked",!0)):o==="continuous"&&h<e&&(c.addClass(i.wijCSS.wijratingRatedStar),u&&c.addClass(f))})},t.prototype._resetTotalValue=function(e){var t=this.options,n=t.hint,i=r("."+t.wijCSS.wijratingNormalStar,this.ratingElement[0]),s=i.length;r.each(i,function(i,u){var a=r(u),f=Math.round((i+1)*e*100/s)/100,l=parseFloat(a.html());l===t.value&&(t.value=f),a.html(f.toString()),n&&n.length&&n.length>=i&&n[i]&&n[i].length?a.attr("title",n[i]):a.attr("title",f)})},t.prototype._resetHint=function(e){var t=this.options,n=r("."+t.wijCSS.wijratingNormalStar,this.ratingElement[0]);r.each(n,function(t,n){var i=r(n),s=parseFloat(i.html());e&&e.length&&e.length>=t&&e[t]&&e[t].length?i.attr("title",e[t]):i.attr("title",s)})},t.prototype._clearIntentTimer=function(){this.intentTimers&&this.intentTimers.length&&r.each(this.intentTimers,function(e,t){t&&(window.clearTimeout(t),t=null)}),this.intentTimers=[]},t.prototype._playJqueryAnimation=function(e,t,n){var i=this,s=this,o=s.options,u={easing:e.easing},a=e.animated;s._clearIntentTimer(),r.each(t,function(f,l){var c=Math.floor(f/o.split)*e.delay,h;h=window.setTimeout(function(){r(l).hide(a,u,e.duration,function(){if(f!==t.length-1)return;r.each(t,function(f,l){var c=Math.floor(f/o.split)*e.delay,h;h=window.setTimeout(function(){r(l).show(a,u,e.duration,function(){f===t.length-1&&n&&r.isFunction(n)&&n.call(i)})},c),s.intentTimers.push(h)})})},c),s.intentTimers.push(h)})},t.prototype._addCustomizedIconsClass=function(e,t){var n=this,i=n.options,s,o=0,u=0;e&&e.length&&(s=r("."+i.wijCSS.wijratingNormalStar,n.ratingElement[0]),r.each(s,function(i,s){o===t&&(o=0,u++);if(typeof e=="string")r(s).addClass(e);else if(r.isArray(e)){var a=e.length;u<a&&(n.options.direction==="reversed"?r(s).addClass(e[a-u-1]):r(s).addClass(e[u]))}o++}))},t.prototype._addCustomizedHoverIconsClass=function(e,t,n){var i=this.options,s=i.direction,o=i.ratingMode,u=r("."+i.wijCSS.wijratingNormalStar,this.ratingElement[0]),a=u.index(n),f=0,l;if(e&&e.length)if(typeof e=="string")n.addClass(e),o!=="single"&&(s==="reversed"?n.parent().nextAll().children().addClass(e):n.parent().prevAll().children().addClass(e));else if(r.isArray(e))if(o==="single")s==="reversed"?l=u.length-1-a:l=a,f=Math.floor(l/t),e.length>f&&n.addClass(e[f]);else if(s==="reversed")for(l=u.length-1;l>=a;l--)f=Math.floor((u.length-1-l)/t),e.length>f&&r(u[l]).addClass(e[f]);else for(l=0;l<=a;l++)f=Math.floor(l/t),e.length>f&&r(u[l]).addClass(e[f])},t.prototype._removeCustomizedIconsClass=function(e){var t=this.options,n=r("."+t.wijCSS.wijratingNormalStar,this.ratingElement[0]);e&&e.length&&(typeof e=="string"?n.removeClass(e):r.isArray(e)&&r.each(e,function(e,t){n.removeClass(t)}))},t.prototype._parseSelect=function(){var e=this.options,t=[],n=r("option",this.element);n.length&&(e.count=n.length,e.totalValue=n.length,r.each(n,function(n,i){var s=r(i);t.push(s.html()),s.is(":selected")&&(e.value=n+1)}),e.hint.content=t)},t.prototype._parseRadio=function(){var e=this,t=e.options,n=[],i=r("input[type='radio']",e.element);i.length&&(t.count=i.length,t.totalValue=i.length,r.each(i,function(i,s){var u=r(s),a=u.attr("id"),f;a&&a.length>0?(f=r("label[for='"+a+"']",e.element),f.length?n.push(f.html()):n.push("")):n.push(""),u.is(":checked")&&(t.value=i+1)}),t.hint.content=n)},t}(e.wijmoWidget);t.wijrating=i;var s=function(){function e(){this.wijCSS={wijrating:"wijmo-wijrating",wijratingStarContainer:"wijmo-wijrating-starcontainer",wijratingResetButton:"wijmo-wijrating-reset",wijratingHoverResetButton:"wijmo-wijrating-resethover",wijratingStar:"wijmo-wijrating-star",wijratingNormalStar:"wijmo-wijrating-normal",wijratingHoverStar:"wijmo-wijrating-hover",wijratingRatedStar:"wijmo-wijrating-rated",wijvRating:"wijmo-wijrating-vertical"},this.wijMobileCSS={iconClose:"ui-icon-delete"},this.disabled=!1,this.count=5,this.split=1,this.totalValue=5,this.value=0,this.min=null,this.max=null,this.resetButton={disabled:!1,hint:"cancel this rating!",position:"leftOrTop",customizedClass:"",customizedHoverClass:""},this.hint={disabled:!1,content:null},this.orientation="horizontal",this.direction="normal",this.ratingMode="continuous",this.icons={iconsClass:null,hoverIconsClass:null,ratedIconsClass:null},this.iconWidth=16,this.iconHeight=16,this.animation=null,this.rating=null,this.rated=null,this.reset=null,this.hover=null}return e}();i.prototype.options=r.extend(!0,{},e.wijmoWidget.prototype.options,new s),r.wijmo.registerWidget("wijrating",i.prototype),r.mobile&&(r.mobile.selectmenu.prototype.options.initSelector=r.mobile.selectmenu.prototype.options.initSelector+":not( :jqmData(role='wijrating') )"),r.extend(r.wijmo.wijrating,{animations:{scroll:function(e,t,i){var s=e,o=i,u=250,a=500,f="linear",l=250,c=jQuery.makeArray(t);c.reverse(),r.each(c,function(e,n){var i=Math.floor(e/s.split)*l,c={width:0},h,p;h=window.setTimeout(function(){r(n).animate(c,u,f,function(){window.clearTimeout(h);if(e!==t.length-1)return;p=window.setTimeout(function(){r.each(t,function(e,n){var i=Math.floor(e/s.split)*l,a={width:s.iconWidth},c;c=window.setTimeout(function(){var i=this;r(n).animate(a,u,f,function(){window.clearTimeout(c),e===t.length-1&&o&&r.isFunction(o)&&o.call(i)})},i)}),window.clearTimeout(p)},a)})},i)}),i&&r.isFunction(i)&&i.call(n)}}})})(e.rating||(e.rating={}));var t=e.rating})(wijmo||(wijmo={}));;
var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(e){var t=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype._create=function(){var t=this;t._handleChartStyles(),e.prototype._create.call(this),t.chartElement.addClass(t.options.wijCSS.scatter)},t.prototype.destroy=function(){var t=this;t.chartElement.removeClass(t.options.wijCSS.scatter),e.prototype.destroy.call(this)},t.prototype.getScatter=function(e,t){var n=this,r=n.chartElement.data("fields"),i,s,o,u;if(r&&r.chartElements){o=r.chartElements.scatters;if(o&&o.length){s=o.length;if(e<0||e>=s)return i;u=o[e];if(typeof t=="undefined")return u;s=u.length;if(u&&s)return t<0||t>=s?i:u[t]}return i}},t.prototype._paintLegendIcon=function(e,t,n,r,i,s,o,u,a,f){var l=this,c=Math.min(n,r),h,p=a.markerType,d;return h=a.markerStyle,h=$.extend({fill:i.stroke,stroke:i.stroke,opacity:1},h),p||(p="circle"),d=l.canvas.paintMarker(p,e+n/2,t+r/2,3),$(d.node).data("legendIndex",s).data("index",o),l.legendIcons.push(d),d.attr(h),$.wijraphael.addClass($(d.node),u),a.visible===!1&&($(f.node).data("dotOpacity",d.attr("opacity")||1),d.attr("opacity",.3)),d},t.prototype._paintLegend=function(){var t=this,n=t.options,r=[].concat(n.seriesList),i=n.seriesStyles,s=0;$.extend(!0,n,{legend:{size:{width:20,height:10}}}),e.prototype._paintLegend.call(this)},t.prototype._showSerieEles=function(e){$.each(e,function(e,t){t.show(),t.label&&t.label.show(),$(t.element).data("wijchartDataObj")&&($(t.element).data("wijchartDataObj").visible=!0)})},t.prototype._hideSerieEles=function(e){$.each(e,function(e,t){t.hide(),t.label&&t.label.hide(),$(t.element).data("wijchartDataObj")&&($(t.element).data("wijchartDataObj").visible=!1)})},t.prototype._indicatorLineShowing=function(t){e.prototype._indicatorLineShowing.call(this,t),$.each(t,function(e,t){t.dot&&(t.dot.attr(t.hoverStyle),t.dot.scale(1.5,1.5))})},t.prototype._removeIndicatorStyles=function(e){$.each(e,function(e,t){t.dot&&(t.dot.attr(t.style),t.dot.scale(1,1))})},t.prototype._paintTooltip=function(){var t=this,n=t.chartElement,r=n.data("fields");e.prototype._paintTooltip.call(this),t.tooltip&&r&&r.chartElements&&r.chartElements.tooltipTars&&(t.tooltip.setTargets(r.chartElements.tooltipTars),t.tooltip.setOptions({mouseTrailing:!1}))},t.prototype._getTooltipText=function(e,t){var n=$(t).data("wijchartDataObj"),r={data:n,label:n.label,x:n.x,y:n.y,type:n.markerType,target:t,fmt:e};return $.proxy(e,r)()},t.prototype._onBeforeTooltipShowing=function(t){var n=this,r=t.options,i=n.options.hint.style,s=t.target,o,u;s&&($.browser.msie&&parseInt($.browser.version)<9?(o=$(s).data().wijchartDataObj,u=o.style,r.style.stroke=i.stroke||u.stroke||u.fill||"#ffffff"):r.style.stroke=i.stroke||s.getAttribute("stroke")||s.getAttribute("fill")||"#ffffff",s.attrs={stroke:r.style.stroke}),e.prototype._onBeforeTooltipShowing.call(this,t)},t.prototype._clearChartElement=function(){var e=this,t=e.chartElement.data("fields");e.headerEles.length&&($.each(e.headerEles,function(e,t){t.wijRemove(),t=null}),e.headerEles=[]),e.footerEles.length&&($.each(e.footerEles,function(e,t){t.wijRemove(),t=null}),e.footerEles=[]),e.legendEles.length&&($.each(e.legendEles,function(e,t){t.wijRemove(),t=null}),e.legendEles=[]),e.legends.length&&($.each(e.legends,function(e,t){t.wijRemove(),t=null}),e.legends=[]),e.legendIcons.length&&($.each(e.legendIcons,function(e,t){t.wijRemove(),t=null}),e.legendIcons=[]),e.legendDots.length&&($.each(e.legendDots,function(e,t){t=null}),e.legendDots=[]),e.axisEles.length&&($.each(e.axisEles,function(e,t){t.wijRemove(),t=null}),e.axisEles=[]),e.chartLabelEles.length&&($.each(e.chartLabelEles,function(e,t){t.wijRemove(),t=null}),e.chartLabelEles=[]),t&&t.chartElements&&($.each(t.chartElements,function(e,n){n.length&&$.each(n,function(e,t){t[0]!==null&&(t.remove&&t.remove(),n[e]=null)}),t.chartElements[e]=null}),t.chartElements={},$(t.clipRect.element).stop().remove(),t.render.destroy(),t.clipRect.destroy()),e.dataPoints=null,e.pointXs=null,e.canvas.clear(),e.innerState={}},t.prototype._paintPlotArea=function(){var e=this,t=e.options,n;n=new r(this.chartElement,{bounds:e.canvasBounds,widgetName:e.widgetName,canvas:e.canvas,tooltip:e.tooltip,axis:t.axis,animation:t.animation,seriesTransition:t.seriesTransition,seriesList:t.seriesList,seriesStyles:t.seriesStyles,seriesHoverStyles:t.seriesHoverStyles,hint:t.hint,disabled:t.disabled,isXTime:e.axisInfo.x.isTime,isYTime:e.axisInfo.y[0].isTime,zoomOnHover:t.zoomOnHover,mouseDown:$.proxy(e._mouseDown,e),mouseUp:$.proxy(e._mouseUp,e),mouseOver:$.proxy(e._mouseOver,e),mouseOut:$.proxy(e._mouseOut,e),mouseMove:$.proxy(e._mouseMove,e),click:$.proxy(e._click,e),showChartLabels:t.showChartLabels,chartLabelStyle:t.chartLabelStyle,chartLabelFormatString:t.chartLabelFormatString,culture:e._getCulture(),wijCSS:t.wijCSS,widget:this}),n.render()},t}(e.wijchartcore);e.wijscatterchart=t,t.prototype.widgetEventPrefix="wijscatterchart";var n=function(){function e(){this.initSelector=":jqmData(role='wijscatterchart')",this.wijCSS={scatter:"wijmo-wijscatterchart",scatterElement:"wijscatterchart"},this.animation={enabled:!0,duration:2e3,easing:">"},this.showChartLabels=!1,this.seriesTransition={enabled:!0,duration:2e3,easing:">"},this.zoomOnHover=!0,this.mouseDown=null,this.mouseUp=null,this.mouseOver=null,this.mouseOut=null,this.mouseMove=null,this.click=null}return e}();t.prototype.options=$.extend(!0,{},e.wijchartcore.prototype.options,new n),$.wijmo.registerWidget("wijscatterchart",t.prototype);var r=function(){function t(e,t){this.scatters=[],this.chartLabels=[],this.tooltipTars=[],this.seriesEles=[],this.element=e,this.options=t,this._init()}return t.prototype._init=function(){var t=this.element,n=this.options,r=n.bounds,i=n.axis.x.min,s=n.axis.y.min,o=n.axis.x.max,u=n.axis.y.max;this.width=r.endX-r.startX,this.height=r.endY-r.startY,this.plotInfo={minX:i,minY:s,maxX:o,maxY:u,width:this.width,height:this.height,kx:this.width/(o-i),ky:this.height/(u-s)},this.fields=t.data("fields")||{},t.find("svg").length>0?this.chartRender=e.render.createRender(t.find("svg").get(0),t.width(),t.height()):this.chartRender=e.render.createRender(t.children(":first").addClass("vmlcontainer").get(0),t.width(),t.height()),this.clipRect=this.chartRender.clipRect(0,0,0,t.height()),this.g=this.chartRender.g(),this.g.clip(this.clipRect),this.g.add(),this.fields.render=this.chartRender,this.fields.clipRect=this.clipRect},t.prototype.bindLiveEvents=function(){var e=$.isFunction,t=this.options,n=t.wijCSS,r=this.element,i=t.widgetName,s=t.mouseDown,o=t.mouseUp,u=t.mouseOver,a=t.mouseOut,f=t.mouseMove,l=t.click,c=t.zoomOnHover,h=t.seriesHoverStyles,p=t.seriesStyles,d=t.disabled;$("."+n.scatterElement,r[0]).on("mousedown."+i,function(t){if(d)return;if(e(s)){var n=$(t.target).data("wijchartDataObj");n||(n=$(t.target.parentNode).data("wijchartDataObj")),s.call(r,t,n)}}).on("mouseup."+i,function(t){if(d)return;if(e(o)){var n=$(t.target).data("wijchartDataObj");n||(n=$(t.target.parentNode).data("wijchartDataObj")),o.call(r,t,n)}}).on("mouseover."+i,function(t){if(d)return;var n=$(t.target).data("wijchartDataObj"),i,s,o;n||(n=$(t.target.parentNode).data("wijchartDataObj")),o=n.dot,c&&(i=n.seriesIndex,o.attr&&(s=$.extend(!0,{},h[i]),o.attr(s)),document.createElementNS?o.scale(1.5,1.5):o.attr("stroke-width",5)),e(u)&&u.call(r,t,n)}).on("mouseout."+i,function(t){if(d)return;var n=$(t.target).data("wijchartDataObj"),i,s;n||(n=$(t.target.parentNode).data("wijchartDataObj")),s=n.dot,c&&(i=n.seriesIndex,s.attr&&s.attr($.extend(!0,{},p[i]))),document.createElementNS&&s.scale(1,1),e(a)&&a.call(r,t,n)}).on("mousemove."+i,function(t){if(d)return;if(e(f)){var n=$(t.target).data("wijchartDataObj");n||(n=$(t.target.parentNode).data("wijchartDataObj")),f.call(r,t,n)}}).on("click."+i,function(t){if(d)return;if(e(l)){var n=$(t.target).data("wijchartDataObj");n||(n=$(t.target.parentNode).data("wijchartDataObj")),l.call(r,t,n)}})},t.prototype.unbindLiveEvents=function(){var e=this.options,t=e.widgetName,n=e.wijCSS;$("."+n.scatterElement,this.element).off(t).off("."+t)},t.prototype.paintDefaultChartLabel=function(e,t,n){var r=this.options,i=$.extend(!0,{},r.textStyle,r.chartLabelStyle),s,o=r.chartLabelFormatString,u;return r.isYTime?s=Globalize.format(n,"f",r.culture):s=$.round(n,2),o&&o.length&&(s=Globalize.format(s,o,r.culture)),u=this.chartRender.text(e,t,s),u},t.prototype.paintScatters=function(){var e=this,t=e.options,n=t.seriesList,r=t.seriesStyles,i=t.seriesHoverStyles,s=t.isXTime,o=t.isYTime,u=t.bounds,a=this.plotInfo,f=t.wijCSS,l=t.showChartLabels,c=t.chartLabelStyle,h=t.widget;$.each(n,function(t,n){var p=n.data,d,v=n.markerWidth||5,m=r[t],g=i[t],y=p.x,b=p.y,w=[],E=[],S;n=$.extend(!0,{visible:!0,markerType:"circle"},n),d=n.markerType;if(n.display==="exclude")return!0;!m.fill&&m.stroke&&(m.fill=m.stroke);if(y===undefined)return!0;$.each(b,function(r,i){var p=y[r],x=0,T=0,N,C,k,L={};s&&(p=$.toOADate(p)),o&&(i=$.toOADate(i));if(typeof p=="undefined")return!1;isNaN(p)||typeof p=="string"?N=r:N=p,x=u.startX+(N-a.minX)*a.kx,T=u.endY-(i-a.minY)*a.ky,m.opacity&&(m["fill-opacity"]=m.opacity,m["stroke-opacity"]=m.opacity,delete m.opacity),d==="cross"&&m["stroke-width"]!==undefined&&m["stroke-width"]===0&&(m["stroke-width"]=1),C=e.chartRender.symbol(d,x,T,v),C.attr(m),C.add(e.g),C.attr({"class":f.canvasObject+" "+f.scatterElement}),L=$.extend(!1,{dot:C,x:y[r],y:b[r],seriesIndex:t,index:r,markerType:d,type:"scatter",style:m,hoverStyle:g,visible:!0},n),l&&(k=e.paintDefaultChartLabel(x,T-6,b[r]),k.add(e.g),c=$.extend({"font-size":"10px",fill:"#888","font-family":"Arial"},c),k.attr(c),C.label=k,e.chartLabels.push(k)),h.dataPoints=h.dataPoints||{},h.pointXs=h.pointXs||[],S=$.round(x,2),h.dataPoints[S.toString()]||(h.dataPoints[S.toString()]=[],h.pointXs.push(S)),h.dataPoints[S.toString()].push(L),$(C.element).data("wijchartDataObj",L),w.push(C),e.tooltipTars.push($.extend({},C,{node:C.element})),E.push(C),n.visible===!1&&C.hide()}),e.scatters.push(w),e.seriesEles.push(E)})},t.prototype.playAnimation=function(){var e=this,t=e.options,n=t.animation,r=e.element,i=r.css("background-color");n.enabled?(i==="transparent"&&(i="white"),e.clipRect.getCSS?$(e.clipRect.members[0].element).animate({width:r.width()},{duration:n.duration,step:function(t){e.clipRect.width=t;var n=e.clipRect.getCSS();$(this).css(n)}}):$(e.clipRect.element).animate({width:r.width()},{duration:n.duration,step:function(t){e.clipRect.attr("width",t)}})):e.clipRect.getCSS?($(e.clipRect.members[0].element).css({width:r.width()}),e.clipRect.width=r.width(),$(e.clipRect.members[0].element).css(e.clipRect.getCSS())):($(e.clipRect.element).css({width:r.width()}),e.clipRect.attr("width",r.width()))},t.prototype.render=function(){this.paintScatters(),this.playAnimation(),this.unbindLiveEvents(),this.bindLiveEvents(),this.chartEles={animationSet:this.animationSet,tooltipTars:this.tooltipTars,scatters:this.scatters,labels:this.chartLabels},this.fields.chartElements||(this.fields.chartElements={}),this.fields.seriesEles=this.seriesEles,$.extend(!0,this.fields.chartElements,this.chartEles),this.element.data("fields",this.fields)},t}();e.ScatterChartRender=r})(e.chart||(e.chart={}));var t=e.chart})(wijmo||(wijmo={}));var wijmo;(function(e){(function(e){(function(e){function w(e){return typeof e=="string"}function E(e){return typeof e=="number"}function S(e){return e!==undefined&&e!==null}function x(e,t,n){var r="setAttribute",i;return w(t)?S(n)?e[r](t,n):e&&e.getAttribute&&(i=e.getAttribute(t)):S(t)&&$.isPlainObject(t)&&$.each(t,function(t,n){e[r](t,n)}),i}function T(e,t){r&&t&&t.opacity!==undefined&&(t.filter="alpha(opacity="+t.opacity*100+")"),$.extend(e.style,t)}function N(e,n,r){var i=t.createElement(e);return n&&$.extend(i,n),r&&T(i,r),i}function C(e){$.each(e,function(t,n){e[t]&&e[t].destroy&&e[t].destroy(),delete e[t]})}function D(e,t,n){return o?new O(e,t,n):new _(e,t,n)}var t=document,n=$.each,r=$.browser.msie,i=t.documentMode===8,s="http://www.w3.org/2000/svg",o=!!t.createElementNS&&!!t.createElementNS(s,"svg").createSVGRect,u=0,a="div",f="absolute",l="hidden",c="scatterchart-",h="visible",p="visibility",d="px",v="none",m="M",g="L",y=/^r(?:\(([^,]+?)[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*,[\x09\x0a\x0b\x0c\x0d\x20\xa0\u1680\u180e\u2000\u2001\u2002\u2003\u2004\u2005\u2006\u2007\u2008\u2009\u200a\u202f\u205f\u3000\u2028\u2029]*([^\)]+?)\))?/,b=/^(\d{1,3})\-(?:((?:[a-zA-Z]+)|(?:\#[0-9a-fA-F]{6})|(?:\#[0-9a-fA-F]{3}))\-)(?:(?:((?:(?:[a-zA-Z]+)|(?:\#[0-9a-fA-F]{6})|(?:\#[0-9a-fA-F]{3}))(?:\:\d{1,3})?)\-)?)*((?:[a-zA-Z]+)|(?:\#[0-9a-fA-F]{6})|(?:\#[0-9a-fA-F]{3}))$/,k=function(){function e(){}return e.prototype.attr=function(e,t){},e.prototype.scale=function(e,t){},e.prototype.symbolAttr=function(e){},e.prototype.clip=function(e){},e.prototype.crisp=function(e,t,n,r,i){},e.prototype.css=function(e){},e.prototype.getBBox=function(){},e.prototype.show=function(){},e.prototype.hide=function(){},e.prototype.add=function(e){},e.prototype.destroy=function(){},e.prototype.empty=function(){},e.prototype.remove=function(){},e}();e.ChartElement=k;var L=function(){function e(e,t,n){}return e.prototype.destroy=function(){},e.prototype.createElement=function(e){},e.prototype.path=function(e){return this._element},e.prototype.circle=function(e,t,n){return this._element},e.prototype.rect=function(e,t,n,r,i,s){return this._element},e.prototype.setSize=function(e,t){},e.prototype.g=function(e){return this._element},e.prototype.text=function(e,t,n){return this._element},e.prototype.symbol=function(e,t,n,r,i){return this._element},e.prototype.clipRect=function(e,t,n,r){return this._element},e}();e.ChartRender=L;var A=function(e){function i(){e.apply(this,arguments)}return __extends(i,e),i.prototype.init=function(e,n){this.element=t.createElementNS(s,n),this.renderer=e},i.prototype.attr=function(e,t){var n,r,i=this.element,s=this.renderer,o=i.nodeName,u,a=this;if(e===undefined)return;return w(e)&&S(t)&&(n=e,e={},e[n]=t),w(e)?(n=e,o==="circle"&&(n={x:"cx",y:"cy"}[n]||n),a=x(i,n)||this[n]||0,n!=="d"&&n!==p&&(a=parseFloat(a))):e&&$.each(e,function(t,n){u=!1,r=e[t],t==="d"?(r&&r.join&&(r=r.join(" ")),/(NaN| {2}|^$)/.test(r)&&(r="M 0 0"),this.d=r):t==="fill"?r=s._color(r,i,t):o==="circle"&&(t==="x"||t==="y")&&(t={x:"cx",y:"cy"}[t]||t),jQuery.browser.safari&&t==="stroke-width"&&r===0&&(r=1e-6),u||x(i,t,r),i.attrs=i.attrs||{},i.attrs[t]=r}),a},i.prototype.scale=function(e,t){var n=this,r=n.getBBox(),i=-(r.x+r.width/2)/2,s=-(r.y+r.height/2)/2;e===1&&(i=0),t===1&&(s=0),n.attr("transform","matrix("+e+",0,0, "+t+","+i+","+s+")")},i.prototype.symbolAttr=function(e){var t=this;n(["x","y","r","start","end","width","height","innerR"],function(n,r){e[r]?t[r]=e[r]:t[r]=t[r]}),t.attr({d:t.renderer.symbols[t.symbolName](Math.round(t.x*2)/2,Math.round(t.y*2)/2,t.r,{start:t.start,end:t.end,width:t.width,height:t.height,innerR:t.innerR})})},i.prototype.clip=function(e){return this.attr("clip-path","url("+this.renderer.url+"#"+e.id+")")},i.prototype.crisp=function(e,t,n,r,i){var s=this,o,u={},a={},f;e=e||s.strokeWidth||0,f=e%2/2,a.x=Math.floor(t||s.x||0)+f,a.y=Math.floor(n||s.y||0)+f,a.width=Math.floor((r||s.width||0)-2*f),a.height=Math.floor((i||s.height||0)-2*f),a.strokeWidth=e;for(o in a)s[o]!==a[o]&&(s[o]=u[o]=a[o]);return u},i.prototype.css=function(e){var t=this,n=t.element,i=e&&e.width&&n.nodeName==="text",s="",u=function(e,t){return"-"+t.toLowerCase()};return e&&e.color&&(e.fill=e.color),e=$.extend(t.styles,e),t.styles=e,r&&!o?(i&&delete e.width,T(t.element,e)):($.each(e,function(t,n){s+=n.replace(/([A-Z])/g,u)+":"+e[n]+";"}),t.attr({style:s})),t},i.prototype.getBBox=function(){var e,t,n,r=this.rotation,i=r*Math.PI*2/360;try{e=$.extend({},this.element.getBBox())}catch(s){e={width:0,height:0}}return t=e.width,n=e.height,r&&(e.width=Math.abs(n*Math.sin(i))+Math.abs(t*Math.cos(i)),e.height=Math.abs(n*Math.cos(i))+Math.abs(t*Math.sin(i))),e},i.prototype.show=function(){return this.attr({visibility:h})},i.prototype.hide=function(){return this.attr({visibility:l})},i.prototype.add=function(e){var t=this,n=t.renderer,r=e||n,i=r.element||n.box,s=i.childNodes,o=t.element,u=x(o,"zIndex"),a,f,l;e&&t.htmlNode&&(e.htmlNode||(e.htmlNode=[]),e.htmlNode.push(t)),u&&(r.handleZ=!0,u=parseInt(u,10));if(r.handleZ)for(l=0;l<s.length;l++){a=s[l],f=x(a,"zIndex");if(a!==o&&(parseInt(f,10)>u||!S(u)&&S(f)))return i.insertBefore(o,a),t}return i.appendChild(o),t.added=!0,t},i.prototype._safeRemoveChild=function(e){var t=e.parentNode;t&&t.removeChild(e)},i.prototype.destroy=function(){var e=this,t=e.element||{},r=e.shadows,i=e.box,s;t.onclick=t.onmouseout=t.onmouseover=t.onmousemove=null,e.clipPath&&(e.clipPath=e.clipPath.destroy());if(e.stops){for(s=0;s<e.stops.length;s++)e.stops[s]=e.stops[s].destroy();e.stops=null}return e._safeRemoveChild(t),r&&n(r,function(t){e._safeRemoveChild(t)}),i&&i.destroy(),$.each(e,function(t,n){delete e[t]}),null},i.prototype.empty=function(){var e=this.element,t=e.childNodes,n=t.length;while(n--)e.removeChild(t[n]),$(t[n]).remove()},i.prototype.remove=function(){var e=this.element,t=e.parentNode;t.removeChild(e),$(e).remove()},i}(k),O=function(e){function n(t,n,r){e.call(this,t,n,r),this.gradientCache={},this.init(t,n,r)}return __extends(n,e),n.prototype.init=function(e,i,o){var u=this,a=t.location,f;this.symbols=n._symbols,this.Element=A,$(e).is("svg")?(u.box=e,f=new u.Element,f.element=e,f.render=u,u.defs=$("defs",e).get(0),u.gradients={}):(f=u.createElement("svg").attr({xmlns:s,version:"1.1"}),e.appendChild(f.element),u.box=f.element,u.boxWrapper=f,u.defs=this.createElement("defs").add(),u.gradients={},u.setSize(i,o)),u.url=r?"":a.href.replace(/#.*?$/,"")},n.prototype.destroy=function(){var e=this;return e.box=null,C(e.gradients||{}),e.gradients=null,null},n.prototype.createElement=function(e){var t=new this.Element;return t.init(this,e),t},n.prototype.path=function(e){var t=this.createElement("path");return t.attr({d:e,fill:v}),t},n.prototype.circle=function(e,t,n){var r=$.isPlainObject(e)?e:{x:e,y:t,r:n},i=this.createElement("circle");return i.attr(r),i},n.prototype.rect=function(e,t,n,r,i,s){$.isPlainObject(e)&&(t=e.y,n=e.width,r=e.height,i=e.r,s=e.strokeWidth,e=e.x);var o=this.createElement("rect");return o.attr({rx:i,ry:i,fill:v}),o.attr(o.crisp(s,e,t,Math.max(n,0),Math.max(r,0))),o},n.prototype.setSize=function(e,t){var n=this;n.width=e,n.height=t,n.boxWrapper.attr({width:e,height:t})},n.prototype.g=function(e){var t=this.createElement("g");return S(e)&&t.attr({"class":c+e}),t},n.prototype.text=function(e,t,n){$.isPlainObject(e)&&(t=e.y,n=e.text,e=e.x);var r=this.createElement("text");return r.attr({x:e,y:t,"text-anchor":"middle"}),r.element.textContent=n,r},n.prototype.symbol=function(e,t,n,r,i){var s,o=this,u=o.symbols[e],a=u&&u(Math.round(t),Math.round(n),r,i);return a?(s=o.path(a),$.extend(s,{symbolName:e,x:t,y:n,r:r}),i&&$.extend(s,i)):s=o.circle(t,n,r),s},n._symbols={box:function(e,t,n){var r=.707*n;return[m,e-r,t-r,g,e+r,t-r,e+r,t+r,e-r,t+r,"Z"]},tri:function(e,t,n){return[m,e,t-1.33*n,g,e+n,t+.67*n,e-n,t+.67*n,"Z"]},invertedTri:function(e,t,n){return[m,e,t+1.33*n,g,e-n,t-.67*n,e+n,t-.67*n,"Z"]},diamond:function(e,t,n){return[m,e,t-n,g,e+n,t,e,t+n,e-n,t,"Z"]},cross:function(e,t,n){var r=.707*n;return[m,e-r,t-r,g,e+r,t+r,m,e-r,t+r,g,e+r,t-r]},arc:function(e,t,n,r){var i=r.start,s=r.end-1e-6,o=r.innerR,u=Math.cos(i),a=Math.sin(i),f=Math.cos(s),l=Math.sin(s),c=r.end-i<Math.PI?0:1;return[m,e+n*u,t+n*a,"A",n,n,0,c,1,e+n*f,t+n*l,g,e+o*f,t+o*l,"A",o,o,0,c,0,e+o*u,t+o*a,"Z"]}},n.prototype.clipRect=function(e,t,n,r){var i,s=c+u++,o=this.createElement("clipPath");return o.attr({id:s}),$(this.defs).append(o.element),i=this.rect(e,t,n,r,0).add(o),i.id=s,i.clipPath=o,i},n.prototype._parsegradientcolor=function(e){var t=this,n=[],r,i,s,o,u,a,f,l;if(t.gradientCache[e])return t.gradientCache[e];for(s=0,a=e.length;s<a;s++){r={},i=e[s].match(/^([^:]*):?([\d\.]*)/),r.color=Raphael.getRGB(i[1]);if(r.color.error)return null;r.color=r.color.hex,i[2]&&(r.offset=i[2]+"%"),n.push(r)}for(s=1,a=n.length-1;s<a;s++)if(!n[s].offset){o=parseFloat(n[s-1].offset||0),u=0;for(f=s+1;f<a;f++)if(n[f].offset){u=n[f].offset;break}u||(u=100,f=a),u=parseFloat(u),l=(u-o)/(f-s+1);for(;s<f;s++)o+=l,n[s].offset=o+"%"}return t.gradientCache[e]=n,n},n.prototype._color=function(e,t,n){var r=this,i="color",s=.5,o=.5,a=r.gradients,f,l,h,p,d,v,m,g,w,E,S=e,T,N,C;b.test(e)?i="linear":e=e.replace(y,function(e,t,n){i="radial";if(t&&n){s=parseFloat(t),o=parseFloat(n);var r=o>.5?1:-1;Math.pow(s-.5,2)+Math.pow(o-.5,2)>.25&&(o=Math.sqrt(.25-Math.pow(s-.5,2))*r+.5)&&o!==.5&&(o=parseFloat(o.toFixed(5))-1e-5*r)}return""});if(i==="linear"||i==="radial"){l=e.split(/\s*\-\s*/);if(i==="linear"){N=l.shift(),N=-parseFloat(N);if(isNaN(N))return e;g=[0,0,Math.cos(Raphael.rad(N)),Math.sin(Raphael.rad(N))],w=1/(Math.max(Math.abs(g[2]),Math.abs(g[3]))||1),g[2]*=w,g[3]*=w,g[2]<0&&(g[0]=-g[2],g[2]=0),g[3]<0&&(g[1]=-g[3],g[3]=0),h=g[0],p=g[1],d=g[2],v=g[3]}return a[S]?T=x(a[S].element,"id"):(C=this._parsegradientcolor(l),$.each(C,function(e,t){t.offset=t.offset?t.offset:e?"100%":"0%"}),T=c+u++,f=r.createElement(i+"Gradient"),i==="radial"?f.attr({id:T,fx:s,fy:o}):f.attr({id:T,x1:h,y1:p,x2:d,y2:v}),$(this.defs).append(f.element),f.stops=[],$.each(C,function(e,t){var n;m=t.color,E=1,n=r.createElement("stop"),n.attr({offset:t.offset,"stop-color":m,"stop-opacity":E}).add(f),f.stops.push(n)}),a[S]=f),"url(#"+T+")"}return t.removeAttribute(n+"-opacity"),e},n}(L),M=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.init=function(e,t){var n=["<",t,' filled="f" stroked="f"'],r=["position: ",f,";"];(t==="shape"||t===a)&&r.push("left:0;top:0;width:10px;height:10px;"),i&&r.push("visibility: ",t===a?l:h),n.push(' style="',r.join(""),'"/>'),t&&(n=t===a||t==="span"||t==="img"?n.join(""):e.prepVML(n),this.element=N(n)),this.renderer=e},t.prototype.add=function(e){var t=this,n=t.renderer,r=t.element,s=n.box,o=e&&e.inverted,u=e?e.element||e:s;return o,i&&u.gVis===l&&T(r,{visibility:l}),u.appendChild(r),t.added=!0,t},t.prototype.attr=function(e,t){var n,r,s,o=this,u=o.element||{},f=u.style,l=u.nodeName,c=o.symbolName,m=o.renderer,g,y,b=o.shadows,N,C,k=o;return e===undefined?k:(w(e)&&S(t)&&(n=e,e={},e[n]=t),w(e)?(n=e,n==="strokeWidth"||n==="stroke-width"?k=o.strokeweight:k=o[n]):e&&$.each(e,function(t,n){r=n,N=!1;if(c&&/^(x|y|r|start|end|width|height|innerR)/.test(t))y||(o.symbolAttr(e),y=!0),N=!0;else if(t==="d"){r=r||[],o.d=r.join(" "),s=r.length,C=[];while(s--)E(r[s])?C[s]=Math.round(r[s]*10)-5:r[s]==="Z"?C[s]="x":C[s]=r[s];r=C.join(" ")||"x",u.path=r;if(b){s=b.length;while(s--)b[s].path=r}N=!0}else if(t==="zIndex"||t===p){if(i&&t===p&&l===a){u.gVis=r,g=u.childNodes,s=g.length;while(s--)T(g[s],{visibility:r});r===h&&(r=null)}r&&(f[t]=r),N=!0}else t==="class"?u.className=r:t==="stroke"?t="strokecolor":t==="stroke-width"||t==="strokeWidth"?(u.stroked=r?!0:!1,t="strokeweight",o[t]=r,E(r)&&(r+=d)):t==="fill"&&(l==="SPAN"?f.color=r:(u.filled=r!==v?!0:!1,r=m.color(r,u,t),t="fillcolor"));N||(t==="opacity"&&(t="fill-opacity"),i?u[t]=r:x(u,t,r)),u.attrs=u.attrs||{},u.attrs[t]=r}),k)},t.prototype.scale=function(e,t){var n=this,r=n.attr("stroke-width")||0;n.css({filter:"progid:DXImageTransform.Microsoft.Matrix(M11="+e+","+", M12=0, M21=0, M22="+t+", Dx=0, Dy=0, sizingmethod='auto expand')"}).attr("stroke-width",r)},t.prototype.clip=function(e){var t=this,n=e.members;return n.push(t),t.css(e.getCSS(t.inverted))},t.prototype.css=function(e){var t=this,n=t.element,r=e&&n.tagName==="SPAN"&&e.width;return r&&(delete e.width,t.textWidth=r),t.styles=$.extend(t.styles,e),T(t.element,e),t},t.prototype.destroy=function(){var e=this;return e.destroyClip&&e.destroyClip(),A.prototype.destroy.apply(e)},t.prototype.empty=function(){var e=this.element,t=e.childNodes,n=t.length,r;while(n--)r=t[n],r.parentNode.removeChild(r),$(r).remove()},t.prototype.getBBox=function(){var e=this,t=e.element,n=e.bBox;return n||(t.nodeName==="text"&&(t.style.position=f),n=e.bBox={x:t.offsetLeft,y:t.offsetTop,width:t.offsetWidth,height:t.offsetHeight}),n},t}(A),_=function(e){function r(){e.apply(this,arguments),this.isIE8=$.browser.msie&&parseInt($.browser.version)===8}return __extends(r,e),r.prototype.init=function(e,n,i){var s=this,o;this.Element=M,this.symbols=r._symbols,$(e).hasClass("vmlcontainer")?(s.box=e,o=new this.Element,o.element=e,o.render=this,s.boxWrapper=o):(o=s.createElement(a),e.appendChild(o.element),s.box=o.element,s.boxWrapper=o,s.setSize(n,i)),t.namespaces.v||(t.namespaces.add("v","urn:schemas-microsoft-com:vml"),t.createStyleSheet().cssText="v\\:fill, v\\:path, v\\:shape, v\\:stroke{ behavior:url(#default#VML); display: inline-block; } ")},r.prototype.clipRect=function(e,t,r,s){var o=this.createElement();return $.extend(o,{members:[],left:e,top:t,width:r,height:s,getCSS:function(e){var t=this,n=t.top,r=t.left,s=r+t.width,o=n+t.height,u={clip:"rect("+Math.round(e?r:n)+"px,"+Math.round(e?o:s)+"px,"+Math.round(e?s:o)+"px,"+Math.round(e?n:r)+"px)"};return!e&&i&&$.extend(u,{width:s+d,height:o+d}),u},updateClipping:function(){n(o.members,function(e,t){t.css(o.getCSS(t.inverted))})}}),o},r.prototype.color=function(e,t,n){var r,i=this,s="color",o,u,a,f,l=[],c,h,p,d,v=0;b.test(e)?s="linear":e=e.replace(y,function(e,t,n){return s="radial",t&&n&&(t=parseFloat(t),n=parseFloat(n),Math.pow(t-.5,2)+Math.pow(n-.5,2)>.25&&(n=Math.sqrt(.25-Math.pow(t-.5,2))*((n>.5?1:0)*2-1)+.5),p=t+" "+n),""});if(s!=="linear"&&s!=="radial")return h=t.getElementsByTagName(n),h.length&&(h[0].opacity=1),e;o=e.split(/\s*\-\s*/),s==="linear"&&(v=o.shift(),v=-parseFloat(v.toString())),d=i._parsegradientcolor(o),$.each(d,function(e,t){t.offset=t.offset?t.offset:e?"100%":"0%",l.push(t.offset+" "+t.color),u=t.color,e?f=u:a=u}),s==="radial"?r=['<fill colors="',l.join(),'" angle="0"','" focusposition="',p,'" color="',a,'" color2="',f,'" focussize="0 0"',' type="gradientTitle" focus="100%" method="none" />']:r=['<fill colors="',l.join(),'" angle="',v.toString(),'" type="gradient" focus="100%" method="sigma" />'],c=N(i.prepVML(r)),$(t).append(c)},r.prototype.prepVML=function(e){var t="display:inline-block;behavior:url(#default#VML);",n=this.isIE8;return e=e.join(""),n?(e=e.replace("/>",' xmlns="urn:schemas-microsoft-com:vml" />'),e.indexOf('style="')===-1?e=e.replace("/>",' style="'+t+'" />'):e=e.replace('style="','style="'+t)):e=e.replace("<","<v:"),e},r.prototype.path=function(e){var t=this.createElement("shape");return t.attr({coordsize:"100 100",d:e}),t},r.prototype.g=function(e){var t,n;return e&&(n={className:c+e,"class":c+e}),t=this.createElement(a).attr(n),t},r.prototype.text=function(e,t,n){var r=this.createElement("span"),i=r.element,s,o;return i.innerHTML=n,$(i).appendTo("body"),s=$(i).width(),o=$(i).height(),e-=s/2,t-=o/2,r.x=e,r.y=t,$(i).css({position:"absolute","white-space":"nowrap","font-family":"Arial","font-size":"10",left:e+"px",top:t+"px"}),r},r._symbols=$.extend({},O._symbols,{arc:function(e,t,n,r){var i=r.start,s=r.end,o=Math.cos(i),u=Math.sin(i),a=Math.cos(s),f=Math.sin(s),l=r.innerR,c=.07/n,h=l&&.1/l||0;return s-i===0?["x"]:(2*Math.PI-s+i<c?a=-c:s-i<h&&(a=Math.cos(i+h)),["wa",e-n,t-n,e+n,t+n,e+n*o,t+n*u,e+n*a,t+n*f,"at",e-l,t-l,e+l,t+l,e+l*a,t+l*f,e+l*o,t+l*u,"x","e"])},circle:function(e,t,n){return["wa",e-n,t-n,e+n,t+n,e+n,t,e+n,t,"e"]},rect:function(e,t,n,r){if(!S(r))return[];var i=r.width,s=r.height,o=e+i,u=t+s;return n=Math.min(n,i,s),[m,e+n,t,g,o-n,t,"wa",o-2*n,t,o,t+2*n,o-n,t,o,t+n,g,o,u-n,"wa",o-2*n,u-2*n,o,u,o,u-n,o-n,u,g,e+n,u,"wa",e,u-2*n,e+2*n,u,e+n,u,e,u-n,g,e,t+n,"wa",e,t,e+2*n,t+2*n,e,t+n,e+n,t,"x","e"]}}),r}(O);e.createRender=D})(e.render||(e.render={}));var t=e.render})(e.chart||(e.chart={}));var t=e.chart})(wijmo||(wijmo={}));;
var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(e){var t=1e4,n=function(e){function n(){e.apply(this,arguments),this.bubMax=0,this.bubMin=0,this.bubDiff=0}return __extends(n,e),n.prototype._setOption=function(n,r){var i=this,s=i.options;if(n==="minimumSize"||n==="minimumSize")isNaN(r)||r<0?r=0:r>t&&(r=t),s[n]=r,i.redraw();else if(n==="chartLabel")$.extend(s.chartLabel,r),i.redraw();else{if(n==="showChartLabels"||n==="chartLabelStyle")s[n]=r,i._setLabelOption();e.prototype._setOption.call(this,n,r)}n==="seriesList"&&(i.indexs=null,i.bubbleRadius=null)},n.prototype._create=function(){var t=this,n=t.options,r=t._getDefFill();this._handleChartStyles(),t._setLabelOption(),e.prototype._create.call(this),t.chartElement.addClass(n.wijCSS.bubbleChart)},n.prototype._setLabelOption=function(){var e=this.options;e.showChartLabels!==!0&&e.chartLabel.visible===!0&&(e.chartLabel.visible=!1),!$.isPlainObject(e.chartLabel.style)&&$.isPlainObject(e.chartLabelStyle)&&(e.chartLabel.style=e.chartLabelStyle)},n.prototype._clearChartElement=function(){var t=this,n=t.options,r=t.chartElement.data("fields");e.prototype._clearChartElement.call(this),r&&r.bubbleInfos&&$.each(r.bubbleInfos,function(e,t){t.bubble&&t.bubble.wijRemove(),t.dcl&&t.dcl.wijRemove(),t.symbol&&t.symbol.wijRemove()}),r&&r.bubbles&&t._destroyRaphaelArray(r.bubbles),t.element.removeData("plotInfos"),n.seriesTransition.enabled||r&&r.bubblesAnimationInfos&&(r.bubblesAnimationInfos=null)},n.prototype.destroy=function(){var t=this;t.chartElement.removeClass(t.options.wijCSS.bubbleChart+" ui-helper-reset"),t._destroyEles(),e.prototype.destroy.call(this)},n.prototype.getBubble=function(e){return this.chartElement.data("fields").bubbles[e]},n.prototype.redraw=function(t){this.bubbleRadius=null,e.prototype.redraw.call(this,t)},n.prototype._destroyEles=function(){var e=this,t=e.element,n=t.data("fields");n.bubbleInfos&&$.each(n.bubbleInfos,function(t,n){e._removeEle(n.bubble),e._removeEle(n.dcl),e._removeEle(n.symbol),n=null}),t.removeData("fields"),e.bubbleRadius=[]},n.prototype._removeEle=function(e){e&&(e.node&&$(e.node).removeData(),e.wijRemove(),e=null)},n.prototype._paintPlotArea=function(){var e=this,t=this.chartElement,n=e.options,r=n.seriesList,s=r.length,o=[].concat(n.seriesStyles.slice(0,s)),u=[].concat(n.seriesHoverStyles.slice(0,s)),a=e.canvasBounds,f=e.axisInfo.x,l=e.axisInfo.y[0];if(s===0)return;e._prepBubbleData(),this.bubbleChartRender=new i(this.chartElement,{seriesList:r,seriesStyles:o,seriesHoverStyles:u,canvas:e.canvas,bounds:a,xAxisInfo:f,yAxisInfo:l,chartLabel:n.chartLabel,textStyle:n.textStyle,chartLabelStyle:n.chartLabelStyle,chartLabelFormatString:n.chartLabelFormatString,bubbleRadius:e.bubbleRadius,animation:n.animation,seriesTransition:n.seriesTransition,sizingMethod:n.sizingMethod,minimumSize:n.minimumSize,maximumSize:n.maximumSize,mouseDown:$.proxy(e._mouseDown,e),mouseUp:$.proxy(e._mouseUp,e),mouseOver:$.proxy(e._mouseOver,e),mouseOut:$.proxy(e._mouseOut,e),mouseMove:$.proxy(e._mouseMove,e),click:$.proxy(e._click,e),disabled:n.disabled,culture:e._getCulture(),wijCSS:n.wijCSS,shadow:n.shadow,widget:this}),this.bubbleChartRender.render(),e.tooltipbubbles=[],$.each(t.data("fields").bubbleInfos,function(t,n){e.tooltipbubbles.push(n.bubble),n.dcl&&e.tooltipbubbles.push(n.dcl),n.symbol&&e.tooltipbubbles.push(n.symbol)}),e.tooltip&&e.tooltip.setTargets(e.tooltipbubbles)},n.prototype._paintLegendIcon=function(e,t,n,r,i,s,o,u,a,f){var l=this,c=Math.min(n,r),h,p,d;return h=a.markerStyle,h=$.extend({fill:i.fill,stroke:i.stroke,opacity:1},h),a.markers&&(p=a.markers.type),p||(p="circle"),d=l.canvas.paintMarker(p,e+n/2,t+r/2,c/2),$(d.node).data("legendIndex",s).data("index",o),l.legendIcons.push(d),d.attr(h),$.wijraphael.addClass($(d.node),u),d},n.prototype._getbubbleIndexs=function(e,t){var r=this,i=r.options,s=i.axis.x.max,o=i.axis.x.min,u=i.axis.y.min,a=i.axis.y.max,f=[],l=[],c=[],h=[],p=[],d=[],v=-1,m=-1,g=-1,y=-1;r.bubbleRadius=[],r._prepBubbleData(),$.each(i.seriesList,function(v,m){var g=m.data,y=m.markers||{},b=y.type||"circle";if(g.y1===undefined)return!0;$.each(g.y1,function(v,m){var y=n.transform(m,i.maximumSize,i.minimumSize,r.canvasBounds,r.bubMax,r.bubDiff,i.sizingMethod,b),w,E;r._isDate(g.x[v])?w=$.toOADate(g.x[v]):isNaN(g.x[v])?w=v:w=g.x[v],E=g.y[v],r._isDate(E)&&(E=$.toOADate(E)),f.push(w-y*(s-o)/e),l.push(E-y*(a-u)/t),c.push(w+y*(s-o)/e),h.push(E+y*(a-u)/t),p.push(w),d.push(E),r.bubbleRadius.push(y)})}),v=r._getMinIndex(f),m=r._getMinIndex(l),g=r._getMaxIndex(c),y=r._getMaxIndex(h),r.indexs={xMin:{x:p[v],y:d[v],r:r.bubbleRadius[v]},xMax:{x:p[g],y:d[g],r:r.bubbleRadius[g]},yMin:{x:p[m],y:d[m],r:r.bubbleRadius[m]},yMax:{x:p[y],y:d[y],r:r.bubbleRadius[y]}}},n.prototype._calculateParameters=function(t,n){e.prototype._calculateParameters.call(this,t,n);var r=this;if(!n.autoMax&&!n.autoMin)return;r._adjust(n,t)},n.prototype._adjust=function(e,t){var n=e.unitMinor,r=this,i=e.autoMin,s=e.autoMax,o=r.canvasBounds,u={x:o.startX,y:o.startY},a=o.endX-u.x,f=o.endY-u.y,l=t.max,c=t.min,h=e.origin;r.indexs||r._getbubbleIndexs(a,f),t.id==="x"?(i&&(c=r._getMinTick(r.indexs.xMin.x,r.indexs.xMin.r,c,l,a,n)),s&&(l=r._getMaxTick(r.indexs.xMax.x,r.indexs.xMax.r,c,l,a,n))):(i&&(c=r._getMinTick(r.indexs.yMin.y,r.indexs.yMin.r,c,l,f,n)),s&&(l=r._getMaxTick(r.indexs.yMax.y,r.indexs.yMax.r,c,l,f,n)));if(l!==t.max||c!==t.min)h!==null&&h!==undefined&&(h<c?c=h:h>l&&(l=h)),t.min=c,t.max=l,this._calculateMajorMinor(e,t),r._adjust(e,t)},n.prototype._getMinTick=function(e,t,n,r,i,s){return(e-n)*i/(r-n)<t?n-s:n},n.prototype._getMaxTick=function(e,t,n,r,i,s){return(e-n)*i/(r-n)+t>i?r+s:r},n.prototype._getMinIndex=function(e){var t=-1,n=0;return $.each(e,function(e,t){e===0?n=t:t<n&&(n=t)}),$.each(e,function(e,r){if(r===n)return t=e,!1}),t},n.prototype._getMaxIndex=function(e){var t=-1,n=0;return $.each(e,function(e,t){e===0?n=t:t>n&&(n=t)}),$.each(e,function(e,r){if(r===n)return t=e,!1}),t},n.prototype._showSerieEles=function(e){$.each(e,function(e,t){t.bubble&&(t.bubble.show(),t.bubble.shadow&&t.bubble.shadow.show(),t.bubble.tracker&&t.bubble.tracker.show(),$(t.bubble.node).data("wijchartDataObj")&&($(t.bubble.node).data("wijchartDataObj").visible=!0)),t.dcl&&t.dcl.show(),t.symbol&&t.symbol.show()})},n.prototype._hideSerieEles=function(e){$.each(e,function(e,t){t.bubble&&(t.bubble.hide(),t.bubble.shadow&&t.bubble.shadow.hide(),t.bubble.tracker&&t.bubble.tracker.hide(),$(t.bubble.node).data("wijchartDataObj")&&($(t.bubble.node).data("wijchartDataObj").visible=!1)),t.dcl&&t.dcl.hide(),t.symbol&&t.symbol.hide()})},n.prototype._indicatorLineShowing=function(t){e.prototype._indicatorLineShowing.call(this,t),$.each(t,function(e,t){t.bubble&&t.bubble.attr(t.hoverStyle)})},n.prototype._removeIndicatorStyles=function(e){$.each(e,function(e,t){t.bubble&&t.bubble.attr(t.style)})},n.prototype._parseTable=function(){if(!this.element.is("table"))return;var e=this,t=e.element,n=e.options,r=$("caption",t),i=$("thead th",t),s=[],o=$("tbody tr",t),u=null,a=null,f=[],l=[],c=[],h=function(e){var t=$.trim(e);return isNaN(e)||(t=parseFloat(e.toString())),t};r.length&&(n.header=$.extend({visible:!0,text:$.trim($(r[0]).text())},n.header),r.length>1&&(n.footer=$.extend({visibel:!0,text:$.trim($(r[1]).text())},n.footer))),n.legend=$.extend({visible:!0},n.legend),u=$.trim(i.eq(1).text()),o.each(function(e,t){var n=$("td",t);return n.length>=3&&(f.push(h(n.eq(0).text())),l.push(h(n.eq(1).text())),c.push(h(n.eq(2).text()))),this}),a={label:u,legendEntry:!0,data:{x:f,y:l,y1:c}},s.push(a),e.options.seriesList=s},n.prototype._unbindLiveEvents=function(){var e=this;$("."+e.options.wijCSS.bubbleElement,e.chartElement[0]).off(".wijbubblechart").off("wijbubblechart"),e.tooltip&&(e.tooltip.destroy(),e.tooltip=null)},n.prototype._paintTooltip=function(){var t=this,n=t.chartElement.data("fields");e.prototype._paintTooltip.call(this),t.tooltip&&n&&n.trackers&&n.trackers.length&&(t.tooltip.setTargets(n.trackers),t.tooltip.setOptions({relatedElement:n.trackers[0]}))},n.prototype._getTooltipText=function(e,t){var n=$(t.node),r,i;return n.data("owner")&&(n=n.data("owner")),r=n.data("wijchartDataObj"),i={data:r,value:r.value,label:r.label,total:r.total,target:t,fmt:e,x:r.x,y:r.y,y1:r.y1},$.proxy(e,i)()},n.prototype._prepBubbleData=function(){var e=this,t=e.options.seriesList,n=-Number.MAX_VALUE,r=Number.MAX_VALUE,i;$.each(t,function(e,t){i=t.data,i&&i.y1&&$.each(i.y1,function(e,t){n=Math.max(n,t),r=Math.min(r,t)})}),this.bubMax=n,this.bubMin=r,this.bubDiff=n-r},n.transform=function(t,r,i,s,o,u,a,f){var l,c=t,h=r-i,p=s.endX-s.startX,d=s.endY-s.startY;return c<0&&(c=0),u===0?c=1:c/=o,c=n.transformByArea(c,a,f),c*=h,c+=i,l=Math.min(p,d),c*=l/200,c},n.transformByArea=function(t,n,r){var i=t;if(n==="area")switch(r){case"circle":i=Math.sqrt(i/Math.PI);break;case"tri":case"invertedTri":i=Math.sqrt(i/(3*Math.sin(Math.PI/6)*Math.cos(Math.PI/6)));break;case"box":i=Math.sqrt(i/2);break;case"diamond":case"cross":i=Math.sqrt(i/2);break;default:i=Math.sqrt(4*i/Math.PI)}return i},n}(e.wijchartcore);e.wijbubblechart=n,n.prototype.widgetEventPrefix="wijbubblechart";var r=function(){function e(){this.initSelector=":jqmData(role='wijbubblechart')",this.wijCSS={bubbleChart:"wijmo-wijbubblechart",bubbleElement:"wijbubblechart-bubble",bubbleTracker:"bubbletracker",bubbleLabel:"wijbubblechart-label",bubbleSymbol:"wijbubblechart-symbol"},this.minimumSize=5,this.maximumSize=20,this.sizingMethod="diameter",this.animation={enabled:!0,duration:1e3,easing:">"},this.seriesTransition={enabled:!0,duration:400,easing:">"},this.seriesList=[],this.seriesHoverStyles=[{opacity:1,"stroke-width":5},{opacity:1,"stroke-width":5},{opacity:1,"stroke-width":5},{opacity:1,"stroke-width":5},{opacity:1,"stroke-width":5},{opacity:1,"stroke-width":5},{opacity:1,"stroke-width":5},{opacity:1,"stroke-width":5},{opacity:1,"stroke-width":5},{opacity:1,"stroke-width":5},{opacity:1,"stroke-width":5},{opacity:1,"stroke-width":5}],this.chartLabel={position:"inside",compass:"north",visible:!0,style:{},chartLabelFormatString:""},this.mouseDown=null,this.mouseUp=null,this.mouseOver=null,this.mouseOut=null,this.mouseMove=null,this.click=null}return e}();n.prototype.options=$.extend(!0,{},e.wijchartcore.prototype.options,new r),$.wijmo.registerWidget("wijbubblechart",n.prototype);var i=function(){function t(e,t){this.element=e,this.options=t,this._init()}return t.prototype._init=function(){var e=this.options,t=e.bounds;this.fields=this.element.data("fields")||{},this.canvas=e.canvas,this.seriesList=$.arrayClone(e.seriesList),this.seriesStyles=e.seriesStyles,this.seriesHoverStyles=e.seriesHoverStyles,this.startLocation={x:t.startX,y:t.startY},this.width=t.endX-this.startLocation.x,this.height=t.endY-this.startLocation.y,this.seriesEles=[],this.bubbles=[],this.bubbleInfos=[],this.trackers=this.canvas.set(),this.currentIndex=0},t.prototype.initAnimationState=function(e,t){var n=e.bubble,r=e.symbol,i;n.type==="circle"?n.attr({r:1e-4,cx:t.startX,cy:t.endY}):(i=n.wijGetBBox(),n.transform("t"+(t.startX-i.x)+","+(t.endY-i.y)+"s0.001..."),n.shadow&&n.shadow.transform("t"+(t.startX-i.x)+","+(t.endY-i.y)+"s0.001...")),r&&r.hide()},t.prototype.playAnimation=function(){var e=this,t=e.options,n=t.animation,r=t.bounds,i=e.fields.bubblesAnimationInfos,s=[],o=e.fields.bubbleInfos,u=t.seriesTransition,a,f,l;n&&n.enabled?(a=n.duration||400,f=n.easing,$.each(o,function(t,n){var o=n.bubble,c,h,p=o.wijGetBBox();o.type==="circle"?c={r:o.attr("r"),cx:o.attr("cx"),cy:o.attr("cy")}:c={transform:o.matrix.toTransformString(),"stroke-width":o.attr("stroke-width"),width:p.width,x:p.x,y:p.y},o.shadow&&o.shadow.hide(),i&&u.enabled?(h=i[t],h?(o.type==="circle"?o.attr({cx:h.cx,cy:h.cy,r:h.r}):(p=o.wijGetBBox(),l=h.width/p.width,c.transform=o.matrix.toTransformString(),o.transform(Raphael.format("s{0}t{1}{2}...",l,h.x-p.x,h.y-p.y)),o.shadow&&o.shadow.transform(Raphael.format("s{0}t{1}{2}...",l,h.x-p.x,h.y-p.y))),a=u.duration,f=u.easing):e.initAnimationState(n,r)):e.initAnimationState(n,r),s.push(c),o.wijAnimate(c,a,f,function(){$(n.bubble.node).data("wijchartDataObj")&&$(n.bubble.node).data("wijchartDataObj").visible&&(n.dcl&&n.dcl.show(),n.symbol&&(n.symbol.show(),n.bubble.wijAttr("opacity",.1)),o.shadow&&o.shadow.show())})}),e.fields.bubblesAnimationInfos=s):$.each(o,function(e,t){$(t.bubble.node).data("wijchartDataObj")&&$(t.bubble.node).data("wijchartDataObj").visible&&(t.dcl&&t.dcl.show(),t.symbol&&t.symbol.show())})},t.prototype.getSymbol=function(e,t){var n;return $.each(e,function(e,r){if(e===t)return n=r,!1}),n},t.prototype.getLabelVisible=function(e,t){var n=!0;return $.each(e,function(e,r){if(t===r)return n=!1,!1}),n},t.prototype.paintMarker=function(e,t,n,r){var i;return this.canvas[e]&&(i=this.canvas[e](t,n,r)),i},t.prototype.getLabelBox=function(e){var t=this.canvas.text(0,0,e),n=t.wijGetBBox(),r;return r={width:n.width,height:n.height},t.remove(),r},t.prototype.applyLabelCompass=function(e,t){var n=this.options.chartLabel.compass||"north",r=this.getLabelBox(t),i=e.r;switch(n){case"north":e.y-=i+r.height/2;break;case"south":e.y+=i+r.height/2;break;case"east":e.x+=i+r.width/2;break;case"west":e.x-=i+r.width/2}},t.prototype.paintDefaultChartLabel=function(e,t){var n=this.options,r=n.chartLabel,i=n.culture,s=$.extend(!0,{},n.textStyle,n.chartLabelStyle,r.style),o=$.round(t,2),u=r.chartLabelFormatString===""?n.chartLabelFormatString:r.chartLabelFormatString,a=this.options.widget,f;return u&&u.length&&(o=Globalize.format(o,u,i)),f=a._text.call(a,e.x,e.y,o).attr(s),f},t.prototype.paintbubble=function(t,r,i,s,o,u,a,f){var l=t.data,c=s.min,h=o.min,p=s.max,d=o.max,v=u/(p-c),m=a/(d-h),g=[],y=this.options,b=this,w=y.bounds,E=y.wijCSS,S=y.widget,x=y.chartLabel,T=y.bubbleRadius,N,C,k,L;if(l.y1===undefined)return;$.each(l.y1,function(u,a){if(l.x===undefined||l.y===undefined)return!0;var f=l.x[u],h=l.y[u],p=t.markers||{},A=p.type||"circle",O=p.symbol,M=t.invisibleMarkLabels||[],_,D,P,H,B,j,F,I,q,R;T?(q=T[b.currentIndex],b.currentIndex++):q=n.transform(a,y.maximumSize,y.minimumSize,y.bounds,b.options.widget.bubMax,b.options.widget.bubDiff,y.sizingMethod,A),s.isTime?f=$.toOADate(f):isNaN(f)&&(f=u),o.isTime&&(h=$.toOADate(h)),B=w.startX+(f-c)*v,j=w.startY+(d-h)*m,O&&(F=b.getSymbol(O,u)),H=b.paintMarker(A,B,j,q),H.attr(r),F&&(C=F.width||q*2,k=F.height||q*2,I=b.canvas.image(F.url,B-q,j-q,C,k)),b.options.shadow&&e.ChartUtil.paintShadow(H,2,null),$.wijraphael.addClass($(H.node),E.canvasObject+" "+E.bubbleElement),F&&H.attr("opacity",.1),P=$.extend(!1,{index:u,bubble:H,style:r,y1:a,x:f,y:h,type:"bubble",hoverStyle:i,visible:!0},t),F&&(P.symbol=!0,P.hoverStyle=$.extend({},i,{opacity:.1}),$(I.node).data("wijchartDataObj",P),$.wijraphael.addClass($(I.node),E.bubbleSymbol)),$(H.node).data("wijchartDataObj",P),S.dataPoints=S.dataPoints||{},S.pointXs=S.pointXs||[],L=$.round(B,2),S.dataPoints[L.toString()]||(S.dataPoints[L.toString()]=[],S.pointXs.push(L)),S.dataPoints[L.toString()].push(P),R=H.clone(),$.browser.msie&&parseInt($.browser.version)<9?R.attr({opacity:.01,fill:"white","stroke-width":0,"fill-opacity":.01}):R.attr({opacity:.01,fill:"white","fill-opacity":.01}),$(R.node).data("owner",$(H.node)),$.wijraphael.addClass($(R.node),E.canvasObject+" "+E.bubbleElement+" "+E.bubbleTracker),H.tracker=R,b.trackers.push(R),b.bubbles.push(H),b.fields.bubbles=b.bubbles,_={x:B,y:j,r:q},x.visible&&b.getLabelVisible(M,u)&&(x.position==="outside"&&b.applyLabelCompass(_,a),N=b.paintDefaultChartLabel(_,a),N.hide(),$(N.node).data("wijchartDataObj",P),$.wijraphael.addClass($(N.node),E.bubbleLabel)),D={bubble:H,dcl:N,symbol:I},b.bubbleInfos.push(D),g.push(D),t.visible===!1&&(H.hide(),N&&N.hide(),R.hide(),I&&I.hide())}),b.fields.bubbleInfos=b.bubbleInfos,b.seriesEles.push(g)},t.prototype.paintBubbles=function(){var e=this,t=e.options,n=t.xAxisInfo,r=t.yAxisInfo;$.each(e.seriesList,function(t,i){var s=e.seriesStyles[t],o=e.seriesHoverStyles[t];e.paintbubble(i,s,o,n,r,e.width,e.height,e.startLocation)})},t.prototype.bindLiveEvents=function(e,t,n,r,i,s,o,u){var a=this.options,f=a.wijCSS,l={mousedown:function(n){if(u)return;var r=$(n.target),i;r.data("owner")&&(r=r.data("owner")),i=r.data("wijchartDataObj"),t.call(e,n,i)},mouseup:function(t){if(u)return;var r=$(t.target),i;r.data("owner")&&(r=r.data("owner")),i=r.data("wijchartDataObj"),n.call(e,t,i)},mouseover:function(t){if(u)return;var n=$(t.target),i,s;n.data("owner")&&(n=n.data("owner")),i=n.data("wijchartDataObj"),s=i.bubble,i.hoverStyle?(s.attr(i.hoverStyle),s.shadow&&s.shadow.attr(i.hoverStyle)):s&&s.attr({opacity:"0.8"}),r.call(e,t,i)},mouseout:function(t){if(u)return;var n=$(t.target),r,s;n.data("owner")&&(n=n.data("owner")),r=n.data("wijchartDataObj"),s=r.bubble;if(r.symbol)return;r.hoverStyle?(r.hoverStyle["stroke-width"]&&!r.style["stroke-width"]&&(s.attr("stroke-width",""),s.shadow&&s.shadow.attr("stroke-width","")),s.wijAttr({transform:""}),s.wijAttr(r.style),r.style.opacity&&(s.attr("opacity",r.style.opacity),s.shadow&&s.shadow.attr("opacity",r.style.opacity))):s&&s.attr({opacity:"1"}),i.call(e,t,r)},mousemove:function(t){if(u)return;var n=$(t.target),r,i;n.data("owner")&&(n=n.data("owner")),r=n.data("wijchartDataObj"),s.call(e,t,r)},click:function(t){if(u)return;var n=$(t.target),r;n.data("owner")&&(n=n.data("owner")),r=n.data("wijchartDataObj"),o.call(e,t,r)}};$.each(["click","mouseover","mouseout","mousemove","mousedown","mouseup"],function(t,n){$("."+f.bubbleTracker,e).on(n+".wijbubblechart",l[n])})},t.prototype.render=function(){var e=this.options,t=e.mouseDown,n=e.mouseUp,r=e.mouseOver,i=e.mouseOut,s=e.mouseMove,o=e.click,u=e.disabled;this.paintBubbles(),this.fields.seriesEles=this.seriesEles,this.playAnimation(),this.trackers.toFront(),this.fields.trackers=this.trackers,this.bindLiveEvents(this.element,t,n,r,i,s,o,u),this.element.data("fields",this.fields)},t}();e.BubbleChartRender=i})(e.chart||(e.chart={}));var t=e.chart})(wijmo||(wijmo={}));;
var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(t){"use strict";var n=jQuery,r="wijcarousel",i="wijmo-wijcarousel-",s="wijmo-wijcarousel ",o=i+"list",u=i+"item ",a=i+"clip",f=i+"current",l=i+"horizontal-multi",c=i+"horizontal",h=i+"button",p=i+"vertical-multi",d=i+"vertical",v=i+"button-next",m=i+"button-previous",g=i+"preview",y="<a><span></span></a>",b=".wijmo-wijcarousel-pager,."+h+",."+v+",."+m,w="<div></div>",E='<li class="wijmo-wijcarousel-page"><a></a></li>',S="li.wijmo-wijcarousel-page",x=".wijmo-wijcarousel-text,.wijmo-wijcarousel-caption",T=1,N=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype._handleDisabledOption=function(e,t){var r=this,i=r.options;r.pager&&!r.pager.is(":hidden")&&(r.disabledEles=r.disabledEles.add(r.pager)),e?(r.element.addClass(i.wijCSS.stateDisabled),r.disabledDiv.length||r._createDisabledDiv(),r.disabledDiv.appendTo("body")):r.disabledDiv&&(r.element.removeClass(i.wijCSS.stateDisabled),r.disabledDiv.remove(),r.disabledDiv=n()),r._applyBtnClass()},t.prototype._createDisabledDiv=function(){var e=this,t=e.options;e.disabledEles.each(function(r,i){var s=n(i),o=s.offset(),u=s.outerWidth(),a=s.outerHeight(),f=n("<div></div>").addClass(t.wijCSS.stateDisabled).css({"z-index":"99999",position:"absolute",width:u,height:a,left:o.left,top:o.top});n.browser.msie&&(f.css("background-color","white"),n.browser.version==="9.0"&&f.css("opacity","0.1")),e.disabledDiv=e.disabledDiv.add(f)})},t.prototype._initStates=function(e,t){var r=this;r.count=0,r.currentIdx=e.start,r.timeout=null,r.isHorizontal=e.orientation==="horizontal",r.width=t.width()||640,r.height=t.height()||480,r.offset=0,r.disabledEles=t,r.disabledDiv=n()},t.prototype._set_showControlsOnHover=function(e){var t=this;t.container.unbind("mouseenter."+t.widgetName),t.container.unbind("mouseleave."+t.widgetName),e&&t.container.bind("mouseenter."+t.widgetName,function(){t._showControls()}).bind("mouseleave."+t.widgetName,function(){t._hideControls()}),t.container.find(b).stop(!0,!0)[e?"hide":"show"]()},t.prototype._create=function(){var e=this,t=e.options,r=e.element;window.wijmoApplyWijTouchUtilEvents&&(n=window.wijmoApplyWijTouchUtilEvents(n)),e._initStates(t,r),e._createDom(e.isHorizontal),e.list.bind("click."+e.widgetName,n.proxy(e._itemClick,e)),t.showControlsOnHover&&(e.container.bind("mouseenter."+e.widgetName,function(){e._showControls()}).bind("mouseleave."+e.widgetName,function(){e._hideControls()}),e.container.find(b).hide()),t.loadCallback&&n.isFunction(t.loadCallback)&&e._trigger("loadCallback",null,e),this.clip&&(this.disabledEles=this.clip);if(t.disabledState){var i=t.disabled;e.disable(),t.disabled=i}else t.auto&&e.play();t.disabled&&e.disable();try{t.display=parseFloat(t.display)}catch(s){t.display=1}e.element.is(":hidden")&&e.element.wijAddVisibilityObserver&&e.element.wijAddVisibilityObserver(function(){e.refresh(),e.element.wijRemoveVisibilityObserver&&e.element.wijRemoveVisibilityObserver()},"wijcarousel")},t.prototype._showControls=function(){this.container.find(b).stop(!0,!0).fadeIn(600,function(){n(this).css("opacity","")})},t.prototype._hideControls=function(){this.container.find(b).stop(!0,!0).fadeOut(600)},t.prototype._applyContainerStyle=function(e,t){var n=this,r=n.options,i={},s=n.list,o=0,u,a=0,f=e?"left":"top",l=0,c,h=e?"width":"height";u=n.itemBound[e?"w":"h"],n.count=n.list.children("li").length,o=n.count*u,n.list[h](o),n.clip[h](r.display*u),n.clip[e?"height":"width"](n.itemBound[e?"h":"w"]);if(!r.loop)i[f]=-u*n.currentIdx,s.css(i);else{c=s.find(">li:first"),r.preview&&!!t&&(c=c.next()),l=c.data("itemIndex");for(l;l<n.currentIdx;l++)s.children("li:first").appendTo(s);if(r.preview){if(!t)for(l=0;l<T;l++)s.children("li:last").prependTo(s);a=-u*T}i[f]=a,s.css(i)}},t.prototype._applyListStyle=function(){var e=this,t=e.options,n=t.orientation==="horizontal",r=0,i,s=n?"width":"height";e.itemBound=e._getItemBound(),i=e.itemBound[n?"w":"h"],r=e.count*i,e.list[s](r)},t.prototype._createButtons=function(e,t){var r=this,i=r.options,s,o=i.wijCSS.stateDisabled;n.each(["prevBtn","nextBtn"],function(u,a){var f=i[a+"Class"],l=a==="nextBtn",c=l?"next":"previous",h=l?v:m,p=l?t:e;f&&f.defaultClass?(o=f.disableClass||o,s=f.hoverClass,r[a]=n('<a class="'+i.wijCSS.stateDefault+'"></a>').addClass(f.defaultClass).mouseover(function(){n(this).hasClass(o)||n(this).addClass(s)}).mouseout(function(){n(this).hasClass(o)||n(this).removeClass(s)})):r[a]=n(r._createBtn(h,p)),r[a].bind("click."+r.widgetName,function(e){if(r.options.disabled)return;var t=n(this);if(t.hasClass(i.wijCSS.stateDisabled))return;r[c].call(r)}).appendTo(r.container)})},t.prototype._applyBtnClass=function(){var e=this,t=e.options,r=t.wijCSS.stateDisabled,i=t.wijCSS.stateHover;n.each(["prevBtn","nextBtn"],function(n,s){var o=t[s+"Class"],u,a=e[s];o&&(r=o.disableClass||r,i=o.hoverClass||i),u=s==="prevBtn"?e.currentIdx<=0:e.currentIdx+t.display>=e.count,u&&!t.loop||t.disabled?a.removeClass(i).addClass(r):a.hasClass(r)&&a.removeClass(r)})},t.prototype._applyBtnStyle=function(e){var t=this,n=0,r,i=t.options.wijCSS,s={collision:"none",of:t.container,my:e?"right{offset} center":"center bottom{offset}",at:e?"right center":"center bottom"},o={collision:"none",of:t.container,my:e?"left{offset} center":"center top{offset}",at:e?"left center":"center top"},u=t.options.buttonPosition==="inside",a,f,l=["cornerBottom","cornerTop","cornerRight","cornerLeft"],c=(e?1:0)*2+(u?1:0),h=(e?1:0)*2+(u?0:1),p=function(e,t,n,r,i){var s="";e.removeClass(t).addClass(n),!isNaN(r)&&r!==0&&(r>0?s="+"+r:s="-"+ -r),i.my=i.my.replace(/\{offset\}/,s),e.position(i)};n=e?t.prevBtn.width():t.prevBtn.height(),r=u?0:n,a=i[l[c]],f=i[l[h]],p(t.nextBtn,f,a,r,s),p(t.prevBtn,a,f,-r,o),t._applyBtnClass()},t.prototype._createDom=function(e){var t=this,r=t.options,i=t.element,u,a,f,h;if(i.is("div"))t.list=i.children("ul:eq(0)"),t.container=t.element,t.list.length||(t.list=n("<ul></ul>").appendTo(t.container));else{if(!i.is("ul"))return;t.list=i,t.container=i.parent()}t.itemBound=t._getItemBound(),e?(u=r.display>1&&!r.preview?l:c,a=r.wijCSS.iconArrowRight,f=r.wijCSS.iconArrowLeft):(u=r.display>1&&!r.preview?p:d,a=r.wijCSS.iconArrowDown,f=r.wijCSS.iconArrowUp),t.list.addClass(o).addClass(r.wijCSS.helperClearFix),h=s+r.wijCSS.widget+" "+u+" "+(r.preview?g+" ":"")+(r.display>1?r.wijCSS.content+" "+r.wijCSS.cornerAll:""),t.container.addClass(h),t._createItems(e),t._createClip(e),t._applyContainerStyle(e),t._createButtons(f,a),t._applyBtnStyle(e),r.preview&&t._createPreview(),r.showTimer&&t._createTimer(),r.showPager&&t._createPager(),r.showControls&&t._createControls()},t.prototype._createPreview=function(){var e=this,t=e.options,n,r,i=t.orientation==="horizontal",s=i?"left":"top",o=i?"right":"bottom",u,a;r=e.itemBound[i?"w":"h"],n=e.offset=Math.round(r/4),u=t.display*r+n*2,e.clip[i?"width":"height"](u),e.list.css(s,function(e,t){return parseFloat(t)+n}),e.clip.css(s,function(e,t){return-n}),e.container.css("margin-"+s,n+"px").css("margin-"+o,n+"px"),e.list.find(x).hide();for(a=0;a<t.display;a++)e._getItemByIndex(e.currentIdx+a).find(x).show()},t.prototype._createItemsFromData=function(e){var t=this;if(!n.isArray(e)||!e.length||!n.isPlainObject(e[0])||n.isEmptyObject(e[0]))return;t.list.empty(),n.each(e,function(e,r){var i;if(!n.isPlainObject(r))return!0;i=t._generateMarkup(r),t.list.append(i)})},t.prototype._generateMarkup=function(e){var t,r;if(!n.isPlainObject(e))return;return t=n("<li></li>"),typeof e.linkUrl=="string"&&e.linkUrl&&(r=n("<a>").attr("href",e.linkUrl),r.appendTo(t)),typeof e.imageUrl=="string"&&e.imageUrl&&n("<img>").attr("src",e.imageUrl).appendTo(r||t),typeof e.caption=="string"&&e.caption&&n("<span>").html(e.caption).appendTo(t),t},t.prototype._createItems=function(e){var t=this,r,i,s=t.options,o,u;if(t.list){t._createItemsFromData(s.data),t.list.children("li").each(function(e,r){var i=n(r);t._createItem(i,e)}),o=t.list.children("li").eq(t.currentIdx).addClass(f);if(s.preview&&s.display>1){r=u=o;for(i=0;i<s.display-1;i++)u=u.next(),r=r.add(u);r.find("div.wijmo-wijcarousel-mask").css({opacity:0})}}},t.prototype._createItem=function(e,t){var r=this,i=r.options,s,o;return s=e.addClass(u).addClass(i.wijCSS.helperClearFix).find("img:eq(0)").attr("role","img").addClass("wijmo-wijcarousel-image"),r._applyItemBound(e),o=e.children("span:eq(0)").hide(),r._createCaption(e,s,o),i.preview&&n('<div class="wijmo-wijcarousel-mask">').appendTo(e),e.data("itemIndex",t),e},t.prototype._applyItemBound=function(e){var t=this,n=t.itemBound.w,r=t.itemBound.h;if(!t.itemWidth||!t.itemHeight)e.width(n).height(r),t.itemWidth=n-(e.outerWidth(!0)-n),t.itemHeight=r-(e.outerHeight(!0)-r);e.width(t.itemWidth).height(t.itemHeight)},t.prototype._createCaption=function(e,t,r){var i=this,s=i.options,o,u,a,f,l;s.showCaption&&(o=r.html()||t.attr("title"),o&&o.length&&(a=n("<span></span>").html(o),f=n(w).addClass([s.wijCSS.helperClearFix,"wijmo-wijcarousel-caption"].join(" ")).appendTo(e),u=n(w).addClass([s.wijCSS.helperClearFix,s.wijCSS.content,"wijmo-wijcarousel-text"].join(" ")).append(a).appendTo(e),i._applyCaptionStyle(f,u)))},t.prototype._applyCaptionStyle=function(e,t){var r=e.add(t),i;r.width(this.itemWidth),n.browser.webkit?(i=t.children("span").css("display","inline-block").height(),t.children("span").css("display","")):i=t.children("span").height(),r.height(i)},t.prototype._showCaption=function(e,t){var n=this,r=n._getItemByIndex(e),i=r.find(".wijmo-wijcarousel-text"),s=r.find(".wijmo-wijcarousel-caption");i.length&&i.fadeIn(300,function(){e<t&&n._showCaption(e+1,t)}),s.length&&(s.show(),s.animate({opacity:.5},300))},t.prototype._hideCaption=function(){this.element.find(x).hide()},t.prototype._createClip=function(e){this.clip=this.list.wrap("<div></div>").parent().addClass(a)},t.prototype._createBtn=function(e,t){var r=n(y),i=this.options;return r.addClass(i.wijCSS.stateDefault+" "+e).attr("role","button").mouseover(function(){n(this).hasClass(i.wijCSS.stateDisabled)||n(this).addClass(i.wijCSS.stateHover)}).mouseout(function(){n(this).hasClass(i.wijCSS.stateDisabled)||n(this).removeClass(i.wijCSS.stateHover)}).children("span:eq(0)").addClass(i.wijCSS.icon+" "+t),r},t.prototype._createControls=function(){var e=this,t=e.options,r={collision:"none",of:e.container,my:"center bottom",at:"center bottom"};t.control&&(e.controls=n(t.control).css({position:"absolute"}).appendTo(e.container),n.extend(r,t.controlPosition),e.controls.position(r))},t.prototype._createTimer=function(){var e=this,t=e.options;e._createPausePlay(),e.progressBar=n("<div></div>").addClass("wijmo-wijcarousel-timerbar-inner "+t.wijCSS.cornerAll).css({width:"0%"}).attr("role","progressbar"),e.timer=n("<div></div>").addClass("wijmo-wijcarousel-timerbar "+t.wijCSS.cornerAll).appendTo(e.container).append(e.progressBar).append(e.playPauseBtn)},t.prototype._createPausePlay=function(){var e=this,t=e.options;e.playPauseBtn=n(e._createBtn(h,t.auto?t.wijCSS.iconPause:t.wijCSS.iconPlay)).bind("click."+e.widgetName,function(){var r=n(this).children("span:eq(0)");e[r.hasClass(t.wijCSS.iconPlay)?"play":"pause"]()})},t.prototype._createPagingItem=function(e,t,r,i){var s=n(E).attr({role:"tab","aria-label":i+1,title:i+1}).addClass(this.options.wijCSS.stateDefault),o,u;if(e)s.addClass("wijmo-wijcarousel-dot");else{if(!(t&&t.images&&t.images[i]))return;o=t.imageWidth,u=t.imageHeight,o&&u&&s.width(o).height(u),s.children("a").append(n("<img>").attr("src",t.images[i]))}r.append(s)},t.prototype._createPaging=function(e){var t=this,r=t.options,i,s,o,u=r.thumbnails,a=e==="dots";t.container.append(t.pager=n('<div><ul class="wijmo-list '+r.wijCSS.cornerAll+" "+r.wijCSS.helperClearFix+' role="tablist"></ul></div>')),a||t.pager.addClass("wijmo-wijcarousel-thumbnails"),s=t.pager.children("ul.wijmo-list");for(i=0;i<t.count;i++)t._createPagingItem(a,u,s,i);o=t.pager.find("li").eq(t.currentIdx),o.length&&t._activePagerItem(o),u&&n.each(["mousedown","mouseup","mouseover","mouseout","click"],function(e,t){var n=u[t];n&&typeof n=="string"&&window[n]&&(u[t]=window[n])}),t.pager.bind("mouseover."+t.widgetName,function(e){t._pageingEvents(e,"mouseover",u,a,function(e){e.addClass(r.wijCSS.stateHover)})}).bind("mouseout."+t.widgetName,function(e){t._pageingEvents(e,"mouseout",u,a,function(e){e.removeClass(r.wijCSS.stateHover)})}).bind("click."+t.widgetName,function(e){t._pageingEvents(e,"click",u,a,function(e){t.scrollTo(e.index()),t._activePagerItem(e)})}),a||n.each(["mousedown","mouseup"],function(e,r){n.isFunction(u[r])&&t.pager.bind(r,function(e){var t=n(e.target).closest(S);t.length&&u[r].call(t,e)})})},t.prototype._pageingEvents=function(e,t,r,i,s){var o=n(e.target).closest(S);o.length&&(n.isFunction(s)&&s.call(e,o),!i&&n.isFunction(r[t])&&r[t].call(o,e))},t.prototype._activePagerItem=function(e){var t=this.options.wijCSS.stateActive;e.addClass(t).attr("aria-selected","true").siblings("li").removeClass(t).removeAttr("aria-selected")},t.prototype._createWijSlider=function(){var e=this,t=e.options.sliderOrientation,r={orientation:t,range:!1,min:0,max:e.count-1,step:1,value:e.currentIdx,buttonClick:function(t,n){var r=n.value;e.scrollTo(r)},slide:function(t,n){var r=n.value;e.scrollTo(r)}},i=n("<div></div>").css("margin-bottom","10px").css(t==="horizontal"?"width":"height","200px").appendTo(e.container);e.pager=i.wijslider(r).parent().wrap("<div>").parent().addClass("wijmo-wijcarousel-slider-wrapper")},t.prototype._createWijPager=function(){var e=this,t={pageCount:e.count,pageIndex:e.currentIdx,pageButtonCount:e.count,mode:"numeric",pageIndexChanged:function(t,n){var r=n.newPageIndex;e.scrollTo(r)}},r=n("<div></div>").appendTo(e.container);e.pager=r.wijpager(t).css({position:"absolute"})},t.prototype._createPager=function(){var e=this,t=e.options,r={collision:"none",of:e.container,my:"right top",at:"right bottom"};if(t.pagerType==="numbers")e._createWijPager();else if(t.pagerType==="dots"||t.pagerType==="thumbnails")e._createPaging(t.pagerType),e.pager.css({position:"absolute"});else{if(!n.wijmo.wijslider||t.pagerType!=="slider")return;e._createWijSlider(),t.sliderOrientation!=="horizontal"&&(r.my="left center",r.at="right center")}e.pager.width(e.pager.width()+1),n.extend(r,t.pagerPosition),t.pagerPosition=r,e.pager.addClass("wijmo-wijcarousel-pager").position(r)},t.prototype._setOption=function(e,t){var r=this,i=r.options,s,o,u,a=i.orientation==="horizontal";if(e==="pagerPosition"||e==="animation"||e==="controlPosition")n.extend(!0,i[e],t);else{u=i[e],n.Widget.prototype._setOption.apply(r,arguments);switch(e){case"showControls":case"showPager":case"showTimer":if(t===u)break;s=e.replace(/show/i,"").toLowerCase(),o=e.replace(/show/i,"_create"),t===!0?r[s]?r[s].jquery&&r[s].show():r[o]():r[s].hide();break;case"loop":case"orientation":case"display":case"preview":t!==u&&(r._wijdestroy(),r._create());break;case"data":r._createItems(a),r._applyContainerStyle(a),r._applyBtnClass(),i.showPager&&r._createPager();break;case"showCaption":t?r._createItems(a):r.element.find(x).remove();break;case"buttonPosition":r._applyBtnStyle(a);break;case"pagerType":t!==u&&(r.pager&&r.pager.jquery&&(r.pager.remove(),r.pager=null),r._createPager());break;case"disabled":r._handleDisabledOption(t,r.element);break;case"showControlsOnHover":r._set_showControlsOnHover(t);break;default:}}},t.prototype._getItemBound=function(){var e={},t=this,n=t.options;return n.orientation==="horizontal"?e={w:Math.round(t.width/n.display),h:t.height}:e={w:t.width,h:Math.round(t.height/n.display)},e},t.prototype._stopAnimation=function(){var e=this;e.isPlaying&&e.progressBar&&e.progressBar.stop().css({width:"0%"}),e.list.stop(!0,!0)},t.prototype._itemClick=function(e){var t=n(e.target),r=this,i=r.options,s=r.currentIdx,o=t.closest("li."+u),a=o.data("itemIndex"),f,l;if(o.length>0){if(i.preview&&a<s||a>s+i.display-1)f=r._getItemByIndex(s).index(),l=o.index()>f?"next":"previous",r[l]();r._trigger("itemClick",e,{index:a,el:o})}},t.prototype._wijdestroy=function(){var e=this,t=e.options.wijCSS;e.container.removeClass("wijmo-wijcarousel "+t.widget).removeClass("wijmo-wijcarousel-horizontal").removeClass("wijmo-wijcarousel-vertical"),e.timeout&&(e.list.stop(!0),window.clearTimeout(e.timeout),e.timeout=null),e.options.showTimer&&e.progressBar&&e.progressBar.stop(!0),e.list.unwrap().removeClass("wijmo-wijcarousel-list").removeClass(t.helperClearFix).unbind("."+e.widgetName).removeAttr("style").children("li").each(function(e,r){var i=n(r);i.removeClass("wijmo-wijcarousel-item").removeClass(t.helperClearFix).removeClass(f),i.children("img").removeClass("wijmo-wijcarousel-image"),i.children(x).remove(),i.css({width:"",height:""}),i.removeData("itemIndex")}),e.itemWidth=e.itemHeight=undefined,e.element.find(b+",.wijmo-wijcarousel-timerbar").remove(),e.pager&&(e.pager.remove(),e.pager=null),e.timer&&(e.timer.remove(),e.timer=null),e.element.find("li>span").css("display",""),e.disabledDiv.length&&(e.disabledDiv.remove(),e.disabledDiv=n())},t.prototype.destroy=function(){this._wijdestroy(),n.Widget.prototype.destroy.apply(this)},t.prototype._resetDom=function(){var e=this;e._applyListStyle(),e.list.children("li").each(function(t,r){var i=n(r),s=i.children("div.wijmo-wijcarousel-caption"),o=i.children("div.wijmo-wijcarousel-text");e._applyItemBound(i),e._setStyle(s.add(o),function(){e._applyCaptionStyle(s,o)})}),e._applyContainerStyle(e.isHorizontal,!0),e.options.preview&&e._createPreview(),e._setStyle(e.prevBtn.add(e.nextBtn),function(){e._applyBtnStyle(e.isHorizontal)}),e._setStyle(e.pager,function(){e.pager.position(e.options.pagerPosition)}),e._setStyle(e.controls,function(){e.controls.position(e.options.controlPosition)})},t.prototype._setStyle=function(e,t){var n=!0;if(!e||e.length===0)return;e.css("display")=="none"&&(n=!1,e.css("display","")),t.call(this),n||e.css("display","none")},t.prototype.refresh=function(){var e=this,t=e.options,n=e.element;e.width=n.width()||640,e.height=n.height()||480,e.itemWidth=e.itemHeight=0,e._resetDom(),e.pause()},t.prototype.play=function(){var e=this,t=e.options;if(e.isPlaying||t.disabled)return;if(t.interval===0)return e.pause();if(t.showTimer&&e.progressBar)e.progressBar.css({width:"0%"}),e.playPauseBtn.children("span:eq(0)").removeClass(t.wijCSS.iconPlay).addClass(t.wijCSS.iconPause),e.progressBar.animate({width:"100%"},t.interval,null,function(){e._scroll("next",t.step)});else{if(e.timeout)return;e.timeout=window.setTimeout(function(){e.next()},t.interval)}e.isPlaying=!0},t.prototype.pause=function(){var e=this,t=e.options;if(t.showTimer&&e.progressBar)e.progressBar.stop(!0).css({width:"0%"}),e.playPauseBtn.children("span:eq(0)").removeClass(t.wijCSS.iconPause).addClass(t.wijCSS.iconPlay);else{if(e.timeout===null)return;window.clearTimeout(e.timeout),e.timeout=null}e.isPlaying=!1},t.prototype.next=function(){var e=this,t=e.options.step;if(typeof t!="number"||t<1)return;e._stopAnimation(),e._scroll("next",t)},t.prototype.previous=function(){var e=this,t=e.options.step;if(typeof t!="number"||t<1)return;e._stopAnimation(),e._scroll("previous",t)},t.prototype.scrollTo=function(e){var t=this,n,r;t._stopAnimation(),n=e>t.currentIdx?"next":"previous",r=Math.abs(e-t.currentIdx),e!==t.currentIdx&&t._scroll(n,r)},t.prototype._scroll=function(e,t){var r=this,i=r.options,s=r.list,o=0,u,a,l=i.orientation==="horizontal",c={},h=r.itemBound[l?"w":"h"],p=l?"left":"top",d=t,v={},m=0,g=r.currentIdx*h;if(!i.loop){if(e==="next")if(r.currentIdx+i.display+t<=r.count)o=-g-h*d;else{if(!(r.currentIdx+i.display<r.count))return;d=r.count-r.currentIdx-i.display,o=-g-h*d}else r.currentIdx-t>=0?o=-g+h*d:r.currentIdx>0&&(d=r.currentIdx,o=0);o!==undefined&&(c[p]=o+r.offset,r._doAnimation(e,c,d))}else{i.preview&&(o=m=-h*T+r.offset);if(e==="next")o+=-h*d,c[p]=o;else{for(a=0;a<t;a++)o-=h,s.children("li:last").prependTo(s);v[p]=o,c[p]=m,s.css(v)}r._doAnimation(e,c,t,p,h)}if(i.preview){u=n();for(a=0;a<i.display;a++)u=u.add(r._getItemByIndex(r.currentIdx+a).find("div.wijmo-wijcarousel-mask:eq(0)"));u.stop(!0).animate({opacity:.6},i.animation.duration/2,function(){r._getItemByIndex(r.currentIdx).removeClass(f)})}},t.prototype._doAnimation=function(e,t,r,i,s){var o=this,u=o.list,a=o.options,f,l,c={complete:null},h,p={},d;if(!o.list.children().length)return;e==="next"?d=o.currentIdx+r:d=o.currentIdx-r,a.loop?(d=d%o.count+(d<0?o.count:0),h=function(){var t=0;a.preview&&(t=o.offset-T*s);if(e==="next"){for(l=0;l<r;l++)u.children("li:first").appendTo(u);i&&(p[i]=t,u.css(p))}o.currentIdx=d,o._setCurrentState(o.currentIdx)}):h=function(){o.currentIdx=d,o._setCurrentState(o.currentIdx)},c.complete=h,f={index:o.currentIdx,to:d,el:o._getItemByIndex(o.currentIdx)};if(!o._trigger("beforeScroll",null,f))return;a.animation&&a.animation.complete&&(a.animation.complete=undefined),n.extend(c,a.animation),o._hideCaption(),u.animate(t,c)},t.prototype._setCurrentState=function(e){var t=this,r=t.options,i,s,o,u=e+r.display-1,a,l,c;r.loop?t.isPlaying&&(window.clearTimeout(t.timeout),t.timeout=null,t.isPlaying=!1,t.play()):(o=e+r.display<t.count,t.isPlaying&&o?(window.clearTimeout(t.timeout),t.timeout=null,t.isPlaying=!1,t.play()):t.progressBar&&t.pause(),t._applyBtnClass());if(r.preview){l=n(),a=t._getItemByIndex(e);for(c=0;c<r.display;c++)l=l.add(t._getItemByIndex(e+c).find("div.wijmo-wijcarousel-mask:eq(0)"));l.animate({opacity:0},r.animation.duration/2,function(){a.addClass(f),t._showCaption(e,u)})}else t._showCaption(e,u);t.pager&&(n.wijmo.wijslider&&t.pager.find(":wijmo-wijslider").length?t.pager.find(":wijmo-wijslider:eq(0)").wijslider("value",e):n.wijmo.wijpager&&t.pager.is(":wijmo-wijpager")?t.pager.wijpager("option","pageIndex",e):t.pager.jquery&&(i=t.pager.find(">ul:eq(0)>li").eq(e),i.length&&t._activePagerItem(i))),s={firstIndex:e,lastIndex:u},t._trigger("afterScroll",null,s)},t.prototype._getItemByIndex=function(e){var t=this,r=t.list,i,s=e%t.count;return t.options.loop?(r.children("li").each(function(e){var t=n(this);if(t.data("itemIndex")===s)return i=t,!1}),i):r.children("li").eq(s)},t.prototype._collectionChanged=function(e){var t=this;t.count=t.count+(e==="add"?1:-1),t._applyListStyle(),t.pager&&t.pager.jquery&&(t.pager.remove(),t.pager=null,t._createPager()),t._applyBtnClass()},t.prototype.add=function(e,t){var r=this,i,s;if(typeof e=="string")i=n(e);else if(e.jquery)i=e;else{if(!n.isPlainObject(e))return;i=r._generateMarkup(e)}i.is("li")||(i=i.wrap("<li></li>").parent()),s=i,typeof t=="number"&&t>=0&&t<r.count?(s.insertBefore(r._getItemByIndex(t)),r.list.children("li").each(function(e,r){var i=n(r);i.data("itemIndex")>=t&&i.data("itemIndex",i.data("itemIndex")+1)})):(t==0&&s.appendTo(r.list),s.insertAfter(r._getItemByIndex(r.count-1))),r._createItem(i,t!==undefined?t:r.count),r._collectionChanged("add")},t.prototype.remove=function(e){var t=this,r;typeof e=="number"&&e>=0&&e<t.count?(r=t._getItemByIndex(e),t.list.children("li").each(function(t,r){var i=n(r);i.data("itemIndex")>e&&i.data("itemIndex",i.data("itemIndex")-1)})):r=t._getItemByIndex(t.count-1),r&&r.remove(),t._collectionChanged("remove")},t}(e.wijmoWidget);t.wijcarousel=N;var C=function(){function e(){this.wijMobileCSS={header:"ui-header ui-bar-a",content:"ui-body-a",stateDefault:"ui-btn-up-a",stateHover:"ui-btn-down-a",stateActive:"ui-btn-down-b",iconPlay:"ui-icon-arrow-r",iconPause:"ui-icon-grid"},this.initSelector=":jqmData(role='wijcarousel')",this.data=[],this.auto=!1,this.interval=5e3,this.showTimer=!1,this.buttonPosition="inside",this.showPager=!1,this.prevBtnClass={defaultClass:"",hoverClass:"",disableClass:""},this.nextBtnClass={defaultClass:"",hoverClass:"",disableClass:""},this.pagerType="numbers",this.thumbnails={mouseover:null,mouseout:null,mousedown:null,mouseup:null,click:null,imageWidth:58,imageHeight:74,images:[]},this.pagerPosition={},this.orientation="horizontal",this.sliderOrientation="horizontal",this.loop=!0,this.animation={queue:!0,disable:!1,duration:1e3,easing:"linear"},this.start=0,this.display=1,this.preview=!1,this.step=1,this.showControls=!1,this.control="",this.controlPosition={},this.showCaption=!0,this.showControlsOnHover=!1,this.itemClick=null,this.beforeScroll=null,this.afterScroll=null,this.loadCallback=null}return e}();N.prototype.options=n.extend(!0,{},e.wijmoWidget.prototype.options,new C),n.wijmo.registerWidget("wijcarousel",N.prototype)})(e.carousel||(e.carousel={}));var t=e.carousel})(wijmo||(wijmo={}));;
var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(t){"use strict";var n=jQuery,r="wijgallery",i="wijmo-wijgallery",s="wijmo-wijgallery-",o=s+"selected",u=s+"button-",a=s+"button",f="wijmo-wijgallery-thumbs-pointer-{0}",l="wijmo-wijgallery-flashwrapper",c='<div class="wijmo-wijgallery-frame"><div class="wijmo-wijgallery-content"></div></div>',h='<div class="wijmo-wijgallery-thumbs"></div>',p="<a><span></span></a>",d='<div class="wijmo-wijgallery-frame-{0}"><a href="#" class="wijmo-wijgallery-frame-link"></a></div>',v="<div></div>",m="li.wijmo-wijcarousel-item";!window.S&&window.swfobject&&(window.S={flash:window.swfobject});var g=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype._setOption=function(e,t){var r=this,i=r.options,s,o,u,a;if(e==="framePosition"||e==="thumbnailPosition"||e==="transitions"||e==="pagingPosition")n.extend(!0,i[e],t);else{u=i[e],n.Widget.prototype._setOption.apply(r,arguments);switch(e){case"disabled":r._handleDisabledOption(t,r.element);break;case"thumbnailOrientation":r.thumbs[r.thumbWidgetName]({orientation:t});break;case"thumbsDisplay":r.thumbs[r.thumbWidgetName]({display:t});break;case"autoPlay":r[t?"play":"pause"]();break;case"showCounter":case"showTimer":case"showControls":s=e.replace(/show/i,"").toLowerCase(),o=e.replace(/show/i,"_create"),t!==u&&(t===!0?r[s]?r[s].jquery&&r[s].show():r[o]():r[s].hide());break;case"showCaption":t?(r._createCaption(r.size),a=r._loadCaption(r.images[r.currentIdx]),a.show()):r.element.find(".wijmo-wijgallery-caption,.wijmo-wijgallery-text").remove();break;case"showPager":case"thumbsLength":case"thumbnailDirection":case"showControlsOnHover":case"mode":case"data":r._wijdestroy(),r._create();break;default:}}},t.prototype._handleDisabledOption=function(e,t){var r=this;r.pager&&!r.pager.is(":hidden")&&(r.disabledEles=r.disabledEles.add(r.pager)),e?(r.disabledDiv.length||r._createDisabledDiv(),r.disabledDiv.appendTo("body")):r.disabledDiv&&(r.disabledDiv.remove(),r.disabledDiv=n())},t.prototype._createDisabledDiv=function(){var e=this;e.disabledEles.each(function(t,r){var i=n(r),s=i.offset(),o=i.outerWidth(),u=i.outerHeight(),a=n("<div></div>").css({"z-index":"99999",position:"absolute",width:o,height:u,left:s.left,top:s.top});n.browser.msie&&parseInt(n.browser.version)<10&&(a.css("background-color","white"),n.browser.version==="9.0"&&a.css("opacity","0.1")),e.disabledDiv=e.disabledDiv.add(a)})},t.prototype._initLi=function(e){var t=e.children("a:eq(0)"),r=e.find("img:eq(0)"),i=e.find("span:eq(0)"),s={url:null,thumbUrl:null,title:r.attr("alt"),caption:undefined};return t.length&&t.attr("href")?(s.url=t.attr("href"),s.title||(s.title=t.attr("title"))):r.length&&(s.url=r.attr("src")),i.length?s.caption=i:r.attr("title")&&(s.caption=n("<span>").html(r.attr("title"))),s.thumbUrl=r.attr("src"),s},t.prototype._initStatus=function(){var e=this,t;e.images=[],e.ul=e.element.children("ul"),t=e.ul.children("li"),e._count=t.length,t.each(function(t){var r=e._initLi(n(this));e.images.push(r)})},t.prototype._createMarkupFromData=function(){var e=this,t=e.options,r=t.data,i=e.element,s=i.children("ul:eq(0)");e.images=r,s.length?s.empty():s=n("<ul>").appendTo(i),e.ul=s,n.each(r,function(e,t){var r=n("<a>"),i=n("<li>"),o=n("<img>");t.url&&r.attr("href",t.url),t.thumbUrl&&o.attr("src",t.thumbUrl),t.title&&o.attr("alt"),r.append(o).appendTo(i),i.appendTo(s)}),e._count=r.length},t.prototype._create=function(){var e=this,t=e.options;e.container=e.element,e.container.addClass([i,t.wijCSS.widget].join(" ")),e.currentThumbIdx=0,e.currentIdx=-1,e.disabledEles=e.element,e.disabledDiv=n(),e.timerCount=0,window.wijmoApplyWijTouchUtilEvents&&(n=window.wijmoApplyWijTouchUtilEvents(n)),t.showPager?(t.pagingPosition=!0,t.thumbnails=!1):t.thumbnails=!0,t.data&&t.data.length?e._createMarkupFromData():e._initStatus(),t.loadCallback&&n.isFunction(t.loadCallback)&&e._trigger("loadCallback",null,e),e._createDom(),t.autoPlay&&e._play(!0),t.showControlsOnHover&&(e.frame.find(".wijmo-wijpager,.wijmo-wijgallery-button-next,.wijmo-wijgallery-counter,.wijmo-wijgallery-button-previous").hide(),!e.isPlaying&&e.timer&&e.timer.hide()),t.disabled&&e.disable(),e.element.is(":hidden")&&e.element.wijAddVisibilityObserver&&e.element.wijAddVisibilityObserver(function(){e.element.wijRemoveVisibilityObserver&&e.element.wijRemoveVisibilityObserver()},"wijgallery")},t.prototype._createDom=function(){var e=this,t=e.options;t.thumbnails?e._createThumbnails():e.ul.hide(),e._createFrame(),t.control&&e._createControls(),t.showCounter&&e._createCounter(),t.showTimer&&e._createTimer(),t.showPager&&e._createPager()},t.prototype._getFrameSize=function(){var e=this,t=e.options.thumbnailOrientation==="horizontal",n=e.element.height()-(t?e.thumbs?e.thumbs.outerHeight(!0):0:0),r=e.element.width()-(t?0:e.thumbs?e.thumbs.outerWidth(!0):0);return{w:r<2||!r?750:r,h:n<2||!n?300:n}},t.prototype._createFrame=function(){var e=this,t=e.options,r,i,s=e._getFrameSize(),o=t.thumbnailDirection==="after";e.frame=n(c).addClass(t.wijCSS.content+" "+t.wijCSS.helperClearFix)[o?"prependTo":"appendTo"](e.container).setOutWidth(s.w-1).setOutHeight(s.h).wrap('<div class="wijmo-wijgallery-framewrapper">'),e.size=s,r=e.frame.width(),i=e.frame.height(),e.frameWrapper=e.frame.parent(),t.thumbnailOrientation==="vertical"&&e.frameWrapper.addClass("wijmo-wijgallery-framewrapper-vertical"),t.showControlsOnHover&&(n.browser.msie&&parseInt(n.browser.version)>9&&(e.frame.data("previousBtnShown",!1),e.frame.data("nextBtnShown",!1),e.frame.bind("mousemove."+e.widgetName,function(t){var r=".wijmo-wijgallery-frame-",i=t.clientX,s=t.clientY;n.each(["previous","next"],function(t,n){var o=r+n,u=e.frame.find(o);e._checkPositionInElement({X:i,Y:s},u)?e.frame.data(n+"BtnShown")||(e._showControls(n),e.frame.data(n+"BtnShown",!0)):e.frame.data(n+"BtnShown")&&(e._hideControls(n),e.frame.data(n+"BtnShown",!1))})}).bind("click."+e.widgetName,function(t){var r=".wijmo-wijgallery-frame-",i=t.clientX,s=t.clientY;n.each(["previous","next"],function(n,o){var u=r+o,a=e.frame.find(u);e._checkPositionInElement({X:i,Y:s},a)&&(e[o](),t.preventDefault())})})),e.frame.bind("mouseenter."+e.widgetName,function(){e._showControls("controls")}).bind("mouseleave."+e.widgetName,function(){e._hideControls("controls"),n.browser.msie&&parseInt(n.browser.version)>9&&n.each(["previous","next"],function(t,n){e.frame.data(n+"BtnShown")&&(e._hideControls(n),e.frame.data(n+"BtnShown",!1))})})),e.content=e.frame.children("div.wijmo-wijgallery-content"),t.mode==="img"&&e._createFrameMask(),e._createPrevNextBtn(),e._createCaption(s),e._createLoading(),e.last=n('<div class="'+t.wijCSS.overlay+' wijmo-wijgallery-last"></div>').appendTo(e.content).width(r).height(i).css({"line-height":s.h+"px"}),e.current=n('<div class="'+t.wijCSS.overlay+' wijmo-wijgallery-current"></div>').appendTo(e.content).width(r).height(i).css({"line-height":s.h+"px"}),e._show(0)},t.prototype._createControls=function(){var e=this,t=e.options,r={collision:"none",of:e.container,my:"center bottom",at:"center bottom"};t.control&&(e.controls=n(t.control).css({position:"absolute"}).appendTo(e.container),n.extend(r,t.controlPosition),e.controls.position(r))},t.prototype._createLoading=function(){var e=this;e.loading=n("<div></div>").addClass("wijmo-wijgallery-loading").appendTo(e.content),e.loading.css({left:(e.content.width()-e.loading.width())/2,top:(e.content.height()-e.loading.height())/2}),e.loading.hide()},t.prototype._createFrameMask=function(){var e=this,t=e.options;n.each(["previous","next"],function(r,i){var s=n(d.replace(/\{0\}/,i)).appendTo(e.frame),o=s.children("a");n.browser.msie&&parseInt(n.browser.version)<=9&&s.css({"background-color":"#fff"}),t.showControlsOnHover&&!(n.browser.msie&&parseInt(n.browser.version)>9)&&s.bind("mouseenter."+e.widgetName,function(){e._showControls(i)}).bind("mouseleave."+e.widgetName,function(){e._hideControls(i)}),n.browser.msie&&parseInt(n.browser.version)>9||o.bind("click."+e.widgetName,function(t){e[i](),t.preventDefault()})})},t.prototype._createCounter=function(){var e=this,t=e.options;if(!t.showCounter){e.counter&&(e.counter.remove(),e.counter=undefined);return}e.counter||(e.counter=n("<div></div>").addClass("wijmo-wijgallery-counter "+t.wijCSS.stateDefault+" "+t.wijCSS.cornerTL).appendTo(e.frame)),e._refreshCounter()},t.prototype._refreshCounter=function(){var e=this,t=e.options,r;if(!e.counter)return;e.counter.empty(),t.counter&&(r=t.counter.replace(/\[i\]/,e.currentIdx+1),r=r.replace(/\[n\]/,e._count),n("<span></span>").text(r).appendTo(e.counter))},t.prototype._createPrevNextBtn=function(){var e=this,t=e.options.wijCSS;n.each(["next","previous"],function(r,i){var s=i==="next"?t.iconArrowRight:t.iconArrowLeft,o;o=e.frame.find(".wijmo-wijgallery-frame-"+i);if(!o.length||e.options.mode!=="img")o=e.frame;n.browser.msie&&parseInt(n.browser.version)>9?e[i+"Btn"]=n(e._createBtn(u+i,s)).appendTo(o):e[i+"Btn"]=n(e._createBtn(u+i,s)).bind("click."+e.widgetName,n.proxy(e[i],e)).appendTo(o),e._applyBtnStyle(i)})},t.prototype._applyBtnStyle=function(e){var t=this,n=t.options,r=e==="next",i=t[e+"Btn"],s=r?"right center":"left center",o=s,u=n.wijCSS,a=r?u.cornerLeft:u.cornerRight,f=e==="next"?t.currentIdx>=t._count:t.currentIdx<=0,l={collision:"none",of:t.frame,my:o,at:s};i.addClass(a).position(l),f?i.removeClass(u.stateHover).addClass(u.stateDisabled):i.hasClass(u.stateDisabled)&&i.removeClass(u.stateDisabled)},t.prototype._createCaption=function(e){var t=this,r=t.options,i=r.wijCSS;r.showCaption&&(t.overlay=n(v).addClass([i.content,i.helperClearFix,"wijmo-wijgallery-caption"].join(" ")).width(e.w).appendTo(t.content),t.caption=n(v).addClass([i.content,i.helperClearFix,"wijmo-wijgallery-text"].join(" ")).width(e.w).appendTo(t.content))},t.prototype._loadCaption=function(e){var t=this,r=e.caption,i,s=n("<span></span>"),o=t.element.find(".wijmo-wijgallery-text,.wijmo-wijgallery-caption");return r&&(o.show(),r.jquery&&r.show(),s.html(r),t.caption.empty().append(s),i=s.outerHeight(!0),o.height(i),n.browser.msie&&o.height(s.css("display","block").outerHeight(!0))),o.hide(),o},t.prototype._showCaption=function(e){var t=this;e&&e.caption&&(t.caption.length&&t.caption.fadeIn(500),t.overlay.length&&t.overlay.show().animate({opacity:.5},500))},t.prototype._createTooltip=function(e){var t=this,r=t.options.wijCSS,i=e||"bottom";t.pointer=n("<div>").addClass([r.content,r.stateDefault,f.replace(/\{0\}/,i)].join(" ")),t.pointer.appendTo(t.thumbsWrapper).hide()},t.prototype._createThumbnails=function(){var e=this,t=e.options,r=t.thumbnailDirection==="after",i="wijmo-wijgallery-thumbs-{0}",s=t.thumbnailOrientation==="horizontal",o=r?s?"bottom":"right":s?"top":"left";e.thumbPosition=o,e.thumbs=n(h).appendTo(e.container).addClass(t.wijCSS.content).addClass(s?"wijmo-wijcarousel-horizontal-multi":"wijmo-wijcarousel-vertical-multi"),s?e.thumbs.css({height:t.thumbsLength+"px"}).setOutWidth(e.element.width()):e.thumbs.css({width:t.thumbsLength+"px"}).setOutHeight(e.element.height()),e.ul.appendTo(e.thumbs),e.ul.children("li").each(function(t,r){var i=n(r).children("a"),s=e.images[t],o=s.thumbUrl;i.length||(i=n(r).wrapInner("<a>").children("a"),i.attr("href",o))}),n[e.namespace][e.thumbWidgetName]&&(e.thumbs.addClass(i.replace(/\{0\}/,o)).find("li").addClass(t.wijCSS.stateDefault).hover(function(){n(this).addClass(t.wijCSS.stateHover)},function(){n(this).removeClass(t.wijCSS.stateHover)}),e.thumbsWrapper=e.thumbs[e.thumbWidgetName]({display:t.thumbsDisplay,step:t.thumbsDisplay-1,itemPadding:"0 10px",showCaption:t.showThumbnailCaptions,orientation:t.thumbnailOrientation,loop:!1,itemClick:function(t,n){var r=n.index;e.show(r),t.preventDefault()},afterScroll:function(t,n){e.currentThumbIdx=n.firstIndex,e.activeLi&&e.activeLi.is("li")&&e.activeLi.index()>=n.firstIndex&&e.activeLi.index()<=n.lastIndex&&e._highlightThumb(e.activeLi),e.isScrolling=!1},beforeScroll:function(n,r){e.isScrolling=!0,t.mode==="swf"||t.mode==="flv"?e.pointer.hide():e.pointer.fadeOut(100)}}).wrap('<div class="wijmo-wijgallery-thumbswrapper">').parent(),s||e.thumbsWrapper.addClass("wijmo-wijgallery-thumbswrapper-vertical"),e._createTooltip(o))},t.prototype._calculatePosition=function(e,t,n,r,i,s){var o=this;o.thumbPosition==="bottom"?(e.left=e.left+(r-t)/2+s,e.top=e.top-n):o.thumbPosition==="top"?(e.left=e.left+(r-t)/2+s,e.top=e.top+i+2*s):o.thumbPosition==="left"?(e.left=e.left+r+2*s,e.top=e.top+(i-n)/2+s):o.thumbPosition==="right"&&(e.left=e.left-t,e.top=e.top+(i-n)/2+s)},t.prototype._highlightThumb=function(e){var t=this,n,r,i,s,u,a,f=[o,t.options.wijCSS.stateActive].join(" ");e&&e.length&&(e.siblings("li."+o).removeClass(f),e.addClass(f),n=t.pointer.outerWidth(!0),r=t.pointer.outerHeight(!0),i=e.width(),s=e.height(),u=e.offset(),a=5,t._calculatePosition(u,n,r,i,s,a),t.pointer.fadeIn(100),t.pointer.offset(u))},t.prototype._getSelector=function(e,t){var n,r=".wijmo-wijgallery-button-",i=".wijmo-wijpager,.wijmo-wijgallery-counter";return t&&(i+=",.wijmo-wijgallery-timerbar"),e==="next"||e==="previous"?n=r+e:e==="controls"?n=i:n=i+","+r+"next,"+r+"previous",n},t.prototype._showControls=function(e){var t=this,r;r=t._getSelector(e,!t.isPlaying&&t.timer),t.frame.find(r).stop(!0,!0).fadeIn(400,function(){n(this).css("opacity","")})},t.prototype._hideControls=function(e){var t=this,n;n=t._getSelector(e,!t.isPlaying&&t.timer),this.frame.find(n).stop(!0,!0).fadeOut(600)},t.prototype._createPager=function(){var e=this,t=e.options,r,i=t.thumbsDisplay,s=1,o=e.currentIdx,u=e.currentIdx,a={collision:"none",of:e.container,my:"right top",at:"right bottom"};t.thumbnails?(r=n("<div></div>").appendTo(e.thumbs),i!==0&&(s=Math.ceil(e._count/i),o=Math.ceil(e.currentIdx/i)),e.pager=r.wijpager({pageCount:s,pageIndex:o,pageButtonCount:s,mode:"numeric",pageIndexChanged:function(t,n){var r=n.newPageIndex;(u<r*i||u>=(r+1)*i)&&e.thumbs[e.thumbWidgetName]("scrollTo",r*i),t.preventDefault()}}).css({position:"absolute"})):(r=n("<div></div>").appendTo(e.container),e.pager=r.wijpager({pageCount:e._count,pageIndex:e.currentIdx,pageButtonCount:e._count,mode:"numeric",pageIndexChanged:function(t,n){var r=n.newPageIndex;e._show(r)}}).css({position:"absolute"}),n.extend(a,t.pagingPosition),e.pager.addClass("wijmo-wijgallery-pager").position(a))},t.prototype._createBtn=function(e,t){var r=n(p),i=this.options;return r.addClass(i.wijCSS.stateDefault+" "+e).attr("role","button").bind("mouseover"+this.widgetName,function(){if(n(this).hasClass(i.wijCSS.stateDisabled))return;n(this).addClass(i.wijCSS.stateHover)}).bind("mouseout"+this.widgetName,function(){if(n(this).hasClass(i.wijCSS.stateDisabled))return;n(this).removeClass(i.wijCSS.stateHover)}),r.children("span:eq(0)").addClass(i.wijCSS.icon+" "+t),r},t.prototype._createTimer=function(){var e=this,t=e.options;e._createPausePlay(),e.progressBar=n("<div></div>").addClass("wijmo-wijgallery-timerbar-inner "+t.wijCSS.cornerAll).css({width:"0%"}).attr("role","progressbar"),e.timer=n("<div></div>").addClass("wijmo-wijgallery-timerbar "+t.wijCSS.cornerAll).appendTo(e.frame).append(e.progressBar).append(e.playPauseBtn)},t.prototype._createPausePlay=function(){var e=this,t=e.options;e.playPauseBtn=n(e._createBtn(a,t.autoPlay?t.wijCSS.iconPause:t.wijCSS.iconPlay)).bind("wijclick."+e.widgetName,function(){if(!n(this).hasClass(t.wijCSS.stateDisabled)){var r=n(this).children("span:eq(0)");e[r.hasClass(t.wijCSS.iconPlay)?"play":"pause"]()}})},t.prototype._show=function(e){var t=this,r=t.images[e],i,s,o,u=t._getFrameSize(),a=t.options,f=a.mode;if(t.currentIdx===e)return;r&&n.isPlainObject(r)&&(t.loading.delay(500).fadeIn(100),o=t.last.children("img,div."+l),o.length&&o.remove(),f==="swf"||f==="flv"?(t.last.hide(),t.current.empty(),t._wrapFlash(t.current,f,r.url),t.picture=t.current.children("div."+l),t._setCurrentStates(e),t.loading.stop().hide(),t._thumbsScroll(e)):f==="img"?(t.picture&&t.picture.length&&t.last.append(t.picture.unbind("load")),t.current.hide(),t.last.show(),t.picture=n("<img>").attr({src:r.url,alt:r.title}).appendTo(t.current).data("itemIndex",e),n.browser.msie&&t.picture[0].hasAttribute("complete")?t._imageLoaded(t,u):t.picture.bind("load",function(){t._imageLoaded(t,u)})):f==="iframe"&&(t.current.is(":hidden")?(i=t.current,s=t.last):(i=t.last,s=t.current),t.picture=n("<iframe></iframe>").addClass("wijmo-wijgallery-iframe").attr({frameborder:"0",marginwidth:"0",marginheight:"0",scrolling:"auto",allowtransparency:"true",src:r.url}).hide().appendTo(i).data("itemIndex",e).bind("load",function(){var e=n(this),r=e.data("itemIndex");t.loading.stop().hide(),t.pointer&&t.pointer.fadeOut(100),t._setCurrentStates(r),r!==undefined&&(a.showCaption,e.show(),s.fadeOut(function(){s.empty()}),i.fadeIn())})))},t.prototype._imageLoaded=function(e,t){var n=e.picture.attr("role","img"),r=n.data("itemIndex"),i=n[0].naturalWidth||n.width(),s=n[0].naturalHeight||n.height(),o=e.images[r];e.loading.stop().hide(),e.pointer&&e.pointer.fadeOut(100),i>t.w||s>t.h?i/s>t.w/t.h?n.css({width:"100%"}):n.css({height:"100%"}):i<t.w&&s<t.h&&n.addClass(e.options.wijCSS.stateDefault).addClass("wijmo-wijgallery-small-image"),r!==undefined&&(e.options.showCaption&&e.caption&&e._loadCaption(o),e._animate(r))},t.prototype._animate=function(e){var t=this,r=t.options,i=r.transitions,s=r.thumbnailOrientation==="horizontal",o,u,a,f,l,c,h=i.animated,p=i.duration;if(!t.last.children().length){t._setCurrentStates(e),t.last.hide(),t.current.show();return}l={index:t.currentIdx,to:e,toImg:t.images[e]};if(!t._trigger("beforeTransition",null,l))return;h?h==="slide"?(o=t.size.w,u=t.size.h,t.current.show(),c=t.currentIdx>e?!0:!1,a=n.createWrapper(t.last).css({overflow:"hidden",width:s?o*2:o,height:s?u:u*2,left:s?c?-o:0:0,top:s?0:c?-u:0}),a[c?"prepend":"append"](t.current),a.animate({left:s?c?0:-o:0,top:s?0:c?0:-u},p,function(){t.last.parent().is(".ui-effects-wrapper")&&t.last.unwrap(),t.last.hide(),t._setCurrentStates(e)})):n.mobile?(f=p/2,t.last.fadeOut(f,function(){t.current.stop(!0,!0).fadeIn(f,function(){t._setCurrentStates(e)})})):h==="explode"||h==="scale"||h==="blind"||h==="fold"?(t.current.css({position:"absolute"}),t.current.stop(!0,!0).show(h,p,function(){t.last.hide(),t._setCurrentStates(e)})):h==="size"?(t.last.hide(),t.current.stop(!0,!0).show(h,p,function(){t.last.hide(),t._setCurrentStates(e)})):(f=p/2,t.last.hide(h,f,function(){t.last.hide(),t.current.stop(!0,!0).show(h,f,function(){t._setCurrentStates(e)})})):(t.last.hide(),t.current.show(),t._setCurrentStates(e)),t._thumbsScroll(e)},t.prototype._thumbsScroll=function(e){var t,n=this,r=n.options;n.thumbs&&n.thumbs[n.thumbWidgetName]&&(r.scrollWithSelection?(t=e-Math.ceil(r.thumbsDisplay/2)+1,e>0&&e<n._count-1&&n.thumbs[n.thumbWidgetName]("scrollTo",t)):e>r.thumbsDisplay+n.currentThumbIdx-1?n.thumbs[n.thumbWidgetName]("scrollTo",e-r.thumbsDisplay+1):e<n.currentThumbIdx&&n.thumbs[n.thumbWidgetName]("scrollTo",e))},t.prototype._setCurrentStates=function(e){var t=this,n=t.options,r,i,s;s=t.currentIdx,t.currentIdx=e,r=e+1<t._count,t.isPlaying&&r?(t.timeout=null,t.isPlaying=!1,t._play()):t.progressBar&&t.pause(),e+1>=t._count?t.nextBtn.add(t.playPauseBtn).removeClass(n.wijCSS.stateHover).addClass(n.wijCSS.stateDisabled):t.nextBtn.add(t.playPauseBtn).removeClass(n.wijCSS.stateDisabled),e<=0?t.previousBtn.removeClass(n.wijCSS.stateHover).addClass(n.wijCSS.stateDisabled):t.previousBtn.removeClass(n.wijCSS.stateDisabled),n.showCaption&&t._showCaption(t.images[e]),t.thumbs&&t.thumbs[t.thumbWidgetName]?(t.activeLi=t.thumbs.find(m).eq(e),t.isScrolling||t._highlightThumb(t.activeLi)):t.pager&&t.pager.is(":wijmo-wijpager")&&t.pager.wijpager("option","pageIndex",e),t._refreshCounter(),t._clearCss(),i={last:s,index:t.currentIdx,toImg:t.images[t.currentIdx]},t._trigger("afterTransition",null,i)},t.prototype._clearCss=function(){this.current.css({position:"",visibility:""})},t.prototype._resetState=function(){var e=this;e._stopAnimation(),e.isPlaying&&e.progressBar&&(e.progressBar.stop(),e.progressBar.css({width:"0%"}))},t.prototype._stopAnimation=function(){var e=this,t;t=e.content.find(".ui-effects-wrapper"),t.length&&t.stop(!0,!0),e.current.stop(!0,!0),e.last.stop(!0,!0)},t.prototype._checkPositionInElement=function(e,t){return e.X>=t.offset().left&&e.X<t.offset().left+t.width()&&e.Y>=t.offset().top&&e.Y<t.offset().top+t.height()},t.prototype.count=function(){return this._count},t.prototype._wijdestroy=function(){var e=this,t=e.options.wijCSS;e.frame.unwrap().remove(),e.options.thumbnails?n[e.namespace][e.thumbWidgetName]&&(e.thumbs[e.thumbWidgetName]("destroy"),e.element.find("li").unbind().removeClass(t.stateActive).filter("."+o).removeClass(o),e.thumbs.children("ul").unwrap().unwrap()):(e.pager&&e.pager.length&&e.pager.remove(),e.element.find("ul").css({display:""})),e.pointer&&e.pointer.remove(),e.element.removeClass([i,t.widget,t.content,t.cornerAll].join(" ")),e.disabledDiv&&(e.disabledDiv.remove(),e.disabledDiv=null)},t.prototype.destroy=function(){this._wijdestroy(),n.Widget.prototype.destroy.apply(this)},t.prototype.show=function(e){var t=this;t._resetState(),t._show(e)},t.prototype.next=function(){var e=this,t;e._resetState(),t=e.currentIdx+1,t<e._count&&e._show(t)},t.prototype.previous=function(){var e=this,t;e._resetState(),t=e.currentIdx-1,t>=0&&e._show(t)},t.prototype.play=function(){this._play()},t.prototype._play=function(e){var t=this,n=t.options;if(t.isPlaying||n.disabled)return;if(n.interval===0)return t.pause();if(e){t.isPlaying=!0;return}if(n.showTimer&&t.progressBar)t.progressBar.css({width:"0%"}),t.playPauseBtn.children("span:eq(0)").removeClass(n.wijCSS.iconPlay).addClass(n.wijCSS.iconPause),t.progressBar.animate({width:"100%"},n.interval,null,function(){t._show(t.currentIdx+1)});else{if(t.timeout)return;t.timeout=window.setTimeout(function(){t.timerCount<=1&&t.next(),t.timerCount--},n.interval),t.timerCount++}t.isPlaying=!0},t.prototype.pause=function(){var e=this,t=e.options;if(t.showTimer&&e.progressBar)e.progressBar.stop(),e.progressBar.css({width:"0%"}),e.playPauseBtn.children("span:eq(0)").removeClass(t.wijCSS.iconPause).addClass(t.wijCSS.iconPlay);else{if(e.timeout===null)return;window.clearTimeout(e.timeout),e.timeout=null}e.isPlaying=!1},t.prototype.add=function(e,t){var r=this,i,s,o;if(typeof e=="string")i=n(e),o=r._initLi(i);else if(e.jquery)i=e,o=r._initLi(i);else{if(!n.isPlainObject(e))return;o=e}!t||t>r._count?s=r._count:t<0?s=0:s=t,r.images.splice(s,0,o),r._count++,r.thumbs&&r.thumbs[r.thumbWidgetName]&&r.thumbs[r.thumbWidgetName]("add",i,t)},t.prototype.remove=function(e){var t=this,n;isNaN(e)||e>t._count?n=t._count:e<0?n=0:n=e,t.images.splice(n,1),t._count--,t.thumbs&&t.thumbs[t.thumbWidgetName]&&t.thumbs[t.thumbWidgetName]("remove",e);if(t.currentIdx==e)t.current.children("img").remove(),t.last.children("img").remove(),t.picture=null,t.currentIdx=-1,t.show(e);else if(t.currentIdx>e){var r=t.currentIdx;t.currentIdx=-1,t.show(r)}},t.prototype._getExt=function(e){var t,n,r=/[0-9a-z]+$/i,i=e.indexOf("?");return i>-1&&(e=e.substring(0,i)),n=e.match(r),n&&(t=n[0].toLowerCase()),t},t.prototype._getPlayerName=function(e){if(e.indexOf("#")===0||e.indexOf("#")>0&&e.indexOf(document.location.href)===0)return"inline";var t=["bmp","gif","jpg","jpeg","png"],r=["swf"],i=["flv","m4v"],s=["dv","mov","moov","movie","mp4","avi","mpg","mpeg"],o=["asf","avi","mpg","mpeg","wm","wmv"],u=this._getExt(e);if(u){if(n.inArray(u,t)>=0)return"img";if(n.inArray(u,r)>=0)return"swf";if(n.inArray(u,i)>=0)return"flv";if(n.inArray(u,o)>=0)return"wmp";if(n.inArray(u,s)>=0)return"qt"}return"unknown"},t.prototype._wrapFlash=function(e,t,r){var i=this,s=i.options,o=r,u,a="100%",f="100%",c=s.flashInstall,h=s.flashVersion,p=s.flashVars,d=s.flashParams,v=i._newId();t==="flv"&&(o=s.flvPlayer,p=n.extend({file:r,width:a,height:f,autostart:s.autoPlayMovies?"true":"false",controlbar:s.showMovieControls?"bottom":"none",backcolor:"0x000000",frontcolor:"0xCCCCCC",lightcolor:"0x557722"},s.flashVars),d=n.extend({autostart:s.autoPlayMovies?"true":"false",allowscriptaccess:"always"},s.flashParams)),u=n("<div/>").addClass(l).appendTo(e),n("<div/>").css({width:"100%",height:"100%",overflow:"hidden"}).attr("id",v).appendTo(u),S.flash.embedSWF(o,v,a,f,h,c,p,d)},t.prototype._newId=function(){var e="a|b|c|d|e|f|g|h|i|j|k|l|m|n|o|p|q|r|s|t|u|v|w|x|y|z",t=[],n="",r;t=e.split("|");for(r=0;r<16;r++)n+=t[Math.round(Math.random()*25)];return n},t}(e.wijmoWidget);t.wijgallery=g,g.prototype.thumbWidgetName="wijcarousel";var y=function(){function e(){this.wijMobileCSS={header:"ui-header ui-bar-a",content:"ui-body-a",stateDefault:"ui-btn-up-a",stateHover:"ui-btn-down-a",stateActive:"ui-btn-down-b",iconPlay:"ui-icon-arrow-r",iconPause:"ui-icon-grid"},this.initSelector=":jqmData(role='wijgallery')",this.autoPlay=!1,this.scrollWithSelection=!1,this.showTimer=!0,this.interval=5e3,this.showCaption=!0,this.showThumbnailCaptions=!1,this.data=[],this.showControls=!1,this.control="",this.controlPosition={},this.showCounter=!0,this.counter="[i] of [n]",this.showPager=!1,this.pagingPosition={},this.thumbnailOrientation="horizontal",this.thumbnailDirection="after",this.transitions={animated:"slide",duration:1e3,easing:null},this.showControlsOnHover=!0,this.thumbsDisplay=5,this.thumbsLength=100,this.beforeTransition=null,this.afterTransition=null,this.loadCallback=null,this.showMovieControls=!1,this.autoPlayMovies=!0,this.flashParams={bgcolor:"#000000",allowfullscreen:!0,wmode:"transparent"},this.flashVars={},this.flashVersion="9.0.115",this.flvPlayer="player\\player.swf",this.flashInstall="player\\expressInstall.swf",this.mode="img"}return e}();g.prototype.options=n.extend(!0,{},e.wijmoWidget.prototype.options,new y),n.wijmo.registerWidget("wijgallery",g.prototype)})(e.gallery||(e.gallery={}));var t=e.gallery})(wijmo||(wijmo={}));;
var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(t){var n=jQuery;(function(e){e._map=[],e._map[0]="east",e.east=0,e._map[1]="west",e.west=1,e._map[2]="south",e.south=2,e._map[3]="north",e.north=3})(t.Compass||(t.Compass={}));var r=t.Compass,i=function(){function e(){}return e.mod360=function(t){var n=t%360;return t<0&&(n+=360),n},e.getAngle=function(t,n,r){var i=this,s=i.distance(n,r),o=i.distance(n,t),u=i.distance(r,t),a=s*s,f=o*o,l=u*u,c=Math.acos((l-f-a)/(-2*o*s));return Math.round(180/Math.PI*c)},e.distance=function(t,n){return Math.sqrt(Math.pow(n.x-t.x,2)+Math.pow(n.y-t.y,2))},e.log=function(t,n){return t<=0?NaN:n===1||n<0?NaN:Math.log(t)/Math.log(n)},e.generateValues=function(t,n,r){var i=[],s,o;if(n>t&&r>0){s=parseInt(((n-t)/r+1).toString(),10);for(o=0;o<s;o++)i.push(t+o*r)}else r===0&&i.push(t);return i},e.isInRange=function(t,n,r){return t>=n&&t<=r||t<=n&&t>=r},e.paintMarker=function(t,n,r,i,s,o,u){var a;return n==="rect"?t.rect(r-s/2,i-o/2,s,o):(u?n==="tri"?a=t.isoTri(r,i,s,o):a=t.paintMarker(n,r,i,o):a=t.paintMarker(n,r,i,s),a)},e.formatString=function(t,r){if(n.isFunction(r))return r.call(this,t);if(r!==""){var i=/\{0(?::((?:n|d|p|c)\d?))?\}/gi,s,o;if(i.test(r))return s=r.match(i),o="$1",r.replace(/\{0(?::(?:(?:n|d|p|c)\d?))?\}/gi,Globalize.format(t,o))}return t},e.getPositionByAngle=function(t,n,r,i){var s={x:0,y:0},o=Raphael.rad(i);return s.x=t-r*Math.cos(o),s.y=n-r*Math.sin(o),s},e.donut=function(t,n,r,i,s,o,u){var a=this.getPositionByAngle,f=a(n,r,i,o),l=a(n,r,i,u),c=a(n,r,s,o),h=a(n,r,s,u),p=u-o>180,d;(u-o)%360!==0?(d=["M",f.x,f.y,"A",i,i,0,+p,1,l.x,l.y,"L",h.x,h.y,"A",s,s,0,+p,1,c.x,c.y,"L",f.x,f.y,"z"],t.path(d)):t.circle(n,r,i)},e}();t.GaugeUtil=i,Raphael.fn.isoTri=function(e,t,n,i,s){var o=e,u=t+i/2,a=e+n,f=t,l=e+n,c=t+i,h;return s==r.north?(o=e,u=t,a=e-n/2,f=t+i,l=e+n/2,c=t+i):s===r.east?(o=e-n/2,u=t-i/2,a=e-n/2,f=t+i/2,l=e+n/2,c=t):s===r.west&&(o=e-n/2,u=t,a=e+n/2,f=t-i/2,l=e+n/2,c=t+i/2),h=["M",o,u,"L",a,f,"L",l,c,"z"],this.path(h.join(" "))};var s=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype._create=function(){var e=this,t=e.options,r;window.wijmoApplyWijTouchUtilEvents&&(n=window.wijmoApplyWijTouchUtilEvents(n)),e.element.is(":hidden")&&e.element.wijAddVisibilityObserver&&e.element.wijAddVisibilityObserver(function(){e.redraw(),e.element.wijRemoveVisibilityObserver&&e.element.wijRemoveVisibilityObserver()},"wijgauge"),isNaN(t.width)&&e._setDefaultWidth(),isNaN(t.height)&&e._setDefaultHeight(),e._setDefaultWidthHeight(),t.disabled&&e.disable(),t.face&&t.face.template&&typeof t.face.template=="string"&&window[t.face.template]&&(t.face.template=window[t.face.template]),t.pointer&&t.pointer.template&&typeof t.pointer.template=="string"&&window[t.pointer.template]&&(t.pointer.template=window[t.pointer.template]),t.cap&&t.cap.template&&typeof t.cap.template=="string"&&window[t.cap.template]&&(t.cap.template=window[t.cap.template]),e.element.addClass(t.wijCSS.widget).toggleClass(t.wijCSS.stateDisabled,t.disabled);try{e.canvas=Raphael(e.element[0],t.width,t.height)}catch(i){var s=e.element.css("display");r=n("<div></div>").insertBefore(e.element).append(e.element),e.element.addClass("ui-helper-hidden-accessible").appendTo(n("body")),s==="none"&&e.element.css("display","block"),e.canvas=Raphael(e.element[0],t.width,t.height),e.element.appendTo(r).unwrap().removeClass("ui-helper-hidden-accessible"),s==="none"&&e.element.css("display","none")}e._autoCalculate(),e._draw()},t.prototype._setDefaultWidth=function(){},t.prototype._setDefaultHeight=function(){},t.prototype._setDefaultWidthHeight=function(){var e=this,t=e.element,n=e.options,r=t.get(0).style,i=r.width,s=r.height;i!==""&&(n.width=t.width()),s!==""&&(n.height=t.height())},t.prototype._autoCalculate=function(){},t.prototype._setOption=function(t,r){var i=this,s=i.options,o=s[t];if(t==="disabled")i._handleDisabledOption(r,i.element),e.prototype._setOption.call(this,t,r);else if(t==="value")i._trigger("beforeValueChanged",null,{newValue:r,oldValue:o})&&(e.prototype._setOption.call(this,t,r),i._set_value(r,o)),i._trigger("valueChanged",null,{newValue:r,oldValue:o});else{e.prototype._setOption.call(this,t,r),n.isPlainObject(r)&&(s[t]=n.extend({},o,r));if(s.radius==="auto"){i._autoCalculate(),i.redraw();return}i["_set_"+t]&&i["_set_"+t](r,o)}},t.prototype._set_value=function(e,t){this._setPointer()},t.prototype._set_max=function(){this._redrawMarksAndLabels(),this._set_ranges(),this._setPointer()},t.prototype._set_min=function(){this._redrawMarksAndLabels(),this._set_ranges(),this._setPointer()},t.prototype._set_width=function(){this.redraw()},t.prototype._set_height=function(){this.redraw()},t.prototype._set_isInverted=function(){this.redraw()},t.prototype._set_tickMajor=function(){this._redrawMarksAndLabels()},t.prototype._set_tickMinor=function(){this._redrawMarksAndLabels()},t.prototype._set_pointer=function(){var e=this;e.pointer&&(e.pointer.wijRemove(),e.pointer=null),e._paintPointer(),e._setPointer()},t.prototype._set_islogarithmic=function(){var e=this;e._redrawMarksAndLabels(),e._setPointer()},t.prototype._set_logarithmicBase=function(){var e=this;e._redrawMarksAndLabels(),e._setPointer()},t.prototype._set_labels=function(){this._redrawMarksAndLabels()},t.prototype._set_margin=function(e,t){e!==t&&this.redraw()},t.prototype._set_marginTop=function(e,t){this._set_margin(e,t)},t.prototype._set_marginBottom=function(e,t){this._set_margin(e,t)},t.prototype._set_marginLeft=function(e,t){this._set_margin(e,t)},t.prototype._set_marginRight=function(e,t){this._set_margin(e,t)},t.prototype._set_ranges=function(){var e=this;e._removeRanges(),e._paintRanges(),e._resetElementPosition()},t.prototype._set_face=function(){var e=this;e.face&&(e.face.wijRemove(),e.face=null,e._paintFace(),e._resetElementPosition(!0))},t.prototype._clearState=function(){var e=this;e.labels=[],e.majorMarks=[],e.minorMarks=[],e.face=null,e.pointer=null},t.prototype._resetElementPosition=function(e){var t=this;e&&t.ranges&&n.each(t.ranges,function(e,t){t.toFront()}),t.majorMarks&&n.each(t.majorMarks,function(e,t){t.toFront()}),t.minorMarks&&n.each(t.minorMarks,function(e,t){t.toFront()}),t.labels&&n.each(t.labels,function(e,t){t.toFront()}),t.pointer&&t.pointer.toFront(),t.cap&&t.cap.toFront()},t.prototype._redrawMarksAndLabels=function(){var e=this;e._removeMarksAndLabels(),e._drawMarksAndLabels()},t.prototype._removeMarksAndLabels=function(){var e=this;n.each(e.labels,function(t,n){n.wijRemove(),e.labels[t]=null}),n.each(e.majorMarks,function(t,n){n.wijRemove(),e.majorMarks[t]=null}),n.each(e.minorMarks,function(t,n){n.wijRemove(),e.minorMarks[t]=null})},t.prototype._drawMarksAndLabels=function(){var e=this;e.labels=[],e.majorMarks=[],e.minorMarks=[],e._paintMarks()},t.prototype._handleDisabledOption=function(e,t){var n=this;e?(n.disabledDiv||(n.disabledDiv=n._createDisabledDiv(t)),n.disabledDiv.appendTo("body")):n.disabledDiv&&(n.disabledDiv.remove(),n.disabledDiv=null)},t.prototype._createDisabledDiv=function(e){var t=this,r=t.options,i=e||t.element,s=i.offset(),o=r.width||i.outerWidth(),u=r.height||i.outerHeight(),a;return a=n("<div></div>").css({"z-index":"99999",position:"absolute",width:o,height:u,left:s.left,top:s.top}),Raphael.vml&&a.addClass(r.stateDisabled).css("background-color","#fff"),a},t.prototype._triggerPainted=function(){return this._trigger("painted")},t.prototype._draw=function(){var e=this,t=e.options;e.pointer=null,e._innerBbox={width:t.width-t.marginLeft-t.marginRight,height:t.height-t.marginTop-t.marginBottom,left:t.marginLeft,top:t.marginTop},e.face=e._paintFace(),e.ranges&&e._removeRanges(),e._paintRanges(),e._drawMarksAndLabels(),e._paintPointer(),e.pointer&&(e._setOffPointerValue(),e._setPointer()),n.wijraphael.clearRaphaelCache(),e._triggerPainted()},t.prototype.redraw=function(){var e=this,t=e.options;e.element.empty(),this._clearState(),e.canvas=Raphael(e.element[0],t.width,t.height),e._draw()},t.prototype.destroy=function(){var t=this;t._unbindEvents(t.majorMarks),t._unbindEvents(t.minorMarks),t._unbindEvents(t.labels),t.element.removeClass("ui-widget").empty(),t.disabledDiv&&(t.disabledDiv.remove(),t.disabledDiv=null),e.prototype.destroy.call(this)},t.prototype.getCanvas=function(){return this.canvas},t.prototype._percentage=function(){var e=this,t=e.options,n=t.max,r=t.min,i=t.value;return isNaN(i)?0:n===r?1:(i-r)/(n-r)},t.prototype._valueToLogical=function(e){var t=this,n=t.options,r=n.min,s=n.max,o=n.logarithmicBase,u,a;return e<r?0:s<e?1:(u=(e-r)/(s-r),n.islogarithmic?a=i.log(1+(o-1)*u,n.logarithmicBase):a=u,a)},t.prototype._logicalToValue=function(e){var t=this,n=t.options,r=n.max,i=n.min,s;if(e<0)return i;if(1<=e)return r;if(!n.islogarithmic)s=e;else{if(n.logarithmicBase<=1)return n.min;s=(Math.pow(n.logarithmicBase,e)-1)/(n.logarithmicBase-1)}return i+(r-i)*s},t.prototype._bindClickEvents=function(e){var t=this;n.each(e,function(e,r){n(r.node).bind("click."+t.widgetName,function(e){t._trigger("click",e,{ele:r})})})},t.prototype._unbindEvents=function(e){var t=this;n.each(e,function(e,r){n(r.node).unbind("."+t.widgetName)})},t.prototype._setOffPointerValue=function(){},t.prototype._setPointer=function(){},t.prototype._paintPointer=function(){},t.prototype._paintFace=function(){},t.prototype._paintRanges=function(){var e=this,t=e.options,r=t.ranges||[];e.ranges=[],n.each(r,function(t,n){e._paintRange(n)})},t.prototype._paintRange=function(e){},t.prototype._removeRanges=function(){var e=this;n.each(e.ranges,function(t,n){n.wijRemove(),e.ranges[t]=null})},t.prototype._paintMarks=function(){var e=this,t=e.options,r=i.generateValues,s=r(t.min,t.max,t.tickMajor.interval),o=r(t.min,t.max,t.tickMinor.interval),u=t.labels,a=u.visible;t.tickMajor.visible&&n.each(s,function(n,r){e.majorMarks.push(e._paintMark(r,t.tickMajor,!0)),a&&e.labels.push(e._paintLabel(r,u))}),t.tickMinor.visible&&n.each(o,function(r,i){var o=!1;n.each(s,function(e,t){if(i===t)return o=!0,!1}),o||e.minorMarks.push(e._paintMark(i,t.tickMinor,!1))}),e._bindClickEvents(e.majorMarks),e._bindClickEvents(e.minorMarks),e._bindClickEvents(e.labels)},t.prototype._paintMark=function(e,t,n){},t.prototype._paintLabel=function(e,t){},t}(e.wijmoWidget);t.wijgauge=s;var o=function(){function e(){this.value=0,this.max=100,this.min=0,this.width=600,this.height=400,this.tickMajor={position:"inside",style:{fill:"#1E395B",stroke:"none"},factor:2,visible:!0,marker:"rect",offset:0,interval:10},this.tickMinor={position:"inside",style:{fill:"#1E395B",stroke:"none"},factor:1,visible:!1,marker:"rect",offset:0,interval:5},this.pointer={length:1,style:{fill:"#1E395B",stroke:"#1E395B"},width:8,offset:0,shape:"tri",visible:!0,template:null},this.islogarithmic=!1,this.logarithmicBase=10,this.labels={format:"",style:{fill:"#1E395B","font-size":12,"font-weight":"800"},visible:!0,offset:0},this.animation={enabled:!0,duration:2e3,easing:">"},this.face={style:{fill:"270-#FFFFFF-#D9E3F0",stroke:"#7BA0CC","stroke-width":4},template:null},this.marginTop=0,this.marginRight=0,this.marginBottom=0,this.marginLeft=0,this.ranges=[],this.isInverted=!1,this.beforeValueChanged=null,this.valueChanged=null,this.painted=null}return e}();s.prototype.options=n.extend({},e.wijmoWidget.prototype.options,new o)})(e.gauge||(e.gauge={}));var t=e.gauge})(wijmo||(wijmo={}));;
var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(e){var t=function(t){function n(){t.apply(this,arguments)}return __extends(n,t),n.prototype._setDefaultWidth=function(){var e=this.options;e.width=e.orientation==="horizontal"?310:70},n.prototype._setDefaultHeight=function(){var e=this.options;e.height=e.orientation==="horizontal"?70:310},n.prototype._set_orientation=function(){var e=this;e._setDefaultWidth(),e._setDefaultHeight(),e.markBbox=null,e.redraw()},n.prototype._set_xAxisLocation=function(){this.redraw()},n.prototype._set_xAxisLength=function(){this.redraw()},n.prototype._set_yAxisLocation=function(){this.redraw()},n.prototype._clearState=function(){t.prototype._clearState.call(this),this.markBbox&&(this.markBbox=null)},n.prototype._create=function(){t.prototype._create.call(this),this.element.addClass(this.options.wijCSS.linearGauge)},n.prototype._paintLabel=function(t,n){var r=this,i=r.options,s=n.format,o=n.style,u=n.offset,a=t,f=r.options.tickMajor,l=f.position||"inside",c,h,p,d;return s!==""&&(a=e.GaugeUtil.formatString(t,s)),p=r._getMarkerBbox(),d=r._getLabelBBox(a),c=r._valueToPoint(t,0),i.orientation==="horizontal"?(l==="inside"?c.y=p.y-d.height:c.y=p.y+p.height+d.height/2,c.y+=u):(l==="inside"?c.x=p.x-d.width/2:c.x=p.x+p.width+d.width/2,c.x+=u),h=r.canvas.text(c.x,c.y,a),h.attr(o),$.wijraphael.addClass($(h.node),i.wijCSS.linearGaugeLabel),h},n.prototype._getLabelBBox=function(e){var t=this,n=t.options,r,i;return r=t.canvas.text(0,0,e),r.attr(n.gaugeLableStyle),i=r.wijGetBBox(),r.remove(),i},n.prototype._getMarkerBbox=function(){var e=this,t=e.options,n=t.tickMajor,r;return e.markBbox||(r=e._paintMark(0,n),e.markBbox=r.wijGetBBox(),r.remove()),e.markBbox},n.prototype._paintMark=function(t,n,r){var i=this,s=i.options,o=n.marker||"rect",u=o==="rect"?5:2,a=i._valueToPoint(t,0),f=n.position||"inside",l=n.offset||0,c=r?2:1,h,p,d=$.extend({},n.style);return h=u*n.factor,$.isFunction(o)?o.call(i,i.canvas,a,s):(o==="cross"&&(d.stroke=d.fill),s.orientation==="horizontal"?p=e.GaugeUtil.paintMarker(i.canvas,o,a.x,a.y,c,h,!0):p=e.GaugeUtil.paintMarker(i.canvas,o,a.x,a.y,h,c),p.attr(d),$.wijraphael.addClass($(p.node),s.wijCSS.linearGaugeMarker),i._applyPosition(p,f,l,t),p)},n.prototype._applyPosition=function(e,t,n,r){var i=0,s=0,o=this,u=o.options.orientation==="horizontal",a=e.wijGetBBox();switch(t){case"inside":u?s-=a.width/2+n:i-=a.width/2+n;break;case"outside":u?s+=a.width/2+n:i+=a.width/2+n;break;case"center":u?s-=n:i-=n;break;default:}e.attr("transform","t"+i+","+s)},n.prototype._paintFace=function(){var e=this,t,n=e.options,r=e._innerBbox.width,i=e._innerBbox.height,s=e._innerBbox.left,o=e._innerBbox.top,u={width:r,height:i,x:s,y:o,canvas:e.canvas};return n.face&&n.face.template&&$.isFunction(n.face.template)?n.face.template.call(e,u):(t=e.canvas.rect(s,o,r,i,5),n.face&&n.face.style&&t.attr(n.face.style),$.wijraphael.addClass($(t.node),n.wijCSS.linearGaugeFace),t)},n.prototype._paintPointer=function(){var t=this,n=t.options,r=t._valueToPoint(n.min,0),i=t._innerBbox.width,s=t._innerBbox.height,o=t._innerBbox.left,u=t._innerBbox.top,a=n.pointer,f,l,c,h;if(!a.visible)return;h=n.orientation==="horizontal"?s:i,c=h*a.offset,l=h*a.length,a.template&&$.isFunction(a.template)?f=a.template.call(t.canvas,r,$.extend({},n.pointer,{offset:c,length:l,gaugeBBox:t._innerBbox})):(n.orientation==="horizontal"?a.shape==="rect"?f=t.canvas.rect(r.x-a.width/2,s-l-c+u,a.width,l):f=t.canvas.isoTri(r.x,s-l-c+u,a.width,l,e.Compass.north):a.shape==="rect"?f=t.canvas.rect(i-l-c+o,r.y-a.width/2,l,a.width):f=t.canvas.isoTri(i-l-c+o,r.y-a.width/2,l,a.width),f.attr(a.style)),$.wijraphael.addClass($(f.node),n.wijCSS.linearGaugePointer),t.pointer=f},n.prototype._setPointer=function(){var e=this,n=e.options;if(!e.pointer)return;t.prototype._setPointer.call(this),e._setLinearPointer(n.value)},n.prototype._setLinearPointer=function(e){var t=this,n=t.options,r=t._valueToPoint(n.min,0),i=t._valueToPoint(e,0),s=n.animation,o={x:0,y:0};n.orientation==="horizontal"?o.x=i.x-r.x:o.y=i.y-r.y,s.enabled?t.pointer.stop().wijAnimate({transform:"t"+o.x+","+o.y},s.duration,s.easing):t.pointer.attr("transform","t"+o.x+","+o.y)},n.prototype._minScreenPoint=function(e){var t=this,n=t.options,r=t._innerBbox.width,i=t._innerBbox.height,s=t._innerBbox.left,o=t._innerBbox.top,u=n.yAxisLocation+e;return n.orientation==="horizontal"?{x:r*n.xAxisLocation+s,y:i*u+o}:{x:r*u+s,y:i*(1-n.xAxisLocation)+o}},n.prototype._maxScreenPoint=function(e){var t=this,n=t.options,r=t._innerBbox.width,i=t._innerBbox.height,s=t._innerBbox.left,o=t._innerBbox.top,u=n.yAxisLocation+e,a=n.xAxisLocation+n.xAxisLength;return n.orientation==="horizontal"?{x:r*a+s,y:i*u+o}:{x:r*u+s,y:i*(1-a)+o}},n.prototype._paintRange=function(e){var t=this,n=t.options,r=isNaN(e.startValue)?0:e.startValue,i=isNaN(e.endValue)?0:e.endValue,s=isNaN(e.startWidth)?isNaN(e.width)?0:e.width:e.startWidth,o=isNaN(e.endWidth)?isNaN(e.width)?0:e.width:e.endWidth,u=e.startDistance||0,a=e.endDistance||0,f,l;r!==i&&(i>r?(f=Math.max(r,n.min),l=Math.min(n.max,i)):(f=Math.max(n.min,i),l=Math.min(n.max,r)),t._drawRange(f,l,u,a,s,o,e))},n.prototype._drawRange=function(e,t,n,r,i,s,o){var u=this,a=u.options,f=a.orientation,l=u._innerBbox.width,c=u._innerBbox.height,h=u._innerBbox.left,p=u._innerBbox.top,d=u._valueToPoint(e,0),v=u._valueToPoint(t,0),m,g,y,b,w,E;f==="horizontal"?(w=i*c,E=s*c,n!==0&&(d.y=n*c+p),r!==0&&(v.y=r*c+p),m={x:d.x,y:d.y-w},g={x:v.x,y:v.y-E}):(w=i*l,E=s*l,n!==0&&(d.x=n*l+h),r!==0&&(v.x=r*l+h),m={x:d.x-w,y:d.y},g={x:v.x-E,y:v.y}),y=["M",d.x,d.y,"L",v.x,v.y,"L",g.x,g.y,"L",m.x,m.y,"Z"],b=u.canvas.path(y.concat(" ")),b.attr(o.style),$.wijraphael.addClass($(b.node),a.wijCSS.linearGaugeRange),u.ranges.push(b)},n.prototype._valueToPoint=function(e,t){var n=this,r=n.options,i=r.isInverted,s,o,u;return r.max===r.min?{x:0,y:0}:(s=n._valueToLogical(e),o=n._minScreenPoint(t),u=n._maxScreenPoint(t),i?{x:o.x*s+u.x*(1-s),y:o.y*s+u.y*(1-s)}:{x:o.x*(1-s)+u.x*s,y:o.y*(1-s)+u.y*s})},n}(e.wijgauge);e.wijlineargauge=t,t.prototype.widgetEventPrefix="wijlineargauge";var n=function(){function e(){this.initSelector=":jqmData(role='wijlineargauge')",this.wijCSS={linearGauge:"wijmo-wijlineargauge",linearGaugeLabel:"wijmo-wijlineargauge-label",linearGaugeMarker:"wijmo-wijlineargauge-mark",linearGaugeFace:"wijmo-wijlineargauge-face",linearGaugePointer:"wijmo-wijlineargauge-pointer",linearGaugeRange:"wijmo-wijlineargauge-range"},this.orientation="horizontal",this.xAxisLocation=.1,this.xAxisLength=.8,this.yAxisLocation=.5,this.width="auto",this.height="auto",this.pointer={length:.5,width:4,offset:0,visible:!0,template:null,shape:"tri",style:{fill:"#1E395B",stroke:"#1E395B"}},this.marginLeft=5,this.marginTop=5,this.marginRight=5,this.marginBottom=5}return e}();t.prototype.options=$.extend(!0,{},e.wijgauge.prototype.options,new n),$.wijmo.registerWidget("wijlineargauge",t.prototype)})(e.gauge||(e.gauge={}));var t=e.gauge})(wijmo||(wijmo={}));;
var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(e){var t=180,n=9,r=5,i=function(i){function s(){i.apply(this,arguments)}return __extends(s,i),s.prototype._create=function(){var e=this;i.prototype._create.call(this),e.element.addClass(this.options.wijCSS.radialGauge)},s.prototype._set_radius=function(){var e=this;e._redrawMarksAndLabels(),e.pointer.wijRemove(),e._paintPointer(),e._setPointer()},s.prototype._set_startAngle=function(){var e=this;e._redrawMarksAndLabels(),e._setPointer()},s.prototype._set_sweepAngle=function(e){var t=this;e>360&&(t.options.endAngle=360),t._redrawMarksAndLabels(),t._setPointer()},s.prototype._set_width=function(){var e=this;e._autoCalculate(),i.prototype._set_width.call(this)},s.prototype._set_height=function(){var e=this;e._autoCalculate(),i.prototype._set_height.call(this)},s.prototype._set_origin=function(){var e=this;e._autoCalculate()},s.prototype._set_cap=function(){var e=this;e.pointer.wijRemove(),e._paintPointer(),e._setPointer()},s.prototype._clearState=function(){i.prototype._clearState.call(this),this.markBbox=null},s.prototype._valueToAngleIncludeOffset=function(n){return e.GaugeUtil.mod360(this._valueToAngle(n)+t)},s.prototype._valueToAngle=function(e){var t=this,n=t._valueToLogical(e);return t._logicalToAngle(n)},s.prototype._angleToValue=function(e){var t=this,n=t._angleToLogical(e);return t._logicalToValue(n)},s.prototype._logicalToAngle=function(e){var t=this,n=t.options,r=n.startAngle,i=n.sweepAngle,s=n.isInverted;return s?r*e+(r+i)*(1-e):r*(1-e)+(r+i)*e},s.prototype._angleToLogical=function(t){var n=this,r=n.options,i=r.startAngle,s=r.isInverted,o=e.GaugeUtil.mod360(t-i),u=r.sweepAngle,a,f;return u===0||o===0?s?1:0:(u<0&&(o=360-o,u=-u),a=o-u,a>0?(f=360-o,a<f?1:0):s?1-o/u:o/u)},s.prototype._generatePoints=function(e,t,i,s){var o=this,u=o.options.isInverted,a=parseInt((n+n*(Math.abs(parseInt((t-e).toString(),10))/(n*r))).toString(),10),f=[],l,c,h,p,d;for(d=0;d<a;d++)l=d/(a-1),c=i+(s-i)*l,p=e+(t-e)*l,h=o._angleToValue(p),f.push(o._valueToPoint(h,c));return f},s.prototype._valueToPoint=function(e,t){var n=this,r=n._valueToAngleIncludeOffset(e)*Math.PI/180,i=t;return{x:i*Math.cos(r),y:i*Math.sin(r)}},s.prototype._pointToValue=function(t){var n=e.GaugeUtil.mod360(Math.atan2(t.x,-t.y)*180/Math.PI);return this._angleToValue(n)},s.prototype._radiusScreen=function(e){var t=this,n=t.options;return Math.max(n.radius*e,0)},s.prototype._autoCalculate=function(){var t=this,n=t.options,r=n.width,i=n.height,s,o,u,a=e.GaugeUtil.formatString(n.max,n.labels.format),f=0,l,c=i-n.marginTop-n.marginBottom,h=r-n.marginLeft-n.marginRight;t.centerPoint={x:n.marginLeft+h*n.origin.x,y:n.marginTop+c*n.origin.y},t.radius=n.radius,n.radius==="auto"&&(t.faceRadius=Math.min(h,c)/2,l=t._getFaceBorder(),t.faceRadius-=l,s=t._getMarkerbbox(n.tickMajor).width,o=t._getMarkerbbox(n.tickMinor).width,u=t._getLabelBBox(a).width,n.tickMajor.position==="center"?(f-=s/2,f-=u):n.tickMajor.position==="outside"&&(f-=s,f-=u),n.tickMinor.position==="center"?f=Math.min(f,-o/2):n.tickMinor.position==="outside"&&(f=Math.min(f,-o)),t.radius=t.faceRadius+f,n.tickMajor.position!=="inside"&&(t.faceRadius+=f))},s.prototype._getFaceBorder=function(){var e=this,t=e._paintFace(),n=t.attr("stroke-width")||1;return t.type==="set"&&(n=t[0].attr("stroke-width")||1),t.wijRemove(),n},s.prototype._getMaxRangeWidth=function(){var e=this,t=e.options,n=0;return $.each(t.ranges,function(e,t){n=Math.max(n,t.width||0),n=Math.max(n,t.startWidth||0),n=Math.max(n,t.endWidth||0)}),n},s.prototype._getMarkerbbox=function(e){var t=this,n=t._paintMarkEle(e),r=n.wijGetBBox();return n.wijRemove(),{width:r.width,height:r.height}},s.prototype._paintMark=function(e,t,n){var r=this,i,s=t.position||"inside",o=t.offset||0;return i=r._paintMarkEle(t),i.attr(t.style),$.wijraphael.addClass($(i.node),r.options.wijCSS.radialGaugeMarker),$(i.node).data("value",e),r._applyAlignment(i,s,o),r._setMarkValue(e,i),i},s.prototype._applyAlignment=function(e,t,n){if(!e)return;var r=e.wijGetBBox(),i=r.width/2,s=0;switch(t){case"outside":s-=i+n;break;case"inside":s+=i+n}e.transform("t"+s+","+0)},s.prototype._paintMarkEle=function(t){var n=this,r=n.options,i={x:n.centerPoint.x-n.radius,y:n.centerPoint.y},s=t.marker||"circle",o=s==="rect"?5:2,u=2,a,f=t.style["stroke-width"]||0;if(s==="tri"||s==="invertedTri")o=5,u=3;return s==="cross"&&(t.style.fill=t.style.stroke||t.style.fill),isNaN(i.x)&&(i.x=0),a=o*t.factor,u+=f*2,a+=f*2,$.isFunction(s)?s.call(n,n.canvas,i,r):e.GaugeUtil.paintMarker(n.canvas,s,i.x,i.y,a,u)},s.prototype._setMarkValue=function(e,t){var n=this,r=n._valueToAngle(e);t.transform(Raphael.format("r{0},{1},{2}...",r,n.centerPoint.x,n.centerPoint.y))},s.prototype._paintLabel=function(t,n){var r=this,i=r._valueToAngle(t),s=n.format,o=n.style,u=n.offset,a=t.toString(),f=r.options.tickMajor,l=f.position||"inside",c,h,p,d,v;s!==""&&(a=e.GaugeUtil.formatString(t,s)),p=r._getMarkerBbox(),v=r._getLabelBBox(a);switch(l){case"inside":d=p.x+p.width+v.width/2;break;case"outside":d=p.x-v.width/2;break;default:d=p.x-v.width/2}return d=r.centerPoint.x-d+u,c=e.GaugeUtil.getPositionByAngle(r.centerPoint.x,r.centerPoint.y,d,i),h=r.canvas.text(c.x,c.y,a),h.attr(o),$.wijraphael.addClass($(h.node),r.options.wijCSS.radialGaugeLabel),h},s.prototype._getLabelBBox=function(e){var t=this,n=t.options,r,i;return r=t.canvas.text(0,0,e),r.attr(n.gaugeLableStyle),i=r.wijGetBBox(),r.wijRemove(),i},s.prototype._getMarkerBbox=function(){var e=this,t=e.options,n=t.tickMajor,r;return e.markBbox||(r=e._paintMarkEle(n),e._applyAlignment(r,n.position,n.offset||0),e.markBbox=r.wijGetBBox(),r.wijRemove()),e.markBbox},s.prototype._paintFace=function(){var e=this,t=e.options,n=Math.min(t.width,t.height)/2,r,i;return e.faceRadius&&(n=e.faceRadius),t.face&&t.face.template&&$.isFunction(t.face.template)?(i={canvas:e.canvas,r:n,origin:{x:e.centerPoint.x,y:e.centerPoint.y}},t.face.template.call(e,i)):(r=e.canvas.circle(e.centerPoint.x,e.centerPoint.y,n),t.face&&t.face.style&&r.attr(t.face.style),$.wijraphael.addClass($(r.node),t.wijCSS.radialGaugeFace),r)},s.prototype._paintPointer=function(){var e=this,t=e.options,n=t.pointer,r=e.radius*n.length,i={x:e.centerPoint.x-r+n.offset*e.radius,y:e.centerPoint.y-n.width/2},s;if(!n.visible)return;t.cap&&t.cap.behindPointer&&t.cap.visible&&e._paintCap(),n.template&&$.isFunction(n.template)?s=n.template.call(e.canvas,i,$.extend({},n,{length:r})):(n.shape==="rect"?s=e.canvas.rect(i.x-n.width/2,i.y,r,n.width):s=e.canvas.isoTri(i.x-n.width/2,i.y,r,n.width),s.attr(n.style)),e.pointer=s,$.wijraphael.addClass($(s.node),t.wijCSS.radialGaugePointer),(!t.cap||!t.cap.behindPointer)&&t.cap.visible&&e._paintCap()},s.prototype._paintCap=function(){var e=this,t=e.options,n=t.cap,r;return n&&n.template&&$.isFunction(n.template)?(r={canvas:e.canvas,origin:{x:e.centerPoint.x,y:e.centerPoint.y}},e.cap=n.template.call(e,r),e.cap):(e.cap=e.canvas.circle(e.centerPoint.x,e.centerPoint.y,n.radius),n&&n.style&&e.cap.attr(n.style),$.wijraphael.addClass($(e.cap.node),t.wijCSS.radialGaugeCap),e.cap)},s.prototype._paintRange=function(e){var t=this,n=t.options,r=isNaN(e.startValue)?0:e.startValue,i=isNaN(e.endValue)?0:e.endValue,s=isNaN(e.startWidth)?isNaN(e.width)?0:e.width:e.startWidth,o=isNaN(e.endWidth)?isNaN(e.width)?0:e.width:e.endWidth,u=e.startDistance||1,a=e.endDistance||1,f,l;r!==i&&(i>r?(f=Math.max(r,n.min),l=Math.min(n.max,i)):(f=Math.max(n.min,i),l=Math.min(n.max,r)),u*=t.radius,a*=t.radius,t._drawRange(f,l,u,a,s,o,e))},s.prototype._drawRange=function(e,t,n,r,i,s,o){var u=this,a=u._valueToAngle(e),f=u._valueToAngle(t),l=u._generatePoints(a,f,i+n,s+r),c=u._generatePoints(a,f,n,r),h,p,d="";$.each(l,function(e,t){e===0?d+="M"+Math.round(t.x+u.centerPoint.x)+" "+Math.round(t.y+u.centerPoint.y):d+="L"+(t.x+u.centerPoint.x)+" "+Math.round(t.y+u.centerPoint.y)});for(h=c.length-1;h>=0;h--)d+="L"+Math.round(c[h].x+u.centerPoint.x)+" "+Math.round(c[h].y+u.centerPoint.y);d+="Z",p=u.canvas.path(d),p.attr(o.style),u.ranges.push(p),$.wijraphael.addClass($(p.node),u.options.wijCSS.radialGaugeRange)},s.prototype._setOffPointerValue=function(){var e=this,t=e._valueToAngle(0);e.pointer.transform(Raphael.format("r{0},{1},{2}",t,e.centerPoint.x,e.centerPoint.y))},s.prototype._setPointer=function(){var e=this,t=e.options,n=e._valueToAngle(t.value),r=t.animation;if(!e.pointer)return;i.prototype._setPointer.call(this),r.enabled?e.pointer.stop().wijAnimate({transform:"r"+n+","+e.centerPoint.x+","+e.centerPoint.y},r.duration,r.easing):e.pointer.transform(Raphael.format("r{0},{1},{2}",n,e.centerPoint.x,e.centerPoint.y))},s}(e.wijgauge);e.wijradialgauge=i,i.prototype.widgetEventPrefix="wijradialgauge";var s=function(){function e(){this.initSelector=":jqmData(role='wijradialgauge')",this.wijCSS={radialGauge:"wijmo-wijradialgauge",radialGaugeLabel:"wijmo-wijradialgauge-label",radialGaugeMarker:"wijmo-wijradialgauge-mark",radialGaugeFace:"wijmo-wijradialgauge-face",radialGaugePointer:"wijmo-wijradialgauge-pointer",radialGaugeCap:"wijmo-wijradialgauge-cap",radialGaugeRange:"wijmo-wijradialgauge-range"},this.radius="auto",this.startAngle=0,this.sweepAngle=180,this.pointer={length:.8,style:{fill:"#1E395B",stroke:"#1E395B"},width:8,offset:.15,shape:"tri",visible:!0,template:null},this.origin={x:.5,y:.5},this.labels={format:"",style:{fill:"#1E395B","font-size":12,"font-weight":"800"},offset:30,visible:!0},this.tickMinor={position:"inside",offset:30,style:{fill:"#1E395B"},visible:!0,factor:1,marker:"rect",interval:5},this.tickMajor={position:"inside",offset:27,style:{fill:"#1E395B",stroke:"#1E395B","stroke-width":1},visible:!0,interval:10,factor:2,marker:"rect"},this.cap={radius:15,style:{fill:"#1E395B",stroke:"#1E395B"},behindPointer:!1,visible:!0,template:null},this.face={style:{fill:"r(0.9, 0.60)#FFFFFF-#D9E3F0",stroke:"#7BA0CC","stroke-width":4},template:null}}return e}();i.prototype.options=$.extend(!0,{},e.wijgauge.prototype.options,new s),$.wijmo.registerWidget("wijradialgauge",i.prototype)})(e.gauge||(e.gauge={}));var t=e.gauge})(wijmo||(wijmo={}));;
var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(t){"use strict";var n=jQuery,r="wijlightbox";!window.S&&window.swfobject&&(window.S={flash:window.swfobject});var i=function(t){function r(){t.apply(this,arguments)}return __extends(r,t),r.prototype._keyDownHandler=function(t){var n=this.options,r=this,i=e.getKeyCodeEnum();if(t.keyCode&&t.keyCode===i.ESCAPE){r._isFullSize()?r._toggleFullSize():n.closeOnEscape&&r._close(),t.preventDefault();return}if(n.keyNav&&t.keyCode)switch(t.keyCode){case i.LEFT:case i.DOWN:r.back(),t.preventDefault();break;case i.RIGHT:case i.UP:r.next(),t.preventDefault();break;case i.HOME:n.groupItems.length>0&&r.show(0),t.preventDefault();break;case i.END:n.groupItems.length>0&&r.show(n.groupItems.length-1),t.preventDefault()}},r.prototype._create=function(){var e=this.options,t=this;window.wijmoApplyWijTouchUtilEvents&&(n=window.wijmoApplyWijTouchUtilEvents(n)),e.groupItems||(e.groupItems=[]),this._defaults={transAnimation:{animated:"fade",duration:400,easing:"linear"},resizeAnimation:{animated:"sync",duration:400},textShowOption:{duration:300,easing:"linear"},textHideOption:{duration:300,easing:"linear"}},this._parse(),this.container=n("<div/>").addClass("wijmo-wijlightbox "+e.wijCSS.widget+" wijmo-wijlightbox-controls-"+e.controlsPosition).css("z-index",e.zIndex).attr({tabIndex:-1,role:"dialog"}).bind("keydown.wijlightbox",n.proxy(t,"_keyDownHandler")).appendTo(document.body).hide(),this.frame=n("<div></div>").addClass(["wijmo-wijlightbox-frame",e.wijCSS.content,e.wijCSS.cornerAll,e.wijCSS.helperClearFix].join(" ")).appendTo(this.container),this.content=n("<div></div>").addClass("wijmo-wijlightbox-content").appendTo(this.frame),e.activeIndex===undefined?(typeof e.activeIndex!="number"&&e.cookie&&(e.activeIndex=parseInt(t._cookie(),10)),e.activeIndex=e.activeIndex||(e.groupItems.length?0:-1)):e.activeIndex===null&&(e.activeIndex=-1),e.activeIndex=e.activeIndex>=0&&e.groupItems[e.activeIndex]||e.activeIndex<0?e.activeIndex:0,this._initClickBehavior(),this._createTimerBar(),this._createDialogButtons(),this._createCtrlButtons(),this._createText(),this._createCounter(),this._refreshCounter(),this.toolBox&&this.toolBox.find(".wijmo-wijlightbox-toolbox-button").bind({mouseover:function(){t._addState("hover",n(this))},mouseout:function(){t._removeState("hover",n(this))},mousedown:function(){t._addState("active",n(this))},mouseup:function(){t._removeState("active",n(this))}}),this._groupMode()&&this._createNavButtons(),this._initHoverBehavior(),this.container.width(this.frame.outerWidth())},r.prototype.destroy=function(){var e=this.options,t=this;return this._hideWaiting(),this._hideOverlay(),e.cookie&&this._cookie(null,e.cookie),this.container.remove(),n.Widget.prototype.destroy.apply(t,arguments),t},r.prototype._setOption=function(e,t){var r=this.options[e];n.Widget.prototype._setOption.apply(this,arguments);switch(e){case"groupItems":this.options.activeIndex>=t.length?this.show(t.length-1):this.options.activeIndex<0&&t.length?this.show(0):this.show(this.options.activeIndex);break;case"activeIndex":this.show(t);break;case"textPosition":this._resetText();break;case"clickPause":this._initClickBehavior();break;case"showNavButtons":this._createNavButtons();break;case"showControlsOnHover":this._initHoverBehavior();break;case"controlsPosition":this._set_controlsPosition(r,t)}},r.prototype._set_controlsPosition=function(e,t){e!==t&&(this._removeCounter(),this._removeNavButtons(),this.container.removeClass("wijmo-wijlightbox-controls-outside wijmo-wijlightbox-controls-inside").addClass("wijmo-wijlightbox-controls-"+t),this._createCounter(),this._createNavButtons())},r.prototype._initClickBehavior=function(){var e=this.options,t=this;this.content.unbind("click"),e.clickPause?this._groupMode()&&this.content.click(function(){t[t.isPlaying()?"stop":"play"]()}):this._groupMode()&&this.content.click(function(r){if(t.isPlaying())return!1;var i=n.extend({},n(this).offset(),{width:n(this).outerWidth(!0),height:n(this).outerHeight(!0)});r.pageX>=i.left&&r.pageX<i.left+i.width/2?t.backBtn.hasClass(e.wijCSS.stateDisabled)||t.back():t.nextBtn.hasClass(e.wijCSS.stateDisabled)||t.next()})},r.prototype._initHoverBehavior=function(){var e=this.options,t=this;this.frame.unbind(".wijlightbox"),e.showControlsOnHover&&this.frame.bind({"mouseenter.wijlightbox":function(){if(t.container.data("moving.wijlightbox"))return!1;t._showAccessories(!0)},"mouseleave.wijlightbox":function(){if(t.container.data("moving.wijlightbox"))return!1;t._hideAccessories(!0)},"mousemove.wijlightbox":function(){t.container.data("moving.wijlightbox")===!1&&t.container.data("accessvisible.wijlightbox")===!1&&t.frame.trigger("mouseenter")}})},r.prototype._getPlugins=function(){var e=this.container.data("plugins.wijlightbox"),t,r,i;return e||(e={},window.navigator.plugins&&window.navigator.plugins.length?(t=[],n.each(window.navigator.plugins,function(e,n){t.push(n.name)}),t=t.join(","),i=t.indexOf("Flip4Mac")>-1,e={fla:t.indexOf("Shockwave Flash")>-1,qt:t.indexOf("QuickTime")>-1,wmp:!i&&t.indexOf("Windows Media")>-1,f4m:i}):(r=function(e){var t;try{t=new ActiveXObject(e)}catch(n){}return!!t},e={fla:r("ShockwaveFlash.ShockwaveFlash"),qt:r("QuickTime.QuickTime"),wmp:r("wmplayer.ocx"),f4m:!1}),this.container.data("plugins.wijlightbox",e)),e},r.prototype._sanitizeSelector=function(e){return e.replace(/:/g,"\\:")},r.prototype._getFragmentId=function(e){var t=/^#.+/,r=n(e).attr("href")||"",i=r.split("#")[0],s=n("base")[0];return i&&(i===window.location.toString().split("#")[0]||s&&i===s.attributes.href)&&(r=e.hash,e.href=r),t.test(r)?this._sanitizeSelector(r):""},r.prototype._parseLink=function(e){var t=this,r=this.options,i=n(e),s={href:undefined,player:undefined,img:undefined,gallery:undefined},o,u,a,f,l=["href","player","title","alt","height","width","gallery","wijvideosrc"];if(i.length>0&&i[0].tagName.toLowerCase()==="a"){o=i.attr("rel"),n.each(l,function(e,t){s[t]=i.attr(t)||""});if(!s.href)return;s.player||(s.player=r.player||t._getPlayerName(s.href)),u=i.find("img"),u&&u.length===0&&(u=i),u&&u.length>=1&&(n.each(["title","alt"],function(e,t){s[t]=u.attr(t)||s[t]}),s.img=u),o&&(a=o.match(/\[(.*?)\]/),a&&(s.gallery=a[1]||s.gallery),n.each(o.split(";"),function(e,t){var n=t.match(/\s*([a-z_]*?)\s*=\s*(.+)\s*/);n&&(s[n[1]]=n[2])})),s.player==="inline"&&(s.href=t._getFragmentId(e)),s.gallery?(f=r.groupItems.length,r.groupItems[f]=s,i.bind({click:function(e){return e.stopPropagation(),e.preventDefault(),r.disabled||t._open(u,f),!1}})):i.bind({click:function(e){return e.stopPropagation(),e.preventDefault(),r.disabled||t._open(u,s),!1}})}},r.prototype._parse=function(){var e=this;this._parseLink(this.element),this.element.find('a[rel^="wijlightbox"], a[rel^="lightbox"]').each(function(t,n){e._parseLink(n)})},r.prototype._showAccessories=function(e){this.container.data("accessvisible.wijlightbox",!0),this._showNavButtons(e),this._showToolboxButtons(e),this._showCounter(e)},r.prototype._hideAccessories=function(e){this.container.data("accessvisible.wijlightbox",!1),this._hideNavButtons(e),this._hideToolboxButtons(e),this._hideCounter(e)},r.prototype._groupMode=function(){var e=this.options;return e.groupItems&&e.groupItems.length>1},r.prototype._resetText=function(){this._removeText(),this._createText()},r.prototype._createText=function(e){var t=this,r=t.options,i,s,o,u,a;if(r.textPosition==="none")return;if(this.container.find(".wijmo-wijlightbox-text").length)return;i=r.textPosition.toLowerCase(),s=n("<div></div>").addClass("wijmo-wijlightbox-text wijmo-wijlightbox-text-"+i+" "+r.wijCSS.content+" "+r.wijCSS.helperClearFix),u=n("<h3></h3>").addClass("wijmo-wijlightbox-title wijmo-wijlightbox-title-"+i+" "+r.wijCSS.helperClearFix).appendTo(s),a=n("<p></p>").addClass("wijmo-wijlightbox-detail wijmo-wijlightbox-detail-"+i+" "+r.wijCSS.helperClearFix).appendTo(s);if(r.textPosition==="inside")s.addClass(r.wijCSS.content+" "+r.wijCSS.helperClearFix).width(this.frame.width()).appendTo(this.frame);else if(r.textPosition==="outside")s.addClass([r.wijCSS.content,r.wijCSS.cornerAll,r.wijCSS.helperClearFix].join(" ")).width(this.frame.width()).appendTo(this.container);else if(r.textPosition==="overlay"||r.textPosition==="titleOverlay")o=n("<div></div>").addClass("wijmo-wijlightbox-mask wijmo-wijlightbox-mask-"+i+" "+r.wijCSS.helperClearFix).width(this.frame.width()).appendTo(this.frame),s.width(this.frame.width()).appendTo(this.frame),r.textPosition==="titleOverlay"&&s.bind({mouseenter:function(){o.stop(),s.stop();var e=u.outerHeight(!0)+a.outerHeight(!0),i=n.extend({},t._defaults.textShowOption,r.textShowOption,{queue:!1});o.animate({height:e},i),s.animate({height:e},i)},mouseleave:function(){o.stop(),s.stop();var e=u.height(),i=n.extend({},t._defaults.textHideOption,r.textHideOption,{queue:!1});o.animate({height:e},i),s.animate({height:e},i)}});this._refreshText(e)},r.prototype._removeText=function(){this.container.find(".wijmo-wijlightbox-text,.wijmo-wijlightbox-mask").remove()},r.prototype._getActiveItem=function(){var e=this.options;return e.groupItems&&e.groupItems.length&&e.activeIndex>=0&&e.activeIndex<e.groupItems.length?e.groupItems[e.activeIndex]:null},r.prototype._refreshText=function(e){var t=this,r=this.options,i,s,o,u,a;if(r.textPosition==="none")return;i=this.container.data("item.wijlightbox")||this._getActiveItem();if(!i)return;s=this.container.find(".wijmo-wijlightbox-text"),o=this.container.find(".wijmo-wijlightbox-title"),u=this.container.find(".wijmo-wijlightbox-detail"),a=this.container.find(".wijmo-wijlightbox-mask"),a.stop(),s.stop(),o.html(i.title),u.html(i.alt),r.textPosition==="outside"&&s.width(this.frame.width());var f=o.outerHeight(!0),l=u.outerHeight(!0),c=n.extend({},t._defaults.textShowOption,r.textShowOption,{queue:!1});if(r.textPosition==="overlay"||r.textPosition==="titleOverlay"){var h=f+(r.textPosition==="overlay"?l:0);s.height(0),a.height(0),s.animate({height:h},c),a.animate({height:h},c)}else e?s.height(f+l):(s.height(0),s.animate({height:f+l},c))},r.prototype._addState=function(e,t){t.is(":not(."+this.options.wijCSS.stateDisabled+")")&&t.addClass("ui-state-"+e)},r.prototype._removeState=function(e,t){t.removeClass("ui-state-"+e)},r.prototype._createNavButtons=function(){var e=this,t=this.options;if(!t.showNavButtons||!this._groupMode()){this._removeNavButtons();return}this.backBtn||(this.backBtn=n("<a href='#'/>").addClass("wijmo-wijlightbox-button wijmo-wijlightbox-button-prev "+t.wijCSS.stateDefault+" "+(t.controlsPosition==="inside"?t.wijCSS.cornerRight:t.wijCSS.cornerLeft)).append("<span class='"+t.wijCSS.icon+" "+t.wijCSS.iconArrowLeft+"'></span>").hide().appendTo(this.frame).bind({click:function(){return n(this).hasClass(t.wijCSS.stateDisabled)||e.back(),!1},mouseover:function(){e._addState("hover",n(this))},mouseout:function(){e._removeState("hover",n(this))},mousedown:function(){e._addState("active",n(this))},mouseup:function(){e._removeState("active",n(this))}})),this.nextBtn||(this.nextBtn=n("<a href='#'/>").addClass("wijmo-wijlightbox-button wijmo-wijlightbox-button-next "+t.wijCSS.stateDefault+" "+(t.controlsPosition==="inside"?t.wijCSS.cornerLeft:t.wijCSS.cornerRight)).append("<span class='"+t.wijCSS.icon+" "+t.wijCSS.iconArrowRight+"'></span>").hide().appendTo(this.frame).bind({click:function(){return n(this).hasClass(t.wijCSS.stateDisabled)||e.next(),!1},mouseover:function(){e._addState("hover",n(this))},mouseout:function(){e._removeState("hover",n(this))},mousedown:function(){e._addState("active",n(this))},mouseup:function(){e._removeState("active",n(this))}}))},r.prototype._removeNavButtons=function(){this.backBtn&&(this.backBtn.remove(),this.backBtn=undefined),this.nextBtn&&(this.nextBtn.remove(),this.nextBtn=undefined)},r.prototype._refreshNavButtons=function(){var e=this.options,t;this.backBtn&&(t=e.activeIndex===0?"addClass":"removeClass",this.backBtn[t](e.wijCSS.stateDisabled)),this.nextBtn&&(t=e.activeIndex>=e.groupItems.length-1?"addClass":"removeClass",this.nextBtn[t](e.wijCSS.stateDisabled))},r.prototype._showNavButtons=function(e){if(this.isPlaying())return;this.container.find(".wijmo-wijlightbox-button").stop(!0,!0).fadeIn(e?600:0,function(){n(this).css("opacity","")})},r.prototype._hideNavButtons=function(e){this.container.find(".wijmo-wijlightbox-button").stop(!0,!0).fadeOut(e?600:0)},r.prototype._createToolbox=function(){this.toolBox||(this.toolBox=n("<div></div>").addClass("wijmo-wijlightbox-toolbox").appendTo(this.frame))},r.prototype._showToolboxButtons=function(e){this.container.find(".wijmo-wijlightbox-toolbox-button").stop(!0,!0).fadeIn(e?600:0,function(){n(this).css("opacity","")})},r.prototype._hideToolboxButtons=function(e){this.container.find(".wijmo-wijlightbox-toolbox-button").stop(!0,!0).fadeOut(e?600:0)},r.prototype._createCtrlButtons=function(){var e=this,t=this.options,r=t.wijCSS;if(!t.ctrlButtons||t.ctrlButtons.length===0||!this._groupMode()){this._removeCtrlButtons();return}this._createToolbox();var i=t.ctrlButtons.split("|");i.length===1&&i[0]===t.ctrlButtons&&(i=t.ctrlButtons.split(",")),n.each(i,function(i,s){s=n.trim(s),s==="play"&&!this.playBtn?e.playBtn=n("<a href='#'/>").addClass(["wijmo-wijlightbox-toolbox-button"," wijmo-wijlightbox-toolbox-button-play ",r.stateDefault,r.cornerAll].join(" ")).append("<span class='"+r.icon+" "+r.iconPlay+"'></span>").hide().click(function(){return e.isPlaying()?e.stop():(t.activeIndex>=t.groupItems.length-1&&e.show(0),e.play()),!1}):s==="stop"&&!this.stopBtn&&(e.stopBtn=n("<a href='#'/>").addClass(["wijmo-wijlightbox-toolbox-button","wijmo-wijlightbox-toolbox-button-stop",r.stateDefault,r.stateDisabled,r.cornerAll].join(" ")).append("<span class='"+r.icon+" "+r.iconStop+"'></span>").hide().click(function(){return e.isPlaying()&&(e.stop(),e.show(0)),!1}))}),this.stopBtn&&this.stopBtn.appendTo(this.toolBox),this.playBtn&&this.playBtn.appendTo(this.toolBox)},r.prototype._removeCtrlButtons=function(){this.playBtn&&(this.playBtn.remove(),this.playBtn=undefined),this.stopBtn&&(this.stopBtn.remove(),this.stopBtn=undefined)},r.prototype._refreshCtrlButtons=function(){var e=this.options.wijCSS;if(this.playBtn){var t=this.playBtn.find("."+e.icon);t&&(t.removeClass(e.iconPause+" "+e.iconPlay),t.addClass(this.isPlaying()?e.iconPause:e.iconPlay))}this.stopBtn&&this.stopBtn[this.isPlaying()?"removeClass":"addClass"](e.stateDisabled)},r.prototype._createDialogButtons=function(){var e=this,t=this.options,r;if(!t.dialogButtons||t.dialogButtons.length===0){this._removeDialogButtons();return}this._createToolbox(),r=t.dialogButtons.split("|"),r.length===1&&r[0]===t.dialogButtons&&(r=t.dialogButtons.split(",")),n.each(r,function(r,i){i=n.trim(i),i==="close"&&!this.closeBtn?e.closeBtn=n("<a href='#'/>").addClass("wijmo-wijlightbox-toolbox-button wijmo-wijlightbox-toolbox-button-close "+t.wijCSS.stateDefault+" "+t.wijCSS.cornerAll).append("<span class='"+t.wijCSS.icon+" "+t.wijCSS.iconClose+"'></span>").hide().click(function(){return e._close(),!1}):i==="fullSize"&&!this.fullBtn&&(e.fullBtn=n("<a href='#'/>").addClass("wijmo-wijlightbox-toolbox-button wijmo-wijlightbox-toolbox-button-fullsize "+t.wijCSS.stateDefault+" "+t.wijCSS.cornerAll).append("<span class='"+t.wijCSS.icon+" "+t.wijCSS.iconArrow4Diag+"'></span>").hide().click(function(){return e._toggleFullSize(),!1}))}),this.closeBtn&&this.closeBtn.appendTo(this.toolBox),this.fullBtn&&this.fullBtn.appendTo(this.toolBox),this.btnSep||(this.btnSep=n("<a href='#'/>").addClass("wijmo-wijlightbox-toolbox-separator").appendTo(this.toolBox))},r.prototype._removeDialogButtons=function(){this.closeBtn&&(this.closeBtn.remove(),this.closeBtn=undefined),this.fullBtn&&(this.fullBtn.remove(),this.fullBtn=undefined)},r.prototype._refreshDialogButtons=function(){var e=this.options.wijCSS;if(this.fullBtn){var t=this.fullBtn.find("."+e.icon);t&&(t.removeClass(e.iconArrow4Diag+" "+e.iconNewWin),t.addClass(this._isFullSize()?e.iconNewWin:e.iconArrow4Diag))}},r.prototype._createTimerBar=function(){var e=this,t=e.options;if(!t.showTimer||!e._groupMode()){e._removeTimerBar();return}e._createToolbox(),e.timerBar||(e.timerBar=n("<div></div>").addClass("wijmo-wijlightbox-timerbar "+t.wijCSS.content+" ui-priority-secondary "+t.wijCSS.cornerAll).appendTo(e.toolBox),e.timerMeter=n("<div></div>").addClass("wijmo-wijlightbox-timermeter ui-progressbar-value "+t.wijCSS.content+" "+t.wijCSS.cornerAll).appendTo(e.toolBox))},r.prototype._removeTimerBar=function(){this.timerMeter&&(this.timerMeter.remove(),this.timerMeter=undefined),this.timerBar&&(this.timerBar.remove(),this.timerBar=undefined)},r.prototype._createCounter=function(){var e=this,t=e.options;if(!t.showCounter||!e._groupMode()){e._removeCounter();return}e.counter||(e.counter=n("<div></div>").addClass("wijmo-wijlightbox-counter "+t.wijCSS.stateDefault+" "+(t.controlsPosition==="inside"?t.wijCSS.cornerTL:t.wijCSS.cornerAll)).hide().appendTo(e.frame))},r.prototype._removeCounter=function(){this.counter&&(this.counter.remove(),this.counter=undefined)},r.prototype._refreshCounter=function(e){var t=this,r=this.options,i="";if(!this.counter||!this._groupMode())return;this.counter.empty();if(r.showCounter&&r.groupItems.length>1&&this.counter){e===undefined&&(e=r.activeIndex);var s=r.groupItems.length;if(r.counterType==="sequence"){var o=0,u=s,a=parseInt(r.counterLimit,10)||0;if(a>=2&&a<s){var f=Math.floor(a/2);o=Math.min(u-a,Math.max(o,e-f)),u=Math.min(u,o+a)}while(o!==u)n("<a></a>").addClass("wijmo-wijlightbox-counter-item "+r.wijCSS.content+" "+r.wijCSS.stateDefault+(o===e?" wijmo-wijlightbox-counter-active "+r.wijCSS.stateActive:"")).text((++o).toString()).appendTo(this.counter);this.counter.find("a").click(function(e,r){return n(this).hasClass("wijmo-wijlightbox-counter-active")?!1:(t.show(parseInt(n(this).text(),10)-1),!1)})}else{var l=r.counterFormat||"[i] of [n]";i=l.replace("[i]",e+1),i=i.replace("[n]",s),n("<span></span>").text(i).appendTo(this.counter)}}},r.prototype._showCounter=function(e){this.container.find(".wijmo-wijlightbox-counter").stop(!0,!0).fadeIn(e?600:0,function(){n(this).css("opacity","")})},r.prototype._hideCounter=function(e){this.container.find(".wijmo-wijlightbox-counter").stop(!0,!0).fadeOut(e?600:0)},r.prototype._cookie=function(e,t){var r=this.cookie||(this.cookie=this.options.cookie.name);return n.cookie.apply(null,[r].concat(n.makeArray(arguments)))},r.prototype._showOverlay=function(){if(this.container.data("overlay.wijlightbox"))return;this.container.data("overlay.wijlightbox",new n.wijmo.wijlightbox.overlay(this))},r.prototype._hideOverlay=function(){var e=this.container.data("overlay.wijlightbox");if(!e)return;e.close(),this.container.removeData("overlay.wijlightbox")},r.prototype._hasOverlay=function(){return this.container.hasData("overlay.wijlightbox")},r.prototype._showWaiting=function(){if(this.container.data("waiting.wijlightbox"))return;this.container.data("waiting.wijlightbox",new n.wijmo.wijlightbox.overlay(this,!0))},r.prototype._hideWaiting=function(){var e=this.container.data("waiting.wijlightbox");if(!e)return;e.close(),this.container.removeData("waiting.wijlightbox")},r.prototype._hasWaiting=function(){return this.container.hasData("waiting.wijlightbox")},r.prototype._getUrl=function(e){var t=this.options,n=typeof e=="string"?e:e.href,r=t.rootUrl;return r&&r.length>0&&(r.indexOf("//")===-1&&(r=window.location.protocol+"//"+window.location.host+(r.startsWith("/")?"":"/")+r),r.substr(r.length-1,1)!=="/"&&(r+="/"),n=r+(n.substr(0,1)==="/"?n.substr(1):n)),n},r.prototype._preload=function(){var e=this.options,t;for(t=Math.max(0,e.activeIndex);t<Math.min(e.activeIndex+5,e.groupItems.length);t++)e.groupItems[t].image||(e.groupItems[t].image=new Image,e.groupItems[t].image.src=this._getUrl(e.groupItems[t]))},r.prototype._slideAnimate=function(e,t,r){var i=["position","top","bottom","left","right","width","height"],s=n.setMode(t,e.mode||"show"),o=s==="show",u=e.direction||"left",a=u==="up"||u==="down"?"top":"left",f=u==="up"||u==="left",l,c={};n.save(t,i),t.show(),l=e.distance||t[a==="top"?"outerHeight":"outerWidth"](!0),n.createWrapper(t).css({overflow:"hidden"}),o&&t.css(a,f?isNaN(l)?parseInt("-"+l):-l:l),c[a]=(o?f?"+=":"-=":f?"-=":"+=")+l,t.animate(c,{queue:!1,duration:e.duration,easing:e.easing,complete:function(){s==="hide"&&t.hide(),n.restore(t,i),n.removeWrapper(t),r()}})},r.prototype._slideTo=function(e,t,r,i,s){var o=this.options,u=this,a=e.getElement(),f,l,c,h,p,d,v,m;a.parent().is(".wijmo-wijlightbox-aniwrapper")?f=a.parent():(f=n.createWrapper(a).css({overflow:"hidden"}),f.removeClass("ui-effects-wrapper"),f.addClass("wijmo-wijlightbox-aniwrapper")),f.parent().is(".wijmo-wijlightbox-aniwrapper")?l=f.parent():(l=n.createWrapper(f).css({overflow:"hidden"}),l.removeClass("ui-effects-wrapper"),l.addClass("wijmo-wijlightbox-aniwrapper")),c=o.slideDirection||"horizontal",h=a.outerWidth(),p=a.outerHeight(),c==="horizontal"?(a.width(h).css("float",i?"left":"right"),f.width(2*h).css({left:i?0:-1*h,position:"absolute"})):(a.height(p),f.width(h).css({top:i?0:-1*p,position:"absolute"}).height(2*p)),t.appendTo(f),d=t.getElement(),c==="horizontal"?d.width(h).css("float",i?"left":"right"):d.height(p),this.container.data("animating.wijlightbox",!0),v=function(){a=f.children(":last");while(a.parent().is(".wijmo-wijlightbox-aniwrapper"))a.parent().replaceWith(a);a.css({"float":"",width:"",height:""}),o.autoSize&&!u._isFullSize()?u._resize(s):(n.isFunction(s)&&s.apply(u),u._refreshText())},m={mode:"hide",direction:c==="horizontal"?i?"left":"right":i?"up":"down",easing:r.easing,distance:c==="horizontal"?h:p,duration:r.duration},n.effects?f.effect("slide",m,v):u._slideAnimate(m,f,v)},r.prototype._moveFrom=function(e,t,r){var i=this,s=this.options,o;n.isFunction(t)?(r=t,t=n.extend({},i._defaults.resizeAnimation,s.resizeAnimation)):t=n.extend({},i._defaults.resizeAnimation,s.resizeAnimation,t),i._removeText();if(t.animated==="none"||t.duration<=0){i._createText(),n.isFunction(r)&&r.apply(i),this.container.data("moving.wijlightbox",!1);return}o=n.extend({width:i.frame.width(),height:i.frame.height()},i.container.offset()),i.frame.width(e.width).height(e.height),i.container.css({left:e.left,top:e.top,width:i.frame.outerWidth(),position:"absolute",opacity:""}),i._moveTo(o,t,function(){i.frame.width(o.width),i.container.width(i.frame.outerWidth()),i._createText(),i.container.data("moving.wijlightbox",!1),n.isFunction(r)&&r.apply(i)})},r.prototype._moveTo=function(e,t,r){var i=this,s=this.options;n.isFunction(t)?(r=t,t=n.extend({},i._defaults.resizeAnimation,s.resizeAnimation)):t=n.extend({},i._defaults.resizeAnimation,s.resizeAnimation,t);var o=t.duration/2,u=t.animated,a=i._isOpen(),f=u==="wh"?{left:e.left,top:undefined}:{top:e.top},l=u==="wh"?{top:e.top,left:undefined}:{left:e.left},c=u==="wh"?{width:e.width,height:undefined}:{height:e.height},h=u==="wh"?{height:e.height,width:undefined}:{width:e.width};if(u==="wh"||u==="hw"){a&&i.container.animate(f,{duration:o,easing:t.easing,queue:!0}),i.frame.animate(c,{duration:o,easing:t.easing,complete:function(){a&&i.container.animate(l,{duration:o,easing:t.easing,queue:!0}),i.frame.animate(h,{duration:o,easing:t.easing,complete:function(){i.container.data("moving.wijlightbox",!1),n.isFunction(r)&&r.apply(i)}})}});return}a&&i.container.animate({left:e.left,top:e.top},{duration:t.duration,easing:t.easing,queue:!0}),i.frame.animate({width:e.width,height:e.height,opacity:1},{duration:t.duration,easing:t.easing,complete:function(){i.container.data("moving.wijlightbox",!1),n.isFunction(r)&&r.apply(i)}})},r.prototype.show=function(e){return this._show(e),this},r.prototype._resize=function(e){var t=this,r=n.extend({},t.container.offset(),{width:t.frame.width(),height:t.frame.height()});t._size(),t._isOpen()&&t._position(),t._moveFrom(r,e)},r.prototype._onAfterShow=function(){var e=this,t=this.options,n;e._refreshNavButtons(),e.container.data("animating.wijlightbox",!1),t.modal||e._hideOverlay(),n={index:t.activeIndex,item:t.groupItems[t.activeIndex]},e._trigger("show",null,n),e._startTimer()},r.prototype._show=function(e,t,r){var i=this,s=this.options,o,u;if(this.container.data("showing.wijlightbox"))return o=[function(){i._show(e,t,r)}],this.container.queue("showqueue",o),this;u=s.activeIndex;if(!n.isPlainObject(e)){u=e;if(u<0||u>=s.groupItems.length)return this;e=s.groupItems[u]}e&&this.container.data("item.wijlightbox",e),this._groupMode()&&this._preload(),n.isFunction(t)&&(r=t,t=undefined),r||(r=i._onAfterShow);var a={index:u,item:e};if(i._trigger("beforeShow",null,a)===!1)return this;this.container.data("showing.wijlightbox",!0);var f=function(){n.isFunction(r)&&r.apply(i),i.container.data("showing.wijlightbox",!1),i.container.dequeue("showqueue"),i.container.clearQueue("showqueue")};i._refreshCounter(u);var l=this.container.data("player.wijlightbox"),c,h=function(){i.container.data("playerwidth.wijlightbox",c.width),i.container.data("playerheight.wijlightbox",c.height);var e=n.extend({},i._defaults.transAnimation,s.transAnimation);if(s.activeIndex===u||e.animated==="none"||e.duration<=0||!i._isOpen()){s.activeIndex=u,l&&l.remove(),c.appendTo(i.content),i._refreshText(),f();return}s.cookie&&i._cookie(s.activeIndex,s.cookie);if(e.animated==="slide")t=t===undefined?u>s.activeIndex:t,i._slideTo(l,c,e,t,f),s.activeIndex=u;else{s.activeIndex=u;var r=function(){c&&(c.appendTo(i.content,!0),c.fadeIn(e.duration,f))};n.browser.msie&&i.frame.trigger("mouseleave");var o=function(){l&&l.remove(),s.autoSize&&!i._isFullSize()?i._resize(r):(r(),i._refreshText())};l?l.fadeOut(e.duration*.4,o):o()}};return c=this._createPlayer(e,h),this},r.prototype.next=function(){var e=this.options;if(!this._groupMode())return!1;var t=e.activeIndex+1;return e.loop&&(t%=e.groupItems.length),t<e.groupItems.length?(this._show(t,!0),!0):!1},r.prototype.back=function(){var e=this.options;if(!this._groupMode())return!1;var t=e.activeIndex-1;return e.loop&&(t=t<0?e.groupItems.length-1:t),t>=0?(this._show(t,!1),!0):!1},r.prototype.adjustPosition=function(){this._position()},r.prototype.isPlaying=function(){return!!this.container.data("playing.wijlightbox")},r.prototype._startTimer=function(){if(!this.isPlaying()||!this._groupMode())return;var e=this.options,t=this,n;e.showTimer===!0?(this.timerMeter||this._createTimerBar(),n=this.timerBar.width(),t.timerMeter.width("0"),t.timerMeter.animate({width:n},e.delay,null,function(){t.isPlaying()&&!t.next()&&t.stop()})):window.setTimeout(function(){t.isPlaying()&&!t.next()&&t.stop()},e.delay)},r.prototype.play=function(){if(!this._groupMode())return!1;this.container.data("playing.wijlightbox")||this.container.data("playing.wijlightbox",!0),this._refreshCtrlButtons(),this._hideNavButtons(),this._startTimer()},r.prototype.stop=function(){this.container.removeData("playing.wijlightbox"),this._refreshCtrlButtons(),this._removeTimerBar()},r.prototype._size=function(e,t){var r=this.options,i=r.width,s=r.height,o=r.autoSize?this.container.data("playerwidth.wijlightbox")||i:i,u=r.autoSize?this.container.data("playerheight.wijlightbox")||s:s,a,f=u/o;if(typeof e=="boolean")t=e;else if(n.isPlainObject(e)&&"width"in e&&"height"in e)i=e.width,s=e.height;else{a=this.container.data("player.wijlightbox"),r.autoSize&&a&&a.name==="img"&&(o>i&&(o=i,u=Math.round(i*f)),u>s&&(u=s,o=Math.round(s/f))),i=o,s=u;if(t)return{width:i,height:s}}this.frame.width(i).height(s),this.container.width(this.frame.outerWidth(!0))},r.prototype._position=function(){var e=this.options,t=[],r=[0,0],i,s=e.position;if(s){if(typeof s=="string"||typeof s=="object"&&"0"in s)t=s.split?s.split(" "):[s[0],s[1]],t.length===1&&(t[1]=t[0]),n.each(["left","top"],function(e,n){+t[e]===t[e]&&(r[e]=t[e],t[e]=n)}),s={my:t.join(" "),at:t.join(" "),offset:r.join(" ")};s=n.extend({},e.position,s)}i=this.container.is(":visible"),i||this.container.show(),this.container.css({top:0,left:0}).position(s),i||this.container.hide()},r.prototype._getRelRect=function(e){var t;return e&&(n.isPlainObject(e)&&"left"in e&&"top"in e&&"width"in e&&"height"in e?t=n.merge({},e):e=n(e),e.jquery&&e.length&&(t=n.extend({},e.offset(),{width:e.width(),height:e.height()}))),t},r.prototype._close=function(e){var t=this.options,r=this,i,s,o;if(!this._isOpen())return;s={rel:e};if(!1===this._trigger("beforeClose",null,s))return;e=s.rel,!e&&this._groupMode()&&(e=t.groupItems[t.activeIndex].img),this.container.data("moving.wijlightbox",!0),this._hideAccessories(!1),this._hideWaiting(),this._hideOverlay(),this.stop(),o=function(){r._removePlayer(),r.container.hide(),r._trigger("close"),r.container.unbind("keypress.wijlightbox"),r.container.removeData("open.wijlightbox").removeData("rect.wijlightbox").removeData("moving.wijlightbox").removeData("fullsize.wijlightbox"),n(document).unbind("keydown.wijlightbox").unbind("click.wijlightbox")},i=this._getRelRect(e),i||this.container.data("rect.wijlightbox")&&(i=this.container.data("rect.wijlightbox")),this._removeText();if(i){this._moveTo(i,{animated:"sync",duration:200},o);return}return o.call(),this},r.prototype._isOpen=function(){return!!this.container.data("open.wijlightbox")},r.prototype._open=function(e,t){if(this._isOpen())return;var r=this.options,i=this;this.toolBox&&(this._isFullSize()?this.toolBox.css({top:"2px",right:"4px"}):this.toolBox.css({top:"",right:""}));var s=function(){r.modal&&i._showOverlay(),r.showControlsOnHover?this._hideAccessories(!1):this._showAccessories(!1);var t=i._getRelRect(e);i.container.css("opacity",0),i.container.show(),i._size(),i._createText(!0),i._refreshText(!0),i._position(),i.container.data("open.wijlightbox",!0);if(e&&t)i.container.data("rect.wijlightbox",t),i._moveFrom(t,{animated:"sync"});else{var s=n.extend({},i._defaults.transAnimation,r.transAnimation);s.animated==="fade"?(i.container.hide(),i.container.fadeIn(s.duration,function(){i._createText()})):i._createText(),this.container.data("moving.wijlightbox",!1)}n(document).bind("keydown.wijlightbox",n.proxy(i,"_keyDownHandler")).bind("click.wijlightbox",function(e){var t=e.target||e.srcElement;i._isOpen()&&!!r.closeOnOuterClick&&t!==i.container.get(0)&&n(t).parents().index(i.container)<0&&i._close()}),r.autoPlay&&this.play(),i._refreshNavButtons(),i._refreshDialogButtons();var u={index:r.activeIndex,item:r.groupItems[r.activeIndex]};i._trigger("show",null,u),i._trigger("open")};return this.container.data("moving.wijlightbox",!0),this._show(t,!0,s),this},r.prototype._getWinRect=function(){var e=n(window);return n.extend({width:e.width(),height:e.height()},e.offset()||{left:2,top:2})},r.prototype._resizeHandler=function(){var e=this;e._removeText(),e._size(e._getWinRect()),e._createText()},r.prototype._isFullSize=function(){return!!this.container.data("fullsize.wijlightbox")},r.prototype._toggleFullSize=function(){var e=this,t=n(window);if(!e._isOpen())return;if(this._isFullSize())e.toolBox&&e.toolBox.css({top:"",right:""}),this.container.data("fullsize.wijlightbox",!1),t.unbind("resize.wijlightbox",n.proxy(this,"_resizeHandler")),e._resize(function(){e._adjustPlayerSize(e.content.innerWidth(),e.content.innerHeight())});else{this.container.data("fullsize.wijlightbox",!0),t.bind("resize.wijlightbox",n.proxy(this,"_resizeHandler"));var r=e._getWinRect(),i=this.frame.borderSize();r.width-=i.width,r.height-=i.height,e._removeText(),e._moveTo(r,{animated:"sync"},function(){e.toolBox&&e.toolBox.css({top:"2px",right:"4px"}),e.frame.width(r.width),e.container.width(e.frame.outerWidth()),e._createText(),e._adjustPlayerSize(e.content.innerWidth(),e.content.innerHeight())})}this._refreshDialogButtons()},r.prototype._getExt=function(e){var t,n,r=/[0-9a-z]+$/i,i=e.indexOf("?");return i>-1&&(e=e.substring(0,i)),n=e.match(r),n&&(t=n[0].toLowerCase()),t},r.prototype._getPlayerName=function(e){if(e.indexOf("#")===0||e.indexOf("#")>0&&e.indexOf(document.location.href)===0)return"inline";var t=["bmp","gif","jpg","jpeg","png"],r=["swf"],i=["flv","m4v"],s=["dv","mov","moov","movie","mp4","avi","mpg","mpeg"],o=["asf","avi","mpg","mpeg","wm","wmv"],u=["mp4","mpg","mpeg","ogg","ogv"],a=this._getExt(e);if(a){if(n.inArray(a,t)>=0)return"img";if(n.inArray(a,r)>=0)return"swf";if(n.inArray(a,i)>=0)return"flv";if(n.inArray(a,o)>=0)return"wmp";if(n.inArray(a,s)>=0)return"qt";if(n.inArray(a,u)>=0)return"wijvideo"}return"iframe"},r.prototype._adjustPlayerSize=function(e,t){var n=this.container.data("player.wijlightbox");n&&n.adjustSize&&n.adjustSize(e,t)},r.prototype._removePlayer=function(){var e=this.container.data("player.wijlightbox");e&&(e.remove(),this.container.data("player.wijlightbox",null))},r.prototype._createPlayer=function(e,t,r){var i=e.player;if(!n.isFunction(n.wijmo.wijlightbox[i]))throw"unknown player "+i;var s=this,o=!1,u,a=function(){o=!0,this._hideWaiting(),n.isFunction(t)&&window.setTimeout(function(){t.apply(s)},1)},f=function(){this._hideWaiting(),n.isFunction(r)&&r.apply(s)};return u=new n.wijmo.wijlightbox[i](this,e,a,f),this.container.data("player.wijlightbox",u),window.setTimeout(function(){o===!1&&s._showWaiting()},200),u},r}(e.wijmoWidget);t.wijlightbox=i;var s=function(){function e(){this.wijMobileCSS={header:"ui-header ui-bar-a",content:"ui-body-c",stateDefault:"ui-btn-up-a",stateHover:"ui-btn-down-a",stateActive:"ui-btn-down-a",iconPlay:"ui-icon-arrow-r",iconPause:"ui-icon-grid"},this.initSelector=":jqmData(role='wijlightbox')",this.textPosition="overlay",this.width=600,this.height=400,this.autoSize=!0,this.player="",this.groupItems=null,this.rootUrl="",this.ctrlButtons="",this.dialogButtons="close",this.counterType="default",this.counterFormat="[i] of [n]",this.counterLimit=10,this.showCounter=!0,this.showNavButtons=!0,this.showTimer=!1,this.controlsPosition="inside",this.showControlsOnHover=!0,this.clickPause=!1,this.keyNav=!1,this.modal=!1,this.position={my:"center",at:"center",of:window,collision:"fit",using:function(e){var t=n(this).css(e).offset().top;t<0&&n(this).css("top",e.top-t)}},this.zIndex=1e3,this.closeOnEscape=!0,this.closeOnOuterClick=!0,this.autoPlay=!1,this.delay=2e3,this.loop=!0,this.cookie=null,this.transAnimation={animated:"fade",duration:400,easing:"linear"},this.slideDirection="horizontal",this.resizeAnimation={animated:"sync",duration:400},this.textShowOption={duration:300,easing:"linear"},this.textHideOption={duration:300,easing:"linear"},this.showMovieControls=!0,this.autoPlayMovies=!0,this.flashParams={bgcolor:"#000000",allowfullscreen:!0},this.flashVars={},this.flashVersion="9.0.115",this.flvPlayer="player\\player.swf",this.flashInstall="player\\expressInstall.swf",this.beforeShow=null,this.show=null,this.open=null,this.beforeClose=null,this.close=null}return e}();i.prototype.options=n.extend(!0,{},e.wijmoWidget.prototype.options,new s),n.wijmo.registerWidget("wijlightbox",i.prototype),n.extend(n.wijmo.wijlightbox,{img:function(e,t,r,i){this.name="img",this.lightbox=e,this.item=t,this.url=this.lightbox._getUrl(t);var s=this;n("<img></img>").css({width:"auto",height:"auto",display:"none"}).appendTo(document.body).bind({load:function(){var i=n(this);s.width=t.width?parseInt(t.width,10):i.width(),s.height=t.height?parseInt(t.height,10):i.height(),i.remove(),r&&n.isFunction(r)&&r.apply(e)},error:function(){n(this).remove(),i&&n.isFunction(i)&&i.apply(e)}}).attr("src",this.url)},swf:function(e,t,r,i){this.name="swf";var s=e.options;this.id="flashhost",this.lightbox=e,this.item=t,this.url=this.lightbox._getUrl(t),this.width=t.width?parseInt(t.width,10):s.width,this.height=t.height?parseInt(t.height,10):s.height,r&&n.isFunction(r)&&r.apply(e)},iframe:function(e,t,r,i){this.name="swf",this.lightbox=e,this.item=t,this.url=this.lightbox._getUrl(t),t.width&&(this.width=parseInt(t.width,10)),t.height&&(this.height=parseInt(t.height,10)),this.$iframe=n("<iframe></iframe>").addClass("wijmo-wijlightbox-iframe").attr({frameborder:"0",marginwidth:"0",marginheight:"0",scrolling:"auto",allowtransparency:"true"}).hide().appendTo(e.content).bind("load",function(){r&&n.isFunction(r)&&r.apply(e)}).attr("src",this.url)},inline:function(e,t,r,i){this.name="inline";var s=e.options,o=s.wijCSS,u="wijmo-wijlightbox-frame "+o.content;" "+o.cornerAll+" "+o.helperClearFix,this.lightbox=e,this.item=t,this.width=t.width?parseInt(t.width,10):s.width;if(t.height)this.height=parseInt(t.height,10);else{var a=n(this.item.href).clone().show().append('<br clear="all" />').wrap('<div class="wijmo-wijlightbox '+o.widget+'">'+'<div class="'+u+'">'+'<div class="'+u+'">'+'<div class="wijmo-wijlightbox-content"> '+"</div></div></div></div>").appendTo(document.body).width(this.width);this.height=a.outerHeight(!0)+10,a.unwrap(),a.remove()}r&&n.isFunction(r)&&r.apply(e)},flv:function(e,t,r,i){this.name="flv";var s=e.options;this.id="flvhost",this.lightbox=e,this.item=t,this.url=this.lightbox._getUrl(t);var o=20;this.width=t.width?parseInt(t.width,10):s.width,this.height=t.height?parseInt(t.height,10):s.height,s.showMovieControls&&(this.height+=o),r&&n.isFunction(r)&&r.apply(e)},wmp:function(e,t,r,i){var s=e.options,o;this.name="wmp",this.id="wmphost",this.lightbox=e,this.item=t,this.url=this.lightbox._getUrl(t),o=n.browser.msie?70:45,this.width=t.width?parseInt(t.width,10):s.width,this.height=t.height?parseInt(t.height,10):s.height,s.showMovieControls&&(this.height+=o),r&&n.isFunction(r)&&r.apply(e)},qt:function(e,t,r,i){var s=e.options,o=16;this.name="qt",this.id="qthost",this.lightbox=e,this.item=t,this.url=this.lightbox._getUrl(t),this.width=t.width?parseInt(t.width,10):s.width,this.height=t.height?parseInt(t.height,10):s.height,s.showMovieControls&&(this.height+=o),r&&n.isFunction(r)&&r.apply(e)},wijvideo:function(e,t,r,i){var s=e.options;this.name="wijvideo",this.id="wijvideohost",this.lightbox=e,this.item=t,this.url=this.lightbox._getUrl(t),this.wijvideosrc=!t.wijvideosrc||t.wijvideosrc===""?null:this.lightbox._getUrl(t.wijvideosrc),this.width=t.width?parseInt(t.width,10):s.width,this.height=t.height?parseInt(t.height,10):s.height,r&&n.isFunction(r)&&r.apply(e)}}),n.extend(n.wijmo.wijlightbox.img.prototype,{appendTo:function(e,t){this.$element=n("<img></img>").addClass("wijmo-wijlightbox-image").attr("src",this.url),t&&this.$element.hide(),this.lightbox.options.transAnimation&&this.lightbox.options.transAnimation.animated=="fade"?(e.children().length&&e.empty(),this.$element.prependTo(e)):this.$element.appendTo(e)},remove:function(){this.$element&&this.$element.remove()},fadeOut:function(e,t){this.$element&&this.$element.fadeOut(e,t)},fadeIn:function(e,t){this.$element&&this.$element.fadeIn(e,t)},getElement:function(){return this.$element}}),n.extend(n.wijmo.wijlightbox.swf.prototype,{appendTo:function(e){this.$container=n("<div/>").css({width:"100%",height:"100%",overflow:"hidden"}).attr("id",this.id).appendTo(e);var t=this.lightbox.options,r=t.flashInstall,i=t.flashVersion,s=t.flashVars,o=t.flashParams;S.flash.embedSWF(this.item.href,this.id,"100%","100%",i,r,s,o)},remove:function(){S.flash.expressInstallCallback(),S.flash.removeSWF(this.id),this.$container.remove()},fadeOut:function(e,t){this.$container&&this.$container.fadeOut(e,t)},fadeIn:function(e,t){this.$container&&this.$container.fadeIn(e,t)},getElement:function(){return this.$container}}),n.extend(n.wijmo.wijlightbox.iframe.prototype,{appendTo:function(e,t){t||this.$iframe.show()},remove:function(){this.$iframe&&this.$iframe.remove()},fadeOut:function(e,t){this.$iframe&&this.$iframe.fadeOut(e,t)},fadeIn:function(e,t){this.$iframe&&this.$iframe.fadeIn(e,t)},getElement:function(){return this.$iframe}}),n.extend(n.wijmo.wijlightbox.inline.prototype,{appendTo:function(e,t){this.$element=n(this.item.href).clone().appendTo(e),t||this.$element.show()},remove:function(){this.$element&&this.$element.remove()},fadeOut:function(e,t){this.$element&&this.$element.fadeOut(e,t)},fadeIn:function(e,t){this.$element&&this.$element.fadeIn(e,t)},getElement:function(){return this.$element}}),n.extend(n.wijmo.wijlightbox.flv.prototype,{appendTo:function(e){this.$container=n("<div/>").css({width:"100%",height:"100%",overflow:"hidden"}).attr("id",this.id).appendTo(e);var t=this.lightbox.options,r="100%",i="100%",s=t.flvPlayer,o=t.flashInstall,u=t.flashVersion,a=n.extend({file:this.url,width:r,height:i,autostart:t.autoPlayMovies?"true":"false",controlbar:t.showMovieControls?"bottom":"none",backcolor:"0x000000",frontcolor:"0xCCCCCC",lightcolor:"0x557722"},t.flashVars),f=n.extend({autostart:t.autoPlayMovies?"true":"false",allowscriptaccess:"always"},t.flashParams);S.flash.embedSWF(s,this.id,r,i,u,o,a,f)},remove:function(){S.flash.expressInstallCallback(),S.flash.removeSWF(this.id),this.$container.remove()},fadeOut:function(e,t){this.$container&&this.$container.fadeOut(e,t)},fadeIn:function(e,t){this.$container&&this.$container.fadeIn(e,t)},getElement:function(){return this.$container}}),n.extend(n.wijmo.wijlightbox.wmp.prototype,{appendTo:function(e){this.$container=n("<div/>").css({width:"100%",height:"100%",overflow:"hidden"}).appendTo(e);var t=this.lightbox.options,r='<object id="'+this.id+'" name="'+this.id+'" height="'+this.height+'" width="'+this.width+'"',i={autostart:t.autoPlayMovies?1:0,url:undefined,uimode:undefined,showcontrols:undefined},s;n.browser.msie?(r+=' classid="clsid:6BF52A52-394A-11d3-B153-00C04F79FAA6"',i.url=this.url,i.uimode=t.showMovieControls?"full":"none"):(r+=' type="video/x-ms-wmv"',r+=' data="'+this.url+'"',i.showcontrols=t.showMovieControls?1:0),r+=">";for(s in i)r+='<param name="'+s+'" value="'+i[s]+'">';r+="</object>",this.$container.html(r)},remove:function(){if(n.browser.msie)try{window[this.id].controls.stop(),window[this.id].URL="movie"+now()+".wmv",window[this.id]=function(){}}catch(e){}this.$container.remove()},fadeOut:function(e,t){this.$container&&this.$container.fadeOut(e,t)},fadeIn:function(e,t){this.$container&&this.$container.fadeIn(e,t)},getElement:function(){return this.$container}}),n.extend(n.wijmo.wijlightbox.qt.prototype,{appendTo:function(e,t){this.$container=n("<div/>").css({width:"100%",height:"100%",overflow:"hidden"}).appendTo(e);var r=this.lightbox.options,i=r.autoPlayMovies?"true":"false",s=r.showMovieControls?"true":"false",o="<object",u={id:this.id,name:this.id,width:this.width,height:this.height,kioskmode:"true",classid:undefined,codebase:undefined,type:undefined,data:undefined},a,f;n.browser.msie?(u.classid="clsid:02BF25D5-8C17-4B23-BC80-D3488ABDDC6B",u.codebase="http://www.apple.com/qtactivex/qtplugin.cab#version=6,0,2,0"):(u.type="video/quicktime",u.data=this.url);for(a in u)o+=" "+a+'="'+u[a]+'"';o+=">";var l={src:this.url,scale:"aspect",controller:s,autoplay:i};for(f in l)o+='<param name="'+f+'" value="'+l[f]+'">';o+="</object>",t&&e.hide(),this.$container.html(o),t&&e.show()},remove:function(){try{document[this.id].Stop(),document[this.id]=null}catch(e){}this.$container.remove()},fadeOut:function(e,t){t.call();return},fadeIn:function(e,t){t.call();return},getElement:function(){return this.$container}}),n.extend(n.wijmo.wijlightbox.wijvideo.prototype,{appendTo:function(e){var t=this.lightbox.options;this.$container=n("<video/>").css({overflow:"hidden"}).attr({width:this.width,height:this.height,autoPlay:t.autoPlayMovies?"true":"false",controls:t.showMovieControls?"controls":""}).appendTo(e),!this.url||n("<source/>").attr({src:this.url}).appendTo(this.$container),!this.wijvideosrc||n("<source/>").attr({src:this.wijvideosrc}).appendTo(this.$container),this.$container.wijvideo({fullScreenButtonVisible:!1})},remove:function(){this.$container.remove()},fadeOut:function(e,t){this.$container&&this.$container.fadeOut(e,t)},fadeIn:function(e,t){this.$container&&this.$container.fadeIn(e,t)},getElement:function(){return this.$container},adjustSize:function(e,t){this.$container.wijvideo("setWidth",e),this.$container.wijvideo("setHeight",t)}}),n.extend(n.wijmo.wijlightbox,{overlay:function(e,t){this.mask=n("<div></div>").addClass(e.options.wijCSS.overlay+" wijmo-wijlightbox-overlay"+(t?" wijmo-wijlightbox-waitingoverlay":"")).appendTo(document.body).css({width:this.width(),height:this.height()}).bind("click",function(){return e.options.closeOnOuterClick&&e._close(),!1}),n.fn.bgiframe&&this.mask.bgiframe();if(t){this.mask.css("z-index",this.zIndex);var r=n("<div></div>").addClass("wijmo-wijlightbox-waiting").css("z-index",this.zIndex+1).appendTo(this.mask);r.css({left:(this.mask.width()-r.width())/2,top:(this.mask.height()-r.height())/2})}n(window).bind("resize.wijlightbox-overlay",n.proxy(this,"resize")),window.setTimeout(function(){var e;this.mask&&(e=n.wijmo.wijlightbox.overlay,n(document).bind(e.events,function(t){if(n(t.target).zIndex()<e.zIndex)return!1}))},1)}}),n.extend(n.wijmo.wijlightbox.overlay.prototype,{mask:null,zIndex:1e3,events:n.map("focus,mousedown,mouseup,keydown,keypress,click".split(","),function(e){return e+".wijlightbox-overlay"}).join(" "),close:function(){n(document).unbind(".wijlightbox-overlay"),n(window).unbind(".wijlightbox-overlay"),this.mask.remove(),this.mask=undefined},height:function(){var e,t;return n.browser.msie&&parseInt(n.browser.version)<7?(e=Math.max(document.documentElement.scrollHeight,document.body.scrollHeight),t=Math.max(document.documentElement.offsetHeight,document.body.offsetHeight),e<t?n(window).height():e):n(document).height()},width:function(){var e,t;return n.browser.msie&&parseInt(n.browser.version)<7?(e=Math.max(document.documentElement.scrollWidth,document.body.scrollWidth),t=Math.max(document.documentElement.offsetWidth,document.body.offsetWidth),e<t?n(window).width():e):n(document).width()},resize:function(){this.mask&&this.mask.css({width:this.width(),height:this.height()})}})})(e.lightbox||(e.lightbox={}));var t=e.lightbox})(wijmo||(wijmo={}));;
var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(t){var n=function(n){function r(){n.apply(this,arguments)}return __extends(r,n),r.prototype._create=function(){var e=this,t=e.options,r=e._getDefFill(),i=t.seriesStyles;$.each(t.seriesList,function(e,n){if(n.type==="bar")return $.extend(!0,t.axis,{x:{compass:"west"},y:{compass:"south"}}),!0;n.type==="pie"&&n.pieSeriesList&&(n.data=n.pieSeriesList)}),$.extend(!0,{compass:"east"},t.hint),t.is100Percent&&(t.is100Percent=!1),t.yAxes&&$.isArray(t.yAxes)&&t.yAxes.length>0&&(t.axis.y=t.yAxes),e._handleChartStyles(),i=t.seriesStyles,$.each(t.seriesList,function(t,n){if(e._isStockSeries(n)){var r=i[t],s=n.type,o=r.fill,u=$.extend({},r);r&&(r.highLow||(r.highLow=u),s==="hloc"?(r.open||(r.open=u),r.close||(r.close=u)):(r.fallingClose||(r.fallingClose=u),r.raisingClose||(r.raisingClose=u)))}}),t.seriesStyles=i,e._isContainsStock()&&(e.isContainsStock=!0,e._handleXData()),n.prototype._create.call(this),e.chartElement.addClass(t.wijCSS.compositechart)},r.prototype._setOption=function(e,t){e!=="is100Percent"&&n.prototype._setOption.call(this,e,t)},r.prototype._supportStacked=function(){return!0},r.prototype.destroy=function(){var e=this,t=e.chartElement,r=t.data("fields"),i=r&&r.aniBarsAttr;t.removeClass(e.options.wijCSS.compositechart),n.prototype.destroy.call(this),e._destroyRaphaelArray(i),t.data("fields",null)},r.prototype._isBarChart=function(){return!0},r.prototype._clearChartElement=function(){var e=this,t=e.options,r=e.chartElement,i=r.data("fields");i&&i.allElements&&($.each(i.allElements,function(t,n){t==="scatters"&&n.length&&$.each(n,function(e,t){t.length&&($.each(t,function(e,n){n&&n.remove&&n.remove(),t[e]=null}),n[e]=null)}),e._destroyRaphaelArray(n)}),i.allElements=null),n.prototype._clearChartElement.call(this),i&&i.ctracers&&(i.ctracers=null),e.element.removeData("plotInfos"),t.seriesTransition.enabled||i&&i.aniBarsAttr&&(i.aniBarsAttr=null)},r.prototype._bindData=function(){var e=this,t=e.options,n=t.dataSource,r=t.seriesList,i=t.data,s;$.each(r,function(t,r){var o=r.data,u,a,f,l=r.dataSource||n,c=r.type,h,p,d,v=[];l&&o&&(c==="pie"?(h=o.label,p=o.value,d=o.offset,h&&h.bind&&(h=e._getBindData(l,h.bind)),p&&p.bind&&(p=e._getBindData(l,p.bind)),d&&d.bind&&(d=e._getBindData(l,d.bind)),h&&$.isArray(h)&&h.length&&p&&$.isArray(p)&&p.length&&($.each(p,function(e,t){var n,r=0;e>=0&&e<h.length&&(n=h[e]),d&&$.isArray(p)&&d.length&&e>=0&&e<d.length&&(r=typeof d[e]=="undefined"?0:d[e]),v.push({data:t,label:n,offset:r,legendEntry:!0})}),r.data=v)):(u=o.x,a=o.y,f=o.y1,u&&u.bind?o.x=e._getBindData(l,u.bind):i&&i.x&&i.x.bind&&(s===undefined&&(s=e._getBindData(l,i.x.bind)),o.x=s),a&&a.bind&&(o.y=e._getBindData(l,a.bind)),f&&f.bind&&(o.y1=e._getBindData(l,f.bind))))})},r.prototype.getElement=function(e,t,n){var r=this.chartElement,i=r.data("fields"),s=i.chartElements;switch(e){case"bar":case"column":return s.bars[t];case"line":case"area":return s.paths[t];case"linemarkers":return s.markersSet[t];case"pie":return this._getPie(s,t,n)}return null},r.prototype._getPie=function(e,t,n){if(n!==undefined)return e["sectors"+n]?e["sectors"+n][t]:null;var r=[];return $.each(e,function(e,t){/sectors/.test(e)&&e!=="sectors"&&$.each(t,function(e,t){r.push(t)})}),r.length===0&&(r=e.sectors),r[t]},r.prototype._paintLegendIcon=function(e,t,r,i,s,o,u,a,f,l){var c=this,h=this.options,p=f.type,d,v,m=3,g=!1,y,b;return p==="line"||p==="area"||p==="spline"||p==="bezier"?(d=c.canvas.path(Raphael.format("M{0},{1}L{2},{3}",e,t+i/2,e+r,t+i/2)),s&&(h.legend.size&&h.legend.size.height&&(m=h.legend.size.height),d.attr($.extend(!0,{},s,{"stroke-width":m}))),g=!0,f.markers&&f.markers.visible&&(y=f.markers.type,b=f.markerStyle,b=$.extend({fill:s.stroke,stroke:s.stroke,opacity:1},b),s["stroke-dasharray"]&&d.attr({"stroke-width":1,"stroke-dasharray":s["stroke-dasharray"]}),y||(y="circle"),v=this.canvas.paintMarker(y,e+r/2,t+i/2,3),$.wijraphael.addClass($(v.node),Raphael.format("{0} {1} {2}",h.wijCSS.legend,h.wijCSS.legendDot,h.wijCSS.canvasObject)),v.attr(b),$(v.node).data("index",u).data("legendIndex",o),this.legendDots[o]=v)):p==="scatter"?(b=f.markerStyle,y=f.markerType,b=$.extend({fill:s.stroke,stroke:s.stroke,opacity:1},b),y||(y="circle"),d=c.canvas.paintMarker(y,e+r/2,t+i/2,3),d.attr(b),f.visible===!1&&($(l.node).data("dotOpacity",d.attr("opacity")||1),d.attr("opacity",.3)),g=!0):p==="bubble"?(b=f.markerStyle,b=$.extend({fill:s.stroke,stroke:s.stroke,opacity:1},b),f.markers&&(y=f.markers.type),y||(y="circle"),d=c.canvas.paintMarker(y,e+r/2,t+i/2,Math.min(r,i)/2),d.attr(b),g=!0):d=n.prototype._paintLegendIcon.call(this,e,t,r,i,s,o,u,a,f,l),g&&($.wijraphael.addClass($(d.node),a),$(d.node).data("legendIndex",o).data("index",u),c.legendIcons.push(d)),d},r.prototype._showHideStockSeries=function(e,t){$.each(e,function(e,n){n.hl&&n.hl[t](),n.o&&n.o[t](),n.c&&n.c[t](),n.path&&n.path[t](),n.h&&n.h[t](),n.l&&n.l[t](),n.oc&&n.oc[t]()})},r.prototype._showSerieEles=function(e){var t=e.type,n=e.eles,r=this.options.showChartLabels,i;switch(t){case"pie":n.sector&&(n.sector.show(),n.sector.shadow&&n.sector.shadow.show(),n.sector.tracker&&n.sector.tracker.show()),n.label&&n.label.show();break;case"line":case"spline":case"bezier":case"area":n.markers&&$.each(n.markers,function(e,t){i=$(t.node).data("wijchartDataObj");if(i&&i.lineSeries&&i.lineSeries.markers&&!i.lineSeries.markers.visible)return!0;t.show()}),n.dcl&&$.each(n.dcl,function(e,t){r&&t.show()}),n.path&&(i=$(n.path.node).data("wijchartDataObj"),i.visible&&(n.path.show(),n.path.shadow&&n.path.shadow.show(),n.path.area&&n.path.area.show(),n.path.tracker&&n.path.tracker.show(),$(n.path.node).data("wijchartDataObj")&&$(n.path.node).data("wijchartDataObj").virtualMarkers&&$.each($(n.path.node).data("wijchartDataObj").virtualMarkers,function(e,t){t.visible=!0})));break;case"bar":case"column":$.each(n,function(e,t){t.bar&&(t.bar.show(),t.bar.shadow&&t.bar.shadow.show(),t.bar.tracker&&t.bar.tracker.show(),$(t.bar.node).data("wijchartDataObj")&&($(t.bar.node).data("wijchartDataObj").visible=!0)),t.dcl&&t.dcl.show(),t.animatedBar&&!t.animatedBar.removed&&t.animatedBar.show()});break;case"scatter":$.each(n,function(e,t){t.show(),t.label&&t.label.show(),$(t.element).data("wijchartDataObj")&&($(t.element).data("wijchartDataObj").visible=!0)});break;case"hloc":case"hl":case"candlestick":this._showHideStockSeries(n,"show");break;case"bubble":$.each(n,function(e,t){t.bubble&&(t.bubble.show(),t.bubble.tracker&&t.bubble.tracker.show()),t.dcl&&t.dcl.show(),t.symbol&&t.symbol.show()})}},r.prototype._hideSerieEles=function(e){var t=e.type,n=e.eles;switch(t){case"pie":n.sector&&(n.sector.hide(),n.sector.shadow&&n.sector.shadow.hide(),n.sector.tracker&&n.sector.tracker.hide()),n.label&&n.label.hide();break;case"line":case"spline":case"bezier":case"area":n.markers&&$.each(n.markers,function(e,t){t.hide()}),n.dcl&&$.each(n.dcl,function(e,t){t.hide()}),n.path&&(n.path.hide(),n.path.shadow&&n.path.shadow.hide(),n.path.area&&n.path.area.hide(),n.path.tracker&&n.path.tracker.hide(),$(n.path.node).data("wijchartDataObj")&&$(n.path.node).data("wijchartDataObj").virtualMarkers&&$.each($(n.path.node).data("wijchartDataObj").virtualMarkers,function(e,t){t.visible=!1}));break;case"bar":case"column":$.each(n,function(e,t){t.bar&&(t.bar.hide(),t.bar.shadow&&t.bar.shadow.hide(),t.bar.tracker&&t.bar.tracker.hide(),$(t.bar.node).data("wijchartDataObj")&&($(t.bar.node).data("wijchartDataObj").visible=!1)),t.dcl&&t.dcl.hide(),t.animatedBar&&!t.animatedBar.removed&&t.animatedBar.hide()});break;case"scatter":$.each(n,function(e,t){t.hide(),t.label&&t.label.hide(),$(t.element).data("wijchartDataObj")&&($(t.element).data("wijchartDataObj").visible=!1)});break;case"hloc":case"hl":case"candlestick":this._showHideStockSeries(n,"hide");break;case"bubble":$.each(n,function(e,t){t.bubble&&(t.bubble.hide(),t.bubble.tracker&&t.bubble.tracker.hide()),t.dcl&&t.dcl.hide(),t.symbol&&t.symbol.hide()})}},r.prototype._indicatorLineShowing=function(e){var t;n.prototype._indicatorLineShowing.call(this,e),$.each(e,function(e,n){t=n.type,t==="column"||t==="bar"?n.bar.attr(n.hoverStyle):t==="marker"?n.marker.attr(n.markerHoverStyle):t==="scatter"&&(n.dot.attr(n.hoverStyle),n.dot.scale(1.5,1.5))})},r.prototype._removeIndicatorStyles=function(e){var t;$.each(e,function(e,n){t=n.type,t==="column"||t==="bar"?n.bar.attr(n.style):t==="marker"?(n.marker.attr(n.markerStyle),n.marker.transform("s1")):t==="scatter"&&(n.dot.attr(n.style),n.dot.scale(1,1))})},r.prototype._paintTooltip=function(){var e=this,t=e.chartElement,r=t.data("fields")||{},i=r.ctracers||[];n.prototype._paintTooltip.call(this),e.tooltip&&$.each(i,function(t,n){n.trackers&&n.trackers.length&&t===0&&e.tooltip.setOptions({relatedElement:n.trackers[0]})})},r.prototype._isContainsStock=function(){var e=!1,t=this,n=t.options,r=n.seriesList;return $.each(r,function(t,n){var r=n.type;if(r==="hloc"||r==="hl"||r==="candlestick")return e=!0,!1}),e},r.prototype._handleXData=function(){},r.prototype._isStockSeries=function(e){var t=e.type;return t==="hloc"||t==="hl"||t==="candlestick"},r.prototype._paintChartArea=function(){var e=this,t=e.options,r=t.data;if(e._isSeriesDataEmpty())return;$.each(t.seriesList,function(t,n){var r=n.data;e._isStockSeries(n)&&(r.y=[].concat(r.high).concat(r.low))}),n.prototype._paintChartArea.call(this),$.each(t.seriesList,function(t,n){e._isStockSeries(n)&&delete n.data.y})},r.prototype._isSeriesDataEmpty=function(){var e=this,t=e.options.seriesList;return!t||t.length===0?!0:($.each(t,function(e,t){var n=t.type;if(n==="hloc"||n==="candlestick"){if(!t.data||!t.data.x||!t.data.high||!t.data.low||!t.data.open||!t.data.close)return!0}else if(n==="hl"){if(!t.data||!t.data.x||!t.data.high||!t.data.low)return!0}else{if(n==="pie"&&(!t.data||!t.label||t.label.length===0))return!0;if(!t.data||(!t.data.x||!t.data.y)&&!t.data.xy)return!0}}),!1)},r.prototype._validateSeriesData=function(e){var t=this.options.type,n=e.data;if(t==="hl"){if(n.x===undefined&&n.high===undefined&&n.low===undefined)return!1}else if(n.x===undefined&&n.high===undefined&&n.low===undefined&&n.open===undefined&&n.close===undefined)return!1;return!0},r.prototype._isStockChart=function(){return this.isContainsStock?!0:!1},r.prototype._calculateStockParameters=function(e,t){if(e.id==="x"){var n=t.unitMinor,r=t.autoMin,i=t.autoMax,s=this._getStockAdjustment(e);this.timeUtil&&this.timeUtil.getCount&&(e.max=this.timeUtil.getCount()-1),s===0?s=n:n<s&&n!==0&&(s=Math.floor(s/n)*n),r&&(e.min-=s),i&&(e.max+=s),this._calculateMajorMinor(t,e)}},r.prototype._getStockAdjustment=function(e){var t=this,n=t.options,r=e.max,i=e.min,s,o=n.seriesList;return $.each(o,function(e,t){s?s=Math.max(t.data.x.length):s=t.data.x.length}),(r-i)/s},r.prototype._calculateMajorMinor=function(e,r){var i=this,s=i.options,o=r.bounds||i.canvasBounds,u=e.autoMajor,a=e.autoMinor,f=r.max,l=r.min,c=r.isTime,h=r.tinc,p=r.annoFormatString,d=null,v=null,m=null,g=null,y=null,b=null,w=null,E=null,S=null,x=f-l,T=0,N=0,C=0,k=0;if(!i.isContainsStock){n.prototype._calculateMajorMinor.call(this,e,r);return}if(u){S=$.extend(!0,{},s.textStyle,e.textStyle,e.labels.style);if(r.id==="x")l<0&&(l=0),f>i.timeUtil.getCount()-1&&(f=i.timeUtil.getCount()-1),f=i.timeUtil.getOATime(f),l=i.timeUtil.getOATime(l),i.formatString?p=i.formatString:(p=p||t.ChartDataUtil.getTimeDefaultFormat(f,l),i.formatString=p),d=Globalize.format($.fromOADate(f),p,i._getCulture()),v=Globalize.format($.fromOADate(l),p,i._getCulture()),y=i._text(-1e3,-1e3,d).attr(S),b=i._text(-1e3,-1e3,v).attr(S),m=y.wijGetBBox(),g=b.wijGetBBox(),y.wijRemove(),y=null,b.wijRemove(),b=null;else{w=t.ChartDataUtil.nicePrecision(x),E=w+1;if(E<0||E>15)E=0;y=i._text(-1e3,-1e3,$.round(f,E).toString()).attr(S),b=i._text(-1e3,-1e3,$.round(l,E).toString()).attr(S),m=y.wijGetBBox(),g=b.wijGetBBox(),y.wijRemove(),y=null,b.wijRemove(),b=null}m.width<g.width&&(m.width=g.width),m.height<g.height&&(m.height=g.height),i._isVertical(e.compass)?(N=o.endY-o.startY-r.vOffset-r.axisTextOffset,k=N/m.height,Number.POSITIVE_INFINITY===k?C=0:C=parseInt(k.toString(),10)):(T=o.endX-o.startX-r.vOffset-r.axisTextOffset,k=T/m.width,Number.POSITIVE_INFINITY===k?C=0:C=parseInt(k.toString(),10)),k=x,C>0&&(x/=C,r.tprec=t.ChartDataUtil.nicePrecision(x),k=t.ChartDataUtil.niceNumber(2*x,-w,!0),k<x&&(k=t.ChartDataUtil.niceNumber(x,-w+1,!1)),k<x&&(k=t.ChartDataUtil.niceTickNumber(x))),e.unitMajor=k}a&&e.unitMajor&&!isNaN(e.unitMajor)&&(e.unitMinor=e.unitMajor/2)},r.prototype._getTickText=function(e){var t=this,n=t.formatString;return t.isContainsStock?Globalize.format(t.timeUtil.getTime(e),n,t._getCulture()):e},r.prototype._AdjustAxisBounds=function(e,n){var r=this,i=r.options,s,o,u,a,f=e.max,l=e.min,c=f-l,h=t.ChartDataUtil.nicePrecision(c),p=h+1,d=e.bounds,v=$.extend(!0,{},i.textStyle,n.textStyle,n.labels.style);s=r._text(-1e3,-1e3,$.round(f,p).toString()).attr(v),o=r._text(-1e3,-1e3,$.round(l,p).toString()).attr(v),u=s.wijGetBBox(),a=o.wijGetBBox(),e.isStartAxis||(d.startY+=a.height),e.isLastAxis||(d.endY-=u.height/2)},r.prototype._initYAxisHeight=function(){var e=this,t=e.options,n=t.axis,r=n.y,i=e.canvasBounds,s=i.endX-i.startX,o=i.endY-i.startY,u=e.axisInfo,a=u.y,f=0,l=-1,c=0,h;$.isArray(r)&&($.each(r,function(e,t){t.height&&!isNaN(t.height)?f+=t.height:t.height==="auto"&&(l=e),a[e].height=t.height}),l>-1&&(a[l].height=o-f),$.each(a,function(t,n){var s=n.height;if(s===undefined)return!0;s>0&&(n.isPartAxis=!0,n.isLastAxis=parseInt(t)===r.length-1,n.isStartAxis=parseInt(t)===0),h?n.bounds={startY:h.endY,endY:h.endY+s}:n.bounds={startY:i.startY,endY:i.startY+s},n.bounds.startX=i.startX,n.bounds.endX=i.endX,e._AdjustAxisBounds(n,r[t]),n.bounds&&(h=$.extend({},n.bounds))}))},r.prototype._getDataExtreme=function(e){var t=this;return t._initYAxisHeight(),n.prototype._getDataExtreme.call(this,e)},r.prototype._paintPlotArea=function(){var t=this,n=t.options,r="seriesList",i="seriesStyles",s="seriesHoverStyles",o=n[i],u=n[s],a=t.canvasBounds,f={},l=0,c=-1,h=[],p=$.isArray(n.axis.y),d={canvas:t.canvas,tooltip:t.tooltip,bounds:a,widgetName:t.widgetName,seriesTransition:n.seriesTransition,showChartLabels:n.showChartLabels,textStyle:n.textStyle,chartLabelStyle:n.chartLabelStyle,chartLabelFormatString:n.chartLabelFormatString,shadow:n.shadow,hint:n.hint,animation:n.animation,disabled:n.disabled,culture:t._getCulture(),widget:this,wijCSS:n.wijCSS,mouseDown:function(e,n){t._trigger("mouseDown",e,n)},mouseUp:function(e,n){t._trigger("mouseUp",e,n)},mouseOver:function(e,n){t._trigger("mouseOver",e,n)},mouseOut:function(e,n){t._trigger("mouseOut",e,n)},mouseMove:function(e,n){t._trigger("mouseMove",e,n)},click:function(e,n){t._trigger("click",e,n)}},v=t.chartElement.data("fields"),m,g,y,b=t._isContainsStock();v&&(v.ctracers=[]),b&&t._handleXData(),$.each(n[r],function(e,t){var a=t.type,h={},d=a,v={},m=$.extend({},o[l]),g=$.extend({},u[l]),y=t.yAxis;if(!a||a.length===0)return!0;if(d==="spline"||d==="bezier")d="line";h=f[d],h||(a==="pie"?h=[]:h={},f[d]=h,t.hint&&(h.hint=t.hint,n.hint.content||(n.hint.content=t.hint.content),n.hint.title||(n.hint.title=t.hint.title)));if(a==="pie")return $.each(t.data,function(t,n){m=$.extend({},o[l]),g=$.extend({},u[l]),v[r]||(v[r]=[]),v[i]||(v[i]=[]),v[s]||(v[s]=[]),n.pieID=e+1,v[r].push(n),v[i].push(m),v[s].push(g),c===-1&&(c=l),l++}),v.sIndex=c,v.radius=t.radius,v.center=t.center,v.label=t.label,c=-1,h.push(v),!0;a==="column"?h.horizontal=!1:a==="bar"?h.horizontal=!0:a==="spline"?t.fitType="spline":a==="bezier"&&(t.fitType="bezier"),d==="stock"&&t.data.high&&t.data.low&&(t.data.y=[].concat(t.data.high).concat(t.data.low)),p&&(h.yAxis=y||0);if(a==="line"||a==="spline"||a==="bezier")delete m.fill,delete g.fill;h[r]||(h[r]=[]),h[i]||(h[i]=[]),h[s]||(h[s]=[]),a==="scatter"&&(h.showChartLabels=n.showChartLabels,t.showChartLabels!==undefined&&(h.showChartLabels=t.showChartLabels)),t.sIndex=l,h[r].push(t),h[i].push(m),h[s].push(g),l++}),$.each(f,function(r,i){var s=e.chart,o=i.yAxis,u=n.chartLabel;o!==undefined&&t.axisInfo.y[o].bounds&&(d.bounds=t.axisInfo.y[o].bounds);switch(r){case"pie":var f;$.each(i,function(e,n){var i=n.center,o=n.radius||50,u,f=a.endX-a.startX,l=a.endY-a.startY;f<2*o&&(o=f/2),l<2*o&&(o=l/2),n.radius=o,u=i?{startX:i.x-o,startY:i.y-o,endX:i.x+o,endY:i.y+o}:{startX:a.startX+f/2-o,startY:a.startY+l/2-o,endX:a.startX+2*o,endY:a.startY+2*o},m=$.extend(!0,{},d,{bounds:u,radius:o},n),y=new s.PieChartRender(t.chartElement,m),y.render(),t.chartElement.data("fields").aniSectorAttrs=null,t.chartElement.data("fields").aniLabelAttrs=null,t._savechartData(r,n.sIndex)});break;case"bar":case"column":m=$.extend(!0,{},d,{stacked:n.stacked,axis:n.axis,clusterOverlap:n.clusterOverlap,clusterWidth:n.clusterWidth,clusterSpacing:n.clusterSpacing,is100Percent:n.is100Percent,clusterRadius:n.clusterRadius,isYTime:t.axisInfo.y[0].isTime,isXTime:t.axisInfo.x.isTime,yAxisInfo:t.axisInfo.y,yAxisIndex:o},i),y=new s.BarChartRender(t.chartElement,m),y.render(),h=[],$.each(i.seriesList,function(e,t){h.push(t.sIndex)}),t._savechartData(r,h);break;case"line":case"spline":case"bezier":case"area":g=t._getyAxisGroup(i),$.each(g,function(e,i){t.aniPathsAttr||(t.aniPathsAttr=[]),m=$.extend(!0,{},d,{axis:n.axis,isXTime:t.axisInfo.x.isTime,isYTime:t.axisInfo.y[0].isTime,type:r==="area"?"area":"line",hole:n.hole},i),m.aniPathsAttr=t.aniPathsAttr,m.chartLabelEles=t.chartLabelEles,m.axis.y=n.axis.y[e]||n.axis.y,m.extremeValue={txx:t.extremeValue.txx,txn:t.extremeValue.txn,tyx:t.extremeValue.y[e].tyx,tyn:t.extremeValue.y[e].tyn},y=new s.LineChartRender(t.chartElement,m),y.render(),h=[],$.each(i.seriesList,function(e,t){h.push(t.sIndex)}),t._savechartData(r,h,!0)});break;case"scatter":g=t._getyAxisGroup(i),$.each(g,function(e,i){m=$.extend(!0,{},d,{axis:n.axis,isXTime:t.axisInfo.x.isTime,isYTime:t.axisInfo.y[0].isTime,zoomOnHover:n.zoomOnHover},i),m.axis.y=n.axis.y[e]||n.axis.y,y=new s.ScatterChartRender(t.chartElement,m),y.render(),h=[],$.each(i.seriesList,function(e,t){h.push(t.sIndex)}),t._savechartData(r,h)});break;case"hloc":case"hl":case"candlestick":break;case"bubble":g=t._getyAxisGroup(i),u||(u={visible:n.showChartLabels,style:n.chartLabelStyle}),$.each(g,function(e,i){m=$.extend(!0,{},d,{axis:n.axis,isXTime:t.axisInfo.x.isTime,isYTime:t.axisInfo.y[0].isTime,xAxisInfo:t.axisInfo.x,yAxisInfo:t.axisInfo.y,chartLabel:u,minimumSize:n.minimumSize||5,maximumSize:n.maximumSize||20,sizingMethod:n.sizingMethod||"diameter"},i),m.axis.y=n.axis.y[e]||n.axis.y,m.yAxisInfo=t.axisInfo.y[e]||t.axisInfo.y[0],y=new s.BubbleChartRender(t.chartElement,m),y.render(),h=[],$.each(i.seriesList,function(e,t){h.push(t.sIndex)}),t._savechartData(r,h)})}}),t.chartElement.data("fields").seriesEles=null,t._bindtooltip()},r.prototype._savechartData=function(e,t,n){var r=this,i=r.chartElement.data("fields"),s=i.seriesEles,o=i.allElements||{},u,a=t;$.isArray(a)&&(a=0),$.each(s,function(n,i){$.isArray(t)?(r.seriesEles[t[a]]={eles:i,type:e},a++):(r.seriesEles[a]={eles:i,type:e},a++)}),n||(u=i.ctracers||[],u.push({trackers:i.trackers,type:e}),i.ctracers=u),i&&i.chartElements&&$.each(i.chartElements,function(e,t){r._copyElements(o,e,t)}),i.allElements=o},r.prototype._copyElements=function(e,t,n){var r;n&&$.isArray(n)?(r=e[t]||[],e[t]=r.concat(n)):n&&(r=e[t]||[],r.concat([n]))},r.prototype._getyAxisGroup=function(e){var t={};return $.each(e.seriesList,function(n,r){var i=r.yAxis||0;t[i]||(t[i]={seriesList:[],seriesStyles:[],seriesHoverStyles:[]}),t[i].seriesList.push(r),t[i].seriesStyles.push(e.seriesStyles[n]),t[i].seriesHoverStyles.push(e.seriesHoverStyles[n])}),t},r.prototype._bindtooltip=function(){var e=this,t=e.widgetName,n=e.chartElement.data("fields");n&&n.ctracers&&$.each(n.ctracers,function(e,t){var n=t.type;n!=="hloc"&&t.trackers&&t.trackers.toFront()}),e.chartElement.delegate(".linetracker, .wijchart-canvas-marker, .bartracker, .pietracker, .wijscatterchart, .bubbletracker","mouseover."+t,$.proxy(e._tooltipMouseOver,e)),e.chartElement.delegate(".linetracker, .wijchart-canvas-marker, .bartracker, .pietracker, .wijscatterchart, .bubbletracker","mouseout."+t,$.proxy(e._tooltipMouseOut,e)),e.chartElement.delegate(".linetracker, .wijchart-canvas-marker, .bartracker, .pietracker, .wijscatterchart, .bubbletracker","mousemove."+t,$.proxy(e._tooltipMouseMove,e))},r.prototype._tooltipMouseOver=function(e){var t=e.target,n=this,r=n.tooltip,i=n.options.hint,s=null,o=i.title,u=i.content,a=i.style,f=$.isFunction(o),l=$.isFunction(u),c,h,p,d;p=$(n.canvas.canvas.parentNode).offset();if(n.indicatorLine)return;$(t).data("owner")&&(t=$(t).data("owner")),t=$(t),c=t.data("wijchartDataObj");if(n.tooltip){s=r.getOptions();if(f||l)f&&(s.title=$.proxy(o,c)),l&&(s.content=$.proxy(u,c));if(c.type==="line"||c.type==="marker"){c.type==="marker"&&(c=c.lineSeries);if(c.path.removed)return;if(n.hoverLine!==c||n.hoverLine===null)n.isNewLine=!0,n.hoverLine&&(n.hoverLine.path.removed||(n.hoverLine.path.wijAttr(n.hoverLine.lineStyle),n.hoverPoint&&!n.hoverPoint.isSymbol&&(n.hoverPoint.marker.wijAttr(n.hoverPoint.markerStyle),n.hoverPoint.marker.transform("s1")))),c.lineHoverStyle&&c.path.wijAttr(c.lineHoverStyle),n.hoverLine=c,n.hoverPoint=null,n.hoverVirtualPoint=null}else c.type==="scatter"||i.relativeTo==="element"?(n._clearHoverState(),c.type==="scatter"?h=c.dot.getBBox():t[0]&&t[0].raphael&&t[0].raphaelid&&(d=n.canvas.getById(t[0].raphaelid),d&&(h=d.getBBox())),s.style.stroke=a.stroke||t.attr("stroke"),h&&n.tooltip.showAt({x:h.x+h.width/2,y:h.y},e)):(n._clearHoverState(),s.style.stroke=a.stroke||t.attr("stroke"),n.tooltip.showAt({x:e.pageX-p.left,y:e.pageY-p.top},e))}},r.prototype._tooltipMouseMove=function(e){var t=this,n=e.target,r,i=t.options.hint,s=$(t.canvas.canvas.parentNode).offset();$(n).data("owner")&&(n=$(n).data("owner")),n=$(n),r=n.data("wijchartDataObj"),t.tooltip&&!this.indicatorLine&&r.type!=="line"&&r.type!=="marker"&&r.type!=="scatter"&&i.relativeTo!=="element"&&t.tooltip.showAt({x:e.pageX-s.left,y:e.pageY-s.top},e)},r.prototype._tooltipMouseOut=function(e){var t=this,n=e.target,r;$(n).data("owner")&&(n=$(n).data("owner")),n=$(n),r=n.data("wijchartDataObj"),r.type!=="line"&&r.type!=="marker"&&!t.indicatorLine&&t.tooltip&&t.tooltip.hide()},r.prototype._mouseMoveInsidePlotArea=function(e,t){var r=this,i=r.tooltip,s=r.options.hint,o,u,a=0,f,l,c,h,p=null,d=null,v=null,m=s.title,g=s.content,y=$.isFunction(m),b=$.isFunction(g),w=0,E;i&&(v=i.getOptions());if(r.hoverLine&&!r.indicatorLine){E=r.hoverLine,r.isNewLine&&(s.enable&&i&&i.hide(),r.isNewLine=!1),o=E.lineMarkers,u=E.virtualMarkers,a=-1,f={x:0,y:0};if(o&&o.length){$.each(o,function(e,n){if(n.removed)return!0;var r=n.wijGetBBox(),i=r.x+r.width/2,s=Math.abs(i-t.left);if(e===0||s<w)w=s,a=e,f={x:i,y:r.y+r.height/2}});if(r.hoverPoint&&r.hoverPoint.index===a)return;if(a>-1){if(o[a].removed)return;l=$(o[a].node).data("wijchartDataObj"),l&&(r.hoverPoint&&!r.hoverPoint.isSymbol&&(r.hoverPoint.removed||(r.hoverPoint.marker.wijAttr(r.hoverPoint.markerStyle),r.hoverPoint.marker.transform("s1"))),l.isSymbol||l.marker.removed||l.marker.wijAttr(l.markerHoverStyle)),r.hoverPoint=l,r.hoverVirtualPoint=u[a]}}else{$.each(u,function(e,n){var r=Math.abs(n.x-t.left);if(e===0||r<w)w=r,a=e,f={x:n.x,y:n.y}});if(r.hoverVirtualPoint&&r.hoverVirtualPoint.index===a)return;a>-1&&(r.hoverPoint=null,r.hoverVirtualPoint=u[a])}if(i){d=r.hoverVirtualPoint,c=d.valX,h=d.valY;if(y||b)y&&(v.title=function(){var e={pointIndex:a,lineIndex:E.index,x:c,y:h,label:E.label,data:d,fmt:m},t=$.proxy(e.fmt,e),n=t();return n}),b&&(v.content=function(){var e={pointIndex:a,lineIndex:E.index,x:c,y:h,label:E.label,data:d,fmt:g},t=$.proxy(e.fmt,e),n=t();return n});p=$.extend({stroke:E.path.attr("stroke")},s.style),v.style.stroke=p.stroke,i.showAt(f)}}n.prototype._mouseMoveInsidePlotArea.call(this,e,t)},r.prototype._mouseDownInsidePlotArea=function(e,t){n.prototype._mouseDownInsidePlotArea.call(this,e,t),this._clearHoverState(!0)},r.prototype._mouseMoveOutsidePlotArea=function(e,t){var r=this;r._clearHoverState(),n.prototype._mouseMoveOutsidePlotArea.call(this,e,t)},r.prototype._clearHoverState=function(e){var t=this,n=t.tooltip,r=t.options.hint;t.hoverLine&&(r.enable&&n&&!e&&n.hide(),t.hoverLine.path.removed||(t.hoverLine.path.wijAttr(t.hoverLine.lineStyle),t.hoverPoint&&!t.hoverPoint.isSymbol&&(t.hoverPoint.marker.wijAttr(t.hoverPoint.markerStyle),t.hoverPoint.marker.transform("s1")))),t.hoverLine=null,t.hoverPoint=null,t.hoverVirtualPoint=null},r.prototype._getTooltipText=function(e,t){return""},r.prototype._calculateParameters=function(e,t){var r=this,i=!1,s,o;n.prototype._calculateParameters.call(this,e,t);if(r.isContainsStock){r._calculateStockParameters(e,t);return}$.each(r.options.seriesList,function(e,t){if(t.type==="column"||t.type==="bar")return i=!0,!1});if(!i)return;e.id==="x"&&(s=t.unitMinor,o=r._getBarAdjustment(e),o===0?o=s:s<o&&s!==0&&(o=Math.floor(o/s)*s),e.min-=o,e.max+=o,r._calculateMajorMinor(t,e))},r.prototype._getBarAdjustment=function(e){var t=0,n=this.options,r=e.max,i=e.min,s=0;return $.each(n.seriesList,function(e,n){if(n.type==="pie")return!0;if(n.data.x===undefined||n.data.y===undefined)return!0;s=n.data.x.length,t<s&&(t=s)}),t>1?(r-i)/t*n.clusterWidth*.0125:t===1?(i===0&&r===1&&(i=-1,e.min=i),(r-i)*.0125):0},r}(t.wijchartcore);t.wijcompositechart=n,n.prototype.widgetEventPrefix="wijcompositechart";var r=function(){function e(){this.initSelector=":jqmData(role='wijcompositechart')",this.wijCSS={compositechart:"wijmo-wijcompositechart",barLabel:"wijbarchart-label",barElement:"wijbarchart",barTracker:"bartracker",bubbleElement:"wijbubblechart-bubble",bubbleTracker:"bubbletracker",bubbleLabel:"wijbubblechart-label",bubbleSymbol:"wijbubblechart-symbol",scatterElement:"wijscatterchart",pieLabel:"wijpiechart-label",pieElement:"wijpiechart",pieTracker:"pietracker",lineLabel:"wijlinechart-label",lineElement:"wijlinechart",areaElement:"wijlinechart-area",lineTracker:"linetracker",canvasMarker:"wijchart-canvas-marker"},this.stacked=!1,this.clusterOverlap=0,this.clusterWidth=85,this.clusterRadius=0,this.clusterSpacing=0,this.seriesList=[],this.animation={enabled:!0,duration:400,easing:">"},this.seriesTransition={enabled:!0,duration:400,easing:">"},this.mouseDown=null,this.mouseUp=null,this.mouseOver=null,this.mouseOut=null,this.mouseMove=null,this.click=null}return e}();n.prototype.options=$.extend(!0,{},t.wijchartcore.prototype.options,new r),$.wijmo.registerWidget("wijcompositechart",n.prototype)})(e.chart||(e.chart={}));var t=e.chart})(wijmo||(wijmo={}));;
var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(t){"use strict";var n=jQuery,r="wijdatepager",i=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype._setOption=function(e,t){n.wijmo.widget.prototype._setOption.apply(this,arguments);switch(e){case"culture":this.options.culture=t,this._initBackground();break;case"selectedDate":this.options.selectedDate=t,this._initBackground();break;case"disabled":t?this._disable():this._enable();break;case"viewType":this.options.viewType=t,this._initBackground();break;case"nextTooltip":this.element.find(".wijmo-wijdatepager-increment").attr("title",t);break;case"prevTooltip":this.element.find(".wijmo-wijdatepager-decrement").attr("title",t);break;case"firstDayOfWeek":this.options.firstDayOfWeek=t,this.options.viewType==="week"&&this._initBackground()}return this},t.prototype._disable=function(){this.element.addClass(this.options.wijCSS.stateDisabled),this.element.find(".wijmo-wijdatepager-decrement").button("option","disabled",!0),this.element.find(".wijmo-wijdatepager-increment").button("option","disabled",!0)},t.prototype._enable=function(){this.element.removeClass(this.options.wijCSS.stateDisabled),this.element.find(".wijmo-wijdatepager-decrement").button("option","disabled",!1),this.element.find(".wijmo-wijdatepager-increment").button("option","disabled",!1)},t.prototype._create=function(){var e=this.options,t,r,i;window.wijmoApplyWijTouchUtilEvents&&(n=window.wijmoApplyWijTouchUtilEvents(n)),e.selectedDate||(e.selectedDate=new Date),this._dtpagernamespacekey="dtpager"+(new Date).getTime(),this.element.addClass("wijmo-wijdatepager "+e.wijCSS.widget+" ui-helper-clearfix"),t=n.proxy(this.invalidate,this),n(window).bind("resize."+this._dtpagernamespacekey,t),this.element.disableSelection&&this.element.disableSelection(),this.element.append(n('<a class="wijmo-wijdatepager-decrement"><span>'+e.prevTooltip+"</span></a>")).append('<div class="wijmo-wijdatepager-container '+e.wijCSS.content+'">'+'<div class="wijmo-wijdatepager-pages"></div>'+"</div>"+'<a class="wijmo-wijdatepager-increment"><span>'+e.nextTooltip+"</span></a>"),n.wijmo.widget.prototype._create.apply(this,arguments),r=this.element.find(".wijmo-wijdatepager-decrement"),i=this.element.find(".wijmo-wijdatepager-increment"),n.mobile==null?(r.button({icons:{primary:"ui-icon-triangle-1-w"},text:!1}),i.button({icons:{primary:"ui-icon-triangle-1-e"},text:!1})):(r.html(""),r.attr("data-icon","arrow-l"),r.button({text:!1}),i.html(""),i.attr("data-icon","arrow-r"),i.button({text:!1})),r.click(n.proxy(this.goLeft,this)),i.click(n.proxy(this.goRight,this)),this._initBackground(),e.disabled&&this._disable()},t.prototype.destroy=function(){this.element.removeClass("wijmo-wijdatepager"),n(window).unbind("."+this._dtpagernamespacekey)},t.prototype.refresh=function(){this.invalidate()},t.prototype.invalidate=function(){var e,t=this.options.selectedDate,r,i=this.element.find(".wijmo-wijdatepager-container"),s=this.element.find(".wijmo-wijdatepager-decrement"),o=this.element.find(".wijmo-wijdatepager-increment"),u=this.element.innerWidth(),a=s.is(":visible")?s.outerWidth(!0):0,f=o.is(":visible")?o.outerWidth(!0):0,l,c,h;e=this.element.find(".wijmo-wijdatepager-pagelabel."+this._getDateClass(t)),e.length!==1?e=n(this.element.find(".wijmo-wijdatepager-pagelabel")[this._index]):(r=this.element.find(".wijmo-wijdatepager-pagelabel").index(e),this._index=r),this.element.find(".wijmo-wijdatepager-pagelabel."+this.options.wijCSS.stateActive).removeClass(this.options.wijCSS.stateActive),e.addClass(this.options.wijCSS.stateActive),i.css("left",a),this.element.removeClass("wijmo-wijdatepager-width-smallest wijmo-wijdatepager-width-small wijmo-wijdatepager-width-medium wijmo-wijdatepager-width-normal"),u<300?this.element.addClass("wijmo-wijdatepager-width-smallest"):u<475?this.element.addClass("wijmo-wijdatepager-width-small"):u<600?this.element.addClass("wijmo-wijdatepager-width-medium"):this.element.addClass("wijmo-wijdatepager-width-normal"),i.outerWidth(u-a-f),n.browser.msie&&parseInt(n.browser.version,10)<=7&&(l=this.element.find(".wijmo-wijdatepager-pages"),c=l.find(".wijmo-wijdatepager-pagelabel"),h=Math.round(l.width()/this._datesDef.length)-(c.outerWidth(!0)-c.width()),c.width(h))},t.prototype.goLeft=function(e){var t=this.options;if(t.disabled)return;this._setSelectedIndex(this._index-1,!0);if(e)return e.preventDefault(),!1},t.prototype.goRight=function(){var e=this.options;if(e.disabled)return;this._setSelectedIndex(this._index+1)},t.prototype._getCulture=function(e){return typeof e=="undefined"&&(e=null),Globalize.findClosestCulture(e||this.options.culture)},t.prototype._isRTL=function(){return!!this._getCulture().isRTL},t.prototype._initBackground=function(e,t){typeof e=="undefined"&&(e=!1),typeof t=="undefined"&&(t=!1);var r,i,s,o,u,a,f=this,l;if(this._isInAnimate)return;this._index=0,this._datesDef=this._getDatesDefinition(),this._min=0,this._max=this._datesDef.length-1,r="";for(i=0;i<this._datesDef.length;i+=1)r+='<div class="wijmo-wijdatepager-pagelabel'+(i===0?" wijmo-wijdatepager-pagelabel-first":"")+(this._datesDef[i].range?" wijmo-wijdatepager-pagerange":"")+(this._datesDef[i].header?" wijmo-wijdatepager-pageheader ui-state-highlight":"")+(i===this._datesDef.length-1?" wijmo-wijdatepager-pagelabel-last":"")+" "+this._getDateClass(this._datesDef[i].d)+'">'+this._datesDef[i].l+"</div>";o=this.element.find(".wijmo-wijdatepager-pages"),e?(this._isInAnimate=!0,s=o.clone(!0),o.html(r),u=o.find(".wijmo-wijdatepager-pagelabel"),t?(s.insertAfter(o),a=n(u[this._index]).offset().left,o.css("opacity",0).css("left",-s.outerWidth(!0)).stop().animate({left:"0px",opacity:100}),s.css("left",0).stop().animate({left:s.outerWidth(!0)+"px",opacity:0},function(){s.remove(),f._isInAnimate=!1,f.invalidate()})):(s.insertBefore(o),a=n(u[this._index]).offset().left,o.css("opacity",0).css("left",s.outerWidth(!0)).stop().animate({left:"0px",opacity:100}),s.stop().animate({left:"-"+s.outerWidth(!0)+"px",opacity:0},function(){s.remove(),f._isInAnimate=!1,f.invalidate()}))):(o.html(r),this.invalidate()),u=o.find(".wijmo-wijdatepager-pagelabel"),u.hover(n.proxy(this._pagelabelHover,this),n.proxy(this._pagelabelHout,this)),u.bind("mousedown",n.proxy(this._pagelabelMouseDown,this)),u.click(n.proxy(function(e){var t=n(e.target),r;r=this.element.find(".wijmo-wijdatepager-pagelabel").index(t),this._setSelectedIndex(r)},this))},t.prototype._getDateClass=function(e){return"c1dt"+e.getFullYear()+"_"+e.getMonth()+"_"+e.getDate()},t.prototype._addDays=function(e,t){return new Date(e.getFullYear(),e.getMonth(),e.getDate()+t)},t.prototype._getDatesDefinition=function(){var e=this.options,t=e.viewType.toLowerCase(),n,r,i,s,o,u=[],a=e.selectedDate;switch(t){case"week":i=new Date(a.getFullYear(),a.getMonth(),-6),n=e.firstDayOfWeek-i.getDay(),Math.abs(n)>6&&(n=i.getDay()-e.firstDayOfWeek),i=this._addDays(i,n),o=new Date(a.getFullYear(),a.getMonth()+1,7),n=0;while(i<o||i.getMonth()===a.getMonth())s=this._addDays(i,7),u.push({l:this._formatString(this.localizeString("weekViewLabelFormat","{0:MMM dd}-{1:dd}"),i,this._addDays(i,6)),d:i,d2:this._addDays(i,6)}),a>=i&&a<=s&&(this._index=n),i=s,n+=1;break;case"month":r=new Date(a.getFullYear()-1,0,1),u.push({l:r.getFullYear(),d:r,range:!0}),r=new Date(a.getFullYear(),0,1),u.push({l:r.getFullYear(),d:r,header:!0});for(n=0;n<12;n+=1)r=new Date(a.getFullYear(),n,1),u.push({l:this._formatString(this.localizeString("monthViewLabelFormat","{0:MMM}"),r),d:r}),s=new Date(a.getFullYear(),n+1,1),a>=r&&a<=s&&(this._index=n+2);r=new Date(a.getFullYear()+1,0,1),u.push({l:r.getFullYear(),d:r,range:!0});break;default:r=new Date(a.getFullYear(),a.getMonth(),0),u.push({l:Globalize.format(r,"MMM",this._getCulture()),d:r,range:!0}),r=new Date(a.getFullYear(),a.getMonth(),1),u.push({l:Globalize.format(r,"MMM",this._getCulture()),d:r,header:!0}),i=r,n=2;while(i.getMonth()===a.getMonth())s=new Date(i.getFullYear(),i.getMonth(),i.getDate()+1),u.push({l:this._formatString(this.localizeString("dayViewLabelFormat","{0:d }"),i),d:i}),a>=i&&a<=s&&(this._index=n),i=s,n+=1;r=new Date(a.getFullYear(),a.getMonth()+1,1),u.push({l:Globalize.format(r,"MMM",this._getCulture()),d:r,range:!0})}return u},t.prototype._setSelectedIndex=function(e,t){typeof t=="undefined"&&(t=!1);var n=this.options,r;if(n.disabled)return;if(e>=this._min&&e<=this._max){this._dragActivated&&this._showTooltip(e);if(this._index!==e){if(this._datesDef[e].header){if(!t)return;e-=1}this._index=e,r=this._datesDef[e].d,n.selectedDate=r,this._max>2&&this._index===0?this._initBackground(!0,!0):this._index===this._max?(n.viewType==="week"&&(n.selectedDate=new Date(n.selectedDate.getFullYear(),n.selectedDate.getMonth(),n.selectedDate.getDate()+7)),this._initBackground(!0,!1),n.selectedDate=r):this.invalidate(),this._trigger("selectedDateChanged",null,{selectedDate:n.selectedDate})}}},t.prototype._pagelabelHover=function(e){var t=n(e.target),r=this.options;if(t.hasClass("wijmo-wijdatepager-pageheader"))return;t.addClass(r.wijCSS.stateHover)},t.prototype._showTooltip=function(e){var t=this.options,r=this._datesDef[e],i=t.viewType,s,o=this.element.find(".wijmo-wijdatepager-pagelabel")[e];this._tooltip||(this._tooltip=n('<div class="wijmo-wijdatepager-tooltip"><div class="wijmo-wijdatepager-tooltip-inner"></div><div class="wijmo-wijdatepager-triangle"></div></div>'),this.element.append(this._tooltip),this._tooltip.wijpopup()),s="";switch(i){case"week":r.d.getMonth()!==r.d2.getMonth()?s=this._formatString(this.localizeString("weekViewTooltip2MonthesFormat","{0:MMMM d} - {1:MMMM d, yyyy}"),r.d,r.d2):s=this._formatString(this.localizeString("weekViewTooltipFormat","{0:MMMM d} - {1:d, yyyy}"),r.d,r.d2);break;case"month":s=this._formatString(this.localizeString("monthViewTooltipFormat","{0:MMMM yyyy}"),r.d);break;default:s=this._formatString(this.localizeString("dayViewTooltipFormat","{0:dddd, MMMM d, yyyy}"),r.d)}n.ui&&(this._tooltip.wijpopup("show",{of:o,my:"center bottom",at:"center top",offset:"-10 -10"}),this._tooltip.find(".wijmo-wijdatepager-tooltip-inner").html(s))},t.prototype._hideTooltip=function(){this._tooltip.wijpopup("hide")},t.prototype._pagelabelHout=function(e){n(e.target).removeClass(this.options.wijCSS.stateHover)},t.prototype._pagelabelMouseDown=function(e){this._dragActivated=!1;if(this.options.disabled)return;e.preventDefault();var t=n(e.target),r;if(t.hasClass("wijmo-wijdatepager-pageheader"))return;r=this.element.find(".wijmo-wijdatepager-pagelabel").index(t),this._dragActivated=!0,this._setSelectedIndex(r),this._mouseDownTimeFix20555=(new Date).getTime(),this._startClientX=e.pageX,this._startInd=r,n(document).bind("mousemove."+this._dtpagernamespacekey,n.proxy(this._pageindicatorMouseMove,this)),n(document).bind("mouseup."+this._dtpagernamespacekey,n.proxy(this._pageindicatorMouseUp,this))},t.prototype._detectLeftButton=function(e){return e.originalEvent&&(e=e.originalEvent),"buttons"in e?e.buttons===1:"which"in e?e.which===1:e.button===1},t.prototype._pageindicatorMouseMove=function(e){if(!this._detectLeftButton(e)){this._pageindicatorMouseUp();return}e.preventDefault();if(this._isInAnimate)return;var t=this.element.find(".wijmo-wijdatepager-pagelabel")[this._startInd],n,r;if(!t)return;n=t.offsetLeft+Math.round(t.offsetWidth/2)+(e.pageX-this._startClientX),r=this._findClosesPageIndexByPos(n);if(this._prevMoveInd===r)return;this._prevMoveInd=r;if(this._mouseDownTimeFix20555+150>(new Date).getTime())return;r!==-1&&r!==this._index&&this._setSelectedIndex(r)},t.prototype._pageindicatorMouseUp=function(){this._dragActivated=!1,n(document).unbind("."+this._dtpagernamespacekey),this._hideTooltip()},t.prototype._findClosesPageIndexByPos=function(e){var t=this.element.find(".wijmo-wijdatepager-pages").find(".wijmo-wijdatepager-pagelabel"),n;for(n=0;n<t.length;n+=1)if(t[n].offsetLeft<e&&t[n].offsetLeft+t[n].offsetWidth>e)return n;return-1},t.prototype.localizeString=function(e,t){var n=this.options;return n.localization&&n.localization[e]?n.localization[e]:t},t.prototype._formatString=function(e,t,n,r){var i,s=arguments,o,u,a=this;if(s.length<=1)return Globalize.format(s);typeof e=="string"&&typeof window[e]=="function"&&(e=window[e]);if(typeof e=="function"){u=[];for(o=1;o<s.length;o+=1)u[o-1]=s[o];return e.apply(this,u)}return i=new RegExp("\\{(\\d+)(?:,([-+]?\\d+))?(?:\\:([^(^}]+)(?:\\(((?:\\\\\\)|[^)])+)\\)){0,1}){0,1}\\}","g"),e.replace(i,function(e,t,n,r,i){return e=s[Number(t)+1],r?Globalize.format(e,r,a._getCulture()):e})},t}(e.wijmoWidget);t.wijdatepager=i;var s=function(){function e(){this.wijMobileCSS={header:"ui-header ui-bar-a",content:"ui-body ui-body-c",stateDefault:"ui-btn-up-c"},this.initSelector=":jqmData(role='wijdatepager')",this.culture="",this.localization=null,this.firstDayOfWeek=0,this.selectedDate=null,this.viewType="day",this.nextTooltip="right",this.prevTooltip="left",this.selectedDateChanged=null}return e}();i.prototype.options=n.extend(!0,{},e.wijmoWidget.prototype.options,new s),n.wijmo.registerWidget(r,i.prototype)})(e.datepager||(e.datepager={}));var t=e.datepager})(wijmo||(wijmo={}));;
var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(t){"use strict";function i(e){return new Date(e.getFullYear(),e.getMonth(),e.getDate())}function s(){var e,t,n;e="";for(n=0;n<32;n+=1){if(n===8||n===12||n===16||n===20)e+="-";t=Math.floor(Math.random()*16).toString(16).toUpperCase(),e+=t}return e}function c(e,t,n){f?(l=amplify.store("wijevcal_tables1"),l||(l={}),l[e]||(l[e]={fields:t},amplify.store("wijevcal_tables1",l),amplify.store("wijevcal_tbl_"+e,{})),n&&n()):o&&o.transaction(function(r){r.executeSql("SELECT COUNT(*) FROM "+e,[],function(){n&&n()},function(r,i){r.executeSql("CREATE TABLE "+e+" "+t,[],n,n)})})}function h(e,t,n,r){var i={rowsAffected:0,rows:new Array},s,u,a,c,h,p,d,v,m,g,y,b,w,E;t||(t=[]),i.rows.item||(i.rows.item=function(e){return this[e]});if(f)try{a=new RegExp("(SELECT) *(.*) *FROM (\\w+)"),c=new RegExp("(INSERT OR REPLACE|INSERT) *(.*) *INTO *(\\w*) *\\(([\\w|,| ]*)\\)"),h=new RegExp("(DELETE) *(.*) *FROM (\\w+) *(\\w*)WHERE (\\w+)='*([^']+)");if(e.match(c)){p=c.exec(e);if(p&&p.length>1){d=p[3],v=l[d],m=amplify.store("wijevcal_tbl_"+d);if(m){y=p[4].split(","),s={};for(u=0;u<y.length;u+=1)y[u]&&(u===0&&(m[t[u]]=s),b=y[u].replace(" ",""),s[b]=t[u])}amplify.store("wijevcal_tbl_"+d,m)}}else if(e.match(a)){p=a.exec(e);if(p&&p.length>1){d=p[3],v=l[d],m=amplify.store("wijevcal_tbl_"+d);if(m){w=e.replace(a,"");if(w.toUpperCase().indexOf(" WHERE ")===0){w=w.substr(7),E=w.split(" OR ");for(u=0;u<E.length;u+=1)E[u]=E[u].split("="),w=E[u][1],w.indexOf("'")===0?(w=w.substring(1,w.length-1),E[u][1]=w):E[u][1]=parseFloat(w)}for(g in m)if(m.hasOwnProperty(g)){s=m[g];if(s)if(E)for(u=0;u<E.length;u+=1)s[E[u][0]]===E[u][1]&&i.rows.push(s);else i.rows.push(s)}}}}else e.match(h)&&(p=h.exec(e),p&&p.length>1&&(d=p[3],v=l[d],m=amplify.store("wijevcal_tbl_"+d),m&&m[p[6]]&&delete m[p[6]],amplify.store("wijevcal_tbl_"+d,m)));n&&n(i)}catch(S){r&&r(S)}else{if(!o){r("Local data storage not found.");return}o.transaction(function(i){i.executeSql(e,t,function(e,t){n&&n(t)},function(e,t){r&&r(t.message);return})})}}var n=jQuery,r="wijevcal",o,u="C1EventsCalendarDB",a="1.1",f=!1,l,p=function(e){function t(){e.apply(this,arguments),this._dynIdCounter=0}return __extends(t,e),t.prototype._setOption=function(e,t){var r=this,i=n.when.apply(this,r._defferObjs),s;i.always(function(){r._setOptionCallbacks.fire(),r._setOptionCallbacks.empty(),r._defferObjs=[]}),i.state()==="pending"?this._setOptionCallbacks.add(function(){n.isPlainObject(t)?s=n.extend(!0,{},t):n.isArray(t)?s=[].concat(t):s=t,r._setOptionInternal(e,s)}):this._setOptionInternal(e,t)},t.prototype._setOptionInternal=function(e,t){var r=this.options,s;switch(e){case"dataSource":r.dataSource=t,this._needLoadLocalStorage=!1,r.eventsData=[],this._bindDataView();break;case"eventsData":r.eventsData=t,r.appointments=t,this._needLoadLocalStorage=!1,this._onEventsDataChanged(),this._bindEvents();break;case"appointments":r.eventsData=t,r.appointments=t,this._needLoadLocalStorage=!1,this._onEventsDataChanged(),this._bindEvents();break;case"localization":this._setLocalization(t);break;case"culture":r.culture=t,this.element.find(".wijmo-wijdatepager").wijdatepager("option","culture",r.culture),this._editEventDialog&&this._editEventDialog.find(".wijmo-wijinput-date").wijinputdate("option","culture",r.culture),this.element.find(".wijmo-wijcalendar").wijcalendar("option","culture",r.culture),this._redrawActiveView();break;case"disabled":r.disabled!==t&&(r.disabled=t,this._ensureDisabled());break;case"enableLogs":r.enableLogs=t,this._initLogPanel();break;case"selectedDate":t&&(t=i(t),r.selectedDates[0].getTime()!==t.getTime()&&(r.selectedDates[0]=t,this._onSelectedDatesChanged()));return;case"selectedDates":t&&(r.selectedDates=t,this._onSelectedDatesChanged());return;case"statusBarVisible":r.statusBarVisible=t,this._initStatusbar(),this.invalidate();return;case"headerBarVisible":r.headerBarVisible=t,this._initHeaderbar(),this.invalidate();return;case"navigationBarVisible":r.navigationBarVisible=t,this._initNavigationbar(),this.invalidate();return;case"rightPaneVisible":r.rightPaneVisible=t,this._initRightPane(),this.invalidate();return;case"timeInterval":case"timeIntervalHeight":case"timeRulerInterval":case"timeRulerFormat":r[e]!==t&&(r[e]=t,this._redrawActiveView());break;case"firstDayOfWeek":r[e]!==t&&(r[e]=t,this._redrawActiveView(),s=this._getCulture(),s&&s.calendar&&(s.calendar.firstDay=t,this.element.find(".wijmo-wijcalendar").wijcalendar("refresh")));break;case"viewType":r.viewType!==t&&(r.viewType=t,this._onViewTypeChanged());break;default:}n.wijmo.widget.prototype._setOption.apply(this,arguments)},t.prototype._setLocalization=function(e){this._destroyInternal(),this.options.localization=e,this._create(),this._init()},t.prototype._ensureDisabled=function(){var e=this.options;if(e.disabled){this.element.addClass(e.wijCSS.stateDisabled);try{this.element.find(".wijmo-wijcalendar").wijcalendar("option","disabled",!0),this.element.find(".wijmo-wijsuperpanel").wijsuperpanel("option","disabled",!0),this.element.find(".wijmo-wijdatepager").wijdatepager("option","disabled",!0),n().buttonset&&this.element.find(".ui-buttonset").buttonset("option","disabled",!0),this.element.find(".wijmo-wijev-today.ui-button").button("option","disabled",!0)}catch(t){this.log(t,"error")}this._unbindEvents()}else{this.element.removeClass(e.wijCSS.stateDisabled);try{this.element.find(".wijmo-wijcalendar").wijcalendar("option","disabled",!1),this.element.find(".wijmo-wijsuperpanel").wijsuperpanel("option","disabled",!1),this.element.find(".wijmo-wijdatepager").wijdatepager("option","disabled",!1),n().buttonset&&this.element.find(".ui-buttonset").buttonset("option","disabled",!1),this.element.find(".wijmo-wijev-today.ui-button").button("option","disabled",!1)}catch(t){this.log(t,"error")}this._bindEvents(),this._updateTitleText()}},t.prototype._onViewTypeChanged=function(){this._renderActiveView(),this._updateTitleText(),this._trigger("viewTypeChanged",null,this.options.viewType),this.element.find(".wijmo-wijev-datepager").wijdatepager("option","viewType",this.options.viewType)},t.prototype._onSelectedDatesChanged=function(){var e=this.options;e.selectedDate=e.selectedDates[0],this.element.find(".wijmo-wijev-datepager").wijdatepager("option","selectedDate",e.selectedDate),this._trigger("selectedDatesChanged",null,{selectedDates:e.selectedDates}),this._renderActiveView(),this._updateTitleText()},t.prototype._updateHeaderTitleText=function(){var e=this.options,t=e.titleFormat,n=e.selectedDates[0],r=e.selectedDates[e.selectedDates.length-1];if(t[e.viewType])t=t[e.viewType];else{if(t[e.viewType]===!1){this.element.find(".wijmo-wijev-view .wijmo-wijev-header-title").hide();return}t=t.toString()}e.viewType==="list"&&(r=this._addDays(n,14)),this.element.find(".wijmo-wijev-view .wijmo-wijev-header-title").show().html(this._formatString(t,n,r))},t.prototype._updateTitleText=function(){var e=this.options,t=e.selectedDates[0],r=e.selectedDates[e.selectedDates.length-1],i=new Date,s=!1;s=this._compareDayDates(t,i)===0||t<i&&r>i,n.mobile==null&&this.element.find(".wijmo-wijev-navigationbar .wijmo-wijev-today").button("option","disabled",s),this._updateHeaderTitleText()},t.prototype.localizeString=function(e,t){var n=this.options;return n.localization&&n.localization[e]?n.localization[e]:t},t.prototype._create=function(){var e=this;window.wijmoApplyWijTouchUtilEvents&&(n=window.wijmoApplyWijTouchUtilEvents(n)),this._defferObjs=[],this._chromeLoadDataDeffer=n.Deferred(),this._defferObjs.push(this._chromeLoadDataDeffer),this._setOptionCallbacks=n.Callbacks("once"),this._needLoadLocalStorage=!0;if(this.options.appointments&&this.options.appointments.length||this.options.eventsData&&this.options.eventsData.length)this._needLoadLocalStorage=!1;n.isFunction(window.wijmoASPNetParseOptions)&&window.wijmoASPNetParseOptions(this.options);var t,r,i=this.options;i.colors||(i.colors=["red","darkorchid","green","blue","cornflowerblue","yellow","bronze"]),this.wijevcalnamespacekey||(this.wijevcalnamespacekey="wijevcal"+(new Date).getTime()),this.element[0].id||(this.element[0].id="wijevcal_dynid_"+(new Date).getTime()),this._uidPref=this.element[0].id+"evcdynid",this.element.addClass("wijmo-wijevcal wijmo-wijev "+i.wijCSS.widget+" ui-helper-reset "+i.wijCSS.stateDefault),n('<div class="wijmo-wijev-headerbar ui-widget-header ui-corner-top"><fieldset class="wijmo-wijev-tools"><input id="'+this._uidPref+'_daybtn" name="viewselection"'+' type="radio" class="wijmo-wijev-day" />'+'<label for="'+this._uidPref+'_daybtn">'+this.localizeString("buttonDayView","Day")+"</label>"+'<input id="'+this._uidPref+'_weekbtn" name="viewselection"'+' type="radio" class="wijmo-wijev-week" />'+'<label for="'+this._uidPref+'_weekbtn">'+this.localizeString("buttonWeekView","Week")+"</label>"+'<input id="'+this._uidPref+'_monthbtn" name="viewselection"'+' type="radio" class="wijmo-wijev-month" />'+'<label for="'+this._uidPref+'_monthbtn">'+this.localizeString("buttonMonthView","Month")+"</label>"+'<input id="'+this._uidPref+'_listbtn" name="viewselection"'+' type="radio" class="wijmo-wijev-list" />'+'<label for="'+this._uidPref+'_listbtn">'+this.localizeString("buttonListView","List")+"</label>"+"</fieldset>"+"</div>").appendTo(this.element),n('<div class="wijmo-wijev-view-container"><div class="wijmo-wijev-leftpane wijmo-wijev-viewdetails '+i.wijCSS.content+' wijmo-wijev-day-details">'+'<div class="wijmo-wijev-leftpane-inner">'+'<div class="wijmo-wijev-daycalendar"></div>'+'<div class="wijmo-wijev-monthday-container">'+'<div class="wijmo-wijev-monthday-label">...</div>'+'<div class="wijmo-wijev-fulldate-label">'+this.localizeString("activityLoading","Loading...")+"</div>"+'<div class="wijmo-wijev-year-label">...</div>'+"</div>"+'<div class="wijmo-wijev-agenda-container '+i.wijCSS.content+" "+i.wijCSS.cornerAll+" ui-helper-clearfix"+'"></div>'+"</div>"+"</div>"+'<div class="wijmo-wijev-leftpane wijmo-wijev-viewdetails '+i.wijCSS.content+' wijmo-wijev-list-details">'+'<div class="wijmo-wijev-leftpane-inner">'+'<div class="wijmo-wijev-agenda-container '+i.wijCSS.content+" "+i.wijCSS.cornerAll+' ui-helper-clearfix">&nbsp;'+"</div>"+"</div>"+"</div>"+'<div class="wijmo-wijev-rightpane">'+"&nbsp;</div>"+"</div>").appendTo(this.element),n('<div class="wijmo-wijev-loading-modal-frame"></div><div class="wijmo-wijev-loading"><div class="wijmo-wijev-loading-text">'+this.localizeString("activityLoading","Loading...")+"</div></div>").appendTo(this.element),n('<div class="wijmo-wijev-navigationbar ui-widget-header ui-corner-bottom ui-helper-clearfix"><a class="wijmo-wijev-today">'+this.localizeString("buttonToday","today")+"</a>"+'<div class="wijmo-wijev-datepager">'+"</div>"+"</div>").appendTo(this.element),n('<div class="wijmo-wijev-statusbar ui-widget-header ui-corner-bottom"></div>').appendTo(this.element),t=this.element.find(".wijmo-wijev-navigationbar"),r=this.element.find(".wijmo-wijev-headerbar .wijmo-wijev-tools"),t.find(".wijmo-wijev-today").button({text:this.localizeString("buttonToday","today")}).click(n.proxy(this._onTodayClick,this)),this.element.find(".wijmo-wijev-datepager").wijdatepager({selectedDate:i.selectedDate,localization:i.datePagerLocalization,culture:i.culture,viewType:i.viewType,nextTooltip:this.localizeString("navigatorBarNextTooltip","right"),prevTooltip:this.localizeString("navigatorBarPrevTooltip","left"),firstDayOfWeek:i.firstDayOfWeek,selectedDateChanged:n.proxy(function(e,t){this.goToDate(t.selectedDate)},this)}),n.mobile==null?(r.find(".wijmo-wijev-day").button(),r.find(".wijmo-wijev-week").button(),r.find(".wijmo-wijev-month").button(),r.find(".wijmo-wijev-list").button(),r.buttonset()):(r.attr("data-role","controlgroup"),r.attr("data-type","horizontal"),r.parent().trigger("create"),r.controlgroup("refresh")),this.element.wijAddVisibilityObserver&&this.element.wijAddVisibilityObserver(function(){e.element.wijRemoveVisibilityObserver&&e.element.wijRemoveVisibilityObserver(),e._redrawActiveView()},"wijevcal"),r.find(".wijmo-wijev-day").click(n.proxy(this._onDayViewClick,this)),r.find(".wijmo-wijev-week").click(n.proxy(this._onWeekViewClick,this)),r.find(".wijmo-wijev-month").click(n.proxy(this._onMonthViewClick,this)),r.find(".wijmo-wijev-list").click(n.proxy(this._onListViewClick,this)),this.showLoadingLabel()},t.prototype.showLoadingLabel=function(e,t){e===!1?this.element.find(".wijmo-wijev-loading-text").hide():(this.element.find(".wijmo-wijev-loading-text").show(),e||(e=this.localizeString("activityLoading","Loading..."))),(t===undefined||t===!0)&&this.element.find(".wijmo-wijev-loading-modal-frame").show(),this.element.find(".wijmo-wijev-loading").show(),this.element.find(".wijmo-wijev-loading-text").html(e)},t.prototype.hideLoadingLabel=function(){this.element.find(".wijmo-wijev-loading-modal-frame").hide(),this.element.find(".wijmo-wijev-loading").hide()},t.prototype._init=function(){var e=this.options;e.selectedDates&&e.selectedDates.length>0?e.selectedDate=e.selectedDates[0]=i(e.selectedDates[0]):e.selectedDate?(e.selectedDate=i(e.selectedDate),e.selectedDates||(e.selectedDates=[]),e.selectedDates[0]=e.selectedDate):(e.selectedDate=i(new Date),e.selectedDates=[e.selectedDate]),e.disabled&&this.element.addClass(e.wijCSS.stateDisabled),this._initHeaderbar(),this._initNavigationbar(),this._initStatusbar(),this._initRightPane(),e.fullScreen&&this._onFullScreenModeChanged(e.fullScreen),this._initLogPanel(),this._initLocalDataStorage(),this.element.ajaxError(jQuery.proxy(this._onAjaxError,this)),n(window).bind("resize."+this.wijevcalnamespacekey,n.proxy(this._onWindowResize,this)),this._renderActiveView(),this._bindDataView()},t.prototype._onFullScreenModeChanged=function(e){},t.prototype._isDataViewLoaded=function(e){return e&&(e.isLoaded()||e.count()>0)},t.prototype._isDataview=function(e){if(e&&typeof e=="object"&&!n.isArray(e))return!0},t.prototype._getDataViewInst=function(){return this.element.data("wijdataview")},t.prototype._bindDataView=function(){var e=this.options,t=e.dataSource,t,n=this;!t&&this._getDataViewInst()&&(t=this._getDataViewInst(),t=e.dataSource=t),t&&this._isDataview(t)?this._isDataViewLoaded(t)?(this._dataView=t,this._setOption("eventsData",t.toArray())):t.element.bind("dataloaded",function(){n._dataView=t,n._setOption("eventsData",t.toArray())}):this._dataView=null},t.prototype._initLocalDataStorage=function(){try{f=!1;if(window.amplify&&window.amplify.store)try{l=amplify.store("wijevcal_tables1"),f=!0,this.log("Using amplify.store for the local data storage")}catch(e){this.log("amplify.store exception:"+e),this._loadData();return}else{if(!window.openDatabase){this.log(this.localizeString("logCouldntOpenLocalStorage","Couldn't open built-in local data storage. Please, add amplify.store references.")),this._loadData();return}try{o=window.openDatabase(u,a,"Wijmo Events Calendar Offline DB",2e5)}catch(t){this.log("web sql database error: "+t),this._loadData();return}if(!o){this.log("Failed to open the database on disk. This is probably because the version was bad or there is not enough space left in this domain's quota"),this._loadData();return}this.log("Using Web SQL Database for the local data storage.")}c("calendars","(id TEXT PRIMARY KEY, name TEXT, location TEXT, description TEXT, color TEXT, tag TEXT)");var r=n.Deferred(),i=this;this._defferObjs.push(r),c("events","(id TEXT PRIMARY KEY, calendar TEXT, subject TEXT, location TEXT, start TIMESTAMP, end TIMESTAMP, description TEXT, color TEXT, allday INTEGER, properties TEXT, tag TEXT)",function(){i._loadData(),r.resolve()})}catch(s){this.log("local datastorage initialization error:"+s)}},t.prototype._initStatusbar=function(){var e=this.element.find(".wijmo-wijev-statusbar");if(!this.options.statusBarVisible){e.hide();return}e.show();if(this.statusbarEventsAdded)return!0;this.statusbarEventsAdded=!0},t.prototype._initHeaderbar=function(){var e=this.element.find(".wijmo-wijev-headerbar");if(!this.options.headerBarVisible){e.hide();return}e.show()},t.prototype._initNavigationbar=function(){var e=this.element.find(".wijmo-wijev-navigationbar");if(!this.options.navigationBarVisible){e.hide();return}e.show()},t.prototype._initRightPane=function(){var e=this.element.find(".wijmo-wijev-rightpane");if(!this.options.rightPaneVisible){e.hide();return}e.show()},t.prototype._initLogPanel=function(){this.options.enableLogs?(this._createLogPanel(),this.log=this._log):(this.logDialog&&this.logDialog.wijdialog("close"),this.log=function(){})},t.prototype._handleServerError=function(e){return e&&e.toString().indexOf("error:")===0?(this.status(e.toString(),"error"),!0):!1},t.prototype._loadData=function(){var e=this.options,t=this,r,i,s,o,u,a,f,l,c,p,d,v,m;this.showLoadingLabel(),p=function(e){e==="Local data storage not found."&&(m=!0),t.hideLoadingLabel()},e.calendars=[],u=this._calendarsById={},l=function(n){e.calendars=[];if(!n)return;if(typeof n=="string"){if(t._handleServerError(n)){p(n);return}try{n=t._jsonParse(n)}catch(i){t.status("Unable to parse received calendars data. "+i,"error");return}}n.calendars&&n.calendars.length&&(n=n.calendars);for(r=0;r<n.length;r+=1)s=t._cloneObj(n[r]),s.prevData=t._cloneObj(s),e.calendars.push(s),u[s.id]=s;t._onCalendarsChanged()},e.dataStorage.loadCalendars?e.dataStorage.loadCalendars(l,p):e.webServiceUrl?n.getJSON(e.webServiceUrl+"?clientId="+this.element[0].id+"&command=loadCalendars"+"&calendars="+e.calendars,l):h("SELECT * FROM calendars",[],function(n){for(r=0,i=n.rows.length;r<i;r+=1)s=t._cloneObj(n.rows.item(r)),s.prevData=t._cloneObj(s),e.calendars.push(s),u[s.id]=s;t._onCalendarsChanged()},p),this._dataView&&(e.eventsData=this._dataView.toArray()),this._eventsDataById?a=this._eventsDataById:a=this._eventsDataById={},c=function(e){if(!e)return;if(typeof e=="string"){if(t._handleServerError(e)){p(e);return}try{e=t._jsonParse(e)}catch(n){t.log("Unable to parse received calendars data. "+n);return}}e.events&&e.events.length&&(e=e.events);for(r=0;r<e.length;r+=1)o=t._readEventData(e[r]),t._storeEventWithSort(o);t._onEventsDataChanged(),t._onInitialized()};if(e.dataStorage.loadEvents)e.dataStorage.loadEvents(e.visibleCalendars,c,p),t._chromeLoadDataDeffer.resolve();else if(e.webServiceUrl)n.ajax({url:e.webServiceUrl+"?clientId="+this.element[0].id+"&command=loadEvents&timestamp="+(new Date).getTime(),dataType:"text",cache:!1,contentType:"application/json; charset=utf-8",type:"POST",success:c,error:p}),t._chromeLoadDataDeffer.resolve();else{if(this._dataView){this._onInitialized();return}f="SELECT * FROM events where ";for(r=0;r<e.visibleCalendars.length;r+=1)r>0&&(f+=" OR "),f+="calendar='"+e.visibleCalendars[r]+"'";h(f,[],function(n){if(t._needLoadLocalStorage){e.eventsData=[];for(r=0,i=n.rows.length;r<i;r+=1)o=t._readEventData(n.rows.item(r)),t._storeEventWithSort(o)}t._onEventsDataChanged(),t._onInitialized(),t._chromeLoadDataDeffer.resolve()},function(){p.apply(this,arguments),m&&(t._onEventsDataChanged(),t._onInitialized()),t._chromeLoadDataDeffer.resolve()})}},t.prototype._onInitialized=function(){this._ensureDisabled(),this.hideLoadingLabel(),this._trigger("initialized")},t.prototype._readEventData=function(e){var t=this._cloneObj(e);return t.start=new Date(t.start),t.end=new Date(t.end),typeof t.allday=="string"&&(t.allday==="false"&&(t.allday=!1),t.allday==="true"&&(t.allday=!0)),t.start.getTime()>=t.end.getTime()&&(t.end=this._addMinutes(t.start,this.options.timeInterval)),this._deSerializeProperties(t.properties,t),t.prevData=this._cloneObj(t),t},t.prototype._prepareEventsForView=function(){this._eventsView=this.getOccurrences()},t.prototype._cloneObj=function(e){var t={},n;for(n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t},t.prototype._onDayViewClick=function(){var e=this.options;e.viewType!=="day"&&(e.viewType="day",this._onViewTypeChanged()),e.selectedDates=[e.selectedDate],this._onSelectedDatesChanged()},t.prototype._onWeekViewClick=function(){var e=this.options,t,n,r;e.viewType!=="week"&&(e.viewType="week",this._onViewTypeChanged()),t=e.selectedDate,r=e.firstDayOfWeek-t.getDay(),Math.abs(r)>6&&(r=t.getDay()-e.firstDayOfWeek),t=this._addDays(t,r),e.selectedDates=[];for(r=0;r<7;r+=1)n=this._addDays(t,r),e.selectedDates.push(n);this._onSelectedDatesChanged()},t.prototype._onMonthViewClick=function(){var e=this.options;e.viewType!=="month"&&(e.viewType="month",this._onViewTypeChanged())},t.prototype._onListViewClick=function(){var e=this.options;e.viewType!=="list"&&(e.viewType="list",this._onViewTypeChanged()),e.selectedDates=[e.selectedDate],this._onSelectedDatesChanged()},t.prototype._ensureEditCalendarDialogCreated=function(){var e=this.options,t,r={};this._editCalendarDialog||(t=e.editCalendarTemplate,t||(t="<p><label>"+this.localizeString("labelCalendarName","Calendar name")+"</label>"+'<input type="text" class="wijmo-wijev-name" value=""> '+'<div class="wijmo-wijev-color-button">'+'<div class="wijmo-wijev-color ui-wijmo-wijev-event-color-default">&nbsp;</div>'+"</div>"+"</p>"+"<p><label>"+this.localizeString("labelLocation","Location")+"</label>"+'<input type="text" class="wijmo-wijev-location" value=""></p>'+"<p><label>"+this.localizeString("labelDescription","Description")+'</label><textarea class="wijmo-wijev-description" /></p>'),this._editCalendarDialog=n('<div class="wijmo-wijev-editcalendar-dialog">'+t+"</div>"),this.element.append(this._editCalendarDialog),r[this.localizeString("buttonSave","Save")]=n.proxy(function(){try{var e=this._validateAndReadCalendarDialogFields(this._editCalendarDialog);e.prevData?this.updateCalendar(e):this.addCalendar(e),this._editCalendarDialog.wijdialog("close")}catch(t){alert(t)}},this),this._editCalendarDialog.wijdialog({autoOpen:!0,height:340,width:440,modal:!0,title:this.localizeString("titleEditCalendar","Edit calendar"),buttons:r,captionButtons:{pin:{visible:!1},refresh:{visible:!1},toggle:{visible:!1},minimize:{visible:!1},maximize:{visible:!1}}}),this._editCalendarDialog.find(".wijmo-wijev-name, .wijmo-wijev-location, .wijmo-wijev-description").wijtextbox(),this._editCalendarDialog.find(".wijmo-wijev-color-button").button({icons:{primary:"ui-icon-triangle-1-s"}}).click(n.proxy(this._onColorButtonClick,{dlg:this._editCalendarDialog,self:this})))},t.prototype._ensureEditEventDialogCreated=function(){var e=this.options,t;this._editEventDialog||(t=this.options.editEventDialogTemplate,t||(t='<div class="wijmo-wijev-event-dialog '+this.options.wijCSS.content+" "+e.wijCSS.cornerAll+'">'+'<ul class="wijmo-wijev-brief-content">'+"<li><label>"+this.localizeString("labelName","name")+"</label>"+'<input type="text" name="subject" class="wijmo-wijev-subject" value="">'+'<div class="wijmo-wijev-color-button">'+'<div class="wijmo-wijev-color ui-wijmo-wijev-event-color-default">&nbsp;</div>'+"</div>"+"</li>"+'<li><label for="'+this._uidPref+'_alldaybtn">'+this.localizeString("labelAllDay","all-day")+"</label>"+'<input type="checkbox" class="wijmo-wijev-allday" id="'+this._uidPref+'_alldaybtn" />'+"</li>"+"<li><label>"+this.localizeString("labelStarts","Starts")+"</label>"+'<input type="text" class="wijmo-wijev-start" value="">'+'<input type="text" class="wijmo-wijev-start-time" value="">'+"</li>"+"<li><label>"+this.localizeString("labelEnds","Ends")+"</label>"+'<input type="text" class="wijmo-wijev-end" value="">'+'<input type="text" class="wijmo-wijev-end-time" value="">'+"</li>"+"</ul>"+'<ul class="wijmo-wijev-detailed-content '+e.wijCSS.cornerAll+'">'+"<li><label>"+this.localizeString("labelLocation","Location")+"</label>"+'<input type="text" class="wijmo-wijev-location" value=""></li>'+"<li><label>"+this.localizeString("labelRepeat","Repeat")+"</label>"+'<select class="wijmo-wijev-repeat">'+'<option value="none">'+this.localizeString("repeatNone","None")+"</option>"+'<option value="daily">'+this.localizeString("repeatDaily","Every Day")+"</option>"+'<option value="workdays">'+this.localizeString("repeatWorkDays","Work days")+"</option>"+'<option value="weekly">'+this.localizeString("repeatWeekly","Every Week")+"</option>"+'<option value="monthly">'+this.localizeString("repeatMonthly","Every Month")+"</option>"+'<option value="yearly">'+this.localizeString("repeatYearly","Every Year")+"</option>"+"</select></li>"+"<li><label>"+this.localizeString("labelCalendar","Calendar")+"</label>"+'<select class="wijmo-wijev-calendar"></select></li>'+'<li class="wijmo-wijev-description-item"><label>'+this.localizeString("labelDescription","Description")+"</label>"+'<textarea class="wijmo-wijev-description" /></li>'+"</ul>"+'<div class="footer">'+'<a href="#" class="wijmo-wijev-delete">'+this.localizeString("buttonDelete","Delete")+"</a>"+'<a href="#" class="wijmo-wijev-save">'+this.localizeString("buttonOK","OK")+"</a>"+'<a href="#" class="wijmo-wijev-cancel">'+this.localizeString("buttonCancel","Cancel")+"</a>"+"</div>"+'<div class="wijmo-wijev-angle"></div>'+"</div>"),this._editEventDialog=n(t),this.element.append(this._editEventDialog),this._editEventDialog.find(".wijmo-wijev-color-button").button({icons:{primary:"ui-icon-triangle-1-s"}}).click(n.proxy(this._onColorButtonClick,{dlg:this._editEventDialog,self:this})),this._editEventDialog.find(".wijmo-wijev-delete").button().click(n.proxy(function(){this.deleteEvent(this._editEventDialog.appt),this._editEventDialog.wijpopup("hide")},this)),this._editEventDialog.find(".wijmo-wijev-cancel").button().click(n.proxy(function(e){this._editEventDialog.wijpopup("hide"),e.preventDefault()},this)),this._editEventDialog.find(".wijmo-wijev-start").width(114).wijinputdate({culture:this.options.culture,titleFormat:this.localizeString("calendarTitleFormat","MMMM yyyy"),toolTipFormat:this.localizeString("calendarToolTipFormat","dddd, MMMM dd, yyyy"),nextTooltip:this.localizeString("calendarNextTooltip","Next"),prevTooltip:this.localizeString("calendarPrevTooltip","Previous"),showTrigger:!0,dateFormat:"d",dateChanged:n.proxy(function(e,t){var n=this._editEventDialog.find(".wijmo-wijev-end").wijinputdate("option","date");t.date>n&&this._editEventDialog.find(".wijmo-wijev-end").wijinputdate("option","date",t.date)},this)}),this._editEventDialog.find(".wijmo-wijev-start-time").width(80).wijinputdate({culture:this.options.culture,titleFormat:this.localizeString("calendarTitleFormat","MMMM yyyy"),toolTipFormat:this.localizeString("calendarToolTipFormat","dddd, MMMM dd, yyyy"),nextTooltip:this.localizeString("calendarNextTooltip","Next"),prevTooltip:this.localizeString("calendarPrevTooltip","Previous"),dateFormat:"t",dateChanged:n.proxy(function(e,t){var n=this._editEventDialog.find(".wijmo-wijev-end-time").wijinputdate("option","date"),r=this._editEventDialog.find(".wijmo-wijev-start").wijinputdate("option","date");t.date.getDate()!==r.getDate()&&(t.date.setDate(r.getDate()),this._editEventDialog.find(".wijmo-wijev-start-time").wijinputdate("option","date",t.date)),t.date>n&&this._editEventDialog.find(".wijmo-wijev-end-time").wijinputdate("option","date",t.date)},this)}),this._editEventDialog.find(".wijmo-wijev-end").width(114).wijinputdate({culture:this.options.culture,titleFormat:this.localizeString("calendarTitleFormat","MMMM yyyy"),toolTipFormat:this.localizeString("calendarToolTipFormat","dddd, MMMM dd, yyyy"),nextTooltip:this.localizeString("calendarNextTooltip","Next"),prevTooltip:this.localizeString("calendarPrevTooltip","Previous"),showTrigger:!0,dateFormat:"d",dateChanged:n.proxy(function(e,t){var n=this._editEventDialog.find(".wijmo-wijev-start").wijinputdate("option","date");t.date<n&&this._editEventDialog.find(".wijmo-wijev-start").wijinputdate("option","date",t.date)},this)}),this._editEventDialog.find(".wijmo-wijev-end-time").width(80).wijinputdate({culture:this.options.culture,titleFormat:this.localizeString("calendarTitleFormat","MMMM yyyy"),toolTipFormat:this.localizeString("calendarToolTipFormat","dddd, MMMM dd, yyyy"),nextTooltip:this.localizeString("calendarNextTooltip","Next"),prevTooltip:this.localizeString("calendarPrevTooltip","Previous"),dateFormat:"t"}),this._editEventDialog.find(".wijmo-wijev-allday").wijcheckbox().change(n.proxy(this._eventDialogEnsureTimePartState,this)),this._editEventDialog.find(".wijmo-wijev-subject,.wijmo-wijev-location,.wijmo-wijev-description").wijtextbox(),this._editEventDialog.find(".wijmo-wijev-save").button().click(n.proxy(function(e){try{var t=this._validateAndReadApptDialogFields(this._editEventDialog);t.prevData?this.updateEvent(t):this.addEvent(t),this._editEventDialog.wijpopup("hide")}catch(n){alert(n)}},this)),this._editEventDialog.wijpopup({autoHide:!0,hiding:n.proxy(function(e){this._colorMenu&&this._colorMenu.wijpopup("hide"),this.element.find(".wijmo-wijev-dayview .ui-selected").removeClass("ui-selected")},this),shown:n.proxy(function(e){var t=this;this._dropDownInitialized?(this._editEventDialog.find(".wijmo-wijev-calendar").wijdropdown("refresh"),this._editEventDialog.find(".wijmo-wijev-repeat").wijdropdown("refresh")):(this._editEventDialog.find(".wijmo-wijev-calendar").wijdropdown().bind("change",function(e){var n=t._calendarsById[this.value];n&&n.color?t._addColorClass(t._editEventDialog.find(".wijmo-wijev-color"),n.color):t._editEventDialog.appt&&t._editEventDialog.appt.color&&t._addColorClass(t._editEventDialog.find(".wijmo-wijev-color"),t._editEventDialog.appt.color)}),this._editEventDialog.find(".wijmo-wijev-repeat").wijdropdown().bind("change",function(e){var n=this.value,r=t._editEventDialog.appt;switch(n){case"none":r.recurrenceState=null,r.recurrencePattern=null;break;case"daily":r.recurrenceState="master",r.recurrencePattern={parentRecurrenceId:r.id,recurrenceType:"daily"};break;case"workdays":r.recurrenceState="master",r.recurrencePattern={parentRecurrenceId:r.id,recurrenceType:"workdays"};break;case"weekly":r.recurrenceState="master",r.recurrencePattern={parentRecurrenceId:r.id,recurrenceType:"weekly"};break;case"monthly":r.recurrenceState="master",r.recurrencePattern={parentRecurrenceId:r.id,recurrenceType:"monthly"};break;case"yearly":r.recurrenceState="master",r.recurrencePattern={parentRecurrenceId:r.id,recurrenceType:"yearly"};break;case"custom":alert("show custom recurrence pattern.")}}),this._dropDownInitialized=!0),this._onEditEventDialogShown(this._editEventDialog,this._editEventDialog.appt),this._editEventDialog.find(".wijmo-wijev-subject").focus(),this._updateEditEventPopupCallout()},this)}))},t.prototype._updateEditEventPopupCallout=function(){if(this._editEventDialog&&this._editEventDialog._arrowTarget){var e=this._editEventDialog,t=n(e._arrowTarget),r=t.offset(),i=e.offset(),s;r.left===i.left?e.removeClass("wijmo-wijev-rightangle").removeClass("wijmo-wijev-leftangle"):r.left<i.left?e.removeClass("wijmo-wijev-rightangle").addClass("wijmo-wijev-leftangle"):e.removeClass("wijmo-wijev-leftangle").addClass("wijmo-wijev-rightangle"),s=Math.round(r.top-i.top+t.outerHeight(!0)/2),this._editEventDialog.find(".wijmo-wijev-angle").css("top",s)}},t.prototype._onColorButtonClick=function(){var e=this.self,t=this.dlg,r,i=e.options,s=i.colors,o="";if(s&&s.length>0)for(r=0;r<s.length;r+=1)o+='<span class="wijmo-wijev-listcolor wijmo-wijev-event-color-'+s[r]+'">&nbsp;</span>';e._colorMenu||(e._colorMenu=n('<div class="wijmo-wijev-color-menu '+i.wijCSS.content+" "+i.wijCSS.cornerAll+'"></div>'),t.append(e._colorMenu),e._colorMenu.wijpopup({autoHide:!0})),e._colorMenu.html(o),e._colorMenu.find(".wijmo-wijev-listcolor").click(n.proxy(function(r){this._addColorClass(t.find(".wijmo-wijev-color"),this._readColorFromClass(n(r.target),"default")),e._colorMenu.wijpopup("hide")},e)),e._colorMenu.wijpopup("show",{of:t.find(".wijmo-wijev-color-button"),my:"left top",at:"left bottom"})},t.prototype._validateAndReadCalendarDialogFields=function(e){var t=e.cal||{};t.name=e.find(".wijmo-wijev-name").val(),t.location=e.find(".wijmo-wijev-location").val(),t.description=e.find(".wijmo-wijev-description").val(),t.color=this._readColorFromClass(e.find(".wijmo-wijev-color"),t.color||"default");if(!t.name)throw"Calendar name can not be empty";return t},t.prototype._validateAndReadApptDialogFields=function(e){var t=e.appt,n,r,s,o,u;n=i(e.find(".wijmo-wijev-start").wijinputdate("option","date")),r=i(e.find(".wijmo-wijev-end").wijinputdate("option","date")),s=e.find(".wijmo-wijev-start-time").wijinputdate("option","date"),o=e.find(".wijmo-wijev-end-time").wijinputdate("option","date");var a=(s.getHours()*60+s.getMinutes())*60+s.getSeconds(),f=(o.getHours()*60+o.getMinutes())*60+o.getSeconds();if(n.getTime()===r.getTime()&&a>f)throw this.localizeString("messageEndOccursBeforeStart","The end date you entered occurs before the start date.");return t.subject=e.find(".wijmo-wijev-subject").val(),t.location=e.find(".wijmo-wijev-location").val(),t.start=n,t.end=r,e.find(".wijmo-wijev-allday").length>0&&(t.allday=e.find(".wijmo-wijev-allday")[0].checked),t.allday?t.start.getTime()>=t.end.getTime()&&(t.end=this._addMinutes(t.start,this.options.timeInterval)):(t.start=new Date(t.start.getFullYear(),t.start.getMonth(),t.start.getDate(),s.getHours(),s.getMinutes(),s.getSeconds()),t.end=new Date(t.end.getFullYear(),t.end.getMonth(),t.end.getDate(),o.getHours(),o.getMinutes(),o.getSeconds())),t.calendar=e.find(".wijmo-wijev-calendar").val(),t.description=e.find(".wijmo-wijev-description").val(),t.color=this._readColorFromClass(e.find(".wijmo-wijev-color"),t.color),u=t.recurrencePattern,u&&t.recurrenceState==="master"&&(u.startTime=t.start,u.endTime=t.end,u.patternStartDate=t.start),t},t.prototype._bindApptToDialog=function(e){if(!e)return;var t=this._editEventDialog,n,r;t.appt=e,t.find(".wijmo-wijev-subject").val(e.subject||""),t.find(".wijmo-wijev-location").val(e.location||"");try{t.find(".wijmo-wijev-start").wijinputdate("option","date",e.start),t.find(".wijmo-wijev-start-time").wijinputdate("option","date",e.start),t.find(".wijmo-wijev-end").wijinputdate("option","date",e.end),t.find(".wijmo-wijev-end-time").wijinputdate("option","date",e.end)}catch(i){alert("[e0001a] wijinputdate/wijtextselection firefox error\n"+i)}t.find(".wijmo-wijev-allday").length>0&&(t.find(".wijmo-wijev-allday")[0].checked=e.allday),t.find(".wijmo-wijev-allday").wijcheckbox("refresh"),this._fillCalendarsSelect(t.find(".wijmo-wijev-calendar"),e.calendar),this._loadRepeatValue(e,t.find(".wijmo-wijev-repeat")),t.find(".wijmo-wijev-description").val(e.description||""),e.prevData?t.find(".wijmo-wijev-delete").show():t.find(".wijmo-wijev-delete").hide(),t.find(".wijmo-wijev-calendar").length>0&&(n=this._calendarsById[t.find(".wijmo-wijev-calendar")[0].value]),r=e.color,!r&&n&&n.color&&(r=n.color),this._addColorClass(t.find(".wijmo-wijev-color"),r),this._eventDialogEnsureTimePartState()},t.prototype._onEditEventDialogShown=function(e,t){t.recurrenceState==="exception"?e.find(".wijmo-wijev-repeat").wijdropdown("option","disabled",!0):e.find(".wijmo-wijev-repeat").wijdropdown("option","disabled",!1)},t.prototype._eventDialogEnsureTimePartState=function(){var e=this._editEventDialog;e.find(".wijmo-wijev-allday").length>0&&(e.find(".wijmo-wijev-allday")[0].checked?(e.find(".wijmo-wijev-start-time").wijinputdate("option","disabled",!0),e.find(".wijmo-wijev-end-time").wijinputdate("option","disabled",!0)):(e.find(".wijmo-wijev-start-time").wijinputdate("option","disabled",!1),e.find(".wijmo-wijev-end-time").wijinputdate("option","disabled",!1)))},t.prototype._loadRepeatValue=function(e,t){var n="none";if(e.recurrencePattern)switch(e.recurrencePattern.recurrenceType){case"daily":n="daily";break;case"workdays":n="workdays";break;case"weekly":n="weekly";break;case"monthly":n="monthly";break;case"yearly":n="yearly";break;default:n="custom"}t.val(n)},t.prototype._addColorClass=function(e,t){var n,r=new RegExp("wijmo-wijev-event-color-(\\w+)\\s*");e.length>0&&(n=e[0].className,e[0].className=n.replace(r,""),e.addClass("wijmo-wijev-event-color-"+(t||"default")))},t.prototype._readColorFromClass=function(e,t){var n=new RegExp("wijmo-wijev-event-color-(\\w+)\\s*"),r;if(e.length>0){r=n.exec(e[0].className);if(r&&r.length>1)return r[1]}return t},t.prototype._fillCalendarsSelect=function(e,t){var n="",r=this.options,i,s,o,u=r.calendars.slice(0),a=r.visibleCalendars;if(a&&a.length>0)for(i=0;i<a.length;i+=1){o=!1;for(s=0;s<u.length;s+=1)u[s].name===a[i]&&(o=!0);o||u.push({id:a[i],name:a[i]})}if(u.length===0){e.html("");return}for(i=0;i<u.length;i+=1)n+='<option value="'+u[i].id+'">'+u[i].name+"</option>";e.html(n).val(t)},t.prototype._bindCalendarToDialog=function(e){if(!e)return;var t=this._editCalendarDialog;t.cal=e,t.find(".wijmo-wijev-name").val(e.name||""),t.find(".wijmo-wijev-location").val(e.location||""),t.find(".wijmo-wijev-description").val(e.description||""),this._addColorClass(t.find(".wijmo-wijev-color"),e.color)},t.prototype._onTodayClick=function(){return this.goToday(),!1},t.prototype._bindEvents=function(){this._eventsAttached||(n(this.element).on("click."+this.wijevcalnamespacekey,".wijmo-wijev-appointment",n.proxy(this._onAppointmentClick,this)),n(this.element).on("mousedown."+this.wijevcalnamespacekey,".wijmo-wijev-dayview .wijmo-wijev-appointment",n.proxy(this._onDayViewAppointmentMouseDown,this)),n(this.element).on("mousedown."+this.wijevcalnamespacekey,".wijmo-wijev-monthview .wijmo-wijev-appointment",n.proxy(this._onMonthViewAppointmentMouseDown,this)),n(this.element).on("click."+this.wijevcalnamespacekey,".wijmo-wijev-dayview .wijmo-wijev-timeinterval",n.proxy(this._onDayViewTimeIntervalClick,this)),n(this.element).on("click."+this.wijevcalnamespacekey,".wijmo-wijev-dayview .wijmo-wijev-allday-cell",n.proxy(this._onDayViewAllDayCellClick,this)),n(this.element).on("click."+this.wijevcalnamespacekey,".wijmo-wijev-monthview .wijmo-wijev-monthcellheader",n.proxy(this._onMonthViewDayLabelClick,this)),n(this.element).on("click."+this.wijevcalnamespacekey,".wijmo-wijev-monthview .wijmo-wijev-monthcell-showmore",n.proxy(this._onMonthViewDayLabelClick,this)),n(this.element).on("click."+this.wijevcalnamespacekey,".wijmo-wijev-weekview .wijmo-wijev-daylabel",n.proxy(this._onMonthViewDayLabelClick,this)),n(this.element).on("click."+this.wijevcalnamespacekey,".wijmo-wijev-monthview .wijmo-wijev-monthcell",n.proxy(this._onMonthViewCellClick,this)),this._eventsAttached=!0)},t.prototype._unbindEvents=function(){this._eventsAttached&&(n(this.element).off("mousedown."+this.wijevcalnamespacekey),n(this.element).off("click."+this.wijevcalnamespacekey),this._eventsAttached=!1)},t.prototype.destroy=function(){this._destroyInternal(),n.wijmo.widget.prototype.destroy.apply(this,arguments)},t.prototype._destroyInternal=function(){var e=this.options;this.element.removeClass("wijmo-wijev wijmo-wijevcal "+e.wijCSS.widget+" ui-helper-reset"),n(window).unbind("resize."+this.wijevcalnamespacekey),this._unbindEvents(),this.element.empty(),this.wijevcalnamespacekey=null,this._uidPref=null,this._isUpdating=null,this._resolveDayApptConflictsTimeout=null,this._pendingRedrawActiveView=null,this._listViewDetailsInit=null,this._dayViewDetailsInit=null,this._eventsAttached=null,this.statusbarEventsAdded=null,this._dataView=null,this._eventsView=null,this._eventsDataById=null,this._calendarsById=null,this._dayViewCache=null,this._templateDayColumn=null,this._templateDayHeader=null,this._dayViewScrollToEvent=null,this._maxAllDayEventCount=null,this._dayColumnsToResolve=null,this._dayColumnResolveIdx=null,this.logDialog=null,this.logPanel=null,this._editCalendarDialog=null,this._editEventDialog=null,this._renderAgendaEventsTimeoutId=null,this.__targetAppt=null,this._isApptResize=null,this.__startApptH=null,this.__startApptY=null,this.__startClientY=null,this._apptDragResizeFlag=null,this._apptMovedFlag=null,this._movedFromTimeInervalApptElem=null,this.__targetApptChanged=null,this._defferObjs=null,this._setOptionCallbacks=null,this._chromeLoadDataDeffer=null,n.wijmo.wijevcal.prototype.options.eventsData=[]},t.prototype.deleteCalendar=function(e,t,r){var i,s=this.options.calendars,o=e.id||e,u=!1,a,f,l,c=this;for(i=0;i<s.length;i+=1)if(s[i].id===o){u=!0,e=s[i];if(!this._trigger("beforeDeleteCalendar",null,{data:e}))return!1;delete this._calendarsById[e.id],s.splice(i,1);break}if(!u)for(i=0;i<s.length;i+=1)if(s[i].name===o){u=!0,e=s[i];if(!this._trigger("beforeDeleteCalendar",null,{data:e}))return!1;delete this._calendarsById[e.id],s.splice(i,1);break}if(!u)return this.status("Calendar with id/name '"+o+"' not found."),!1;this.showLoadingLabel(this.localizeString("activityDeletingCalendar","Deleting calendar...")),a=function(n){c.status("Calendar '"+e.name+"' deleted."),c._onCalendarsChanged(),c.hideLoadingLabel(),t&&t(n)},f=function(t){c.status("Unable to delete calendar '"+e.name+"': "+t),c.hideLoadingLabel(),r&&r(t)};if(this.options.dataStorage.deleteCalendar)this.options.dataStorage.deleteCalendar(e,a,f);else if(this.options.webServiceUrl){try{l=this._jsonStringify(e)}catch(p){this.status("Unable to prepare calendar data for server. "+p,"error"),f("Unable to prepare calendar data for server. "+p);return}n.ajax({url:this.options.webServiceUrl+"?clientId="+this.element[0].id+"&command=deleteCalendar&timestamp="+(new Date).getTime(),dataType:"text",contentType:"application/json; charset=utf-8",type:"POST",data:"jsonData="+l,success:a,error:f})}else h("DELETE FROM calendars WHERE id='"+e.id+"'",[],a,f)},t.prototype.addCalendar=function(e,t,r){var i,s,o,u=this,a=!1;if(!this._trigger("beforeAddCalendar",null,{data:e,prevData:e.prevData||{}})){if(e.prevData)for(s in e.prevData)e.prevData.hasOwnProperty(s)&&(e[s]=e.prevData[s]);return!1}e.id||(this._dynIdCounter||(this._dynIdCounter=0),this._dynIdCounter+=1,e.id="dynid"+this._dynIdCounter+"ts"+(new Date).getTime()),n.each(u.options.calendars,function(t,n){if(e.name===n.name)return a=!0,!1});if(a)return;this.showLoadingLabel(this.localizeString("activityCreatingCalendar","Creating calendar...")),i=function(n){if(u._handleServerError(n)){o(n);return}u._readUpdatedServerDataIfAny(n,e),u._calendarsById[e.id]?u.status("Calendar '"+e.name+"' added."):(u.options.calendars.push(e),u._calendarsById[e.id]=e,u.status("Calendar '"+e.name+"' added.")),e.prevData=u._cloneObj(e),u._onCalendarsChanged(),u.hideLoadingLabel(),t&&t(n)},o=function(t){u.status("Unable to add calendar '"+e.name+"': "+t),u.hideLoadingLabel(),r&&r(t)};if(this.options.dataStorage.addCalendar)this.options.dataStorage.addCalendar(e,i,o);else if(this.options.webServiceUrl){try{s=this._jsonStringify(e)}catch(f){this.status("Unable prepare calendar data for server."+f,"error"),o("Unable to prepare calendar data for server."+f);return}n.ajax({url:this.options.webServiceUrl+"?clientId="+this.element[0].id+"&command=addCalendar&timestamp="+(new Date).getTime(),dataType:"text",contentType:"application/json; charset=utf-8",type:"POST",data:"jsonData="+s,success:i,error:o})}else h("INSERT OR REPLACE INTO calendars (id, name, location, description, color, tag) VALUES(?,?,?,?,?,?);",[e.id,e.name,e.location,e.description,e.color,e.tag],i,o)},t.prototype.updateCalendar=function(e,t,r){var i,s,o,u=this;if(!this._trigger("beforeUpdateCalendar",null,{data:e,prevData:e.prevData||{}})){if(e.prevData)for(s in e.prevData)e.prevData.hasOwnProperty(s)&&(e[s]=e.prevData[s]);return!1}e.id||(this._dynIdCounter||(this._dynIdCounter=0),this._dynIdCounter+=1,e.id="dynid"+this._dynIdCounter+"ts"+(new Date).getTime()),this.showLoadingLabel(this.localizeString("activityUpdatingCalendar","Updating calendar...")),i=function(r){var i=!1,s=u.options.visibleCalendars;if(u._handleServerError(r)){o(r);return}u._readUpdatedServerDataIfAny(r,e),u._calendarsById[e.id]?(n.each(s,function(t,n){if(n===e.prevData.name)return s[t]=e.name,!1}),u.status("Calendar '"+e.name+"' updated.")):(n.each(u.options.calendars,function(t,n){if(e.name===n.name)return i=!0,!1}),i||(u.options.calendars.push(e),u._calendarsById[e.id]=e,u.status("Calendar '"+e.name+"' added."))),e.prevData=u._cloneObj(e),u._onCalendarsChanged(),u.hideLoadingLabel(),t&&t(r)},o=function(t){u.status("Unable to update calendar '"+e.name+"': "+t),u.hideLoadingLabel(),r&&r(t)};if(this.options.dataStorage.updateCalendar)this.options.dataStorage.updateCalendar(e,i,o);else if(this.options.webServiceUrl){try{s=this._jsonStringify(e)}catch(a){this.status("Unable prepare calendar data for server. "+a,"error"),o("Unable to prepare calendar data for server. "+a);return}n.ajax({url:this.options.webServiceUrl+"?clientId="+this.element[0].id+"&command=updateCalendar&timestamp="+(new Date).getTime(),dataType:"text",contentType:"application/json; charset=utf-8",type:"POST",data:"jsonData="+s,success:i,error:o})}else h("INSERT OR REPLACE INTO calendars (id, name, location, description, color, tag) VALUES(?,?,?,?,?,?);",[e.id,e.name,e.location,e.description,e.color,e.tag],i,o)},t.prototype._initEventData=function(e){return n.extend({allday:!1,location:null,subject:null,description:null,color:null,tag:null},e)},t.prototype.addEvent=function(e,t,r){var i,o,u,a=this;if(!this._trigger("beforeAddEvent",null,{data:e,prevData:e.prevData||{}})){if(e.prevData)for(u in e.prevData)e.prevData.hasOwnProperty(u)&&(e[u]=e.prevData[u]);return!1}e.id||(this._dynIdCounter||(this._dynIdCounter=0),this._dynIdCounter+=1,e.id=s()),e.calendar||(e.calendar="Default"),this.showLoadingLabel(this.localizeString("activityCreatingEvent","Creating event...")),o=function(t){a.hideLoadingLabel(),a.status("Unable to add event '"+e.subject+"': "+t,"error");if(e.prevData)for(u in e.prevData)e.prevData.hasOwnProperty(u)&&(e[u]=e.prevData[u]);r&&r(t)},i=function(n){if(a._handleServerError(n)){o(n);return}a._readUpdatedServerDataIfAny(n,e),!a._eventsDataById[e.id]||e.recurrenceState==="exception"?(a._storeEventWithSort(e),a.status("Event '"+e.subject+"' added.")):a.status("Event '"+e.subject+"' added."),e.prevData=a._cloneObj(e),a._onEventsDataChanged(),a.hideLoadingLabel(),t&&t(n)};if(this.options.dataStorage.addEvent)this.options.dataStorage.addEvent(e,i,o);else if(this.options.webServiceUrl){try{u=this._jsonStringify(e)}catch(l){this.status("Unable prepare event data for server. "+l,"error"),o("Unable to prepare event data for server. "+l);return}n.ajax({url:this.options.webServiceUrl+"?clientId="+this.element[0].id+"&command=addEvent&timestamp="+(new Date).getTime(),dataType:"text",contentType:"application/json; charset=utf-8",type:"POST",data:"jsonData="+u,success:i,error:o})}else{e=a._initEventData(e);if(!f&&!window.openDatabase){i.call(this,{rowsAffected:0,rows:[e]});return}h("INSERT OR REPLACE INTO events (id, calendar, subject, location, start, end, description, color, allday, properties, tag) VALUES(?,?,?,?,?,?,?,?,?,?,?);",[e.id,e.calendar,e.subject,e.location,e.start.getTime(),e.end.getTime(),e.description,e.color,e.allday,this._serializeProperties(e),e.tag],i,o)}},t.prototype._storeEventWithSort=function(e){var t=this.options.eventsData,n,r;this._eventsDataById[e.id]=e;for(n=0,r=t.length;n<r;n+=1){if(t[n].start>e.start){t.splice(n,0,e);return}if(t[n].start.getTime()===e.start.getTime()&&t[n].subject>e.subject){t.splice(n,0,e);return}}t.push(e)},t.prototype._readUpdatedServerDataIfAny=function(e,t){var n=null,r;if(typeof e=="string"&&e.indexOf("update:")===0){e=e.toString().substr("update:".length);try{n=this._jsonParse(e)}catch(i){this.status("Unable to read updated server data. "+i,"warning")}if(n)for(r in n)n[r]&&(t[r]=n[r])}},t.prototype.updateEvent=function(e,t,r){var i,s,o,u=this;if(!this._trigger("beforeUpdateEvent",null,{data:e,prevData:e.prevData||{}})){if(e.prevData)for(o in e.prevData)e.prevData.hasOwnProperty(o)&&(e[o]=e.prevData[o]);return this._updateAppointmentVisual(e),!1}e.calendar||(e.calendar="Default"),this.showLoadingLabel(this.localizeString("activityUpdatingEvent","Updating event...")),s=function(t){u.hideLoadingLabel(),u.status("Unable to update event '"+e.subject+"': "+t,"error");if(e.prevData)for(o in e.prevData)e.prevData.hasOwnProperty(o)&&(e[o]=e.prevData[o]);u._updateAppointmentVisual(e),r&&r(t)};if(!e.id){s("id is empty");return}if(e.recurrenceState==="exception"||e.recurrenceState==="occurrence"){if(!this._eventsDataById[e.parentRecurrenceId]){s("Unable to find master event for event with id:"+e.id);return}if(e.recurrenceState==="occurrence")return this.log(this._formatString("[updateEvent->addEvent] recurrenceState for event {0} changed to 'exception'.",e.id)),e.recurrenceState="exception",this.addEvent(e,t,r)}i=function(r){if(u._handleServerError(r)){s(r);return}u._readUpdatedServerDataIfAny(r,e),u._eventsDataById[e.id]?(n.extend(u._eventsDataById[e.id],e),u.status("Event '"+e.subject+"' updated.")):(u._storeEventWithSort(e),u.status("Event '"+e.subject+"' added.")),e.prevData=u._cloneObj(e),u._onEventsDataChanged(),u.hideLoadingLabel(),t&&t(r)};if(this.options.dataStorage.updateEvent)this.options.dataStorage.updateEvent(e,i,s);else if(this.options.webServiceUrl){try{o=this._jsonStringify(e)}catch(a){this.status("Unable prepare event data for server. "+a,"error"),s("Unable to prepare event data for server. "+a);return}n.ajax({url:this.options.webServiceUrl+"?clientId="+this.element[0].id+"&command=updateEvent&timestamp="+(new Date).getTime(),dataType:"text",contentType:"application/json; charset=utf-8",type:"POST",data:"jsonData="+o,success:i,error:s})}else{e=u._initEventData(e);if(!f&&!window.openDatabase){i.call(this,{rowsAffected:0,rows:[e]});return}h("INSERT OR REPLACE INTO events (id, calendar, subject, location, start, end, description, color, allday, properties, tag) VALUES(?,?,?,?,?,?,?,?,?,?,?);",[e.id,e.calendar,e.subject,e.location,e.start.getTime(),e.end.getTime(),e.description,e.color,e.allday,this._serializeProperties(e),e.tag],i,s)}},t.prototype._serializeProperties=function(e){var t="",n={};n.parentRecurrenceId=e.parentRecurrenceId,n.recurrenceState=e.recurrenceState,n.recurrencePattern=e.recurrencePattern,n.color=e.color,n.allday=e.allday;try{t=this._jsonStringify(n)}catch(r){this.status("Unable save additional event properties. "+r,"error")}return t},t.prototype._deSerializeProperties=function(e,t){var n={},r;if(e){if(typeof e=="string")try{n=this._jsonParse(e)}catch(i){this.status("Unable to load additional event properties. "+i,"error");return}else n=e;n.parentRecurrenceId&&(t.parentRecurrenceId=n.parentRecurrenceId),n.recurrenceState&&(t.recurrenceState=n.recurrenceState),n.recurrencePattern&&(t.recurrencePattern=n.recurrencePattern),n.color&&(t.color=n.color),n.allday&&(t.allday=n.allday)}t&&t.recurrencePattern&&(r=t.recurrencePattern,r.patternStartDate=r.patternStartDate?new Date(r.patternStartDate):r.patternStartDate,r.startTime=r.startTime?new Date(r.startTime):r.startTime,r.endTime=r.endTime?new Date(r.endTime):r.endTime,r.startTime.getTime()>=r.endTime.getTime()&&(r.endTime=this._addMinutes(r.startTime,this.options.timeInterval)))},t.prototype._jsonStringify=function(e){var t;if(window.__JSONC1)t=window.__JSONC1.stringify(e);else{if(!window.JSON)throw"JSON not found.";t=JSON.stringify(e)}return t},t.prototype._jsonParse=function(e){var t,n,r;if(window.__JSONC1)t=window.__JSONC1.parse(e);else{if(!window.JSON)throw"JSON variable not found.";n=/^(\d{4})-(\d{2})-(\d{2})T(\d{2}):(\d{2}):(\d{2}(?:\.\d*)?)Z$/,r=/^\/Date\((d|-|.*)\)\/$/,t=window.JSON.parse(e,function(e,t){if(typeof t=="string"){var i=n.exec(t),s;if(i)return new Date(Date.UTC(+i[1],+i[2]-1,+i[3],+i[4],+i[5],+i[6]));i=r.exec(t);if(i)return s=i[1].split(/[-,.]/),new Date(+s[0])}return t})}return t},t.prototype.getOccurrences=function(e,t){var n=this.options,r=n.eventsData,i,s,o,u,a,f,l,c,h=100,p,d,v,m=[],g=[],y=[],b={};this._eventsDataById||(this._eventsDataById={});for(a=0,l=r.length;a<l;a+=1){i=r[a],this._eventsDataById[i.id]=i;if(i.recurrenceState==="master"){u=i.recurrencePattern,u.removedOccurrences&&(y=y.concat(u.removedOccurrences)),c=u.occurrences||h,p=u.patternStartDate||i.start,d=u.startTime||i.start,v=u.endTime||i.end;switch(u.recurrenceType){case"daily":for(f=0;f<c;f+=1)s=this._cloneObj(i),s.parentRecurrenceId=i.id,s.recurrenceState="occurrence",s.start=this._setTime(this._addDays(p,f),d),s.end=this._setTime(s.start,v,d),s.recurrencePattern=null,this._testIsEventInTimeInterval(s,e,t)&&(s.id=this._formatString("{0}_OCCR_{1:yyyy_MM_dd}",i.id,s.start),b[s.id]=s);break;case"workdays":for(f=0;f<c;f+=1){s=this._cloneObj(i),s.parentRecurrenceId=i.id,s.recurrenceState="occurrence",s.start=this._setTime(this._addDays(p,f),d);if(s.start.getDay()===0||s.start.getDay()===6)continue;s.end=this._setTime(s.start,v,d),s.recurrencePattern=null,this._testIsEventInTimeInterval(s,e,t)&&(s.id=this._formatString("{0}_OCCR_{1:yyyy_MM_dd}",i.id,s.start),b[s.id]=s)}break;case"weekly":for(f=0;f<c;f+=1)s=this._cloneObj(i),s.parentRecurrenceId=i.id,s.recurrenceState="occurrence",s.start=this._setTime(this._addDays(p,f*7),d),s.end=this._setTime(s.start,v,d),s.recurrencePattern=null,this._testIsEventInTimeInterval(s,e,t)&&(s.id=this._formatString("{0}_OCCR_{1:yyyy_MM_dd}",i.id,s.start),b[s.id]=s);break;case"monthly":for(f=0;f<c;f+=1)s=this._cloneObj(i),s.parentRecurrenceId=i.id,s.recurrenceState="occurrence",s.start=this._setTime(new Date(p),d),s.start.setMonth(s.start.getMonth()+f),s.end=this._setTime(s.start,v,d),s.recurrencePattern=null,this._testIsEventInTimeInterval(s,e,t)&&(s.id=this._formatString("{0}_OCCR_{1:yyyy_MM_dd}",i.id,s.start),b[s.id]=s);break;case"yearly":for(f=0;f<c;f+=1)s=this._cloneObj(i),s.parentRecurrenceId=i.id,s.recurrenceState="occurrence",s.start=this._setTime(new Date(p),d),s.start.setYear(s.start.getFullYear()+f),s.end=this._setTime(s.start,v,d),s.recurrencePattern=null,this._testIsEventInTimeInterval(s,e,t)&&(s.id=this._formatString("{0}_OCCR_{1:yyyy_MM_dd}",i.id,s.start),b[s.id]=s);break;case"monthlyNth":break;case"yearlyNth":}}else this._testIsEventInTimeInterval(i,e,t)&&(i.recurrenceState==="exception"?g.push(i):i.recurrenceState==="removed"?(y.push(i.id),this.log("[warning] Seems we found removed event inside events storage, id:"+i.id)):m.push(i))}for(a=0,l=g.length;a<l;a+=1)o=g[a],b[o.id]&&delete b[o.id],m.push(o),this._eventsDataById[o.id]=o;for(a=0,l=y.length;a<l;a+=1)b[y[a]]&&delete b[y[a]];for(a in b)s=b[a],m.push(s),this._eventsDataById[s.id]=s;return m},t.prototype._testIsEventInTimeInterval=function(e,t,n){return!t||!n?!0:e.start<n&&e.end>t?!0:!1},t.prototype.deleteEvent=function(e,t,r){e.id&&(e=e.id);var i=this._eventsDataById[e],s,o,u,a,l=this,c,p;if(!this._trigger("beforeDeleteEvent",null,{data:i}))return!1;this.showLoadingLabel(this.localizeString("activityDeletingEvent","Deleting event...")),a=function(e){l.status("Unable to delete event '"+(i?i.subject:"undefined")+"': "+e),l.hideLoadingLabel(),r&&r(e)};if(i.recurrenceState==="exception"||i.recurrenceState==="occurrence"){p=this._eventsDataById[i.parentRecurrenceId];if(p){this.log(this._formatString("[deleteEvent] removing {0} with id {1}. Updating master event with id {2}",i.recurrenceState,i.id,p.id)),p.recurrencePattern.removedOccurrences||(p.recurrencePattern.removedOccurrences=[]),p.recurrencePattern.removedOccurrences.push(i.id),this.updateEvent(p,t,r);if(i.recurrenceState==="occurrence"){this.log("No need to delete occurrence from store. Master event should be updated.");return}}else if(i.recurrenceState!=="exception")return a("Unable to find master event with id "+i.parentRecurrenceId),!1}i.recurrenceState==="master",u=function(n){if(l._handleServerError(n)){a(n);return}if(l._eventsDataById[i.id]){o=l.options.eventsData;for(s=0;s<o.length;s+=1)o[s].id===e&&o.splice(s,1);delete l._eventsDataById[i.id],l.status("Event '"+i.subject+"' deleted.")}else l.status("Event '"+i.subject+"' deleted.");i.prevData=l._cloneObj(i),l._onEventsDataChanged(),l.hideLoadingLabel(),t&&t(n)};if(this.options.dataStorage.deleteEvent)this.options.dataStorage.deleteEvent(i,u,a);else if(this.options.webServiceUrl){try{c=this._jsonStringify(i)}catch(d){this.status("Unable prepare event data for server. "+d,"error"),a("Unable prepare event data for server. "+d);return}n.ajax({url:this.options.webServiceUrl+"?clientId="+this.element[0].id+"&command=deleteEvent&timestamp="+(new Date).getTime(),dataType:"text",contentType:"application/json; charset=utf-8",type:"POST",data:"jsonData="+c,success:u,error:a})}else{if(!f&&!window.openDatabase){u.call(this,{rowsAffected:0,rows:[i]});return}h("DELETE FROM events WHERE id='"+e+"'",[],u,a)}},t.prototype.beginUpdate=function(){this._isUpdating=!0,this.showLoadingLabel("Updating...")},t.prototype.endUpdate=function(){this._isUpdating=!1,this._pendingRedrawActiveView&&this._redrawActiveView(),this.hideLoadingLabel()},t.prototype.goToEvent=function(e){e.id&&(e=e.id);var t=this.options,n,r=this.findEventById(e);switch(t.viewType){case"day":case"week":case"list":n=this.element.find(".wijmo-wijev-dayview .wijmo-wijev-daycolumn ."+this._eventIdToCssClass(e)),n.length>0?this.element.find(".wijmo-wijev-scrollpanel").wijsuperpanel("scrollChildIntoView",n):(this._dayViewScrollToEvent=r,this.goToDate(r.start));break;case"month":this.goToDate(r.start)}},t.prototype.isAllDayEvent=function(e){var t=e;return e.id||(t=this.findEventById(e)),t.allday?(t.end.getTime()-t.start.getTime())/864e5>=1?!0:!0:!1},t.prototype.goToDate=function(e){e=i(e);var t=this.options,n=e.getDay(),r,s,o,u,a,f=t.selectedDates;if(f&&f.length>0){if(this._isContainsDayDate(f,e))return;a=f[0],o=Date.UTC(e.getFullYear(),e.getMonth(),e.getDate()),u=Date.UTC(a.getFullYear(),a.getMonth(),a.getDate()),s=(o-u)/864e5;if(t.viewType==="week")for(r=0;r<f.length;r+=1)if(f[r].getDay()===n){s-=r;break}for(r=0;r<f.length;r+=1)f[r]=this._addDays(f[r],s);this._onSelectedDatesChanged()}else t.selectedDates=[e],this._onSelectedDatesChanged()},t.prototype.goToTime=function(e){var t=this.element.find(".wijmo-wijev-daycolumn .wijmo-wijev-timeinterval:first-child"),n=this.element.find(".wijmo-wijev-daycolumn .wijmo-wijev-timeinterval:last-child"),r=t.position().top,i=n.position().top+n.height(),s,o,u;u=86400,o=e.getHours()*60*60+e.getMinutes()*60,s=(i-r)*o/u+r,this.element.find(".wijmo-wijev-scrollpanel").wijsuperpanel("vScrollTo",s)},t.prototype.goToday=function(){this.goToDate(new Date)},t.prototype.goLeft=function(){var e,t=this.options,n=t.viewType,r=t.selectedDates;n==="month"?this.goToDate(this._addMonths(r[0],-1)):(e=-7,r.length===1&&(e=-1),this.goToDate(this._addDays(r[0],e)))},t.prototype.goRight=function(){var e,t=this.options,n=t.viewType,r=t.selectedDates;n==="month"?this.goToDate(this._addMonths(r[0],1)):(e=7,r.length===1&&(e=1),this.goToDate(this._addDays(r[0],e)))},t.prototype.refresh=function(){this.invalidate()},t.prototype.invalidate=function(){var e=this.options;switch(e.viewType.toLowerCase()){case"list":case"day":case"week":this._invalidateDayView();break;case"month":this._invalidateMonthView();break;default:}},t.prototype.showEditCalendarDialog=function(e){var t=this.options,n=t.calendars,r;if(!e)e={name:"",description:"",location:"",color:""};else if(!e.name)for(r=0;r<n.length;r+=1)if(n[r].name===e){e=n[r];break}this._ensureEditCalendarDialogCreated(),this._bindCalendarToDialog(e),this._editCalendarDialog.wijdialog("open")},t.prototype.showEditEventDialog=function(e,t,r){var i=this.options,s,o,u,a=t?n(t):r?n(r.target):null;this._ensureEditEventDialogCreated(),this.element.find(".wijmo-wijev-dayview .ui-selected").removeClass("ui-selected"),a&&a.hasClass("wijmo-wijev-daylabel")&&(a=a.parent(".wijmo-wijev-allday-cell")),e?(this._editEventDialog._arrowTarget=a,e.recurrenceState==="occurrence"&&(s=this._eventsDataById[e.parentRecurrenceId],window.confirm(this._formatString(this.localizeString("promptOpenOccurrenceFormat","{2}  is recurring event. Do you want to open only this occurrence?"),e.start,e.end,e.subject,e.location))||(e=s))):(e={subject:this.localizeString("textNewEvent","New event")},e.isNewEvent=!0,a&&a.length>0?(this._editEventDialog._arrowTarget=a,a.addClass("ui-selected"),o=a.parent(".wijmo-wijev-daycolumn"),o.length<1&&(o=a.parent(".wijmo-wijev-dayheadercolumn")),o=o[0],a.hasClass("wijmo-wijev-allday-cell")?e.allday=!0:a.hasClass("wijmo-wijev-monthcellcontainer")?(o=a[0],e.allday=!0):e.allday=!1,o&&(u=this._parseDateFromClass(o.className,e.allday?null:a[0].className),e.start=u,e.allday?e.end=this._addMinutes(e.start,1440):e.end=this._addMinutes(e.start,i.timeInterval))):(e.start=new Date(i.selectedDates[0]),e.end=this._addMinutes(e.start,i.timeInterval))),this._trigger("beforeEditEventDialogShow",null,{data:e,targetCell:a})&&(this._bindApptToDialog(e),this._editEventDialog.wijpopup("show",{of:a,my:"left center",at:"right center",offset:(a&&r?Math.round(r.offsetX-a.width()):10)+" 0",collision:"fit"}))},t.prototype._renderActiveView=function(){var e=this.options,t=this.element.find(".wijmo-wijev-headerbar .wijmo-wijev-tools");this.element.find(".wijmo-wijev-view").hide(),this.element.find(".wijmo-wijev-viewdetails").hide(),this.element.find(".wijmo-wijev-"+e.viewType.toLowerCase()+"-details").show();switch(e.viewType.toLowerCase()){case"day":case"week":case"list":this.element.find(".wijmo-wijev-view.wijmo-wijev-dayview").show(),this._renderDayView();break;case"month":this.element.find(".wijmo-wijev-view.wijmo-wijev-monthview").show(),this._renderMonthView();break;default:}t.find(".wijmo-wijev-"+e.viewType.toLowerCase())[0].checked=!0,n().buttonset&&t.buttonset("refresh")},t.prototype._redrawActiveView=function(){if(this._isUpdating){this._pendingRedrawActiveView=!0;return}switch(this.options.viewType.toLowerCase()){case"day":case"week":case"list":this._clearDayViewCache(),this._templateDayColumn=null}this._renderActiveView()},t.prototype._getDayColumnDates=function(e){var t=this.options,n=t.selectedDates,r,i,s;n||(n=[new Date]);if(t.viewType==="week"){r=t.selectedDate||n[0],s=t.firstDayOfWeek-r.getDay(),Math.abs(s)>6&&(s=r.getDay()-t.firstDayOfWeek),r=this._addDays(r,s),n=[];for(s=0;s<7;s+=1)i=this._addDays(r,s),n.push(i)}return e&&(t.selectedDates=n),n},t.prototype._renderDayView=function(){var e=this.options,t=0,r=1440,i,s,o,u=this._getDayColumnDates(!0),a,f,l,c,h=new Date,p,d=!1,v=this.element.find(".wijmo-wijev-dayview"),m,g,y,b=0,w;v.length===0&&(v=n('<div class="wijmo-wijev-view wijmo-wijev-dayview '+e.wijCSS.content+'">'+'<h3 class="wijmo-wijev-header-title">title'+"</h3>"+'<div class="wijmo-wijev-dayview-inner">'+'<div class="wijmo-wijev-headercontainer">'+'<div class="wijmo-wijev-sizer">'+'<div class="wijmo-wijev-gmtlabel">'+this.localizeString("labelAllDay","all-day")+"</div>"+"</div>"+"</div>"+'<div class="wijmo-wijev-scrollpanel">'+'<div class="wijmo-wijev-scrollcontent">'+'<div class="wijmo-wijev-timeruler">'+'<div class="wijmo-wijev-currenttime-indicator">'+'<div class="wijmo-wijev-currenttime-indicator-arrow ui-state-error"></div>'+'<div class="wijmo-wijev-currenttime-indicator-line ui-state-error"></div>'+"</div>"+"</div>"+"</div>"+"</div>"+"</div>"+"</div>"),v.appendTo(this.element.find(".wijmo-wijev-view-container")),this.element.find(".wijmo-wijev-scrollpanel").wijsuperpanel({hScroller:{scrollBarVisibility:"hidden"},animationOptions:{disabled:!0}})),v.removeClass("wijmo-wijev-weekview wijmo-wijev-listview"),v.addClass("wijmo-wijev-"+e.viewType.toLowerCase()+"view"),m=this.element.find(".wijmo-wijev-headercontainer"),g=this.element.find(".wijmo-wijev-scrollcontent"),y=g.find(".wijmo-wijev-timeruler");if(!this._templateDayColumn){y.find(".wijmo-wijev-timerulerinterval").remove(),i='<div class="wijmo-wijev-daycolumn">',w=!0;while(t<r)s="wijmo-wijev-timeinterval "+e.wijCSS.content+" wijmo-wijev-minute-"+t,w&&(s+=" wijmo-wijev-oddrow"),w=!w,o="wijmo-wijev-timerulerinterval "+e.wijCSS.content+" wijmo-wijev-minute-"+t,i+='<div class="'+s+'" style="height: '+e.timeIntervalHeight+'px"></div>',t+=e.timeInterval,b+=e.timeInterval,b>=e.timeRulerInterval&&(s+=" wijmo-wijev-timeinterval-hourstart",o+=" wijmo-wijev-timerulerinterval-hourstart",y.append(n('<div class="'+o+'" style="height:'+b/e.timeInterval*e.timeIntervalHeight+'px">'+this._formatString(e.timeRulerFormat,new Date(h.getFullYear(),h.getMonth(),h.getDate(),0,t-b))+"</div>")),b=0);i+="</div>",this._templateDayColumn=n(i),this._templateDayHeader=n('<div class="wijmo-wijev-dayheadercolumn '+e.wijCSS.content+'">'+'<div class="wijmo-wijev-allday-cell '+e.wijCSS.content+'">'+'<div class="wijmo-wijev-daylabel">3 Monday</div>'+"</div>"+"</div>")}m.find(".wijmo-wijev-dayheadercolumn").remove(),g.find(".wijmo-wijev-daycolumn").remove();for(a=0,p=u.length;a<p;a+=1)c=u[a],f=this._getCachedDayHeader(c),l=this._getCachedDayColumn(c),f?(f=n(f),f.find(".wijmo-wijev-daylabel").html(this._formatDayHeaderDate(c))):(f=this._templateDayHeader.clone(!0),l=this._templateDayColumn.clone(!0),f.addClass(this._dayDateToCssClass(c)),f.find(".wijmo-wijev-daylabel").html(this._formatDayHeaderDate(c)),l.addClass(this._dayDateToCssClass(c)),d?d=!1:(l.addClass("wijmo-wijev-leftborder"),f.addClass("wijmo-wijev-leftborder")),this._compareDayDates(c,h)===0&&(l.addClass("wijmo-wijev-today ui-state-highlight"),l.addClass("wijmo-wijev-leftborder"),l.addClass("wijmo-wijev-rightborder"),f.addClass("wijmo-wijev-today").find(".wijmo-wijev-allday-cell").addClass("ui-state-highlight"),f.addClass("wijmo-wijev-leftborder"),f.addClass("wijmo-wijev-rightborder"),d=!0),a===p-1&&(l.addClass("wijmo-wijev-rightborder"),f.addClass("wijmo-wijev-rightborder"))),m.append(f),g.append(l);this._invalidateDayView(),this._renderDayViewAppointments()},t.prototype._getCachedDayHeader=function(e){var t=null;return this._dayViewCache&&this._dayViewCache[e]&&(t=this._dayViewCache[e].h),t},t.prototype._getCachedDayColumn=function(e){var t=null;return this._dayViewCache&&this._dayViewCache[e]&&(t=this._dayViewCache[e].c),t},t.prototype._storeDayCache=function(e,t,n){this._dayViewCache||(this._dayViewCache={}),this._dayViewCache[e]={h:t,c:n}},t.prototype._clearViewsCache=function(){this._clearDayViewCache(),this._clearListViewCache()},t.prototype._clearDayViewCache=function(){this._dayViewCache={}},t.prototype._clearListViewCache=function(){var e=this.element.find(".wijmo-wijev-list-details .wijmo-wijev-agenda-container .wijmo-wijsuperpanel-templateouterwrapper");e[0]||(e=this.element.find(".wijmo-wijev-list-details .wijmo-wijev-agenda-container .wijmo-wijsuperpanel-contentwrapper-touch")),e.data("wijevcal_agenda_initialized",!1),e.data("wijevcal_agenda_loadedeventscount",0)},t.prototype._invalidateDayView=function(e){var t=this.element.find(".wijmo-wijev-headercontainer"),r=this.element.find(".wijmo-wijev-scrollcontent"),i=r.find(".wijmo-wijev-timeruler"),s=t.find(".wijmo-wijev-dayheadercolumn"),o=r.find(".wijmo-wijev-daycolumn"),u=this.element.find(".wijmo-wijev-view .wijmo-wijev-header-title"),a,f,l,c,h,p,d,v=i.outerWidth(),m,g,y,b,w;this._updateHeaderTitleText(),a=u.is(":visible")?u.outerHeight(!0):0,this._invalidateView(),this._maxAllDayEventCount||(this._maxAllDayEventCount=0),c=t.find(".wijmo-wijev-dayheadercolumn .wijmo-wijev-appointment").outerHeight(!0),c||(c=17),h=t.find(".wijmo-wijev-daylabel").outerHeight(!0),p=0;for(m=0;m<s.length;m+=1)d=n(s[m]).find(".wijmo-wijev-allday-cell .wijmo-wijev-appointment").length,d>p&&(p=d);l=c*p+h+c,t.outerHeight(l+Math.round(c/2)),t.find(".wijmo-wijev-allday-cell").outerHeight(l),f=this.element.find(".wijmo-wijev-view").innerWidth(),g=f-v,g-=18,y=this.element.find(".wijmo-wijev-view").innerHeight()-t.outerHeight(!0)-a,b=Math.floor(g/o.length),t.outerWidth(f),r.outerWidth(f),s.outerWidth(b),o.outerWidth(b),this._invalidateCurrentTimeIndicator(),w=this.element.find(".wijmo-wijev-scrollpanel"),w.outerWidth(f),w.outerHeight(y),w.wijsuperpanel("refresh");switch(this.options.viewType.toLowerCase()){case"day":this._updateDayViewDetails();break;case"list":this._updateListViewDetails()}},t.prototype._updateDayViewDetails=function(){var e=this.options,t=e.selectedDate,r=this.element.find(".wijmo-wijev-leftpane"),i=r.find(".wijmo-wijev-agenda-container");this._dayViewDetailsInit||(this._dayViewDetailsInit=!0,this.element.find(".wijmo-wijev-day-details .wijmo-wijev-daycalendar").wijcalendar({culture:e.culture,titleFormat:this.localizeString("calendarTitleFormat","MMMM yyyy"),toolTipFormat:this.localizeString("calendarToolTipFormat","dddd, MMMM dd, yyyy"),showTitle:!1,showOtherMonthDays:!1,showWeekNumbers:!1,selectionMode:{day:!0,days:!1},selectedDatesChanged:n.proxy(function(t,n){n.dates&&!e.disabled&&this.goToDate(n.dates[0])},this),nextTooltip:this.localizeString("calendarNextTooltip","Next"),prevTooltip:this.localizeString("calendarPrevTooltip","Previous")}),this.element.find(".wijmo-wijev-day-details .wijmo-wijev-agenda-container").wijsuperpanel()),this.element.find(".wijmo-wijev-day-details .wijmo-wijev-daycalendar").wijcalendar("option","displayDate",t).wijcalendar("unSelectAll").wijcalendar("selectDate",t),this.element.find(".wijmo-wijev-day-details .wijmo-wijev-daycalendar").wijcalendar("refresh"),this.element.find(".wijmo-wijev-day-details .wijmo-wijev-monthday-label").html(t.getDate()),this.element.find(".wijmo-wijev-day-details .wijmo-wijev-fulldate-label").html(this._formatString(this.localizeString("dayDetailsLabelFulldateFormat","{0:dddd, MMMM d}"),t)),this.element.find(".wijmo-wijev-day-details .wijmo-wijev-year-label").html(this._formatString(this.localizeString("dayDetailsLabelYearFormat","{0:yyyy}"),t)),this._updateAgendaList(this.element.find(".wijmo-wijev-day-details  .wijmo-wijev-agenda-container"),t,t,!1)},t.prototype._listViewAgendaScrolled=function(e,t){var r=this.element.find(".wijmo-wijev-list-details .wijmo-wijev-agenda-container"),i=r.wijsuperpanel("option","vScroller"),s,o=i.scrollValue,u=i.scrollMax-i.scrollLargeChange*2,a=e.type,f=!1,l;a==="wijsuperpanelscroll"?(l=t.position,s=r.find(".wijmo-wijsuperpanel-contentwrapper-touch"),r.height()+l>=s.height()&&(f=!0)):s=r.find(".wijmo-wijsuperpanel-templateouterwrapper"),(o>=u||f)&&s.data("wijevcal_agenda_loadnextpage")&&(s.data("wijevcal_agenda_loadnextpage",!1),s.find(".wijmo-wijev-agenda-more-events").show().html(this.localizeString("agendaLoadingMoreEvents","Loading more events...")),this._renderAgendaEventsTimeoutId&&(clearTimeout(this._renderAgendaEventsTimeoutId),this._renderAgendaEventsTimeoutId=null),this._renderAgendaEventsTimeoutId=setTimeout(n.proxy(function(){this._renderAgendaEventsTimeoutId=null,this._renderAgendaEvents(s,null,null,!0),s.find(".wijmo-wijev-agenda-more-events").remove()},this),100))},t.prototype._updateListViewDetails=function(){this._listViewDetailsInit||(this._listViewDetailsInit=!0,n.support.isTouchEnabled&&n.support.isTouchEnabled()?this.element.find(".wijmo-wijev-list-details .wijmo-wijev-agenda-container").wijsuperpanel({scroll:n.proxy(this._listViewAgendaScrolled,this)}):this.element.find(".wijmo-wijev-list-details .wijmo-wijev-agenda-container").wijsuperpanel({scrolled:n.proxy(this._listViewAgendaScrolled,this)})),this._updateAgendaList(this.element.find(".wijmo-wijev-list-details  .wijmo-wijev-agenda-container"),null,null,!0)},t.prototype._updateAgendaList=function(e,t,r,i){var s=this.element.find(".wijmo-wijev-leftpane"),o=e;e.outerHeight(s.innerHeight()-e[0].offsetTop),o.find(".wijmo-wijsuperpanel-templateouterwrapper").length>0&&(o=o.find(".wijmo-wijsuperpanel-templateouterwrapper")),n.support.isTouchEnabled&&n.support.isTouchEnabled()&&(o=o.find(".wijmo-wijsuperpanel-contentwrapper-touch"));if(i&&o.data("wijevcal_agenda_initialized")){o.parents(".wijmo-wijsuperpanel").wijsuperpanel("refresh");return}o.data("wijevcal_agenda_initialized",!0),o.data("wijevcal_agenda_loadedeventscount",0),o.html(""),this._renderAgendaEvents(o,t,r,i)},t.prototype._renderAgendaEvents=function(e,t,r,s){var o=this._eventsView,u,a,f,l,c=0,h,p="",d="",v=null,m=null,g=this.options,y,b,w=100,E=e.data("wijevcal_agenda_loadedeventscount");t&&(v=i(t),m=this._addDays(i(r),1),l=(m.getTime()-v.getTime())/864e5);if(o){f=o.length<w+E||!s?o.length:w+E,e.data("wijevcal_agenda_loadedeventscount",f);if(!v){d="";for(a=E;a<f;a+=1){u=o[a];if(a===E||y.getDate()!==u.start.getDate())y=u.start,a!==0&&(p+='<ul class="wijmo-wijev-agenda-list">'+d+"</ul>",p+="</div>"),p+='<div class="wijmo-wijev-agenda-day-container '+this._dayDateToCssClass(y)+'">',s&&(p+=this._renderAgendaDayHeader(y)),d="";d+=this._renderAgendaAppointmentVisual(u),h+=1,a===f-1&&(p+='<ul class="wijmo-wijev-agenda-list">'+d+"</ul>",p+="</div>",f<o.length?(p+='<div class="wijmo-wijev-agenda-more-events">',p+=this._formatString(this.localizeString("agendaMoreEventsFormat","More events ({0})..."),o.length-f),p+="<div>",e.data("wijevcal_agenda_loadnextpage",!0)):e.data("wijevcal_agenda_loadnextpage",!1))}}else while(c<l){y=this._addDays(v,c),y=new Date(y.getFullYear(),y.getMonth(),y.getDate()),b=new Date(y.getFullYear(),y.getMonth(),y.getDate(),23,59,59),h=0,d="";for(a=E;a<f;a+=1)u=o[a],u.start<m&&u.end>v&&u.start<b&&u.start>=y&&(d+=this._renderAgendaAppointmentVisual(u),h+=1);d!==""&&(p+='<div class="wijmo-wijev-agenda-day-container '+this._dayDateToCssClass(y)+'">',s&&(p+=this._renderAgendaDayHeader(y)),p+='<ul class="wijmo-wijev-agenda-list">'+d+"</ul>",p+="</div>"),c+=1}n(p).appendTo(e)}e.on("click",".wijmo-wijev-agenda-event",n.proxy(this._onAgendaEventClick,this)).on("mouseover",".wijmo-wijev-agenda-event",function(e){n(this).addClass(g.wijCSS.stateHover)}).on("mouseout",".wijmo-wijev-agenda-event",function(e){n(this).removeClass(g.wijCSS.stateHover).removeClass(g.wijCSS.stateActive)}).on("mousedown",".wijmo-wijev-agenda-event",function(){n(this).addClass(g.wijCSS.stateActive)}).on("mouseup",".wijmo-wijev-agenda-event",function(){n(this).removeClass(g.wijCSS.stateActive)}),e.parents(".wijmo-wijsuperpanel").wijsuperpanel("refresh")},t.prototype._renderAgendaDayHeader=function(e){var t='<div class="wijmo-wijev-agenda-header ui-widget-header"><div class="wijmo-wijev-weekday">'+this._formatString("{0:dddd}",e)+"</div>"+'<div class="wijmo-wijev-date">'+this._formatString(this.localizeString("agendaHeaderFullDateFormat","{0:MMMM d, yyyy}"),e)+"</div>"+"</div>";return t},t.prototype._onAgendaEventClick=function(e){var t=n(e.target);t.hasClass("wijmo-wijev-agenda-event")||(t=t.parent(".wijmo-wijev-agenda-event")),t.length>0&&this.goToEvent(this._parseEventIdFromClass(t[0].className))},t.prototype._renderAgendaAppointmentVisual=function(e){var t='<li class="wijmo-wijev-agenda-event '+this._dayDateToCssClass(e.start)+" "+this._eventIdToCssClass(e.id)+" "+this.options.wijCSS.stateDefault+' ui-helper-clearfix">'+'<div class="wijmo-wijev-agenda-event-color '+"wijmo-wijev-event-color-"+(e.color||"default")+'">'+"<div></div>"+"</div>"+'<div class="wijmo-wijev-agenda-event-title">'+e.subject+"</div>"+'<div class="wijmo-wijev-agenda-event-time">'+(this.isAllDayEvent(e)?this.localizeString("labelAllDay","all-day"):this._formatString(this.localizeString("agendaTimeFormat","{0:hh:mm tt} to {1:hh:mm tt}"),e.start,e.end))+"</div>"+"</li>";return t},t.prototype._invalidateCurrentTimeIndicator=function(){var e=this.element.find(".wijmo-wijev-timeruler .wijmo-wijev-currenttime-indicator"),t=new Date,n=this.options;t=t.getMinutes()+t.getHours()*60,e.css("top",t/n.timeInterval*n.timeIntervalHeight)},t.prototype._onEventsDataChanged=function(){this._clearViewsCache(),this._prepareEventsForView(),this._renderActiveView(),this._trigger("eventsDataChanged",null,{eventsData:this.options.eventsData})},t.prototype._onCalendarsChanged=function(){this._trigger("calendarsChanged",null,{calendars:this.options.calendars})},t.prototype._renderDayViewAppointments=function(){var e=this._eventsView,t,r,i,s,o,u=this.element.find(".wijmo-wijev-headercontainer"),a=this.element.find(".wijmo-wijev-scrollcontent"),f=u.find(".wijmo-wijev-dayheadercolumn"),l=a.find(".wijmo-wijev-daycolumn"),c,h,p=this.options,d=this._getDayColumnDates(),v=d[0],m,g,y,b,w,E,S,x,T,N=[];m=d[d.length-1],m=new Date(m.getFullYear(),m.getMonth(),m.getDate(),23,59,59);if(e)for(i=0,o=d.length;i<o;i+=1)if(!l[i]._cached){c=d[i],c=new Date(c.getFullYear(),c.getMonth(),c.getDate()),h=new Date(c.getFullYear(),c.getMonth(),c.getDate(),23,59,59);for(r=0,s=e.length;r<s;r+=1)t=e[r],t.start<m&&t.end>v&&t.start<h&&t.end>c&&(this.isAllDayEvent(t)?(g=!0,y=n(this._getAllDayEventMarkup(t)),n(f[i]).find(".wijmo-wijev-allday-cell").append(y)):(b=t.start,w=t.end,b<c&&(b=c),w>h&&(w=h),E=(b-c)/1e3/60,S=(w-c)/1e3/60,x=Math.round(E*p.timeIntervalHeight/p.timeInterval),T=Math.round(S*p.timeIntervalHeight/p.timeInterval),y=n(this._getEventMarkup(t)),y.css("top",x),y.outerHeight(T-x),n(l[i]).append(y)));this._storeDayCache(d[i],f[i],l[i]),l[i]._cached=!0,N.push(l[i])}else N.push(l[i]);this._dayColumnsToResolve=N,this._dayColumnResolveIdx=0,this._resolveDayApptConflictsTimeout||(clearTimeout(this._resolveDayApptConflictsTimeout),this._resolveDayApptConflictsTimeout=null),this._resolveDayApptConflictsTimeout=setTimeout(n.proxy(this._resolveDayViewAppointmentConflictsCb1,this),1),g&&this._invalidateDayView(!0),this._dayViewScrollToEvent&&(y=this.element.find(".wijmo-wijev-dayview .wijmo-wijev-daycolumn ."+this._eventIdToCssClass(this._dayViewScrollToEvent.id)),y.length>0&&this.element.find(".wijmo-wijev-scrollpanel").wijsuperpanel("scrollChildIntoView",y))},t.prototype._getAllDayEventMarkup=function(e){return'<div class="wijmo-wijev-appointment '+this._eventIdToCssClass(e.id)+'">'+'<div class="'+" wijmo-wijev-colordot wijmo-wijev-event-color-"+(e.color||"default")+'"></div>'+'<div class="wijmo-wijev-event-title">'+e.subject+"</div>"+"</div>"},t.prototype._getEventMarkup=function(e){return'<div class="wijmo-wijev-appointment wijmo-wijev-event-color-'+(e.color||"default")+" "+this._eventIdToCssClass(e.id)+'">'+'<div class="wijmo-wijev-content"><div class="wijmo-wijev-title">'+this._formatString(this.options.eventTitleFormat,e.start,e.end,e.subject,e.location,"",e.description)+"</div></div>"+'<div class="wijmo-wijev-resizer">'+'<div class="ui-icon ui-icon-grip-solid-horizontal">'+"&nbsp;</div></div>"+"</div>"},t.prototype._resolveDayViewAppointmentConflictsCb1=function(){this._resolveDayApptConflictsTimeout=null;if(!this._dayColumnsToResolve||this._dayColumnResolveIdx>=this._dayColumnsToResolve.length)return;this._resolveDayViewAppointmentConflicts(this._dayColumnsToResolve[this._dayColumnResolveIdx]),this._dayColumnResolveIdx=this._dayColumnResolveIdx+1,setTimeout(n.proxy(this._resolveDayViewAppointmentConflictsCb1,this),1)},t.prototype._resolveDayViewAppointmentConflicts=function(e){var t=n(e).find(".wijmo-wijev-appointment"),r,i=[],s,o,u,a,f,l,c,h,p=0;r=n(t).toArray().sort(this._sortOffsetTop);for(o=0,l=t.length;o<l;o+=1){if(o<p)continue;a=r[o];for(u=o;u<l;u+=1)if(u!==o){f=r[u];if(!(a.offsetTop<f.offsetTop+f.offsetHeight&&a.offsetTop+a.offsetHeight>f.offsetTop))break;i[o]||(i[o]=[a]),i[o].push(f),f.offsetTop+f.offsetHeight>a.offsetTop+a.offsetHeight&&(a=f)}p=u}for(o=0,l=i.length;o<l;o+=1){s=i[o];if(s){c=s.length,s.sort(this._sortOffsetTop);for(u=0;u<c;u+=1)a=s[u],a.style.width=Math.floor(100/c)+"%",h=Math.floor(100*u/c),a.style.marginLeft=h+"%",a.style.zIndex=h}}},t.prototype._sortOffsetTop=function(e,t){return e.offsetTop<t.offsetTop?-1:e.offsetTop>t.offsetTop?1:0},t.prototype._onDayViewTimeIntervalClick=function(e){if(this.options.readOnly)return;this.showEditEventDialog(null,e.target,e)},t.prototype._onDayViewAllDayCellClick=function(e){if(this.options.readOnly)return;var t=n(e.target);if(t.hasClass("wijmo-wijev-appointment")||t.parents(".wijmo-wijev-appointment").length>0)return;if(t.hasClass("wijmo-wijev-daylabel")||t.parents(".wijmo-wijev-daylabel").length>0)return;this.showEditEventDialog(null,e.target,e)},t.prototype._onMonthViewDayLabelClick=function(e){var t=n(e.target).parents(".wijmo-wijev-monthcellcontainer"),r=this.options,i;t.length<1&&(t=n(e.target).parents(".wijmo-wijev-dayheadercolumn")),t[0]&&(i=this._parseDateFromClass(t[0].className),r.viewType!=="day"&&(r.viewType="day",this._onViewTypeChanged()),r.selectedDates=[new Date(i)],this._onSelectedDatesChanged())},t.prototype._onMonthViewCellClick=function(e){var t=n(e.target).parent(".wijmo-wijev-monthcellcontainer");if(this.options.readOnly)return;if(t.length<1)return;this.showEditEventDialog(null,t,e)},t.prototype._onAppointmentClick=function(e){var t=n(e.target),r;if(this.options.readOnly)return;if(this._apptDragResizeFlag)return;t.hasClass("wijmo-wijev-appointment")||(t=t.parents(".wijmo-wijev-appointment")),t.length>0&&(r=this.findEventById(t[0].className),this.showEditEventDialog(r,t,e))},t.prototype.findEventById=function(e){var t;if(e){t=e.indexOf("apptid_"),t!==-1&&(e=this._parseEventIdFromClass(e));if(this._eventsDataById)return this._eventsDataById[e]}return null},t.prototype._onMonthViewAppointmentMouseDown=function(e){if(this.options.readOnly)return;var t=n(e.target),r=t.hasClass("wijmo-wijev-appointment")?t:t.parents(".wijmo-wijev-appointment");e.preventDefault(),this.__targetAppt=r,n(document).bind("mouseup.tmp_wijevcal",n.proxy(this._onMonthViewAppointmentMouseUp,this)),this.element.find(".wijmo-wijev-monthview .wijmo-wijev-monthcellcontainer").bind("mouseover.tmp_wijevcal",n.proxy(this._onMonthViewCellMouseOver,this))},t.prototype._onDayViewAppointmentMouseDown=function(e){if(this.options.readOnly)return;var t=n(e.target),r=t.hasClass("wijmo-wijev-appointment")?t:t.parents(".wijmo-wijev-appointment"),i=t.hasClass("wijmo-wijev-resizer")||t.parents(".wijmo-wijev-resizer").length>0;if(this.options.disabled)return;this._isApptResize=i,e.preventDefault(),this._isApptResize?(this.__startApptH=r[0].offsetHeight,this.__startApptY=r[0].offsetTop):this.__startApptY=r[0].offsetTop,this.__startClientY=e.clientY,this.__targetAppt=r,n(document).bind("mousemove.tmp_wijevcal",n.proxy(this._onDayViewAppointmentMouseMove,this)),n(document).bind("mouseup.tmp_wijevcal",n.proxy(this._onDayViewAppointmentMouseUp,this)),n(this.element).find(".wijmo-wijev-dayview .wijmo-wijev-daycolumn").bind("mouseover.tmp_wijevcal",n.proxy(this._onDayViewColumnMouseOver,this)),n(this.element).find(".wijmo-wijev-dayview .wijmo-wijev-allday-cell").bind("mouseover.tmp_wijevcal",n.proxy(this._onDayViewAllDayMouseOver,this))},t.prototype._onDayViewAppointmentMouseMove=function(e){e.preventDefault();var t=e.clientY-this.__startClientY,n,r=this.options,i,s;e.ctrlKey||(t=Math.round(t/r.timeIntervalHeight)*r.timeIntervalHeight),t!==0&&!this._apptDragResizeFlag&&(this._apptDragResizeFlag=!0,this.__targetAppt.addClass("wijmo-wijev-dragging"),this.__targetAppt.css("width","100%").css("margin-left","0").css("z-index","1000")),this._apptDragResizeFlag&&(this._isApptResize?(i=this.__startApptH+t,i<0?(i=Math.abs(i),n=this.__startApptY-i,n>=0&&(this.__targetAppt.css("height",i),this.__targetAppt.css("top",n))):this.__targetAppt.css("height",i)):(n=this.__startApptY+t,n<0&&(n=0),this.__targetAppt.css("top",n),s=this.__targetAppt.offset().top,this.element.find(".wijmo-wijev-scrollpanel").wijsuperpanel("scrollChildIntoView",this.__targetAppt),this.__startApptY=this.__startApptY-(this.__targetAppt.offset().top-s)),this._onApptVisualDargOrResize(this.__targetAppt,this.findEventById(this.__targetAppt[0].className)))},t.prototype._onDayViewAppointmentMouseUp=function(e){this.__targetAppt&&this.__targetAppt.removeClass("wijmo-wijev-dragging"),n(document).unbind(".tmp_wijevcal"),n(this.element).find(".wijmo-wijev-dayview .wijmo-wijev-daycolumn").unbind(".tmp_wijevcal"),n(this.element).find(".wijmo-wijev-dayview .wijmo-wijev-allday-cell").unbind(".tmp_wijevcal");if(this._apptDragResizeFlag||this._apptMovedFlag){var t=this.findEventById(this.__targetAppt[0].className);this._onApptVisualDargOrResize(this.__targetAppt,t),this._apptMovedFlag=!1,this._movedFromTimeInervalApptElem=null,this.updateEvent(t),window.setTimeout(n.proxy(function(){this.__targetAppt&&!this.__targetAppt.hasClass("wijmo-wijev-dragging")&&(this._apptDragResizeFlag=!1,this._resolveDayViewAppointmentConflicts(this.__targetAppt.parents(".wijmo-wijev-daycolumn")))},this),1)}},t.prototype._updateAppointmentVisual=function(e){var t=this.element.find(".wijmo-wijev-dayview ."+this._eventIdToCssClass(e.id)),n=this.options,r,s,o,u,a,f,l,c;t.length===1&&(this._addColorClass(t,e.color),t.find(".wijmo-wijev-title").html(this._formatString(n.eventTitleFormat,e.start,e.end,e.subject,e.location,"",e.description)),a=i(e.start),r=(e.start-a)/1e3/60,s=(e.end-a)/1e3/60,o=Math.round(r*n.timeIntervalHeight/n.timeInterval),u=Math.round(s*n.timeIntervalHeight/n.timeInterval),t.css("top",o),t.css("height",u-o),f=this._dayDateToCssClass(a),t.parents(".wijmo-wijev-daycolumn."+f).length!==1&&(l=t[0].parentNode,c=this.element.find(".wijmo-wijev-daycolumn."+f),l.removeChild(t[0]),t.appendTo(c)))},t.prototype._onApptVisualDargOrResize=function(e,t){var n=this.options,r=e[0].offsetTop,s=r+e[0].offsetHeight,o,u,a,f,l,c,h,p;e.parents(".wijmo-wijev-dayheadercolumn").length>0?p=e.parents(".wijmo-wijev-dayheadercolumn")[0]:p=e.parents(".wijmo-wijev-daycolumn")[0],h=this._parseDateFromClass(p.className,null),o=Math.round(r*n.timeInterval/n.timeIntervalHeight),u=Math.round(s*n.timeInterval/n.timeIntervalHeight),a=new Date(o*60*1e3+h.getTime()),f=new Date(u*60*1e3+h.getTime()),t&&(this._isApptResize?l=f:(c=t.end.getTime()-t.start.getTime(),l=new Date(a.getTime()+c)),t.allday=e.parents(".wijmo-wijev-dayheadercolumn").length>0,t.start=a,t.end=l,e.find(".wijmo-wijev-title").html(this._formatString(n.eventTitleFormat,t.start,t.end,t.subject,t.location,"",t.description)),!this._isApptResize&&l.getTime()!==f.getTime()&&e.css("height",Math.round((t.end-i(t.start))/1e3/60*n.timeIntervalHeight/n.timeInterval)-Math.round((t.start-i(t.start))/1e3/60*n.timeIntervalHeight/n.timeInterval)))},t.prototype._onDayViewColumnMouseOver=function(e){var t=n(e.target).parents(".wijmo-wijev-daycolumn"),r=this.__targetAppt.parents(".wijmo-wijev-daycolumn");if(t.length<1)return;if(r.length<1){r=this.__targetAppt.parents(".wijmo-wijev-dayheadercolumn");if(r.length<1)return;this._movedFromTimeInervalApptElem?(this.__targetAppt.replaceWith(this._movedFromTimeInervalApptElem),this.__targetAppt=n(this._movedFromTimeInervalApptElem),this._movedFromTimeInervalApptElem=null):this.__targetAppt.html(this._getEventMarkup(this.findEventById(this.__targetAppt[0].className)))}t[0].className!==r[0].className&&(this.__targetAppt[0].parentNode.removeChild(this.__targetAppt[0]),this._resolveDayViewAppointmentConflicts(r),this.__targetAppt.appendTo(t),this._apptMovedFlag=!0)},t.prototype._onMonthViewCellMouseOver=function(e){var t=n(e.target),r=t.hasClass("wijmo-wijev-monthcellcontainer")?t:t.parents(".wijmo-wijev-monthcellcontainer"),i=this.__targetAppt.parents(".wijmo-wijev-monthcellcontainer");if(r.length<1||i.length<1)return;r[0].className!==i[0].className&&(this.__targetAppt[0].parentNode.removeChild(this.__targetAppt[0]),this.__targetAppt.appendTo(r.find(".wijmo-wijev-monthcell")),this.__targetApptChanged=!0)},t.prototype._onMonthViewAppointmentMouseUp=function(){var e,t=this.__targetAppt.parents(".wijmo-wijev-monthcellcontainer")[0],r=this._parseDateFromClass(t.className,null),s;n(document).unbind(".tmp_wijevcal"),this.element.find(".wijmo-wijev-monthview .wijmo-wijev-monthcellcontainer").unbind(".tmp_wijevcal"),this.__targetApptChanged&&(this.__targetApptChanged=!1,e=this.findEventById(this.__targetAppt[0].className),s=(r.getTime()-i(e.start).getTime())/864e5,e.start=this._addDays(e.start,s),e.end=this._addDays(e.end,s),this.updateEvent(e))},t.prototype._onDayViewAllDayMouseOver=function(e){var t=n(e.target).parents(".wijmo-wijev-dayheadercolumn"),r=this.__targetAppt.parents(".wijmo-wijev-daycolumn"),i;if(t.length<1)return;r.length>0?(i=n(this._getAllDayEventMarkup(this.findEventById(this.__targetAppt[0].className))),this._movedFromTimeInervalApptElem=this.__targetAppt[0].cloneNode(!0),this.__targetAppt.replaceWith(i),this.__targetAppt=i):r=this.__targetAppt.parents(".wijmo-wijev-dayheadercolumn");if(r.length<1)return;t[0].className!==r[0].className&&(this.__targetAppt[0].parentNode.removeChild(this.__targetAppt[0]),this._resolveDayViewAppointmentConflicts(r),this.__targetAppt.appendTo(n(t).find(".wijmo-wijev-allday-cell")),this._apptMovedFlag=!0)},t.prototype._renderMonthView=function(){var e=this.options,t=e.selectedDate,r=e.firstDayOfWeek,i=!1,s=!1,o,u,a,f=new Date,l,c,h=!1,p,d=["","","","","","",""],v,m,g=this.element.find(".wijmo-wijev-view.wijmo-wijev-monthview"),y,b=e.dayHeaderFormat,w=e.firstRowDayHeaderFormat;t||(t=new Date),u=new Date(t.getFullYear(),t.getMonth(),1);while(u.getDay()!==parseInt(r))u=this._addDays(u,-1);a=new Date(t.getFullYear(),t.getMonth(),this._daysInMonth(t.getMonth(),t.getFullYear())),o=u,l=0,c=0;while(o<a||l<7){o>a&&(a=o),v="",p="wijmo-wijev-monthcellcontainer "+e.wijCSS.content+" "+this._dayDateToCssClass(o),s=o.getMonth()!==t.getMonth(),s&&(p+=" wijmo-wijev-othermonth"),h?h=!1:(p+=" wijmo-wijev-leftborder",l===6&&(p+=" wijmo-wijev-rightborder")),i=this._compareDayDates(o,f)===0,i&&(p+=" wijmo-wijev-today",p+=" wijmo-wijev-rightborder",h=!0),v+='<div class="'+p+'">',v+='<div class="wijmo-wijev-monthcellheader',s&&(v+=" ui-priority-secondary"),i&&(v+=" ui-state-highlight"),v+='">',i&&(v+='<span class="wijmo-wijev-todaylabel">'+this.localizeString("labelToday","Today")+"</span>"),c===0?v+=this._formatString(w,o):v+=this._formatString(b,o),v+="</div>",v+='<div class="wijmo-wijev-monthcell',s&&(v+=" ui-priority-secondary"),i&&(v+=" ui-state-highlight"),v+='"></div>',v+="</div>",d[l]=d[l]+v,l+=1,o=this._addDays(o,1);if(l>6){if(o>a)break;l=0,c+=1}}g.length===0&&(g=n('<div class="wijmo-wijev-view wijmo-wijev-monthview '+e.wijCSS.content+'">'+'<h3 class="wijmo-wijev-header-title">title'+"</h3>"+'<div class="wijmo-wijev-monthview-inner">'+"</div>"+"</div>"),g.appendTo(this.element.find(".wijmo-wijev-view-container"))),y=g.find(".wijmo-wijev-monthview-inner"),y.find(".wijmo-wijev-monthcolumn").remove(),o=u;for(m=0;m<7;m+=1)y.append('<div class="wijmo-wijev-monthcolumn">'+d[m]+"</div>"),o=this._addDays(o,1);this._invalidateMonthView(),this._renderMonthViewAppointments()},t.prototype._invalidateMonthView=function(){var e=this.element.find(".wijmo-wijev-monthview"),t=e.find(".wijmo-wijev-monthview-inner"),r=e.find(".wijmo-wijev-monthcolumn"),i=e.find(".wijmo-wijev-monthcellcontainer"),s=this.element.find(".wijmo-wijev-monthview .wijmo-wijev-header-title"),o,u,a,f,l,c,h,p;this._invalidateView();if(r.length<1)return;o=e.innerWidth(),u=e.innerHeight()-s.outerHeight(!0),t.outerWidth(o),t.outerHeight(u),o-=t.outerWidth(!0)-t.innerWidth(),u-=t.outerHeight(!0)-t.innerHeight(),a=Math.floor(o/r.length),r.outerWidth(a),p=o-a*r.length,p>0&&n(r[r.length-1]).outerWidth(a+p),h=n(r[0]).find(".wijmo-wijev-weekdayname").outerHeight(!0),h||(h=0),f=Math.floor((u-h)/n(r[0]).find(".wijmo-wijev-monthcellcontainer").length),i.height(f),l=n(i[0]).find(".wijmo-wijev-monthcellheader").outerHeight(!0),c=f-l,i.find(".wijmo-wijev-monthcell").outerHeight(c)},t.prototype._renderMonthViewAppointments=function(){var e=this._eventsView,t,r,i,s,o,u=this.element.find(".wijmo-wijev-monthcellcontainer"),a,f,l,c;if(e)for(i=0,o=u.length;i<o;i+=1){a=u[i],f=this._parseDateFromClass(a.className),l=new Date(f.getFullYear(),f.getMonth(),f.getDate(),23,59,59);for(r=0,s=e.length;r<s;r+=1)t=e[r],t.start<l&&t.end>f&&(c=n('<div class="wijmo-wijev-appointment '+this._eventIdToCssClass(t.id)+'">'+'<div class="'+" wijmo-wijev-colordot wijmo-wijev-event-color-"+(t.color||"default")+'"></div>'+'<div class="wijmo-wijev-event-title">'+t.subject+"</div>"+"</div>"),n(a).find(".wijmo-wijev-monthcell").append(c))}u.find(".wijmo-wijev-monthcell").each(n.proxy(function(e,t){var r=n(t),i=r.find(".wijmo-wijev-appointment"),s=r.outerHeight(),o=i.outerHeight(),u=i.length*o,a=0;u>s&&(i.each(function(e,t){e*o+o>s&&(t.style.display="none",a+=1)}),a>0&&r.find(".wijmo-wijev-monthcell-showmore").length<1&&r.append(n('<div class="wijmo-wijev-monthcell-showmore">'+this._formatString(this.localizeString("monthCellMoreEventsFormat","{0}  more..."),a)+"</div>")))},this))},t.prototype.log=function(e,t){},t.prototype._log=function(e,t){var r;this.logPanel&&(r=new Date,this.logPanel.prepend(n('<span class="'+(t?t:"wijmo-wijev-information")+'">'+"["+r.getHours()+":"+r.getMinutes()+":"+r.getSeconds()+"] "+e+"</span><br/>")))},t.prototype._createLogPanel=function(){if(!this.logPanel){this.logDialog=n('<div title="Log"><div class="wijmo-wijev-log"></div></div>'),this.logDialog.appendTo(this.element);var e={};e[this.localizeString("buttonClearAll","Clear All")]=function(){n(this).find(".wijmo-wijev-log").html("")},e[this.localizeString("buttonClose","Close")]=function(){n(this).wijdialog("close")},this.logPanel=this.logDialog.wijdialog({captionButtons:{},buttons:e,width:600,height:420,position:["right","top"]}).find(".wijmo-wijev-log")}this.logDialog.wijdialog("open")},t.prototype.status=function(e,t){this.element.find(".wijmo-wijev-statusbar").html("<span class='"+(t?t:"wijmo-wijev-status")+"'>"+e+"</span>"),this.log(e,t?t:"wijmo-wijev-status")},t.prototype._invalidateView=function(){var e=this.element.find(".wijmo-wijev-rightpane"),t=this.element.find(".wijmo-wijev-leftpane"),r=this.element.find(".wijmo-wijev-headerbar"),i=this.element.find(".wijmo-wijev-navigationbar"),s=this.element.find(".wijmo-wijev-statusbar"),o=this.element.find(".wijmo-wijev-view-container"),u=this.element.find(".wijmo-wijev-view"),a,f,l,c,h,p,d,v,m,g,y,b=this.options.minWidth;y=this.element.innerWidth(),y<b&&(y=b,this.element.width(b)),a=y-(o.outerWidth(!0)-o.innerWidth()),f=this.element.innerHeight()-(o.outerHeight(!0)-o.innerHeight()),l=r.is(":visible")?r.outerHeight(!0):0,c=i.is(":visible")?i.outerHeight(!0):0,h=s.is(":visible")?s.outerHeight(!0):0,o.outerWidth(a),o.outerHeight(f-l-c-h),v=0;for(g=0;g<t.length;g+=1)n(t[g]).is(":visible")&&(v+=n(t[g]).outerWidth());m=e.is(":visible")?e.outerWidth():0,p=f-l-c-h,d=a-m-v-1,u.outerHeight(p),u.outerWidth(d),r.outerWidth(d+v),i.outerWidth(this.element.innerWidth()),s.outerWidth(d+v+m),t.outerHeight(f-l-c-h),e.outerHeight(f+100),this.element.find(".wijmo-wijev-datepager").wijdatepager("refresh")},t.prototype._daysInMonth=function(e,t){var n=new Date(t,e+1,0);return n.getDate()},t.prototype._addMinutes=function(e,t){return new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes()+t)},t.prototype._addDays=function(e,t){return new Date(e.getFullYear(),e.getMonth(),e.getDate()+t,e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())},t.prototype._setTime=function(e,t,n){var r;return e=new Date(e),e.setHours(t.getHours()),e.setMinutes(t.getMinutes()),e.setSeconds(t.getSeconds()),e.setMilliseconds(t.getMilliseconds()),n&&(r=Math.floor((t.getTime()-n.getTime())/864e5),r>0&&(e=this._addDays(e,r))),e},t.prototype._addMonths=function(e,t){return new Date(e.getFullYear(),e.getMonth()+t,e.getDate())},t.prototype._compareDayDates=function(e,t){return e=new Date(e.getFullYear(),e.getMonth(),e.getDate()),t=new Date(t.getFullYear(),t.getMonth(),t.getDate()),e<t?-1:e>t?1:0},t.prototype._dayDateToCssClass=function(e){return"wijmo-wijev-date_"+e.getFullYear()+"_"+e.getMonth()+"_"+e.getDate()},t.prototype._parseDateFromClass=function(e,t,n){var r,i,s,o=new RegExp("wijmo-wijev-minute-(\\d+)\\s"),u=new RegExp("wijmo-wijev-date_(\\d+_\\d+_\\d+)\\s");return e?(s=u.exec(e+" ")[1].split("_"),r=new Date(parseInt(s[0],10),parseInt(s[1],10),parseInt(s[2],10)),t&&(i=o.exec(t+" "),i&&(i=parseInt(i[1],10),r.setMinutes(i))),r):n||null},t.prototype._eventIdToCssClass=function(e){return"apptid_"+e},t.prototype._parseEventIdFromClass=function(e){var t="",n,r;return n=new RegExp("apptid_(\\S+)"),r=n.exec(e),r&&r.length>1&&(t=r[1]),t},t.prototype._isContainsDayDate=function(e,t){var n;if(!e)return!1;for(n=0;n<e.length;n+=1)if(this._compareDayDates(e[n],t)===0)return!0},t.prototype._formatString=function(e,t,n,r,i,s,o,u){var a,f=arguments,l,c,h=this;if(f.length<=1)return Globalize.format(f);typeof e=="string"&&(e==="_formatWeekTitle"?e=this._formatWeekTitle:e==="_formatMonthTitle"?e=this._formatMonthTitle:typeof window[e]=="function"&&(e=window[e]));if(typeof e=="function"){c=[];for(l=1;l<f.length;l+=1)c[l-1]=f[l];return e.apply(this,c)}return a=new RegExp("\\{(\\d+)(?:,([-+]?\\d+))?(?:\\:([^(^}]+)(?:\\(((?:\\\\\\)|[^)])+)\\)){0,1}){0,1}\\}","g"),e.replace(a,function(e,t,n,r,i){return e=f[Number(t)+1],r?Globalize.format(e,r,h._getCulture()):e})},t.prototype._formatMonthTitle=function(e){return this._formatString(this.localizeString("monthViewHeaderFormat","{0:MMMM yyyy}"),e)},t.prototype._formatWeekTitle=function(e,t){return e.getMonth()!==t.getMonth()?this._formatString(this.localizeString("weekViewHeaderFormat2Months","{0:MMMM} - {1:MMMM yyyy}"),e,t):this._formatString(this.localizeString("weekViewHeaderFormat","{0:MMMM yyyy}"),e)},t.prototype._formatDayHeaderDate=function(e){var t=this.options,n=t.viewType.toLowerCase(),r=this.options.dayViewHeaderFormat;if(r[n])r=r[n];else if(!r[n])return"";return this._formatString(r,e)},t.prototype._getCulture=function(e){return Globalize.findClosestCulture(e||this.options.culture)},t.prototype._isRTL=function(){return!!this._getCulture().isRTL},t.prototype._onAjaxError=function(e,t,n,r){t?(this.status("Ajax error "+t.status+" ("+t.statusText+")","error"),this.log("Error, requested url: "+n.url,"error"),t.responseText&&this.log("Error, response text: "+t.responseText,"error")):(this.status("Ajax error detected.","error"),this.log("Error, requested url: "+n.url,"error"))},t.prototype._onWindowResize=function(){this.invalidate()},t}(e.wijmoWidget);t.wijevcal=p;var d=function(){function e(){this.wijMobileCSS={header:"ui-header ui-bar-a",content:"ui-body ui-body-c",stateDefault:"ui-btn-up-c"},this.initSelector=":jqmData(role='wijevcal')",this.culture="",this.localization=null,this.datePagerLocalization=null,this.readOnly=!1,this.webServiceUrl="",this.colors=null,this.dataStorage={addEvent:null,updateEvent:null,deleteEvent:null,loadEvents:null,addCalendar:null,updateCalendar:null,deleteCalendar:null,loadCalendars:null},this.dataSource=null,this.eventsData=[],this.appointments=[],this.calendars=[],this.disabled=!1,this.editCalendarTemplate="",this.enableLogs=!1,this.eventTitleFormat="{2}",this.titleFormat={day:!1,week:"_formatWeekTitle",month:"_formatMonthTitle",list:!1},this.firstDayOfWeek=0,this.headerBarVisible=!0,this.navigationBarVisible=!0,this.rightPaneVisible=!1,this.selectedDate=null,this.selectedDates=null,this.statusBarVisible=!1,this.timeInterval=30,this.timeIntervalHeight=15,this.timeRulerInterval=60,this.timeRulerFormat="{0:h tt}",this.dayHeaderFormat="{0:d }",this.firstRowDayHeaderFormat="{0:ddd d}",this.dayViewHeaderFormat={day:"all-day events",week:"{0:d dddd}",list:"{0:d dddd}"},this.viewType="day",this.visibleCalendars=new Array("Default"),this.minWidth=750,this.calendarsChanged=null,this.initialized=null,this.selectedDatesChanged=null,this.viewTypeChanged=null,this.beforeEditEventDialogShow=null,this.beforeAddEvent=null,this.beforeUpdateEvent=null,this.beforeDeleteEvent=null,this.beforeAddCalendar=null,this.beforeUpdateCalendar=null,this.beforeDeleteCalendar=null,this.eventsDataChanged=null}return e}();p.prototype.options=n.extend(!0,{},e.wijmoWidget.prototype.options,new d),n.wijmo.registerWidget(r,p.prototype)})(e.evcal||(e.evcal={}));var t=e.evcal})(wijmo||(wijmo={}));;
var __extends=this.__extends||function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},wijmo;(function(e){(function(t){"use strict";function h(){return document.location.hash.match(/^#\w+=/)}var n=jQuery,r="wijappview",i={menu:"menu",content:"content",header:"header",footer:"footer",page:"appviewpage"},s={adjusted:r+"-adjusted"},o="",u=!1;n.fn.findRole=function(e){return this.find(":jqmData(role='"+e+"')")};var a=function(e){function t(){e.apply(this,arguments),this._updatingUrl=!1}return __extends(t,e),t.prototype._appViewCSS=function(){return this.options.wijCSS.wijappview},t.prototype._initMenu=function(){this._menuDiv=this.element.findRole(i.menu);if(!this._menuDiv.length)throw"A DIV with data-role='"+i.menu+"' not found!";this._linkList=this._menuDiv.find("ul");if(!this._linkList.length)throw"Invalid markup. Link list not found";this._menuDiv.addClass(this._appViewCSS().menu)},t.prototype._initPages=function(e,t){var r=this._pageStore,i=this._appViewCSS();e.each(function(){var e=n(this).addClass(i.page),r=e.attr("id"),s=t;if(e.jqmData("url"))return;r&&(s+="#"+r),e.attr("data-url",s)})},t.prototype._initPageContainer=function(){var e=this._appViewCSS(),t=this._pageStore;this._pageContainer=n("<div/>").addClass(e.pageContainer).prependTo(this.element);var r=this.element.findRole(i.page);this._initPages(r,this._documentUrl),r.each(function(e){t.push(n(this).clone()),e>0&&n(this).remove()}),this._firstPage=r.first().addClass(e.pageActive).appendTo(this._pageContainer),this._initCurrentPage()},t.prototype._getUrl=function(e){var t=e.is("form")?"action":"href",r=e.attr(t);return!r||r==="#"?null:(n.mobile.path.isRelativeUrl(r)&&e.parents(":jqmData(url)").each(function(e,t){var i=n(t).jqmData("url");if(i&&n.mobile.path.isAbsoluteUrl(i))return r=n.mobile.path.makeUrlAbsolute(r,i),!1}),r)},t.prototype._hijackLinks=function(e){var t=this;e.on("click."+r,"a, .ui-btn",function(e){if(e.isDefaultPrevented())return;var r=t._findClosestLink(e.target);if(!r||n(r).jqmData("appviewpage")===!1)return;var i=t._getUrl(n(r));i&&(e.preventDefault(),e.stopPropagation(),t.changePage(i))})},t.prototype._hijackForms=function(e){var t=this;e.on("submit."+r,"form",function(e){if(e.isDefaultPrevented())return;var r=n(e.currentTarget),i=r.closest("."+t._appViewCSS().page);if(!n.mobile.ajaxEnabled||r.is(":jqmData(ajax='false')")||!r.jqmHijackable().length)return;var s=r.attr("method"),o=r.attr("target"),u=t._getUrl(r);e.preventDefault(),e.stopPropagation(),t.changePage(u,{type:s&&s.length&&s.toLowerCase()||"get",data:r.serialize(),reloadPage:!0})})},t.prototype._initNavigation=function(){var e=this;this._onPopStateScoped=this._onPopStateScoped||n.proxy(this._onPopState,this),n(window).bind("popstate."+r,this._onPopStateScoped),n(window).bind("appviewpagehashchange."+r,function(){return e._navigateToCurrentLocation()}),this._onNavigateScoped=this._onNavigateScoped||n.proxy(this._onNavigate,this),n(n.mobile.pageContainer).bind("navigate."+r,this._onNavigateScoped)},t.prototype._create=function(){this._pageStore=[],this._documentUrl=this._removePageUrlParam(location.href),this.element.attr("data-url",this._documentUrl),this.element.addClass(this._appViewCSS().outerDiv),this._initMenu(),this._initPageContainer(),this._hijackLinks(this.element),this._hijackForms(this.element),this._initNavigation(),this._navigateToCurrentLocation()},t.prototype.destroy=function(){e.prototype.destroy.call(this);var t="."+r;this.element.unbind(t),n(window).unbind(t),n(n.mobile.pageContainer).unbind(t)},t.prototype._initCurrentPage=function(){var e=this._appViewCSS(),t=this.activePage();t.findRole(i.content).addClass(e.content);var n=t.findRole(i.header).addClass(e.header),r=n.jqmData("position"),s=!r||r==="fixed";s&&n.addClass("ui-header-fixed"),this.element.toggleClass(e.withFixedHeader,s)},t.prototype._findClosestLink=function(e){while(e&&(typeof e.nodeName!="string"||e.nodeName.toLowerCase()!=="a"))e=e.parentNode;return e},t.prototype._clickHandler=function(e){var t=n(e.currentTarget),r=t.is("li")?t.jqmData("url"):t.is("a")?t.attr("href"):null;if(!r)return;e.preventDefault(),e.stopPropagation(),this.changePage(r)},t.prototype._inheritAttribute=function(e,t,n){e.attr(n)&&!t.attr(n)&&t.attr(n,e.attr(n))},t.prototype.loadPage=function(e,t){var r=this;e=e||"";var s=n.Deferred(),o=n.mobile.path,u=n.extend({},this.options.loadSettings,t),a=!e||e.charAt(0)==="#",f=null,l=null,c=this._makeAbsoluteUrl(e);if(u.data)switch(u.type){case"get":c=o.addSearchParams(c,u.data),u.data=undefined;break;case"post":u.reloadPage=!0}var h=n.Event("pagebeforeload"),p={url:e,absUrl:c,dataUrl:c,deferred:s,options:u};this._trigger(h.type,h,p);if(h.isDefaultPrevented())return s.promise();if(!n.mobile.allowCrossDomainPages&&!o.isSameDomain(o.parseLocation(),c))return s.reject(c,t),s.promise();var d=c&&o.getFilePath(c).replace(/#.+/,""),v=n.ajax({url:d,type:u.type,data:u.data,dataType:"html",success:function(u,a,h){function y(e){return o.isAbsoluteUrl(e)||/^(\w+:|#|\/)/.test(e)?null:o.makeUrlAbsolute(e,d)}var v=n("<div></div>"),m=new RegExp("(<[^>]+\\bdata-"+n.mobile.ns+"role=[\"']?"+i.page+"[\"']?[^>]*>)"),g=new RegExp("\\bdata-"+n.mobile.ns+"url=[\"']?([^\"'>]*)[\"']?");n.browser.msie&&parseFloat(n.browser.version)<=7&&(u=u.replace(/<a[^>]+href=['"][^'"]+['"]/g,function(e){return e.replace(/href=['"]([^'"]+)['"]/,function(e,t){return t=y(t)||t,"href='"+t+"'"})})),v.get(0).innerHTML=u;var b=r._getAllPages(v,e);b.length||(b=n("<div/>").attr("data-role",i.page).html(u.split(/<\/?body[^>]*>/gmi)[1]));var w=u.match(/<title[^>]*>([^<]*)/)&&RegExp.$1;w&&~w.indexOf("&")&&(w=n("<div>"+w+"</div>").text()),b.each(function(e,t){t=n(t),t.attr("data-external-page",!0),!t.jqmData("title")&&w&&t.attr("data-title",w);var r=o.get(d);t.find("[src], [href]").each(function(){var e=n(this).is("[href]")?"href":n(this).is("[src]")?"src":"action",t=y(n(this).attr(e));t&&n(this).attr(e,t)})}),r._initPages(b,d),f=b.filter(function(){return n(this).jqmData("url")===c}),f.length||(f=b.first()),p.xhr=h,p.textStatus=a,p.page=f,p.allPages=b,r._trigger("pageload",null,p),b.each(function(e,t){r._pageStore.push(n(t).clone())}),s.resolve(c,t,f,l)},error:function(e,i,o){p.xhr=e,p.textStatus=i,p.errorThrown=o;var u=n.Event("pageloadfailed");r._trigger(u.type,u,p);if(u.isDefaultPrevented())return;s.reject(c,t)}});return s.fail(function(){v.abort()}),s},t.prototype._getAllPages=function(e,t){return e.findRole(i.page)},t.prototype.activePage=function(){return this._pageContainer.children("."+this._appViewCSS().pageActive).first()},t.prototype.isMenuUrl=function(e){var t=this;return e=e.toLowerCase(),this._menuDiv.find("a").is(function(){return t._getUrl(n(this)).toLowerCase()===e})},t.prototype._showLoading=function(){n.mobile.loading("show")},t.prototype._hideLoading=function(){n.mobile.loading("hide")},t.prototype.changePage=function(e,t){var r=this;t=n.extend({updateUrl:!0},this.options.loadSettings,t);var o={toPage:e,options:t};this._curRequest&&this._curRequest.state()==="pending"&&this._curRequest.rejectWith&&this._curRequest.rejectWith(this,[e,t,!0]);if(typeof e=="string"){var a=this.activePage().data("url"),f=this._makeAbsoluteUrl(e);this._updateUIBeforeChange(f),t.showLoadMsg&&this._showLoading(),this._curRequest=this.loadPage(e,t).always(function(){t.showLoadMsg&&r._hideLoading(),r._curRequest=null}).done(function(e,t,n,i){r._updateUIAfterChange(n.jqmData("url")),r.changePage(n,t)}).fail(function(e,t,n){n||r._updateUI(a),r._trigger("pagechangefailed",null,o)});return}var l=n.Event("pagebeforechange");this._trigger(l.type,l,o);if(l.isDefaultPrevented())return;var c=e.jqmData("url"),h=null;this._updateUI(c),c&&(h=this._makeRelative(c),h!=null&&(h=this._makeRelative(h)));var p=e.jqmData("title"),d=e.findRole("header"),v=this._appViewCSS();!d.length&&p&&(d=n("<div data-role='header'/>").append(n("<h2/>").text(p)).prependTo(e));if(d.length&&!d.jqmData(s.adjusted)){d.jqmData(s.adjusted,!0);var m=this._firstPage.findRole(i.header);m&&this._inheritAttribute(m,d,"data-position"),this.isMenuUrl(c)&&!d.find("a[data-icon=back]").length&&n("<a/>").attr({href:this._documentUrl,"data-icon":"back"}).text("Back").prependTo(d)}p&&(document.title=p),this._pageContainer.children().removeClass(v.pageActive),e.addClass(v.pageActive).appendTo(this._pageContainer.empty()),this._initCurrentPage();if(t.updateUrl||u)this._updateUrl(c,h,document.title),u=!1;e.jqmData("page",n.mobile.activePage.jqmData("page")).trigger("pagecreate").trigger(this.widgetEventPrefix+"pageinit",o),this._trigger("pagechange",null,o)},t.prototype._updateUIBeforeChange=function(e){var t=this,r=e===this._documentUrl,i=this._linkList.find("li"),s=this._appViewCSS().menuItemActive;if(r)i.removeClass(s);else{var o=i.filter(function(){var r=t._getUrl(n(this).find("a"));return r&&r.toLowerCase()===e.toLowerCase()});o.length&&!o.hasClass(s)&&(i.removeClass(s),o.addClass(s))}},t.prototype._updateUIAfterChange=function(e){var t=this._appViewCSS(),n=e===this._documentUrl;this.element.toggleClass(t.inPage,!n)},t.prototype._updateUI=function(e){this._updateUIBeforeChange(e),this._updateUIAfterChange(e)},t.prototype._changePageIfDifferent=function(e,t){var n=typeof e=="string"?e:e.jqmData("url");this.activePage().jqmData("url")!==n&&this.changePage(e,t)},t.prototype._onNavigate=function(e){var t=new RegExp("^#?"+this.options.urlParamName+"=");(history.state&&history.state.wijappview||document.location.hash.match(t))&&e.preventDefault()},t.prototype._removePageUrlParam=function(e){return e.replace(/\#.*$/,"")},t.prototype._addUrl=function(e){var t=this.options.urlParamName,n=this._removePageUrlParam(location.href);return e&&(n+="#"+t+"="+e),n},t.prototype._makeRelative=function(e){var t=n.mobile.path.parseLocation(),r=e;if(e){var i=t.domain+t.directory;e.substr(0,t.hrefNoHash.length)===t.hrefNoHash?r=e.substr(t.hrefNoHash.length):e.substr(0,i.length)===i&&(r=e.substr(i.length))}return r},t.prototype._makeAbsoluteUrl=function(e){var t=n.mobile.path,r=this.activePage(),i=t.makeUrlAbsolute(r.jqmData("url")||this._documentUrl,this._documentUrl);return!i.match(/\/$/)&&!i.match(/\./)&&(i+="/"),e&&t.makeUrlAbsolute(e,i)},t.prototype._onPopState=function(e){if(this._updatingUrl)return;history.state&&history.state.wijappview?this._changePageIfDifferent(history.state.absUrl||this._firstPage,{updateUrl:!1}):this._navigateToCurrentLocation()},t.prototype._navigateToCurrentLocation=function(){var e=new RegExp("#"+this.options.urlParamName+"=(.+)"),t=e.exec(location.href)||o&&e.exec(o),r=t?n.mobile.path.makeUrlAbsolute(t[1],this._documentUrl):this._firstPage;o="",this._changePageIfDifferent(r,{updateUrl:!1})},t.prototype._updateUrl=function(e,t,r){this._updatingUrl=!0;try{n.mobile.urlHistory.ignoreNextHashChange=!0,document.location.hash=e===this._documentUrl?"":this.options.urlParamName+"="+t}finally{this._updatingUrl=!1}},t}(e.wijmoWidget);t.wijappview=a;var f="wijmo-wijappview",l=f+"-",c=function(){function e(){this.urlParamName="appviewpage",this.loadSettings={type:"GET",data:undefined,reloadPage:!1,showLoadMsg:!1},this.wijCSS={wijappview:{outerDiv:f,inPage:l+"in-page",menu:l+"menu",menuItemActive:"ui-btn-down-b",page:l+"page",pageActive:l+"page-active",pageContainer:l+"page-container",content:l+"content",header:l+"header",withFixedHeader:l+"with-fixed-header"}}}return e}();t.wijappview_options=c,a.prototype.options=n.extend({},e.wijmoWidget.prototype.options,new c),n.mobile&&(n.wijmo.registerWidget(r,a.prototype),n(window).bind("hashchange",function(e){h()&&(e.stopImmediatePropagation(),n(window).trigger("appviewpagehashchange"))}),h()&&(o=document.location.hash,n(window).bind("pagecontainercreate",function(){document.location.hash="",u=!0})))})(e.appview||(e.appview={}));var t=e.appview})(wijmo||(wijmo={}));